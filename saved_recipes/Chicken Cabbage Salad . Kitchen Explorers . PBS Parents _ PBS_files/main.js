define("home/config",[],function(){return{appRoot:"/"}}),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e){var t="length"in e&&e.length,n=at.type(e);return"function"===n||at.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function i(e,t,n){if(at.isFunction(t))return at.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return at.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(ht.test(t))return at.filter(t,e,n);t=at.filter(t,e)}return at.grep(e,function(e){return at.inArray(e,t)>=0!==n})}function a(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function s(e){var t=xt[e]={};return at.each(e.match(bt)||[],function(e,n){t[n]=!0}),t}function o(){pt.addEventListener?(pt.removeEventListener("DOMContentLoaded",r,!1),e.removeEventListener("load",r,!1)):(pt.detachEvent("onreadystatechange",r),e.detachEvent("onload",r))}function r(){(pt.addEventListener||"load"===event.type||"complete"===pt.readyState)&&(o(),at.ready())}function l(e,t,n){if(void 0===n&&1===e.nodeType){var i="data-"+t.replace(Tt,"-$1").toLowerCase();if(n=e.getAttribute(i),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:Ct.test(n)?at.parseJSON(n):n}catch(a){}at.data(e,t,n)}else n=void 0}return n}function c(e){var t;for(t in e)if(("data"!==t||!at.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function d(e,t,n,i){if(at.acceptData(e)){var a,s,o=at.expando,r=e.nodeType,l=r?at.cache:e,c=r?e[o]:e[o]&&o;if(c&&l[c]&&(i||l[c].data)||void 0!==n||"string"!=typeof t)return c||(c=r?e[o]=Y.pop()||at.guid++:o),l[c]||(l[c]=r?{}:{toJSON:at.noop}),("object"==typeof t||"function"==typeof t)&&(i?l[c]=at.extend(l[c],t):l[c].data=at.extend(l[c].data,t)),s=l[c],i||(s.data||(s.data={}),s=s.data),void 0!==n&&(s[at.camelCase(t)]=n),"string"==typeof t?(a=s[t],null==a&&(a=s[at.camelCase(t)])):a=s,a}}function u(e,t,n){if(at.acceptData(e)){var i,a,s=e.nodeType,o=s?at.cache:e,r=s?e[at.expando]:at.expando;if(o[r]){if(t&&(i=n?o[r]:o[r].data)){at.isArray(t)?t=t.concat(at.map(t,at.camelCase)):t in i?t=[t]:(t=at.camelCase(t),t=t in i?[t]:t.split(" ")),a=t.length;for(;a--;)delete i[t[a]];if(n?!c(i):!at.isEmptyObject(i))return}(n||(delete o[r].data,c(o[r])))&&(s?at.cleanData([e],!0):nt.deleteExpando||o!=o.window?delete o[r]:o[r]=null)}}}function h(){return!0}function m(){return!1}function p(){try{return pt.activeElement}catch(e){}}function f(e){var t=Ot.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function g(e,t){var n,i,a=0,s=typeof e.getElementsByTagName!==kt?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==kt?e.querySelectorAll(t||"*"):void 0;if(!s)for(s=[],n=e.childNodes||e;null!=(i=n[a]);a++)!t||at.nodeName(i,t)?s.push(i):at.merge(s,g(i,t));return void 0===t||t&&at.nodeName(e,t)?at.merge([e],s):s}function v(e){Dt.test(e.type)&&(e.defaultChecked=e.checked)}function w(e,t){return at.nodeName(e,"table")&&at.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function b(e){return e.type=(null!==at.find.attr(e,"type"))+"/"+e.type,e}function x(e){var t=Gt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function y(e,t){for(var n,i=0;null!=(n=e[i]);i++)at._data(n,"globalEval",!t||at._data(t[i],"globalEval"))}function _(e,t){if(1===t.nodeType&&at.hasData(e)){var n,i,a,s=at._data(e),o=at._data(t,s),r=s.events;if(r){delete o.handle,o.events={};for(n in r)for(i=0,a=r[n].length;a>i;i++)at.event.add(t,n,r[n][i])}o.data&&(o.data=at.extend({},o.data))}}function k(e,t){var n,i,a;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!nt.noCloneEvent&&t[at.expando]){a=at._data(t);for(i in a.events)at.removeEvent(t,i,a.handle);t.removeAttribute(at.expando)}"script"===n&&t.text!==e.text?(b(t).text=e.text,x(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),nt.html5Clone&&e.innerHTML&&!at.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Dt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function C(t,n){var i,a=at(n.createElement(t)).appendTo(n.body),s=e.getDefaultComputedStyle&&(i=e.getDefaultComputedStyle(a[0]))?i.display:at.css(a[0],"display");return a.detach(),s}function T(e){var t=pt,n=Zt[e];return n||(n=C(e,t),"none"!==n&&n||(Qt=(Qt||at("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=(Qt[0].contentWindow||Qt[0].contentDocument).document,t.write(),t.close(),n=C(e,t),Qt.detach()),Zt[e]=n),n}function S(e,t){return{get:function(){var n=e();if(null!=n)return n?void delete this.get:(this.get=t).apply(this,arguments)}}}function E(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),i=t,a=mn.length;a--;)if(t=mn[a]+n,t in e)return t;return i}function F(e,t){for(var n,i,a,s=[],o=0,r=e.length;r>o;o++)i=e[o],i.style&&(s[o]=at._data(i,"olddisplay"),n=i.style.display,t?(s[o]||"none"!==n||(i.style.display=""),""===i.style.display&&Ft(i)&&(s[o]=at._data(i,"olddisplay",T(i.nodeName)))):(a=Ft(i),(n&&"none"!==n||!a)&&at._data(i,"olddisplay",a?n:at.css(i,"display"))));for(o=0;r>o;o++)i=e[o],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?s[o]||"":"none"));return e}function P(e,t,n){var i=cn.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function D(e,t,n,i,a){for(var s=n===(i?"border":"content")?4:"width"===t?1:0,o=0;4>s;s+=2)"margin"===n&&(o+=at.css(e,n+Et[s],!0,a)),i?("content"===n&&(o-=at.css(e,"padding"+Et[s],!0,a)),"margin"!==n&&(o-=at.css(e,"border"+Et[s]+"Width",!0,a))):(o+=at.css(e,"padding"+Et[s],!0,a),"padding"!==n&&(o+=at.css(e,"border"+Et[s]+"Width",!0,a)));return o}function M(e,t,n){var i=!0,a="width"===t?e.offsetWidth:e.offsetHeight,s=en(e),o=nt.boxSizing&&"border-box"===at.css(e,"boxSizing",!1,s);if(0>=a||null==a){if(a=tn(e,t,s),(0>a||null==a)&&(a=e.style[t]),an.test(a))return a;i=o&&(nt.boxSizingReliable()||a===e.style[t]),a=parseFloat(a)||0}return a+D(e,t,n||(o?"border":"content"),i,s)+"px"}function V(e,t,n,i,a){return new V.prototype.init(e,t,n,i,a)}function A(){return setTimeout(function(){pn=void 0}),pn=at.now()}function R(e,t){var n,i={height:e},a=0;for(t=t?1:0;4>a;a+=2-t)n=Et[a],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function N(e,t,n){for(var i,a=(xn[t]||[]).concat(xn["*"]),s=0,o=a.length;o>s;s++)if(i=a[s].call(n,t,e))return i}function O(e,t,n){var i,a,s,o,r,l,c,d,u=this,h={},m=e.style,p=e.nodeType&&Ft(e),f=at._data(e,"fxshow");n.queue||(r=at._queueHooks(e,"fx"),null==r.unqueued&&(r.unqueued=0,l=r.empty.fire,r.empty.fire=function(){r.unqueued||l()}),r.unqueued++,u.always(function(){u.always(function(){r.unqueued--,at.queue(e,"fx").length||r.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[m.overflow,m.overflowX,m.overflowY],c=at.css(e,"display"),d="none"===c?at._data(e,"olddisplay")||T(e.nodeName):c,"inline"===d&&"none"===at.css(e,"float")&&(nt.inlineBlockNeedsLayout&&"inline"!==T(e.nodeName)?m.zoom=1:m.display="inline-block")),n.overflow&&(m.overflow="hidden",nt.shrinkWrapBlocks()||u.always(function(){m.overflow=n.overflow[0],m.overflowX=n.overflow[1],m.overflowY=n.overflow[2]}));for(i in t)if(a=t[i],gn.exec(a)){if(delete t[i],s=s||"toggle"===a,a===(p?"hide":"show")){if("show"!==a||!f||void 0===f[i])continue;p=!0}h[i]=f&&f[i]||at.style(e,i)}else c=void 0;if(at.isEmptyObject(h))"inline"===("none"===c?T(e.nodeName):c)&&(m.display=c);else{f?"hidden"in f&&(p=f.hidden):f=at._data(e,"fxshow",{}),s&&(f.hidden=!p),p?at(e).show():u.done(function(){at(e).hide()}),u.done(function(){var t;at._removeData(e,"fxshow");for(t in h)at.style(e,t,h[t])});for(i in h)o=N(p?f[i]:0,i,u),i in f||(f[i]=o.start,p&&(o.end=o.start,o.start="width"===i||"height"===i?1:0))}}function I(e,t){var n,i,a,s,o;for(n in e)if(i=at.camelCase(n),a=t[i],s=e[n],at.isArray(s)&&(a=s[1],s=e[n]=s[0]),n!==i&&(e[i]=s,delete e[n]),o=at.cssHooks[i],o&&"expand"in o){s=o.expand(s),delete e[i];for(n in s)n in e||(e[n]=s[n],t[n]=a)}else t[i]=a}function U(e,t,n){var i,a,s=0,o=bn.length,r=at.Deferred().always(function(){delete l.elem}),l=function(){if(a)return!1;for(var t=pn||A(),n=Math.max(0,c.startTime+c.duration-t),i=n/c.duration||0,s=1-i,o=0,l=c.tweens.length;l>o;o++)c.tweens[o].run(s);return r.notifyWith(e,[c,s,n]),1>s&&l?n:(r.resolveWith(e,[c]),!1)},c=r.promise({elem:e,props:at.extend({},t),opts:at.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:pn||A(),duration:n.duration,tweens:[],createTween:function(t,n){var i=at.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(a)return this;for(a=!0;i>n;n++)c.tweens[n].run(1);return t?r.resolveWith(e,[c,t]):r.rejectWith(e,[c,t]),this}}),d=c.props;for(I(d,c.opts.specialEasing);o>s;s++)if(i=bn[s].call(c,e,d,c.opts))return i;return at.map(d,N,c),at.isFunction(c.opts.start)&&c.opts.start.call(e,c),at.fx.timer(at.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function L(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,a=0,s=t.toLowerCase().match(bt)||[];if(at.isFunction(n))for(;i=s[a++];)"+"===i.charAt(0)?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function q(e,t,n,i){function a(r){var l;return s[r]=!0,at.each(e[r]||[],function(e,r){var c=r(t,n,i);return"string"!=typeof c||o||s[c]?o?!(l=c):void 0:(t.dataTypes.unshift(c),a(c),!1)}),l}var s={},o=e===zn;return a(t.dataTypes[0])||!s["*"]&&a("*")}function H(e,t){var n,i,a=at.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((a[i]?e:n||(n={}))[i]=t[i]);return n&&at.extend(!0,e,n),e}function $(e,t,n){for(var i,a,s,o,r=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===a&&(a=e.mimeType||t.getResponseHeader("Content-Type"));if(a)for(o in r)if(r[o]&&r[o].test(a)){l.unshift(o);break}if(l[0]in n)s=l[0];else{for(o in n){if(!l[0]||e.converters[o+" "+l[0]]){s=o;break}i||(i=o)}s=s||i}return s?(s!==l[0]&&l.unshift(s),n[s]):void 0}function j(e,t,n,i){var a,s,o,r,l,c={},d=e.dataTypes.slice();if(d[1])for(o in e.converters)c[o.toLowerCase()]=e.converters[o];for(s=d.shift();s;)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=s,s=d.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(o=c[l+" "+s]||c["* "+s],!o)for(a in c)if(r=a.split(" "),r[1]===s&&(o=c[l+" "+r[0]]||c["* "+r[0]])){o===!0?o=c[a]:c[a]!==!0&&(s=r[0],d.unshift(r[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(u){return{state:"parsererror",error:o?u:"No conversion from "+l+" to "+s}}}return{state:"success",data:t}}function z(e,t,n,i){var a;if(at.isArray(t))at.each(t,function(t,a){n||Yn.test(e)?i(e,a):z(e+"["+("object"==typeof a?t:"")+"]",a,n,i)});else if(n||"object"!==at.type(t))i(e,t);else for(a in t)z(e+"["+a+"]",t[a],n,i)}function B(){try{return new e.XMLHttpRequest}catch(t){}}function W(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function G(e){return at.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var Y=[],J=Y.slice,K=Y.concat,X=Y.push,Q=Y.indexOf,Z={},et=Z.toString,tt=Z.hasOwnProperty,nt={},it="1.11.3",at=function(e,t){return new at.fn.init(e,t)},st=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ot=/^-ms-/,rt=/-([\da-z])/gi,lt=function(e,t){return t.toUpperCase()};at.fn=at.prototype={jquery:it,constructor:at,selector:"",length:0,toArray:function(){return J.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:J.call(this)},pushStack:function(e){var t=at.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return at.each(this,e,t)},map:function(e){return this.pushStack(at.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(J.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:X,sort:Y.sort,splice:Y.splice},at.extend=at.fn.extend=function(){var e,t,n,i,a,s,o=arguments[0]||{},r=1,l=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[r]||{},r++),"object"==typeof o||at.isFunction(o)||(o={}),r===l&&(o=this,r--);l>r;r++)if(null!=(a=arguments[r]))for(i in a)e=o[i],n=a[i],o!==n&&(c&&n&&(at.isPlainObject(n)||(t=at.isArray(n)))?(t?(t=!1,s=e&&at.isArray(e)?e:[]):s=e&&at.isPlainObject(e)?e:{},o[i]=at.extend(c,s,n)):void 0!==n&&(o[i]=n));return o},at.extend({expando:"jQuery"+(it+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw Error(e)},noop:function(){},isFunction:function(e){return"function"===at.type(e)},isArray:Array.isArray||function(e){return"array"===at.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!at.isArray(e)&&e-parseFloat(e)+1>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==at.type(e)||e.nodeType||at.isWindow(e))return!1;try{if(e.constructor&&!tt.call(e,"constructor")&&!tt.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(nt.ownLast)for(t in e)return tt.call(e,t);for(t in e);return void 0===t||tt.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Z[et.call(e)]||"object":typeof e},globalEval:function(t){t&&at.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(ot,"ms-").replace(rt,lt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var a,s=0,o=e.length,r=n(e);if(i){if(r)for(;o>s&&(a=t.apply(e[s],i),a!==!1);s++);else for(s in e)if(a=t.apply(e[s],i),a===!1)break}else if(r)for(;o>s&&(a=t.call(e[s],s,e[s]),a!==!1);s++);else for(s in e)if(a=t.call(e[s],s,e[s]),a===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(st,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?at.merge(i,"string"==typeof e?[e]:e):X.call(i,e)),i},inArray:function(e,t,n){var i;if(t){if(Q)return Q.call(t,e,n);for(i=t.length,n=n?0>n?Math.max(0,i+n):n:0;i>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){for(var n=+t.length,i=0,a=e.length;n>i;)e[a++]=t[i++];if(n!==n)for(;void 0!==t[i];)e[a++]=t[i++];return e.length=a,e},grep:function(e,t,n){for(var i,a=[],s=0,o=e.length,r=!n;o>s;s++)i=!t(e[s],s),i!==r&&a.push(e[s]);return a},map:function(e,t,i){var a,s=0,o=e.length,r=n(e),l=[];if(r)for(;o>s;s++)a=t(e[s],s,i),null!=a&&l.push(a);else for(s in e)a=t(e[s],s,i),null!=a&&l.push(a);return K.apply([],l)},guid:1,proxy:function(e,t){var n,i,a;return"string"==typeof t&&(a=e[t],t=e,e=a),at.isFunction(e)?(n=J.call(arguments,2),i=function(){return e.apply(t||this,n.concat(J.call(arguments)))},i.guid=e.guid=e.guid||at.guid++,i):void 0},now:function(){return+new Date},support:nt}),at.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Z["[object "+t+"]"]=t.toLowerCase()});var ct=function(e){function t(e,t,n,i){var a,s,o,r,l,c,u,m,p,f;if((t?t.ownerDocument||t:q)!==V&&M(t),t=t||V,n=n||[],r=t.nodeType,"string"!=typeof e||!e||1!==r&&9!==r&&11!==r)return n;if(!i&&R){if(11!==r&&(a=wt.exec(e)))if(o=a[1]){if(9===r){if(s=t.getElementById(o),!s||!s.parentNode)return n;if(s.id===o)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&U(t,s)&&s.id===o)return n.push(s),n}else{if(a[2])return Q.apply(n,t.getElementsByTagName(e)),n;if((o=a[3])&&y.getElementsByClassName)return Q.apply(n,t.getElementsByClassName(o)),n}if(y.qsa&&(!N||!N.test(e))){if(m=u=L,p=t,f=1!==r&&e,1===r&&"object"!==t.nodeName.toLowerCase()){for(c=T(e),(u=t.getAttribute("id"))?m=u.replace(xt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",l=c.length;l--;)c[l]=m+h(c[l]);p=bt.test(e)&&d(t.parentNode)||t,f=c.join(",")}if(f)try{return Q.apply(n,p.querySelectorAll(f)),n}catch(g){}finally{u||t.removeAttribute("id")}}}return E(e.replace(lt,"$1"),t,n,i)}function n(){function e(n,i){return t.push(n+" ")>_.cacheLength&&delete e[t.shift()],e[n+" "]=i}var t=[];return e}function i(e){return e[L]=!0,e}function a(e){var t=V.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function s(e,t){for(var n=e.split("|"),i=e.length;i--;)_.attrHandle[n[i]]=t}function o(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||G)-(~e.sourceIndex||G);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function r(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function l(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function c(e){return i(function(t){return t=+t,i(function(n,i){for(var a,s=e([],n.length,t),o=s.length;o--;)n[a=s[o]]&&(n[a]=!(i[a]=n[a]))})})}function d(e){return e&&void 0!==e.getElementsByTagName&&e}function u(){}function h(e){for(var t=0,n=e.length,i="";n>t;t++)i+=e[t].value;return i}function m(e,t,n){var i=t.dir,a=n&&"parentNode"===i,s=$++;return t.first?function(t,n,s){for(;t=t[i];)if(1===t.nodeType||a)return e(t,n,s)}:function(t,n,o){var r,l,c=[H,s];if(o){for(;t=t[i];)if((1===t.nodeType||a)&&e(t,n,o))return!0}else for(;t=t[i];)if(1===t.nodeType||a){if(l=t[L]||(t[L]={}),(r=l[i])&&r[0]===H&&r[1]===s)return c[2]=r[2];if(l[i]=c,c[2]=e(t,n,o))return!0}}}function p(e){return e.length>1?function(t,n,i){for(var a=e.length;a--;)if(!e[a](t,n,i))return!1;return!0}:e[0]}function f(e,n,i){for(var a=0,s=n.length;s>a;a++)t(e,n[a],i);return i}function g(e,t,n,i,a){for(var s,o=[],r=0,l=e.length,c=null!=t;l>r;r++)(s=e[r])&&(!n||n(s,i,a))&&(o.push(s),c&&t.push(r));return o}function v(e,t,n,a,s,o){return a&&!a[L]&&(a=v(a)),s&&!s[L]&&(s=v(s,o)),i(function(i,o,r,l){var c,d,u,h=[],m=[],p=o.length,v=i||f(t||"*",r.nodeType?[r]:r,[]),w=!e||!i&&t?v:g(v,h,e,r,l),b=n?s||(i?e:p||a)?[]:o:w;if(n&&n(w,b,r,l),a)for(c=g(b,m),a(c,[],r,l),d=c.length;d--;)(u=c[d])&&(b[m[d]]=!(w[m[d]]=u));if(i){if(s||e){if(s){for(c=[],d=b.length;d--;)(u=b[d])&&c.push(w[d]=u);s(null,b=[],c,l)}for(d=b.length;d--;)(u=b[d])&&(c=s?et(i,u):h[d])>-1&&(i[c]=!(o[c]=u))}}else b=g(b===o?b.splice(p,b.length):b),s?s(null,o,b,l):Q.apply(o,b)})}function w(e){for(var t,n,i,a=e.length,s=_.relative[e[0].type],o=s||_.relative[" "],r=s?1:0,l=m(function(e){return e===t},o,!0),c=m(function(e){return et(t,e)>-1},o,!0),d=[function(e,n,i){var a=!s&&(i||n!==F)||((t=n).nodeType?l(e,n,i):c(e,n,i));return t=null,a}];a>r;r++)if(n=_.relative[e[r].type])d=[m(p(d),n)];else{if(n=_.filter[e[r].type].apply(null,e[r].matches),n[L]){for(i=++r;a>i&&!_.relative[e[i].type];i++);return v(r>1&&p(d),r>1&&h(e.slice(0,r-1).concat({value:" "===e[r-2].type?"*":""})).replace(lt,"$1"),n,i>r&&w(e.slice(r,i)),a>i&&w(e=e.slice(i)),a>i&&h(e))}d.push(n)}return p(d)}function b(e,n){var a=n.length>0,s=e.length>0,o=function(i,o,r,l,c){var d,u,h,m=0,p="0",f=i&&[],v=[],w=F,b=i||s&&_.find.TAG("*",c),x=H+=null==w?1:Math.random()||.1,y=b.length;for(c&&(F=o!==V&&o);p!==y&&null!=(d=b[p]);p++){if(s&&d){for(u=0;h=e[u++];)if(h(d,o,r)){l.push(d);break}c&&(H=x)}a&&((d=!h&&d)&&m--,i&&f.push(d))}if(m+=p,a&&p!==m){for(u=0;h=n[u++];)h(f,v,o,r);if(i){if(m>0)for(;p--;)f[p]||v[p]||(v[p]=K.call(l));v=g(v)}Q.apply(l,v),c&&!i&&v.length>0&&m+n.length>1&&t.uniqueSort(l)}return c&&(H=x,F=w),f};return a?i(o):o}var x,y,_,k,C,T,S,E,F,P,D,M,V,A,R,N,O,I,U,L="sizzle"+1*new Date,q=e.document,H=0,$=0,j=n(),z=n(),B=n(),W=function(e,t){return e===t&&(D=!0),0},G=1<<31,Y={}.hasOwnProperty,J=[],K=J.pop,X=J.push,Q=J.push,Z=J.slice,et=function(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},tt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",at=it.replace("w","w#"),st="\\["+nt+"*("+it+")(?:"+nt+"*([*^$|!~]?=)"+nt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+at+"))|)"+nt+"*\\]",ot=":("+it+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+st+")*)|.*)\\)|)",rt=RegExp(nt+"+","g"),lt=RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),ct=RegExp("^"+nt+"*,"+nt+"*"),dt=RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),ut=RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),ht=RegExp(ot),mt=RegExp("^"+at+"$"),pt={ID:RegExp("^#("+it+")"),CLASS:RegExp("^\\.("+it+")"),TAG:RegExp("^("+it.replace("w","w*")+")"),ATTR:RegExp("^"+st),PSEUDO:RegExp("^"+ot),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:RegExp("^(?:"+tt+")$","i"),needsContext:RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},ft=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,wt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,bt=/[+~]/,xt=/'|\\/g,yt=RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),_t=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},kt=function(){M()};try{Q.apply(J=Z.call(q.childNodes),q.childNodes)}catch(Ct){Q={apply:J.length?function(e,t){X.apply(e,Z.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}y=t.support={},C=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},M=t.setDocument=function(e){var t,n,i=e?e.ownerDocument||e:q;return i!==V&&9===i.nodeType&&i.documentElement?(V=i,A=i.documentElement,n=i.defaultView,n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",kt,!1):n.attachEvent&&n.attachEvent("onunload",kt)),R=!C(i),y.attributes=a(function(e){return e.className="i",!e.getAttribute("className")}),y.getElementsByTagName=a(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),y.getElementsByClassName=vt.test(i.getElementsByClassName),y.getById=a(function(e){return A.appendChild(e).id=L,!i.getElementsByName||!i.getElementsByName(L).length}),y.getById?(_.find.ID=function(e,t){if(void 0!==t.getElementById&&R){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},_.filter.ID=function(e){var t=e.replace(yt,_t);return function(e){return e.getAttribute("id")===t}}):(delete _.find.ID,_.filter.ID=function(e){var t=e.replace(yt,_t);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),_.find.TAG=y.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):y.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],a=0,s=t.getElementsByTagName(e);if("*"===e){for(;n=s[a++];)1===n.nodeType&&i.push(n);return i}return s},_.find.CLASS=y.getElementsByClassName&&function(e,t){return R?t.getElementsByClassName(e):void 0},O=[],N=[],(y.qsa=vt.test(i.querySelectorAll))&&(a(function(e){A.appendChild(e).innerHTML="<a id='"+L+"'></a><select id='"+L+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&N.push("[*^$]="+nt+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||N.push("\\["+nt+"*(?:value|"+tt+")"),e.querySelectorAll("[id~="+L+"-]").length||N.push("~="),e.querySelectorAll(":checked").length||N.push(":checked"),e.querySelectorAll("a#"+L+"+*").length||N.push(".#.+[+~]")}),a(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&N.push("name"+nt+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||N.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),N.push(",.*:")})),(y.matchesSelector=vt.test(I=A.matches||A.webkitMatchesSelector||A.mozMatchesSelector||A.oMatchesSelector||A.msMatchesSelector))&&a(function(e){y.disconnectedMatch=I.call(e,"div"),I.call(e,"[s!='']:x"),O.push("!=",ot)}),N=N.length&&RegExp(N.join("|")),O=O.length&&RegExp(O.join("|")),t=vt.test(A.compareDocumentPosition),U=t||vt.test(A.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},W=t?function(e,t){if(e===t)return D=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!y.sortDetached&&t.compareDocumentPosition(e)===n?e===i||e.ownerDocument===q&&U(q,e)?-1:t===i||t.ownerDocument===q&&U(q,t)?1:P?et(P,e)-et(P,t):0:4&n?-1:1)}:function(e,t){if(e===t)return D=!0,0;var n,a=0,s=e.parentNode,r=t.parentNode,l=[e],c=[t];if(!s||!r)return e===i?-1:t===i?1:s?-1:r?1:P?et(P,e)-et(P,t):0;if(s===r)return o(e,t);for(n=e;n=n.parentNode;)l.unshift(n);for(n=t;n=n.parentNode;)c.unshift(n);for(;l[a]===c[a];)a++;return a?o(l[a],c[a]):l[a]===q?-1:c[a]===q?1:0},i):V},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==V&&M(e),n=n.replace(ut,"='$1']"),!(!y.matchesSelector||!R||O&&O.test(n)||N&&N.test(n)))try{var i=I.call(e,n);if(i||y.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(a){}return t(n,V,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==V&&M(e),U(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==V&&M(e);var n=_.attrHandle[t.toLowerCase()],i=n&&Y.call(_.attrHandle,t.toLowerCase())?n(e,t,!R):void 0;return void 0!==i?i:y.attributes||!R?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},t.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],i=0,a=0;if(D=!y.detectDuplicates,P=!y.sortStable&&e.slice(0),e.sort(W),D){for(;t=e[a++];)t===e[a]&&(i=n.push(a));for(;i--;)e.splice(n[i],1)}return P=null,e},k=t.getText=function(e){var t,n="",i=0,a=e.nodeType;if(a){if(1===a||9===a||11===a){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=k(e)}else if(3===a||4===a)return e.nodeValue}else for(;t=e[i++];)n+=k(t);return n},_=t.selectors={cacheLength:50,createPseudo:i,match:pt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(yt,_t),e[3]=(e[3]||e[4]||e[5]||"").replace(yt,_t),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return pt.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&ht.test(n)&&(t=T(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(yt,_t).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=j[e+" "];return t||(t=RegExp("(^|"+nt+")"+e+"("+nt+"|$)"))&&j(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,i){return function(a){var s=t.attr(a,e);return null==s?"!="===n:n?(s+="","="===n?s===i:"!="===n?s!==i:"^="===n?i&&0===s.indexOf(i):"*="===n?i&&s.indexOf(i)>-1:"$="===n?i&&s.slice(-i.length)===i:"~="===n?(" "+s.replace(rt," ")+" ").indexOf(i)>-1:"|="===n?s===i||s.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,n,i,a){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),r="of-type"===t;return 1===i&&0===a?function(e){return!!e.parentNode}:function(t,n,l){var c,d,u,h,m,p,f=s!==o?"nextSibling":"previousSibling",g=t.parentNode,v=r&&t.nodeName.toLowerCase(),w=!l&&!r;if(g){if(s){for(;f;){for(u=t;u=u[f];)if(r?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;p=f="only"===e&&!p&&"nextSibling"}return!0}if(p=[o?g.firstChild:g.lastChild],o&&w){for(d=g[L]||(g[L]={}),c=d[e]||[],m=c[0]===H&&c[1],h=c[0]===H&&c[2],u=m&&g.childNodes[m];u=++m&&u&&u[f]||(h=m=0)||p.pop();)if(1===u.nodeType&&++h&&u===t){d[e]=[H,m,h];break}}else if(w&&(c=(t[L]||(t[L]={}))[e])&&c[0]===H)h=c[1];else for(;(u=++m&&u&&u[f]||(h=m=0)||p.pop())&&((r?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++h||(w&&((u[L]||(u[L]={}))[e]=[H,h]),u!==t)););return h-=a,h===i||h%i===0&&h/i>=0}}},PSEUDO:function(e,n){var a,s=_.pseudos[e]||_.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return s[L]?s(n):s.length>1?(a=[e,e,"",n],_.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,t){for(var i,a=s(e,n),o=a.length;o--;)i=et(e,a[o]),e[i]=!(t[i]=a[o])}):function(e){return s(e,0,a)}):s}},pseudos:{not:i(function(e){var t=[],n=[],a=S(e.replace(lt,"$1"));return a[L]?i(function(e,t,n,i){for(var s,o=a(e,null,i,[]),r=e.length;r--;)(s=o[r])&&(e[r]=!(t[r]=s))}):function(e,i,s){return t[0]=e,a(t,null,s,n),t[0]=null,!n.pop()}}),has:i(function(e){return function(n){return t(e,n).length>0}}),contains:i(function(e){return e=e.replace(yt,_t),function(t){return(t.textContent||t.innerText||k(t)).indexOf(e)>-1}}),lang:i(function(e){return mt.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(yt,_t).toLowerCase(),function(t){var n;do if(n=R?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===A},focus:function(e){return e===V.activeElement&&(!V.hasFocus||V.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(6>e.nodeType)return!1;return!0},parent:function(e){return!_.pseudos.empty(e)},header:function(e){return gt.test(e.nodeName)},input:function(e){return ft.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,n){return[0>n?n+t:n]}),even:c(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:c(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:c(function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e}),gt:c(function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e})}},_.pseudos.nth=_.pseudos.eq;for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})_.pseudos[x]=r(x);for(x in{submit:!0,reset:!0})_.pseudos[x]=l(x);return u.prototype=_.filters=_.pseudos,_.setFilters=new u,T=t.tokenize=function(e,n){var i,a,s,o,r,l,c,d=z[e+" "];if(d)return n?0:d.slice(0);for(r=e,l=[],c=_.preFilter;r;){(!i||(a=ct.exec(r)))&&(a&&(r=r.slice(a[0].length)||r),l.push(s=[])),i=!1,(a=dt.exec(r))&&(i=a.shift(),s.push({value:i,type:a[0].replace(lt," ")}),r=r.slice(i.length));for(o in _.filter)!(a=pt[o].exec(r))||c[o]&&!(a=c[o](a))||(i=a.shift(),s.push({value:i,type:o,matches:a}),r=r.slice(i.length));if(!i)break}return n?r.length:r?t.error(e):z(e,l).slice(0)},S=t.compile=function(e,t){var n,i=[],a=[],s=B[e+" "];
if(!s){for(t||(t=T(e)),n=t.length;n--;)s=w(t[n]),s[L]?i.push(s):a.push(s);s=B(e,b(a,i)),s.selector=e}return s},E=t.select=function(e,t,n,i){var a,s,o,r,l,c="function"==typeof e&&e,u=!i&&T(e=c.selector||e);if(n=n||[],1===u.length){if(s=u[0]=u[0].slice(0),s.length>2&&"ID"===(o=s[0]).type&&y.getById&&9===t.nodeType&&R&&_.relative[s[1].type]){if(t=(_.find.ID(o.matches[0].replace(yt,_t),t)||[])[0],!t)return n;c&&(t=t.parentNode),e=e.slice(s.shift().value.length)}for(a=pt.needsContext.test(e)?0:s.length;a--&&(o=s[a],!_.relative[r=o.type]);)if((l=_.find[r])&&(i=l(o.matches[0].replace(yt,_t),bt.test(s[0].type)&&d(t.parentNode)||t))){if(s.splice(a,1),e=i.length&&h(s),!e)return Q.apply(n,i),n;break}}return(c||S(e,u))(i,t,!R,n,bt.test(e)&&d(t.parentNode)||t),n},y.sortStable=L.split("").sort(W).join("")===L,y.detectDuplicates=!!D,M(),y.sortDetached=a(function(e){return 1&e.compareDocumentPosition(V.createElement("div"))}),a(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||s("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),y.attributes&&a(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||s("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),a(function(e){return null==e.getAttribute("disabled")})||s(tt,function(e,t,n){var i;return n?void 0:e[t]===!0?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),t}(e);at.find=ct,at.expr=ct.selectors,at.expr[":"]=at.expr.pseudos,at.unique=ct.uniqueSort,at.text=ct.getText,at.isXMLDoc=ct.isXML,at.contains=ct.contains;var dt=at.expr.match.needsContext,ut=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ht=/^.[^:#\[\.,]*$/;at.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?at.find.matchesSelector(i,e)?[i]:[]:at.find.matches(e,at.grep(t,function(e){return 1===e.nodeType}))},at.fn.extend({find:function(e){var t,n=[],i=this,a=i.length;if("string"!=typeof e)return this.pushStack(at(e).filter(function(){for(t=0;a>t;t++)if(at.contains(i[t],this))return!0}));for(t=0;a>t;t++)at.find(e,i[t],n);return n=this.pushStack(a>1?at.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(i(this,e||[],!1))},not:function(e){return this.pushStack(i(this,e||[],!0))},is:function(e){return!!i(this,"string"==typeof e&&dt.test(e)?at(e):e||[],!1).length}});var mt,pt=e.document,ft=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,gt=at.fn.init=function(e,t){var n,i;if(!e)return this;if("string"==typeof e){if(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:ft.exec(e),!n||!n[1]&&t)return!t||t.jquery?(t||mt).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof at?t[0]:t,at.merge(this,at.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:pt,!0)),ut.test(n[1])&&at.isPlainObject(t))for(n in t)at.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}if(i=pt.getElementById(n[2]),i&&i.parentNode){if(i.id!==n[2])return mt.find(e);this.length=1,this[0]=i}return this.context=pt,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):at.isFunction(e)?void 0!==mt.ready?mt.ready(e):e(at):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),at.makeArray(e,this))};gt.prototype=at.fn,mt=at(pt);var vt=/^(?:parents|prev(?:Until|All))/,wt={children:!0,contents:!0,next:!0,prev:!0};at.extend({dir:function(e,t,n){for(var i=[],a=e[t];a&&9!==a.nodeType&&(void 0===n||1!==a.nodeType||!at(a).is(n));)1===a.nodeType&&i.push(a),a=a[t];return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),at.fn.extend({has:function(e){var t,n=at(e,this),i=n.length;return this.filter(function(){for(t=0;i>t;t++)if(at.contains(this,n[t]))return!0})},closest:function(e,t){for(var n,i=0,a=this.length,s=[],o=dt.test(e)||"string"!=typeof e?at(e,t||this.context):0;a>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(o?o.index(n)>-1:1===n.nodeType&&at.find.matchesSelector(n,e))){s.push(n);break}return this.pushStack(s.length>1?at.unique(s):s)},index:function(e){return e?"string"==typeof e?at.inArray(this[0],at(e)):at.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(at.unique(at.merge(this.get(),at(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),at.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return at.dir(e,"parentNode")},parentsUntil:function(e,t,n){return at.dir(e,"parentNode",n)},next:function(e){return a(e,"nextSibling")},prev:function(e){return a(e,"previousSibling")},nextAll:function(e){return at.dir(e,"nextSibling")},prevAll:function(e){return at.dir(e,"previousSibling")},nextUntil:function(e,t,n){return at.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return at.dir(e,"previousSibling",n)},siblings:function(e){return at.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return at.sibling(e.firstChild)},contents:function(e){return at.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:at.merge([],e.childNodes)}},function(e,t){at.fn[e]=function(n,i){var a=at.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(a=at.filter(i,a)),this.length>1&&(wt[e]||(a=at.unique(a)),vt.test(e)&&(a=a.reverse())),this.pushStack(a)}});var bt=/\S+/g,xt={};at.Callbacks=function(e){e="string"==typeof e?xt[e]||s(e):at.extend({},e);var t,n,i,a,o,r,l=[],c=!e.once&&[],d=function(s){for(n=e.memory&&s,i=!0,o=r||0,r=0,a=l.length,t=!0;l&&a>o;o++)if(l[o].apply(s[0],s[1])===!1&&e.stopOnFalse){n=!1;break}t=!1,l&&(c?c.length&&d(c.shift()):n?l=[]:u.disable())},u={add:function(){if(l){var i=l.length;!function s(t){at.each(t,function(t,n){var i=at.type(n);"function"===i?e.unique&&u.has(n)||l.push(n):n&&n.length&&"string"!==i&&s(n)})}(arguments),t?a=l.length:n&&(r=i,d(n))}return this},remove:function(){return l&&at.each(arguments,function(e,n){for(var i;(i=at.inArray(n,l,i))>-1;)l.splice(i,1),t&&(a>=i&&a--,o>=i&&o--)}),this},has:function(e){return e?at.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],a=0,this},disable:function(){return l=c=n=void 0,this},disabled:function(){return!l},lock:function(){return c=void 0,n||u.disable(),this},locked:function(){return!c},fireWith:function(e,n){return!l||i&&!c||(n=n||[],n=[e,n.slice?n.slice():n],t?c.push(n):d(n)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},at.extend({Deferred:function(e){var t=[["resolve","done",at.Callbacks("once memory"),"resolved"],["reject","fail",at.Callbacks("once memory"),"rejected"],["notify","progress",at.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var e=arguments;return at.Deferred(function(n){at.each(t,function(t,s){var o=at.isFunction(e[t])&&e[t];a[s[1]](function(){var e=o&&o.apply(this,arguments);e&&at.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s[0]+"With"](this===i?n.promise():this,o?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?at.extend(e,i):i}},a={};return i.pipe=i.then,at.each(t,function(e,s){var o=s[2],r=s[3];i[s[1]]=o.add,r&&o.add(function(){n=r},t[1^e][2].disable,t[2][2].lock),a[s[0]]=function(){return a[s[0]+"With"](this===a?i:this,arguments),this},a[s[0]+"With"]=o.fireWith}),i.promise(a),e&&e.call(a,a),a},when:function(e){var t,n,i,a=0,s=J.call(arguments),o=s.length,r=1!==o||e&&at.isFunction(e.promise)?o:0,l=1===r?e:at.Deferred(),c=function(e,n,i){return function(a){n[e]=this,i[e]=arguments.length>1?J.call(arguments):a,i===t?l.notifyWith(n,i):--r||l.resolveWith(n,i)}};if(o>1)for(t=Array(o),n=Array(o),i=Array(o);o>a;a++)s[a]&&at.isFunction(s[a].promise)?s[a].promise().done(c(a,i,s)).fail(l.reject).progress(c(a,n,t)):--r;return r||l.resolveWith(i,s),l.promise()}});var yt;at.fn.ready=function(e){return at.ready.promise().done(e),this},at.extend({isReady:!1,readyWait:1,holdReady:function(e){e?at.readyWait++:at.ready(!0)},ready:function(e){if(e===!0?!--at.readyWait:!at.isReady){if(!pt.body)return setTimeout(at.ready);at.isReady=!0,e!==!0&&--at.readyWait>0||(yt.resolveWith(pt,[at]),at.fn.triggerHandler&&(at(pt).triggerHandler("ready"),at(pt).off("ready")))}}}),at.ready.promise=function(t){if(!yt)if(yt=at.Deferred(),"complete"===pt.readyState)setTimeout(at.ready);else if(pt.addEventListener)pt.addEventListener("DOMContentLoaded",r,!1),e.addEventListener("load",r,!1);else{pt.attachEvent("onreadystatechange",r),e.attachEvent("onload",r);var n=!1;try{n=null==e.frameElement&&pt.documentElement}catch(i){}n&&n.doScroll&&!function a(){if(!at.isReady){try{n.doScroll("left")}catch(e){return setTimeout(a,50)}o(),at.ready()}}()}return yt.promise(t)};var _t,kt="undefined";for(_t in at(nt))break;nt.ownLast="0"!==_t,nt.inlineBlockNeedsLayout=!1,at(function(){var e,t,n,i;n=pt.getElementsByTagName("body")[0],n&&n.style&&(t=pt.createElement("div"),i=pt.createElement("div"),i.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(i).appendChild(t),typeof t.style.zoom!==kt&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",nt.inlineBlockNeedsLayout=e=3===t.offsetWidth,e&&(n.style.zoom=1)),n.removeChild(i))}),function(){var e=pt.createElement("div");if(null==nt.deleteExpando){nt.deleteExpando=!0;try{delete e.test}catch(t){nt.deleteExpando=!1}}e=null}(),at.acceptData=function(e){var t=at.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return 1!==n&&9!==n?!1:!t||t!==!0&&e.getAttribute("classid")===t};var Ct=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Tt=/([A-Z])/g;at.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?at.cache[e[at.expando]]:e[at.expando],!!e&&!c(e)},data:function(e,t,n){return d(e,t,n)},removeData:function(e,t){return u(e,t)},_data:function(e,t,n){return d(e,t,n,!0)},_removeData:function(e,t){return u(e,t,!0)}}),at.fn.extend({data:function(e,t){var n,i,a,s=this[0],o=s&&s.attributes;if(void 0===e){if(this.length&&(a=at.data(s),1===s.nodeType&&!at._data(s,"parsedAttrs"))){for(n=o.length;n--;)o[n]&&(i=o[n].name,0===i.indexOf("data-")&&(i=at.camelCase(i.slice(5)),l(s,i,a[i])));at._data(s,"parsedAttrs",!0)}return a}return"object"==typeof e?this.each(function(){at.data(this,e)}):arguments.length>1?this.each(function(){at.data(this,e,t)}):s?l(s,e,at.data(s,e)):void 0},removeData:function(e){return this.each(function(){at.removeData(this,e)})}}),at.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=at._data(e,t),n&&(!i||at.isArray(n)?i=at._data(e,t,at.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=at.queue(e,t),i=n.length,a=n.shift(),s=at._queueHooks(e,t),o=function(){at.dequeue(e,t)};"inprogress"===a&&(a=n.shift(),i--),a&&("fx"===t&&n.unshift("inprogress"),delete s.stop,a.call(e,o,s)),!i&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return at._data(e,n)||at._data(e,n,{empty:at.Callbacks("once memory").add(function(){at._removeData(e,t+"queue"),at._removeData(e,n)})})}}),at.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),n>arguments.length?at.queue(this[0],e):void 0===t?this:this.each(function(){var n=at.queue(this,e,t);at._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&at.dequeue(this,e)})},dequeue:function(e){return this.each(function(){at.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,a=at.Deferred(),s=this,o=this.length,r=function(){--i||a.resolveWith(s,[s])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)n=at._data(s[o],e+"queueHooks"),n&&n.empty&&(i++,n.empty.add(r));return r(),a.promise(t)}});var St=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Et=["Top","Right","Bottom","Left"],Ft=function(e,t){return e=t||e,"none"===at.css(e,"display")||!at.contains(e.ownerDocument,e)},Pt=at.access=function(e,t,n,i,a,s,o){var r=0,l=e.length,c=null==n;if("object"===at.type(n)){a=!0;for(r in n)at.access(e,t,r,n[r],!0,s,o)}else if(void 0!==i&&(a=!0,at.isFunction(i)||(o=!0),c&&(o?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(at(e),n)})),t))for(;l>r;r++)t(e[r],n,o?i:i.call(e[r],r,t(e[r],n)));return a?e:c?t.call(e):l?t(e[0],n):s},Dt=/^(?:checkbox|radio)$/i;!function(){var e=pt.createElement("input"),t=pt.createElement("div"),n=pt.createDocumentFragment();if(t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",nt.leadingWhitespace=3===t.firstChild.nodeType,nt.tbody=!t.getElementsByTagName("tbody").length,nt.htmlSerialize=!!t.getElementsByTagName("link").length,nt.html5Clone="<:nav></:nav>"!==pt.createElement("nav").cloneNode(!0).outerHTML,e.type="checkbox",e.checked=!0,n.appendChild(e),nt.appendChecked=e.checked,t.innerHTML="<textarea>x</textarea>",nt.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,n.appendChild(t),t.innerHTML="<input type='radio' checked='checked' name='t'/>",nt.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,nt.noCloneEvent=!0,t.attachEvent&&(t.attachEvent("onclick",function(){nt.noCloneEvent=!1}),t.cloneNode(!0).click()),null==nt.deleteExpando){nt.deleteExpando=!0;try{delete t.test}catch(i){nt.deleteExpando=!1}}}(),function(){var t,n,i=pt.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})n="on"+t,(nt[t+"Bubbles"]=n in e)||(i.setAttribute(n,"t"),nt[t+"Bubbles"]=i.attributes[n].expando===!1);i=null}();var Mt=/^(?:input|select|textarea)$/i,Vt=/^key/,At=/^(?:mouse|pointer|contextmenu)|click/,Rt=/^(?:focusinfocus|focusoutblur)$/,Nt=/^([^.]*)(?:\.(.+)|)$/;at.event={global:{},add:function(e,t,n,i,a){var s,o,r,l,c,d,u,h,m,p,f,g=at._data(e);if(g){for(n.handler&&(l=n,n=l.handler,a=l.selector),n.guid||(n.guid=at.guid++),(o=g.events)||(o=g.events={}),(d=g.handle)||(d=g.handle=function(e){return typeof at===kt||e&&at.event.triggered===e.type?void 0:at.event.dispatch.apply(d.elem,arguments)},d.elem=e),t=(t||"").match(bt)||[""],r=t.length;r--;)s=Nt.exec(t[r])||[],m=f=s[1],p=(s[2]||"").split(".").sort(),m&&(c=at.event.special[m]||{},m=(a?c.delegateType:c.bindType)||m,c=at.event.special[m]||{},u=at.extend({type:m,origType:f,data:i,handler:n,guid:n.guid,selector:a,needsContext:a&&at.expr.match.needsContext.test(a),namespace:p.join(".")},l),(h=o[m])||(h=o[m]=[],h.delegateCount=0,c.setup&&c.setup.call(e,i,p,d)!==!1||(e.addEventListener?e.addEventListener(m,d,!1):e.attachEvent&&e.attachEvent("on"+m,d))),c.add&&(c.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),a?h.splice(h.delegateCount++,0,u):h.push(u),at.event.global[m]=!0);e=null}},remove:function(e,t,n,i,a){var s,o,r,l,c,d,u,h,m,p,f,g=at.hasData(e)&&at._data(e);if(g&&(d=g.events)){for(t=(t||"").match(bt)||[""],c=t.length;c--;)if(r=Nt.exec(t[c])||[],m=f=r[1],p=(r[2]||"").split(".").sort(),m){for(u=at.event.special[m]||{},m=(i?u.delegateType:u.bindType)||m,h=d[m]||[],r=r[2]&&RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=s=h.length;s--;)o=h[s],!a&&f!==o.origType||n&&n.guid!==o.guid||r&&!r.test(o.namespace)||i&&i!==o.selector&&("**"!==i||!o.selector)||(h.splice(s,1),o.selector&&h.delegateCount--,u.remove&&u.remove.call(e,o));l&&!h.length&&(u.teardown&&u.teardown.call(e,p,g.handle)!==!1||at.removeEvent(e,m,g.handle),delete d[m])}else for(m in d)at.event.remove(e,m+t[c],n,i,!0);at.isEmptyObject(d)&&(delete g.handle,at._removeData(e,"events"))}},trigger:function(t,n,i,a){var s,o,r,l,c,d,u,h=[i||pt],m=tt.call(t,"type")?t.type:t,p=tt.call(t,"namespace")?t.namespace.split("."):[];if(r=d=i=i||pt,3!==i.nodeType&&8!==i.nodeType&&!Rt.test(m+at.event.triggered)&&(m.indexOf(".")>=0&&(p=m.split("."),m=p.shift(),p.sort()),o=m.indexOf(":")<0&&"on"+m,t=t[at.expando]?t:new at.Event(m,"object"==typeof t&&t),t.isTrigger=a?2:3,t.namespace=p.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:at.makeArray(n,[t]),c=at.event.special[m]||{},a||!c.trigger||c.trigger.apply(i,n)!==!1)){if(!a&&!c.noBubble&&!at.isWindow(i)){for(l=c.delegateType||m,Rt.test(l+m)||(r=r.parentNode);r;r=r.parentNode)h.push(r),d=r;d===(i.ownerDocument||pt)&&h.push(d.defaultView||d.parentWindow||e)}for(u=0;(r=h[u++])&&!t.isPropagationStopped();)t.type=u>1?l:c.bindType||m,s=(at._data(r,"events")||{})[t.type]&&at._data(r,"handle"),s&&s.apply(r,n),s=o&&r[o],s&&s.apply&&at.acceptData(r)&&(t.result=s.apply(r,n),t.result===!1&&t.preventDefault());if(t.type=m,!a&&!t.isDefaultPrevented()&&(!c._default||c._default.apply(h.pop(),n)===!1)&&at.acceptData(i)&&o&&i[m]&&!at.isWindow(i)){d=i[o],d&&(i[o]=null),at.event.triggered=m;try{i[m]()}catch(f){}at.event.triggered=void 0,d&&(i[o]=d)}return t.result}},dispatch:function(e){e=at.event.fix(e);var t,n,i,a,s,o=[],r=J.call(arguments),l=(at._data(this,"events")||{})[e.type]||[],c=at.event.special[e.type]||{};if(r[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(o=at.event.handlers.call(this,e,l),t=0;(a=o[t++])&&!e.isPropagationStopped();)for(e.currentTarget=a.elem,s=0;(i=a.handlers[s++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,n=((at.event.special[i.origType]||{}).handle||i.handler).apply(a.elem,r),void 0!==n&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,a,s,o=[],r=t.delegateCount,l=e.target;if(r&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==e.type)){for(a=[],s=0;r>s;s++)i=t[s],n=i.selector+" ",void 0===a[n]&&(a[n]=i.needsContext?at(n,this).index(l)>=0:at.find(n,this,null,[l]).length),a[n]&&a.push(i);a.length&&o.push({elem:l,handlers:a})}return t.length>r&&o.push({elem:this,handlers:t.slice(r)}),o},fix:function(e){if(e[at.expando])return e;var t,n,i,a=e.type,s=e,o=this.fixHooks[a];for(o||(this.fixHooks[a]=o=At.test(a)?this.mouseHooks:Vt.test(a)?this.keyHooks:{}),i=o.props?this.props.concat(o.props):this.props,e=new at.Event(s),t=i.length;t--;)n=i[t],e[n]=s[n];return e.target||(e.target=s.srcElement||pt),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,a,s=t.button,o=t.fromElement;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||pt,a=i.documentElement,n=i.body,e.pageX=t.clientX+(a&&a.scrollLeft||n&&n.scrollLeft||0)-(a&&a.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(a&&a.scrollTop||n&&n.scrollTop||0)-(a&&a.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&o&&(e.relatedTarget=o===e.target?t.toElement:o),e.which||void 0===s||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==p()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===p()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return at.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return at.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var a=at.extend(new at.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?at.event.trigger(a,null,t):at.event.dispatch.call(t,a),a.isDefaultPrevented()&&n.preventDefault()}},at.removeEvent=pt.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var i="on"+t;e.detachEvent&&(typeof e[i]===kt&&(e[i]=null),e.detachEvent(i,n))},at.Event=function(e,t){return this instanceof at.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?h:m):this.type=e,t&&at.extend(this,t),this.timeStamp=e&&e.timeStamp||at.now(),void(this[at.expando]=!0)):new at.Event(e,t)},at.Event.prototype={isDefaultPrevented:m,isPropagationStopped:m,isImmediatePropagationStopped:m,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=h,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=h,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=h,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},at.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){at.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,a=e.relatedTarget,s=e.handleObj;return(!a||a!==i&&!at.contains(i,a))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),nt.submitBubbles||(at.event.special.submit={setup:function(){return at.nodeName(this,"form")?!1:void at.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=at.nodeName(t,"input")||at.nodeName(t,"button")?t.form:void 0;n&&!at._data(n,"submitBubbles")&&(at.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),at._data(n,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&at.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return at.nodeName(this,"form")?!1:void at.event.remove(this,"._submit")}}),nt.changeBubbles||(at.event.special.change={setup:function(){return Mt.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(at.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),at.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),at.event.simulate("change",this,e,!0)})),!1):void at.event.add(this,"beforeactivate._change",function(e){var t=e.target;Mt.test(t.nodeName)&&!at._data(t,"changeBubbles")&&(at.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||at.event.simulate("change",this.parentNode,e,!0)}),at._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return at.event.remove(this,"._change"),!Mt.test(this.nodeName)}}),nt.focusinBubbles||at.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){at.event.simulate(t,e.target,at.event.fix(e),!0)};at.event.special[t]={setup:function(){var i=this.ownerDocument||this,a=at._data(i,t);a||i.addEventListener(e,n,!0),at._data(i,t,(a||0)+1)},teardown:function(){var i=this.ownerDocument||this,a=at._data(i,t)-1;a?at._data(i,t,a):(i.removeEventListener(e,n,!0),at._removeData(i,t))}}}),at.fn.extend({on:function(e,t,n,i,a){var s,o;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=void 0);for(s in e)this.on(s,t,n,e[s],a);return this}if(null==n&&null==i?(i=t,n=t=void 0):null==i&&("string"==typeof t?(i=n,n=void 0):(i=n,n=t,t=void 0)),i===!1)i=m;else if(!i)return this;return 1===a&&(o=i,i=function(e){return at().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=at.guid++)),this.each(function(){at.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i,a;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,at(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(a in e)this.off(a,t,e[a]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=void 0),n===!1&&(n=m),this.each(function(){at.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){at.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?at.event.trigger(e,t,n,!0):void 0}});var Ot="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",It=/ jQuery\d+="(?:null|\d+)"/g,Ut=RegExp("<(?:"+Ot+")[\\s/>]","i"),Lt=/^\s+/,qt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ht=/<([\w:]+)/,$t=/<tbody/i,jt=/<|&#?\w+;/,zt=/<(?:script|style|link)/i,Bt=/checked\s*(?:[^=]|=\s*.checked.)/i,Wt=/^$|\/(?:java|ecma)script/i,Gt=/^true\/(.*)/,Yt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Jt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:nt.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Kt=f(pt),Xt=Kt.appendChild(pt.createElement("div"));Jt.optgroup=Jt.option,Jt.tbody=Jt.tfoot=Jt.colgroup=Jt.caption=Jt.thead,Jt.th=Jt.td,at.extend({clone:function(e,t,n){var i,a,s,o,r,l=at.contains(e.ownerDocument,e);if(nt.html5Clone||at.isXMLDoc(e)||!Ut.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(Xt.innerHTML=e.outerHTML,Xt.removeChild(s=Xt.firstChild)),!(nt.noCloneEvent&&nt.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||at.isXMLDoc(e)))for(i=g(s),r=g(e),o=0;null!=(a=r[o]);++o)i[o]&&k(a,i[o]);if(t)if(n)for(r=r||g(e),i=i||g(s),o=0;null!=(a=r[o]);o++)_(a,i[o]);else _(e,s);return i=g(s,"script"),i.length>0&&y(i,!l&&g(e,"script")),i=r=a=null,s},buildFragment:function(e,t,n,i){for(var a,s,o,r,l,c,d,u=e.length,h=f(t),m=[],p=0;u>p;p++)if(s=e[p],s||0===s)if("object"===at.type(s))at.merge(m,s.nodeType?[s]:s);else if(jt.test(s)){for(r=r||h.appendChild(t.createElement("div")),l=(Ht.exec(s)||["",""])[1].toLowerCase(),d=Jt[l]||Jt._default,r.innerHTML=d[1]+s.replace(qt,"<$1></$2>")+d[2],a=d[0];a--;)r=r.lastChild;if(!nt.leadingWhitespace&&Lt.test(s)&&m.push(t.createTextNode(Lt.exec(s)[0])),!nt.tbody)for(s="table"!==l||$t.test(s)?"<table>"!==d[1]||$t.test(s)?0:r:r.firstChild,a=s&&s.childNodes.length;a--;)at.nodeName(c=s.childNodes[a],"tbody")&&!c.childNodes.length&&s.removeChild(c);for(at.merge(m,r.childNodes),r.textContent="";r.firstChild;)r.removeChild(r.firstChild);r=h.lastChild}else m.push(t.createTextNode(s));for(r&&h.removeChild(r),nt.appendChecked||at.grep(g(m,"input"),v),p=0;s=m[p++];)if((!i||-1===at.inArray(s,i))&&(o=at.contains(s.ownerDocument,s),r=g(h.appendChild(s),"script"),o&&y(r),n))for(a=0;s=r[a++];)Wt.test(s.type||"")&&n.push(s);return r=null,h},cleanData:function(e,t){for(var n,i,a,s,o=0,r=at.expando,l=at.cache,c=nt.deleteExpando,d=at.event.special;null!=(n=e[o]);o++)if((t||at.acceptData(n))&&(a=n[r],s=a&&l[a])){if(s.events)for(i in s.events)d[i]?at.event.remove(n,i):at.removeEvent(n,i,s.handle);l[a]&&(delete l[a],c?delete n[r]:typeof n.removeAttribute!==kt?n.removeAttribute(r):n[r]=null,Y.push(a))}}}),at.fn.extend({text:function(e){return Pt(this,function(e){return void 0===e?at.text(this):this.empty().append((this[0]&&this[0].ownerDocument||pt).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=w(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=w(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?at.filter(e,this):this,a=0;null!=(n=i[a]);a++)t||1!==n.nodeType||at.cleanData(g(n)),n.parentNode&&(t&&at.contains(n.ownerDocument,n)&&y(g(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&at.cleanData(g(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&at.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return at.clone(this,e,t)})},html:function(e){return Pt(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(It,""):void 0;if(!("string"!=typeof e||zt.test(e)||!nt.htmlSerialize&&Ut.test(e)||!nt.leadingWhitespace&&Lt.test(e)||Jt[(Ht.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(qt,"<$1></$2>");try{for(;i>n;n++)t=this[n]||{},1===t.nodeType&&(at.cleanData(g(t,!1)),t.innerHTML=e);t=0}catch(a){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,at.cleanData(g(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=K.apply([],e);var n,i,a,s,o,r,l=0,c=this.length,d=this,u=c-1,h=e[0],m=at.isFunction(h);if(m||c>1&&"string"==typeof h&&!nt.checkClone&&Bt.test(h))return this.each(function(n){var i=d.eq(n);m&&(e[0]=h.call(this,n,i.html())),i.domManip(e,t)});if(c&&(r=at.buildFragment(e,this[0].ownerDocument,!1,this),n=r.firstChild,1===r.childNodes.length&&(r=n),n)){for(s=at.map(g(r,"script"),b),a=s.length;c>l;l++)i=r,l!==u&&(i=at.clone(i,!0,!0),a&&at.merge(s,g(i,"script"))),t.call(this[l],i,l);if(a)for(o=s[s.length-1].ownerDocument,at.map(s,x),l=0;a>l;l++)i=s[l],Wt.test(i.type||"")&&!at._data(i,"globalEval")&&at.contains(o,i)&&(i.src?at._evalUrl&&at._evalUrl(i.src):at.globalEval((i.text||i.textContent||i.innerHTML||"").replace(Yt,"")));r=n=null}return this}}),at.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){at.fn[e]=function(e){for(var n,i=0,a=[],s=at(e),o=s.length-1;o>=i;i++)n=i===o?this:this.clone(!0),at(s[i])[t](n),X.apply(a,n.get());return this.pushStack(a)}});var Qt,Zt={};!function(){var e;nt.shrinkWrapBlocks=function(){if(null!=e)return e;e=!1;var t,n,i;return n=pt.getElementsByTagName("body")[0],n&&n.style?(t=pt.createElement("div"),i=pt.createElement("div"),i.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(i).appendChild(t),typeof t.style.zoom!==kt&&(t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",t.appendChild(pt.createElement("div")).style.width="5px",e=3!==t.offsetWidth),n.removeChild(i),e):void 0}}();var en,tn,nn=/^margin/,an=RegExp("^("+St+")(?!px)[a-z%]+$","i"),sn=/^(top|right|bottom|left)$/;e.getComputedStyle?(en=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)},tn=function(e,t,n){var i,a,s,o,r=e.style;return n=n||en(e),o=n?n.getPropertyValue(t)||n[t]:void 0,n&&(""!==o||at.contains(e.ownerDocument,e)||(o=at.style(e,t)),an.test(o)&&nn.test(t)&&(i=r.width,a=r.minWidth,s=r.maxWidth,r.minWidth=r.maxWidth=r.width=o,o=n.width,r.width=i,r.minWidth=a,r.maxWidth=s)),void 0===o?o:o+""}):pt.documentElement.currentStyle&&(en=function(e){return e.currentStyle},tn=function(e,t,n){var i,a,s,o,r=e.style;
return n=n||en(e),o=n?n[t]:void 0,null==o&&r&&r[t]&&(o=r[t]),an.test(o)&&!sn.test(t)&&(i=r.left,a=e.runtimeStyle,s=a&&a.left,s&&(a.left=e.currentStyle.left),r.left="fontSize"===t?"1em":o,o=r.pixelLeft+"px",r.left=i,s&&(a.left=s)),void 0===o?o:o+""||"auto"}),function(){function t(){var t,n,i,a;n=pt.getElementsByTagName("body")[0],n&&n.style&&(t=pt.createElement("div"),i=pt.createElement("div"),i.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(i).appendChild(t),t.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",s=o=!1,l=!0,e.getComputedStyle&&(s="1%"!==(e.getComputedStyle(t,null)||{}).top,o="4px"===(e.getComputedStyle(t,null)||{width:"4px"}).width,a=t.appendChild(pt.createElement("div")),a.style.cssText=t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",a.style.marginRight=a.style.width="0",t.style.width="1px",l=!parseFloat((e.getComputedStyle(a,null)||{}).marginRight),t.removeChild(a)),t.innerHTML="<table><tr><td></td><td>t</td></tr></table>",a=t.getElementsByTagName("td"),a[0].style.cssText="margin:0;border:0;padding:0;display:none",r=0===a[0].offsetHeight,r&&(a[0].style.display="",a[1].style.display="none",r=0===a[0].offsetHeight),n.removeChild(i))}var n,i,a,s,o,r,l;n=pt.createElement("div"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=n.getElementsByTagName("a")[0],i=a&&a.style,i&&(i.cssText="float:left;opacity:.5",nt.opacity="0.5"===i.opacity,nt.cssFloat=!!i.cssFloat,n.style.backgroundClip="content-box",n.cloneNode(!0).style.backgroundClip="",nt.clearCloneStyle="content-box"===n.style.backgroundClip,nt.boxSizing=""===i.boxSizing||""===i.MozBoxSizing||""===i.WebkitBoxSizing,at.extend(nt,{reliableHiddenOffsets:function(){return null==r&&t(),r},boxSizingReliable:function(){return null==o&&t(),o},pixelPosition:function(){return null==s&&t(),s},reliableMarginRight:function(){return null==l&&t(),l}}))}(),at.swap=function(e,t,n,i){var a,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];a=n.apply(e,i||[]);for(s in t)e.style[s]=o[s];return a};var on=/alpha\([^)]*\)/i,rn=/opacity\s*=\s*([^)]*)/,ln=/^(none|table(?!-c[ea]).+)/,cn=RegExp("^("+St+")(.*)$","i"),dn=RegExp("^([+-])=("+St+")","i"),un={position:"absolute",visibility:"hidden",display:"block"},hn={letterSpacing:"0",fontWeight:"400"},mn=["Webkit","O","Moz","ms"];at.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=tn(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":nt.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var a,s,o,r=at.camelCase(t),l=e.style;if(t=at.cssProps[r]||(at.cssProps[r]=E(l,r)),o=at.cssHooks[t]||at.cssHooks[r],void 0===n)return o&&"get"in o&&void 0!==(a=o.get(e,!1,i))?a:l[t];if(s=typeof n,"string"===s&&(a=dn.exec(n))&&(n=(a[1]+1)*a[2]+parseFloat(at.css(e,t)),s="number"),null!=n&&n===n&&("number"!==s||at.cssNumber[r]||(n+="px"),nt.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),!(o&&"set"in o&&void 0===(n=o.set(e,n,i)))))try{l[t]=n}catch(c){}}},css:function(e,t,n,i){var a,s,o,r=at.camelCase(t);return t=at.cssProps[r]||(at.cssProps[r]=E(e.style,r)),o=at.cssHooks[t]||at.cssHooks[r],o&&"get"in o&&(s=o.get(e,!0,n)),void 0===s&&(s=tn(e,t,i)),"normal"===s&&t in hn&&(s=hn[t]),""===n||n?(a=parseFloat(s),n===!0||at.isNumeric(a)?a||0:s):s}}),at.each(["height","width"],function(e,t){at.cssHooks[t]={get:function(e,n,i){return n?ln.test(at.css(e,"display"))&&0===e.offsetWidth?at.swap(e,un,function(){return M(e,t,i)}):M(e,t,i):void 0},set:function(e,n,i){var a=i&&en(e);return P(e,n,i?D(e,t,i,nt.boxSizing&&"border-box"===at.css(e,"boxSizing",!1,a),a):0)}}}),nt.opacity||(at.cssHooks.opacity={get:function(e,t){return rn.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,a=at.isNumeric(t)?"alpha(opacity="+100*t+")":"",s=i&&i.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===at.trim(s.replace(on,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||i&&!i.filter)||(n.filter=on.test(s)?s.replace(on,a):s+" "+a)}}),at.cssHooks.marginRight=S(nt.reliableMarginRight,function(e,t){return t?at.swap(e,{display:"inline-block"},tn,[e,"marginRight"]):void 0}),at.each({margin:"",padding:"",border:"Width"},function(e,t){at.cssHooks[e+t]={expand:function(n){for(var i=0,a={},s="string"==typeof n?n.split(" "):[n];4>i;i++)a[e+Et[i]+t]=s[i]||s[i-2]||s[0];return a}},nn.test(e)||(at.cssHooks[e+t].set=P)}),at.fn.extend({css:function(e,t){return Pt(this,function(e,t,n){var i,a,s={},o=0;if(at.isArray(t)){for(i=en(e),a=t.length;a>o;o++)s[t[o]]=at.css(e,t[o],!1,i);return s}return void 0!==n?at.style(e,t,n):at.css(e,t)},e,t,arguments.length>1)},show:function(){return F(this,!0)},hide:function(){return F(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ft(this)?at(this).show():at(this).hide()})}}),at.Tween=V,V.prototype={constructor:V,init:function(e,t,n,i,a,s){this.elem=e,this.prop=n,this.easing=a||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=s||(at.cssNumber[n]?"":"px")},cur:function(){var e=V.propHooks[this.prop];return e&&e.get?e.get(this):V.propHooks._default.get(this)},run:function(e){var t,n=V.propHooks[this.prop];return this.pos=t=this.options.duration?at.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):V.propHooks._default.set(this),this}},V.prototype.init.prototype=V.prototype,V.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=at.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){at.fx.step[e.prop]?at.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[at.cssProps[e.prop]]||at.cssHooks[e.prop])?at.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},V.propHooks.scrollTop=V.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},at.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},at.fx=V.prototype.init,at.fx.step={};var pn,fn,gn=/^(?:toggle|show|hide)$/,vn=RegExp("^(?:([+-])=|)("+St+")([a-z%]*)$","i"),wn=/queueHooks$/,bn=[O],xn={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),a=vn.exec(t),s=a&&a[3]||(at.cssNumber[e]?"":"px"),o=(at.cssNumber[e]||"px"!==s&&+i)&&vn.exec(at.css(n.elem,e)),r=1,l=20;if(o&&o[3]!==s){s=s||o[3],a=a||[],o=+i||1;do r=r||".5",o/=r,at.style(n.elem,e,o+s);while(r!==(r=n.cur()/i)&&1!==r&&--l)}return a&&(o=n.start=+o||+i||0,n.unit=s,n.end=a[1]?o+(a[1]+1)*a[2]:+a[2]),n}]};at.Animation=at.extend(U,{tweener:function(e,t){at.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,a=e.length;a>i;i++)n=e[i],xn[n]=xn[n]||[],xn[n].unshift(t)},prefilter:function(e,t){t?bn.unshift(e):bn.push(e)}}),at.speed=function(e,t,n){var i=e&&"object"==typeof e?at.extend({},e):{complete:n||!n&&t||at.isFunction(e)&&e,duration:e,easing:n&&t||t&&!at.isFunction(t)&&t};return i.duration=at.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in at.fx.speeds?at.fx.speeds[i.duration]:at.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){at.isFunction(i.old)&&i.old.call(this),i.queue&&at.dequeue(this,i.queue)},i},at.fn.extend({fadeTo:function(e,t,n,i){return this.filter(Ft).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var a=at.isEmptyObject(e),s=at.speed(t,n,i),o=function(){var t=U(this,at.extend({},e),s);(a||at._data(this,"finish"))&&t.stop(!0)};return o.finish=o,a||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,a=null!=e&&e+"queueHooks",s=at.timers,o=at._data(this);if(a)o[a]&&o[a].stop&&i(o[a]);else for(a in o)o[a]&&o[a].stop&&wn.test(a)&&i(o[a]);for(a=s.length;a--;)s[a].elem!==this||null!=e&&s[a].queue!==e||(s[a].anim.stop(n),t=!1,s.splice(a,1));(t||!n)&&at.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=at._data(this),i=n[e+"queue"],a=n[e+"queueHooks"],s=at.timers,o=i?i.length:0;for(n.finish=!0,at.queue(this,e,[]),a&&a.stop&&a.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),at.each(["toggle","show","hide"],function(e,t){var n=at.fn[t];at.fn[t]=function(e,i,a){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(R(t,!0),e,i,a)}}),at.each({slideDown:R("show"),slideUp:R("hide"),slideToggle:R("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){at.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),at.timers=[],at.fx.tick=function(){var e,t=at.timers,n=0;for(pn=at.now();t.length>n;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||at.fx.stop(),pn=void 0},at.fx.timer=function(e){at.timers.push(e),e()?at.fx.start():at.timers.pop()},at.fx.interval=13,at.fx.start=function(){fn||(fn=setInterval(at.fx.tick,at.fx.interval))},at.fx.stop=function(){clearInterval(fn),fn=null},at.fx.speeds={slow:600,fast:200,_default:400},at.fn.delay=function(e,t){return e=at.fx?at.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},function(){var e,t,n,i,a;t=pt.createElement("div"),t.setAttribute("className","t"),t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=t.getElementsByTagName("a")[0],n=pt.createElement("select"),a=n.appendChild(pt.createElement("option")),e=t.getElementsByTagName("input")[0],i.style.cssText="top:1px",nt.getSetAttribute="t"!==t.className,nt.style=/top/.test(i.getAttribute("style")),nt.hrefNormalized="/a"===i.getAttribute("href"),nt.checkOn=!!e.value,nt.optSelected=a.selected,nt.enctype=!!pt.createElement("form").enctype,n.disabled=!0,nt.optDisabled=!a.disabled,e=pt.createElement("input"),e.setAttribute("value",""),nt.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),nt.radioValue="t"===e.value}();var yn=/\r/g;at.fn.extend({val:function(e){var t,n,i,a=this[0];{if(arguments.length)return i=at.isFunction(e),this.each(function(n){var a;1===this.nodeType&&(a=i?e.call(this,n,at(this).val()):e,null==a?a="":"number"==typeof a?a+="":at.isArray(a)&&(a=at.map(a,function(e){return null==e?"":e+""})),t=at.valHooks[this.type]||at.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,a,"value")||(this.value=a))});if(a)return t=at.valHooks[a.type]||at.valHooks[a.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(a,"value"))?n:(n=a.value,"string"==typeof n?n.replace(yn,""):null==n?"":n)}}}),at.extend({valHooks:{option:{get:function(e){var t=at.find.attr(e,"value");return null!=t?t:at.trim(at.text(e))}},select:{get:function(e){for(var t,n,i=e.options,a=e.selectedIndex,s="select-one"===e.type||0>a,o=s?null:[],r=s?a+1:i.length,l=0>a?r:s?a:0;r>l;l++)if(n=i[l],!(!n.selected&&l!==a||(nt.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&at.nodeName(n.parentNode,"optgroup"))){if(t=at(n).val(),s)return t;o.push(t)}return o},set:function(e,t){for(var n,i,a=e.options,s=at.makeArray(t),o=a.length;o--;)if(i=a[o],at.inArray(at.valHooks.option.get(i),s)>=0)try{i.selected=n=!0}catch(r){}else i.selected=!1;return n||(e.selectedIndex=-1),a}}}}),at.each(["radio","checkbox"],function(){at.valHooks[this]={set:function(e,t){return at.isArray(t)?e.checked=at.inArray(at(e).val(),t)>=0:void 0}},nt.checkOn||(at.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var _n,kn,Cn=at.expr.attrHandle,Tn=/^(?:checked|selected)$/i,Sn=nt.getSetAttribute,En=nt.input;at.fn.extend({attr:function(e,t){return Pt(this,at.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){at.removeAttr(this,e)})}}),at.extend({attr:function(e,t,n){var i,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===kt?at.prop(e,t,n):(1===s&&at.isXMLDoc(e)||(t=t.toLowerCase(),i=at.attrHooks[t]||(at.expr.match.bool.test(t)?kn:_n)),void 0===n?i&&"get"in i&&null!==(a=i.get(e,t))?a:(a=at.find.attr(e,t),null==a?void 0:a):null!==n?i&&"set"in i&&void 0!==(a=i.set(e,n,t))?a:(e.setAttribute(t,n+""),n):void at.removeAttr(e,t))},removeAttr:function(e,t){var n,i,a=0,s=t&&t.match(bt);if(s&&1===e.nodeType)for(;n=s[a++];)i=at.propFix[n]||n,at.expr.match.bool.test(n)?En&&Sn||!Tn.test(n)?e[i]=!1:e[at.camelCase("default-"+n)]=e[i]=!1:at.attr(e,n,""),e.removeAttribute(Sn?n:i)},attrHooks:{type:{set:function(e,t){if(!nt.radioValue&&"radio"===t&&at.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),kn={set:function(e,t,n){return t===!1?at.removeAttr(e,n):En&&Sn||!Tn.test(n)?e.setAttribute(!Sn&&at.propFix[n]||n,n):e[at.camelCase("default-"+n)]=e[n]=!0,n}},at.each(at.expr.match.bool.source.match(/\w+/g),function(e,t){var n=Cn[t]||at.find.attr;Cn[t]=En&&Sn||!Tn.test(t)?function(e,t,i){var a,s;return i||(s=Cn[t],Cn[t]=a,a=null!=n(e,t,i)?t.toLowerCase():null,Cn[t]=s),a}:function(e,t,n){return n?void 0:e[at.camelCase("default-"+t)]?t.toLowerCase():null}}),En&&Sn||(at.attrHooks.value={set:function(e,t,n){return at.nodeName(e,"input")?void(e.defaultValue=t):_n&&_n.set(e,t,n)}}),Sn||(_n={set:function(e,t,n){var i=e.getAttributeNode(n);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(n)),i.value=t+="","value"===n||t===e.getAttribute(n)?t:void 0}},Cn.id=Cn.name=Cn.coords=function(e,t,n){var i;return n?void 0:(i=e.getAttributeNode(t))&&""!==i.value?i.value:null},at.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);return n&&n.specified?n.value:void 0},set:_n.set},at.attrHooks.contenteditable={set:function(e,t,n){_n.set(e,""===t?!1:t,n)}},at.each(["width","height"],function(e,t){at.attrHooks[t]={set:function(e,n){return""===n?(e.setAttribute(t,"auto"),n):void 0}}})),nt.style||(at.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var Fn=/^(?:input|select|textarea|button|object)$/i,Pn=/^(?:a|area)$/i;at.fn.extend({prop:function(e,t){return Pt(this,at.prop,e,t,arguments.length>1)},removeProp:function(e){return e=at.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(t){}})}}),at.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var i,a,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return s=1!==o||!at.isXMLDoc(e),s&&(t=at.propFix[t]||t,a=at.propHooks[t]),void 0!==n?a&&"set"in a&&void 0!==(i=a.set(e,n,t))?i:e[t]=n:a&&"get"in a&&null!==(i=a.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=at.find.attr(e,"tabindex");return t?parseInt(t,10):Fn.test(e.nodeName)||Pn.test(e.nodeName)&&e.href?0:-1}}}}),nt.hrefNormalized||at.each(["href","src"],function(e,t){at.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),nt.optSelected||(at.propHooks.selected={get:function(e){return null}}),at.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){at.propFix[this.toLowerCase()]=this}),nt.enctype||(at.propFix.enctype="encoding");var Dn=/[\t\r\n\f]/g;at.fn.extend({addClass:function(e){var t,n,i,a,s,o,r=0,l=this.length,c="string"==typeof e&&e;if(at.isFunction(e))return this.each(function(t){at(this).addClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(bt)||[];l>r;r++)if(n=this[r],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(Dn," "):" ")){for(s=0;a=t[s++];)i.indexOf(" "+a+" ")<0&&(i+=a+" ");o=at.trim(i),n.className!==o&&(n.className=o)}return this},removeClass:function(e){var t,n,i,a,s,o,r=0,l=this.length,c=0===arguments.length||"string"==typeof e&&e;if(at.isFunction(e))return this.each(function(t){at(this).removeClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(bt)||[];l>r;r++)if(n=this[r],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(Dn," "):"")){for(s=0;a=t[s++];)for(;i.indexOf(" "+a+" ")>=0;)i=i.replace(" "+a+" "," ");o=e?at.trim(i):"",n.className!==o&&(n.className=o)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):this.each(at.isFunction(e)?function(n){at(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n)for(var t,i=0,a=at(this),s=e.match(bt)||[];t=s[i++];)a.hasClass(t)?a.removeClass(t):a.addClass(t);else(n===kt||"boolean"===n)&&(this.className&&at._data(this,"__className__",this.className),this.className=this.className||e===!1?"":at._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(Dn," ").indexOf(t)>=0)return!0;return!1}}),at.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){at.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),at.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Mn=at.now(),Vn=/\?/,An=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;at.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var n,i=null,a=at.trim(t+"");return a&&!at.trim(a.replace(An,function(e,t,a,s){return n&&t&&(i=0),0===i?e:(n=a||t,i+=!s-!a,"")}))?Function("return "+a)():at.error("Invalid JSON: "+t)},at.parseXML=function(t){var n,i;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(i=new DOMParser,n=i.parseFromString(t,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(t))}catch(a){n=void 0}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||at.error("Invalid XML: "+t),n};var Rn,Nn,On=/#.*$/,In=/([?&])_=[^&]*/,Un=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ln=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,qn=/^(?:GET|HEAD)$/,Hn=/^\/\//,$n=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,jn={},zn={},Bn="*/".concat("*");try{Nn=location.href}catch(Wn){Nn=pt.createElement("a"),Nn.href="",Nn=Nn.href}Rn=$n.exec(Nn.toLowerCase())||[],at.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Nn,type:"GET",isLocal:Ln.test(Rn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Bn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":at.parseJSON,"text xml":at.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?H(H(e,at.ajaxSettings),t):H(at.ajaxSettings,e)},ajaxPrefilter:L(jn),ajaxTransport:L(zn),ajax:function(e,t){function n(e,t,n,i){var a,d,v,w,x,_=t;2!==b&&(b=2,r&&clearTimeout(r),c=void 0,o=i||"",y.readyState=e>0?4:0,a=e>=200&&300>e||304===e,n&&(w=$(u,y,n)),w=j(u,w,y,a),a?(u.ifModified&&(x=y.getResponseHeader("Last-Modified"),x&&(at.lastModified[s]=x),x=y.getResponseHeader("etag"),x&&(at.etag[s]=x)),204===e||"HEAD"===u.type?_="nocontent":304===e?_="notmodified":(_=w.state,d=w.data,v=w.error,a=!v)):(v=_,(e||!_)&&(_="error",0>e&&(e=0))),y.status=e,y.statusText=(t||_)+"",a?p.resolveWith(h,[d,_,y]):p.rejectWith(h,[y,_,v]),y.statusCode(g),g=void 0,l&&m.trigger(a?"ajaxSuccess":"ajaxError",[y,u,a?d:v]),f.fireWith(h,[y,_]),l&&(m.trigger("ajaxComplete",[y,u]),--at.active||at.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,a,s,o,r,l,c,d,u=at.ajaxSetup({},t),h=u.context||u,m=u.context&&(h.nodeType||h.jquery)?at(h):at.event,p=at.Deferred(),f=at.Callbacks("once memory"),g=u.statusCode||{},v={},w={},b=0,x="canceled",y={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!d)for(d={};t=Un.exec(o);)d[t[1].toLowerCase()]=t[2];t=d[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=w[n]=w[n]||e,v[e]=t),this},overrideMimeType:function(e){return b||(u.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)g[t]=[g[t],e[t]];else y.always(e[y.status]);return this},abort:function(e){var t=e||x;return c&&c.abort(t),n(0,t),this}};if(p.promise(y).complete=f.add,y.success=y.done,y.error=y.fail,u.url=((e||u.url||Nn)+"").replace(On,"").replace(Hn,Rn[1]+"//"),u.type=t.method||t.type||u.method||u.type,u.dataTypes=at.trim(u.dataType||"*").toLowerCase().match(bt)||[""],null==u.crossDomain&&(i=$n.exec(u.url.toLowerCase()),u.crossDomain=!(!i||i[1]===Rn[1]&&i[2]===Rn[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(Rn[3]||("http:"===Rn[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=at.param(u.data,u.traditional)),q(jn,u,t,y),2===b)return y;l=at.event&&u.global,l&&0===at.active++&&at.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!qn.test(u.type),s=u.url,u.hasContent||(u.data&&(s=u.url+=(Vn.test(s)?"&":"?")+u.data,delete u.data),u.cache===!1&&(u.url=In.test(s)?s.replace(In,"$1_="+Mn++):s+(Vn.test(s)?"&":"?")+"_="+Mn++)),u.ifModified&&(at.lastModified[s]&&y.setRequestHeader("If-Modified-Since",at.lastModified[s]),at.etag[s]&&y.setRequestHeader("If-None-Match",at.etag[s])),(u.data&&u.hasContent&&u.contentType!==!1||t.contentType)&&y.setRequestHeader("Content-Type",u.contentType),y.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Bn+"; q=0.01":""):u.accepts["*"]);for(a in u.headers)y.setRequestHeader(a,u.headers[a]);if(u.beforeSend&&(u.beforeSend.call(h,y,u)===!1||2===b))return y.abort();x="abort";for(a in{success:1,error:1,complete:1})y[a](u[a]);if(c=q(zn,u,t,y)){y.readyState=1,l&&m.trigger("ajaxSend",[y,u]),u.async&&u.timeout>0&&(r=setTimeout(function(){y.abort("timeout")},u.timeout));try{b=1,c.send(v,n)}catch(_){if(!(2>b))throw _;n(-1,_)}}else n(-1,"No Transport");return y},getJSON:function(e,t,n){return at.get(e,t,n,"json")},getScript:function(e,t){return at.get(e,void 0,t,"script")}}),at.each(["get","post"],function(e,t){at[t]=function(e,n,i,a){return at.isFunction(n)&&(a=a||i,i=n,n=void 0),at.ajax({url:e,type:t,dataType:a,data:n,success:i})}}),at._evalUrl=function(e){return at.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},at.fn.extend({wrapAll:function(e){if(at.isFunction(e))return this.each(function(t){at(this).wrapAll(e.call(this,t))});if(this[0]){var t=at(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(at.isFunction(e)?function(t){at(this).wrapInner(e.call(this,t))}:function(){var t=at(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=at.isFunction(e);return this.each(function(n){at(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){at.nodeName(this,"body")||at(this).replaceWith(this.childNodes)}).end()}}),at.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!nt.reliableHiddenOffsets()&&"none"===(e.style&&e.style.display||at.css(e,"display"))},at.expr.filters.visible=function(e){return!at.expr.filters.hidden(e)};var Gn=/%20/g,Yn=/\[\]$/,Jn=/\r?\n/g,Kn=/^(?:submit|button|image|reset|file)$/i,Xn=/^(?:input|select|textarea|keygen)/i;at.param=function(e,t){var n,i=[],a=function(e,t){t=at.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=at.ajaxSettings&&at.ajaxSettings.traditional),at.isArray(e)||e.jquery&&!at.isPlainObject(e))at.each(e,function(){a(this.name,this.value)});else for(n in e)z(n,e[n],t,a);return i.join("&").replace(Gn,"+")},at.fn.extend({serialize:function(){return at.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=at.prop(this,"elements");return e?at.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!at(this).is(":disabled")&&Xn.test(this.nodeName)&&!Kn.test(e)&&(this.checked||!Dt.test(e))}).map(function(e,t){var n=at(this).val();return null==n?null:at.isArray(n)?at.map(n,function(e){return{name:t.name,value:e.replace(Jn,"\r\n")}}):{name:t.name,value:n.replace(Jn,"\r\n")}}).get()}}),at.ajaxSettings.xhr=void 0!==e.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&B()||W()}:B;var Qn=0,Zn={},ei=at.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in Zn)Zn[e](void 0,!0)}),nt.cors=!!ei&&"withCredentials"in ei,ei=nt.ajax=!!ei,ei&&at.ajaxTransport(function(e){if(!e.crossDomain||nt.cors){var t;return{send:function(n,i){var a,s=e.xhr(),o=++Qn;if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(a in n)void 0!==n[a]&&s.setRequestHeader(a,n[a]+"");s.send(e.hasContent&&e.data||null),t=function(n,a){var r,l,c;if(t&&(a||4===s.readyState))if(delete Zn[o],t=void 0,s.onreadystatechange=at.noop,a)4!==s.readyState&&s.abort();else{c={},r=s.status,"string"==typeof s.responseText&&(c.text=s.responseText);try{l=s.statusText}catch(d){l=""}r||!e.isLocal||e.crossDomain?1223===r&&(r=204):r=c.text?200:404}c&&i(r,l,c,s.getAllResponseHeaders())},e.async?4===s.readyState?setTimeout(t):s.onreadystatechange=Zn[o]=t:t()},abort:function(){t&&t(void 0,!0)}}}}),at.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return at.globalEval(e),e}}}),at.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),at.ajaxTransport("script",function(e){if(e.crossDomain){var t,n=pt.head||at("head")[0]||pt.documentElement;return{send:function(i,a){t=pt.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,n){(n||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,n||a(200,"success"))},n.insertBefore(t,n.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}});var ti=[],ni=/(=)\?(?=&|$)|\?\?/;at.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=ti.pop()||at.expando+"_"+Mn++;return this[e]=!0,e}}),at.ajaxPrefilter("json jsonp",function(t,n,i){var a,s,o,r=t.jsonp!==!1&&(ni.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&ni.test(t.data)&&"data");return r||"jsonp"===t.dataTypes[0]?(a=t.jsonpCallback=at.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,r?t[r]=t[r].replace(ni,"$1"+a):t.jsonp!==!1&&(t.url+=(Vn.test(t.url)?"&":"?")+t.jsonp+"="+a),t.converters["script json"]=function(){return o||at.error(a+" was not called"),o[0]},t.dataTypes[0]="json",s=e[a],e[a]=function(){o=arguments},i.always(function(){e[a]=s,t[a]&&(t.jsonpCallback=n.jsonpCallback,ti.push(a)),o&&at.isFunction(s)&&s(o[0]),o=s=void 0}),"script"):void 0}),at.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||pt;var i=ut.exec(e),a=!n&&[];return i?[t.createElement(i[1])]:(i=at.buildFragment([e],t,a),a&&a.length&&at(a).remove(),at.merge([],i.childNodes))};var ii=at.fn.load;at.fn.load=function(e,t,n){if("string"!=typeof e&&ii)return ii.apply(this,arguments);var i,a,s,o=this,r=e.indexOf(" ");return r>=0&&(i=at.trim(e.slice(r,e.length)),e=e.slice(0,r)),at.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(s="POST"),o.length>0&&at.ajax({url:e,type:s,dataType:"html",data:t}).done(function(e){a=arguments,o.html(i?at("<div>").append(at.parseHTML(e)).find(i):e)}).complete(n&&function(e,t){o.each(n,a||[e.responseText,t,e])}),this},at.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){at.fn[t]=function(e){return this.on(t,e)}}),at.expr.filters.animated=function(e){return at.grep(at.timers,function(t){return e===t.elem}).length};var ai=e.document.documentElement;at.offset={setOffset:function(e,t,n){var i,a,s,o,r,l,c,d=at.css(e,"position"),u=at(e),h={};"static"===d&&(e.style.position="relative"),r=u.offset(),s=at.css(e,"top"),l=at.css(e,"left"),c=("absolute"===d||"fixed"===d)&&at.inArray("auto",[s,l])>-1,c?(i=u.position(),o=i.top,a=i.left):(o=parseFloat(s)||0,a=parseFloat(l)||0),at.isFunction(t)&&(t=t.call(e,n,r)),null!=t.top&&(h.top=t.top-r.top+o),null!=t.left&&(h.left=t.left-r.left+a),"using"in t?t.using.call(e,h):u.css(h)}},at.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){at.offset.setOffset(this,e,t)});var t,n,i={top:0,left:0},a=this[0],s=a&&a.ownerDocument;if(s)return t=s.documentElement,at.contains(t,a)?(typeof a.getBoundingClientRect!==kt&&(i=a.getBoundingClientRect()),n=G(s),{top:i.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0),left:i.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):i},position:function(){if(this[0]){var e,t,n={top:0,left:0},i=this[0];return"fixed"===at.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),at.nodeName(e[0],"html")||(n=e.offset()),n.top+=at.css(e[0],"borderTopWidth",!0),n.left+=at.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-at.css(i,"marginTop",!0),left:t.left-n.left-at.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||ai;e&&!at.nodeName(e,"html")&&"static"===at.css(e,"position");)e=e.offsetParent;return e||ai})}}),at.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n=/Y/.test(t);at.fn[e]=function(i){return Pt(this,function(e,i,a){var s=G(e);return void 0===a?s?t in s?s[t]:s.document.documentElement[i]:e[i]:void(s?s.scrollTo(n?at(s).scrollLeft():a,n?a:at(s).scrollTop()):e[i]=a)},e,i,arguments.length,null)}}),at.each(["top","left"],function(e,t){at.cssHooks[t]=S(nt.pixelPosition,function(e,n){return n?(n=tn(e,t),an.test(n)?at(e).position()[t]+"px":n):void 0})}),at.each({Height:"height",Width:"width"},function(e,t){at.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){at.fn[i]=function(i,a){var s=arguments.length&&(n||"boolean"!=typeof i),o=n||(i===!0||a===!0?"margin":"border");return Pt(this,function(t,n,i){var a;return at.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(a=t.documentElement,Math.max(t.body["scroll"+e],a["scroll"+e],t.body["offset"+e],a["offset"+e],a["client"+e])):void 0===i?at.css(t,n,o):at.style(t,n,i,o)},t,s?i:void 0,s,null)}})}),at.fn.size=function(){return this.length},at.fn.andSelf=at.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return at
});var si=e.jQuery,oi=e.$;return at.noConflict=function(t){return e.$===at&&(e.$=oi),t&&e.jQuery===at&&(e.jQuery=si),at},typeof t===kt&&(e.jQuery=e.$=at),at}),function(){function e(e){function t(t,n,i,a,s,o){for(;s>=0&&o>s;s+=e){var r=a?a[s]:s;i=n(i,t[r],r,t)}return i}return function(n,i,a,s){i=b(i,s,4);var o=!S(n)&&w.keys(n),r=(o||n).length,l=e>0?0:r-1;return 3>arguments.length&&(a=n[o?o[l]:l],l+=e),t(n,i,a,o,l,r)}}function t(e){return function(t,n,i){n=x(n,i);for(var a=T(t),s=e>0?0:a-1;s>=0&&a>s;s+=e)if(n(t[s],s,t))return s;return-1}}function n(e,t,n){return function(i,a,s){var o=0,r=T(i);if("number"==typeof s)e>0?o=s>=0?s:Math.max(s+r,o):r=s>=0?Math.min(s+1,r):s+r+1;else if(n&&s&&r)return s=n(i,a),i[s]===a?s:-1;if(a!==a)return s=t(d.call(i,o,r),w.isNaN),s>=0?s+o:-1;for(s=e>0?o:r-1;s>=0&&r>s;s+=e)if(i[s]===a)return s;return-1}}function i(e,t){var n=M.length,i=e.constructor,a=w.isFunction(i)&&i.prototype||r,s="constructor";for(w.has(e,s)&&!w.contains(t,s)&&t.push(s);n--;)s=M[n],s in e&&e[s]!==a[s]&&!w.contains(t,s)&&t.push(s)}var a=this,s=a._,o=Array.prototype,r=Object.prototype,l=Function.prototype,c=o.push,d=o.slice,u=r.toString,h=r.hasOwnProperty,m=Array.isArray,p=Object.keys,f=l.bind,g=Object.create,v=function(){},w=function(e){return e instanceof w?e:this instanceof w?void(this._wrapped=e):new w(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=w),exports._=w):a._=w,w.VERSION="1.8.3";var b=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,a){return e.call(t,n,i,a)};case 4:return function(n,i,a,s){return e.call(t,n,i,a,s)}}return function(){return e.apply(t,arguments)}},x=function(e,t,n){return null==e?w.identity:w.isFunction(e)?b(e,t,n):w.isObject(e)?w.matcher(e):w.property(e)};w.iteratee=function(e,t){return x(e,t,1/0)};var y=function(e,t){return function(n){var i=arguments.length;if(2>i||null==n)return n;for(var a=1;i>a;a++)for(var s=arguments[a],o=e(s),r=o.length,l=0;r>l;l++){var c=o[l];t&&void 0!==n[c]||(n[c]=s[c])}return n}},_=function(e){if(!w.isObject(e))return{};if(g)return g(e);v.prototype=e;var t=new v;return v.prototype=null,t},k=function(e){return function(t){return null==t?void 0:t[e]}},C=Math.pow(2,53)-1,T=k("length"),S=function(e){var t=T(e);return"number"==typeof t&&t>=0&&C>=t};w.each=w.forEach=function(e,t,n){t=b(t,n);var i,a;if(S(e))for(i=0,a=e.length;a>i;i++)t(e[i],i,e);else{var s=w.keys(e);for(i=0,a=s.length;a>i;i++)t(e[s[i]],s[i],e)}return e},w.map=w.collect=function(e,t,n){t=x(t,n);for(var i=!S(e)&&w.keys(e),a=(i||e).length,s=Array(a),o=0;a>o;o++){var r=i?i[o]:o;s[o]=t(e[r],r,e)}return s},w.reduce=w.foldl=w.inject=e(1),w.reduceRight=w.foldr=e(-1),w.find=w.detect=function(e,t,n){var i;return i=S(e)?w.findIndex(e,t,n):w.findKey(e,t,n),void 0!==i&&-1!==i?e[i]:void 0},w.filter=w.select=function(e,t,n){var i=[];return t=x(t,n),w.each(e,function(e,n,a){t(e,n,a)&&i.push(e)}),i},w.reject=function(e,t,n){return w.filter(e,w.negate(x(t)),n)},w.every=w.all=function(e,t,n){t=x(t,n);for(var i=!S(e)&&w.keys(e),a=(i||e).length,s=0;a>s;s++){var o=i?i[s]:s;if(!t(e[o],o,e))return!1}return!0},w.some=w.any=function(e,t,n){t=x(t,n);for(var i=!S(e)&&w.keys(e),a=(i||e).length,s=0;a>s;s++){var o=i?i[s]:s;if(t(e[o],o,e))return!0}return!1},w.contains=w.includes=w.include=function(e,t,n,i){return S(e)||(e=w.values(e)),("number"!=typeof n||i)&&(n=0),w.indexOf(e,t,n)>=0},w.invoke=function(e,t){var n=d.call(arguments,2),i=w.isFunction(t);return w.map(e,function(e){var a=i?t:e[t];return null==a?a:a.apply(e,n)})},w.pluck=function(e,t){return w.map(e,w.property(t))},w.where=function(e,t){return w.filter(e,w.matcher(t))},w.findWhere=function(e,t){return w.find(e,w.matcher(t))},w.max=function(e,t,n){var i,a,s=-1/0,o=-1/0;if(null==t&&null!=e){e=S(e)?e:w.values(e);for(var r=0,l=e.length;l>r;r++)i=e[r],i>s&&(s=i)}else t=x(t,n),w.each(e,function(e,n,i){a=t(e,n,i),(a>o||a===-1/0&&s===-1/0)&&(s=e,o=a)});return s},w.min=function(e,t,n){var i,a,s=1/0,o=1/0;if(null==t&&null!=e){e=S(e)?e:w.values(e);for(var r=0,l=e.length;l>r;r++)i=e[r],s>i&&(s=i)}else t=x(t,n),w.each(e,function(e,n,i){a=t(e,n,i),(o>a||1/0===a&&1/0===s)&&(s=e,o=a)});return s},w.shuffle=function(e){for(var t,n=S(e)?e:w.values(e),i=n.length,a=Array(i),s=0;i>s;s++)t=w.random(0,s),t!==s&&(a[s]=a[t]),a[t]=n[s];return a},w.sample=function(e,t,n){return null==t||n?(S(e)||(e=w.values(e)),e[w.random(e.length-1)]):w.shuffle(e).slice(0,Math.max(0,t))},w.sortBy=function(e,t,n){return t=x(t,n),w.pluck(w.map(e,function(e,n,i){return{value:e,index:n,criteria:t(e,n,i)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return e.index-t.index}),"value")};var E=function(e){return function(t,n,i){var a={};return n=x(n,i),w.each(t,function(i,s){var o=n(i,s,t);e(a,i,o)}),a}};w.groupBy=E(function(e,t,n){w.has(e,n)?e[n].push(t):e[n]=[t]}),w.indexBy=E(function(e,t,n){e[n]=t}),w.countBy=E(function(e,t,n){w.has(e,n)?e[n]++:e[n]=1}),w.toArray=function(e){return e?w.isArray(e)?d.call(e):S(e)?w.map(e,w.identity):w.values(e):[]},w.size=function(e){return null==e?0:S(e)?e.length:w.keys(e).length},w.partition=function(e,t,n){t=x(t,n);var i=[],a=[];return w.each(e,function(e,n,s){(t(e,n,s)?i:a).push(e)}),[i,a]},w.first=w.head=w.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:w.initial(e,e.length-t)},w.initial=function(e,t,n){return d.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},w.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:w.rest(e,Math.max(0,e.length-t))},w.rest=w.tail=w.drop=function(e,t,n){return d.call(e,null==t||n?1:t)},w.compact=function(e){return w.filter(e,w.identity)};var F=function(e,t,n,i){for(var a=[],s=0,o=i||0,r=T(e);r>o;o++){var l=e[o];if(S(l)&&(w.isArray(l)||w.isArguments(l))){t||(l=F(l,t,n));var c=0,d=l.length;for(a.length+=d;d>c;)a[s++]=l[c++]}else n||(a[s++]=l)}return a};w.flatten=function(e,t){return F(e,t,!1)},w.without=function(e){return w.difference(e,d.call(arguments,1))},w.uniq=w.unique=function(e,t,n,i){w.isBoolean(t)||(i=n,n=t,t=!1),null!=n&&(n=x(n,i));for(var a=[],s=[],o=0,r=T(e);r>o;o++){var l=e[o],c=n?n(l,o,e):l;t?(o&&s===c||a.push(l),s=c):n?w.contains(s,c)||(s.push(c),a.push(l)):w.contains(a,l)||a.push(l)}return a},w.union=function(){return w.uniq(F(arguments,!0,!0))},w.intersection=function(e){for(var t=[],n=arguments.length,i=0,a=T(e);a>i;i++){var s=e[i];if(!w.contains(t,s)){for(var o=1;n>o&&w.contains(arguments[o],s);o++);o===n&&t.push(s)}}return t},w.difference=function(e){var t=F(arguments,!0,!0,1);return w.filter(e,function(e){return!w.contains(t,e)})},w.zip=function(){return w.unzip(arguments)},w.unzip=function(e){for(var t=e&&w.max(e,T).length||0,n=Array(t),i=0;t>i;i++)n[i]=w.pluck(e,i);return n},w.object=function(e,t){for(var n={},i=0,a=T(e);a>i;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},w.findIndex=t(1),w.findLastIndex=t(-1),w.sortedIndex=function(e,t,n,i){n=x(n,i,1);for(var a=n(t),s=0,o=T(e);o>s;){var r=Math.floor((s+o)/2);n(e[r])<a?s=r+1:o=r}return s},w.indexOf=n(1,w.findIndex,w.sortedIndex),w.lastIndexOf=n(-1,w.findLastIndex),w.range=function(e,t,n){null==t&&(t=e||0,e=0),n=n||1;for(var i=Math.max(Math.ceil((t-e)/n),0),a=Array(i),s=0;i>s;s++,e+=n)a[s]=e;return a};var P=function(e,t,n,i,a){if(!(i instanceof t))return e.apply(n,a);var s=_(e.prototype),o=e.apply(s,a);return w.isObject(o)?o:s};w.bind=function(e,t){if(f&&e.bind===f)return f.apply(e,d.call(arguments,1));if(!w.isFunction(e))throw new TypeError("Bind must be called on a function");var n=d.call(arguments,2),i=function(){return P(e,i,t,this,n.concat(d.call(arguments)))};return i},w.partial=function(e){var t=d.call(arguments,1),n=function(){for(var i=0,a=t.length,s=Array(a),o=0;a>o;o++)s[o]=t[o]===w?arguments[i++]:t[o];for(;arguments.length>i;)s.push(arguments[i++]);return P(e,n,this,this,s)};return n},w.bindAll=function(e){var t,n,i=arguments.length;if(1>=i)throw Error("bindAll must be passed function names");for(t=1;i>t;t++)n=arguments[t],e[n]=w.bind(e[n],e);return e},w.memoize=function(e,t){var n=function(i){var a=n.cache,s=""+(t?t.apply(this,arguments):i);return w.has(a,s)||(a[s]=e.apply(this,arguments)),a[s]};return n.cache={},n},w.delay=function(e,t){var n=d.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},w.defer=w.partial(w.delay,w,1),w.throttle=function(e,t,n){var i,a,s,o=null,r=0;n||(n={});var l=function(){r=n.leading===!1?0:w.now(),o=null,s=e.apply(i,a),o||(i=a=null)};return function(){var c=w.now();r||n.leading!==!1||(r=c);var d=t-(c-r);return i=this,a=arguments,0>=d||d>t?(o&&(clearTimeout(o),o=null),r=c,s=e.apply(i,a),o||(i=a=null)):o||n.trailing===!1||(o=setTimeout(l,d)),s}},w.debounce=function(e,t,n){var i,a,s,o,r,l=function(){var c=w.now()-o;t>c&&c>=0?i=setTimeout(l,t-c):(i=null,n||(r=e.apply(s,a),i||(s=a=null)))};return function(){s=this,a=arguments,o=w.now();var c=n&&!i;return i||(i=setTimeout(l,t)),c&&(r=e.apply(s,a),s=a=null),r}},w.wrap=function(e,t){return w.partial(t,e)},w.negate=function(e){return function(){return!e.apply(this,arguments)}},w.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,i=e[t].apply(this,arguments);n--;)i=e[n].call(this,i);return i}},w.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},w.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),1>=e&&(t=null),n}},w.once=w.partial(w.before,2);var D=!{toString:null}.propertyIsEnumerable("toString"),M=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];w.keys=function(e){if(!w.isObject(e))return[];if(p)return p(e);var t=[];for(var n in e)w.has(e,n)&&t.push(n);return D&&i(e,t),t},w.allKeys=function(e){if(!w.isObject(e))return[];var t=[];for(var n in e)t.push(n);return D&&i(e,t),t},w.values=function(e){for(var t=w.keys(e),n=t.length,i=Array(n),a=0;n>a;a++)i[a]=e[t[a]];return i},w.mapObject=function(e,t,n){t=x(t,n);for(var i,a=w.keys(e),s=a.length,o={},r=0;s>r;r++)i=a[r],o[i]=t(e[i],i,e);return o},w.pairs=function(e){for(var t=w.keys(e),n=t.length,i=Array(n),a=0;n>a;a++)i[a]=[t[a],e[t[a]]];return i},w.invert=function(e){for(var t={},n=w.keys(e),i=0,a=n.length;a>i;i++)t[e[n[i]]]=n[i];return t},w.functions=w.methods=function(e){var t=[];for(var n in e)w.isFunction(e[n])&&t.push(n);return t.sort()},w.extend=y(w.allKeys),w.extendOwn=w.assign=y(w.keys),w.findKey=function(e,t,n){t=x(t,n);for(var i,a=w.keys(e),s=0,o=a.length;o>s;s++)if(i=a[s],t(e[i],i,e))return i},w.pick=function(e,t,n){var i,a,s={},o=e;if(null==o)return s;w.isFunction(t)?(a=w.allKeys(o),i=b(t,n)):(a=F(arguments,!1,!1,1),i=function(e,t,n){return t in n},o=Object(o));for(var r=0,l=a.length;l>r;r++){var c=a[r],d=o[c];i(d,c,o)&&(s[c]=d)}return s},w.omit=function(e,t,n){if(w.isFunction(t))t=w.negate(t);else{var i=w.map(F(arguments,!1,!1,1),String);t=function(e,t){return!w.contains(i,t)}}return w.pick(e,t,n)},w.defaults=y(w.allKeys,!0),w.create=function(e,t){var n=_(e);return t&&w.extendOwn(n,t),n},w.clone=function(e){return w.isObject(e)?w.isArray(e)?e.slice():w.extend({},e):e},w.tap=function(e,t){return t(e),e},w.isMatch=function(e,t){var n=w.keys(t),i=n.length;if(null==e)return!i;for(var a=Object(e),s=0;i>s;s++){var o=n[s];if(t[o]!==a[o]||!(o in a))return!1}return!0};var V=function(e,t,n,i){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof w&&(e=e._wrapped),t instanceof w&&(t=t._wrapped);var a=u.call(e);if(a!==u.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var s="[object Array]"===a;if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var o=e.constructor,r=t.constructor;if(o!==r&&!(w.isFunction(o)&&o instanceof o&&w.isFunction(r)&&r instanceof r)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],i=i||[];for(var l=n.length;l--;)if(n[l]===e)return i[l]===t;if(n.push(e),i.push(t),s){if(l=e.length,l!==t.length)return!1;for(;l--;)if(!V(e[l],t[l],n,i))return!1}else{var c,d=w.keys(e);if(l=d.length,w.keys(t).length!==l)return!1;for(;l--;)if(c=d[l],!w.has(t,c)||!V(e[c],t[c],n,i))return!1}return n.pop(),i.pop(),!0};w.isEqual=function(e,t){return V(e,t)},w.isEmpty=function(e){return null==e?!0:S(e)&&(w.isArray(e)||w.isString(e)||w.isArguments(e))?0===e.length:0===w.keys(e).length},w.isElement=function(e){return!(!e||1!==e.nodeType)},w.isArray=m||function(e){return"[object Array]"===u.call(e)},w.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},w.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){w["is"+e]=function(t){return u.call(t)==="[object "+e+"]"}}),w.isArguments(arguments)||(w.isArguments=function(e){return w.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(w.isFunction=function(e){return"function"==typeof e||!1}),w.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},w.isNaN=function(e){return w.isNumber(e)&&e!==+e},w.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===u.call(e)},w.isNull=function(e){return null===e},w.isUndefined=function(e){return void 0===e},w.has=function(e,t){return null!=e&&h.call(e,t)},w.noConflict=function(){return a._=s,this},w.identity=function(e){return e},w.constant=function(e){return function(){return e}},w.noop=function(){},w.property=k,w.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},w.matcher=w.matches=function(e){return e=w.extendOwn({},e),function(t){return w.isMatch(t,e)}},w.times=function(e,t,n){var i=Array(Math.max(0,e));t=b(t,n,1);for(var a=0;e>a;a++)i[a]=t(a);return i},w.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},w.now=Date.now||function(){return(new Date).getTime()};var A={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},R=w.invert(A),N=function(e){var t=function(t){return e[t]},n="(?:"+w.keys(e).join("|")+")",i=RegExp(n),a=RegExp(n,"g");return function(e){return e=null==e?"":""+e,i.test(e)?e.replace(a,t):e}};w.escape=N(A),w.unescape=N(R),w.result=function(e,t,n){var i=null==e?void 0:e[t];return void 0===i&&(i=n),w.isFunction(i)?i.call(e):i};var O=0;w.uniqueId=function(e){var t=++O+"";return e?e+t:t},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var I=/(.)^/,U={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\u2028|\u2029/g,q=function(e){return"\\"+U[e]};w.template=function(e,t,n){!t&&n&&(t=n),t=w.defaults({},t,w.templateSettings);var i=RegExp([(t.escape||I).source,(t.interpolate||I).source,(t.evaluate||I).source].join("|")+"|$","g"),a=0,s="__p+='";e.replace(i,function(t,n,i,o,r){return s+=e.slice(a,r).replace(L,q),a=r+t.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?s+="'+\n((__t=("+i+"))==null?'':__t)+\n'":o&&(s+="';\n"+o+"\n__p+='"),t}),s+="';\n",t.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=Function(t.variable||"obj","_",s)}catch(r){throw r.source=s,r}var l=function(e){return o.call(this,e,w)},c=t.variable||"obj";return l.source="function("+c+"){\n"+s+"}",l},w.chain=function(e){var t=w(e);return t._chain=!0,t};var H=function(e,t){return e._chain?w(t).chain():t};w.mixin=function(e){w.each(w.functions(e),function(t){var n=w[t]=e[t];w.prototype[t]=function(){var e=[this._wrapped];return c.apply(e,arguments),H(this,n.apply(w,e))}})},w.mixin(w),w.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=o[e];w.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],H(this,n)}}),w.each(["concat","join","slice"],function(e){var t=o[e];w.prototype[e]=function(){return H(this,t.apply(this._wrapped,arguments))}}),w.prototype.value=function(){return this._wrapped},w.prototype.valueOf=w.prototype.toJSON=w.prototype.value,w.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return w})}.call(this),define("home/utils/layoutUtils",["jquery","underscore"],function(e,t){function n(){this.isElementInViewport=function(e){var t=e[0].getBoundingClientRect();return t.top>=0&&t.left>=0&&(window.innerHeight||document.documentElement.clientHeight)>=t.bottom&&(window.innerWidth||document.documentElement.clientWidth)>=t.right},this.getScreenWidth=function(){return this.screenWidth=this.screenWidth||window.screen.width},this.getNavHeight=t.memoize(function(){return e("[data-role=nav-view]").outerHeight()}),this.shouldShowImages=function(){return this.getScreenWidth()>i},this.isScreenGreaterThanLarge=function(){return this.getScreenWidth()>a}}var i=480,a=1024;return new n}),window.Modernizr=function(e,t,n){function i(e){w.cssText=e}function a(e,t){return typeof e===t}function s(e,t){return!!~(""+e).indexOf(t)}function o(e,t){for(var i in e){var a=e[i];if(!s(a,"-")&&w[a]!==n)return"pfx"==t?a:!0}return!1}function r(e,t,i){for(var s in e){var o=t[e[s]];if(o!==n)return i===!1?e[s]:a(o,"function")?o.bind(i||t):o}return!1}function l(e,t,n){var i=e.charAt(0).toUpperCase()+e.slice(1),s=(e+" "+y.join(i+" ")+i).split(" ");return a(t,"string")||a(t,"undefined")?o(s,t):(s=(e+" "+_.join(i+" ")+i).split(" "),r(s,t,n))}var c,d,u,h="2.8.3",m={},p=!0,f=t.documentElement,g="modernizr",v=t.createElement(g),w=v.style,b=" -webkit- -moz- -o- -ms- ".split(" "),x="Webkit Moz O ms",y=x.split(" "),_=x.toLowerCase().split(" "),k={},C=[],T=C.slice,S=function(e,n,i,a){var s,o,r,l,c=t.createElement("div"),d=t.body,u=d||t.createElement("body");if(parseInt(i,10))for(;i--;)r=t.createElement("div"),r.id=a?a[i]:g+(i+1),c.appendChild(r);return s='&#173;<style id="s'+g+'">'+e+"</style>",c.id=g,(d?c:u).innerHTML+=s,u.appendChild(c),d||(u.style.background="",u.style.overflow="hidden",l=f.style.overflow,f.style.overflow="hidden",f.appendChild(u)),o=n(c,e),d?c.parentNode.removeChild(c):(u.parentNode.removeChild(u),f.style.overflow=l),!!o},E={}.hasOwnProperty;u=a(E,"undefined")||a(E.call,"undefined")?function(e,t){return t in e&&a(e.constructor.prototype[t],"undefined")}:function(e,t){return E.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var n=T.call(arguments,1),i=function(){if(this instanceof i){var a=function(){};a.prototype=t.prototype;var s=new a,o=t.apply(s,n.concat(T.call(arguments)));return Object(o)===o?o:s}return t.apply(e,n.concat(T.call(arguments)))};return i}),k.flexbox=function(){return l("flexWrap")},k.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:S("@media ("+b.join("touch-enabled),(")+g+"){#modernizr{top:9px;position:absolute}}",function(e){n=9===e.offsetTop}),n},k.history=function(){return!(!e.history||!history.pushState)},k.localstorage=function(){try{return localStorage.setItem(g,g),localStorage.removeItem(g),!0}catch(e){return!1}};for(var F in k)u(k,F)&&(d=F.toLowerCase(),m[d]=k[F](),C.push((m[d]?"":"no-")+d));return m.addTest=function(e,t){if("object"==typeof e)for(var i in e)u(e,i)&&m.addTest(i,e[i]);else{if(e=e.toLowerCase(),m[e]!==n)return m;t="function"==typeof t?t():t,n!==p&&p&&(f.className+=" "+(t?"":"no-")+e),m[e]=t}return m},i(""),v=c=null,function(e,t){function i(e,t){var n=e.createElement("p"),i=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",i.insertBefore(n.lastChild,i.firstChild)}function a(){var e=b.elements;return"string"==typeof e?e.split(" "):e}function s(e){var t=w[e[g]];return t||(t={},v++,e[g]=v,w[v]=t),t}function o(e,n,i){if(n||(n=t),u)return n.createElement(e);i||(i=s(n));var a;return a=i.cache[e]?i.cache[e].cloneNode():f.test(e)?(i.cache[e]=i.createElem(e)).cloneNode():i.createElem(e),!a.canHaveChildren||p.test(e)||a.tagUrn?a:i.frag.appendChild(a)}function r(e,n){if(e||(e=t),u)return e.createDocumentFragment();n=n||s(e);for(var i=n.frag.cloneNode(),o=0,r=a(),l=r.length;l>o;o++)i.createElement(r[o]);return i}function l(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return b.shivMethods?o(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+a().join().replace(/[\w\-]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(b,t.frag)}function c(e){e||(e=t);var n=s(e);return!b.shivCSS||d||n.hasCSS||(n.hasCSS=!!i(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),u||l(e,n),e}var d,u,h="3.7.0",m=e.html5||{},p=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,g="_html5shiv",v=0,w={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",d="hidden"in e,u=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return n===e.cloneNode||n===e.createDocumentFragment||n===e.createElement}()}catch(i){d=!0,u=!0}}();var b={elements:m.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:h,shivCSS:m.shivCSS!==!1,supportsUnknownElements:u,shivMethods:m.shivMethods!==!1,type:"default",shivDocument:c,createElement:o,createDocumentFragment:r};e.html5=b,c(t)}(this,t),m._version=h,m._prefixes=b,m._domPrefixes=_,m._cssomPrefixes=y,m.testProp=function(e){return o([e])},m.testAllProps=l,m.testStyles=S,f.className=f.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(p?" js "+C.join(" "):""),m}(this,this.document),function(e,t,n){function i(e){return"[object Function]"==g.call(e)}function a(e){return"string"==typeof e}function s(){}function o(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function r(){var e=v.shift();w=1,e?e.t?p(function(){("c"==e.t?h.injectCss:h.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),r()):w=0}function l(e,n,i,a,s,l,c){function d(t){if(!m&&o(u.readyState)&&(b.r=m=1,!w&&r(),u.onload=u.onreadystatechange=null,t)){"img"!=e&&p(function(){y.removeChild(u)},50);for(var i in S[n])S[n].hasOwnProperty(i)&&S[n][i].onload()}}var c=c||h.errorTimeout,u=t.createElement(e),m=0,g=0,b={t:i,s:n,e:s,a:l,x:c};1===S[n]&&(g=1,S[n]=[]),"object"==e?u.data=n:(u.src=n,u.type=e),u.width=u.height="0",u.onerror=u.onload=u.onreadystatechange=function(){d.call(this,g)},v.splice(a,0,b),"img"!=e&&(g||2===S[n]?(y.insertBefore(u,x?null:f),p(d,c)):S[n].push(u))}function c(e,t,n,i,s){return w=0,t=t||"j",a(e)?l("c"==t?k:_,e,t,this.i++,n,i,s):(v.splice(this.i++,0,e),1==v.length&&r()),this}function d(){var e=h;return e.loader={load:c,i:0},e}var u,h,m=t.documentElement,p=e.setTimeout,f=t.getElementsByTagName("script")[0],g={}.toString,v=[],w=0,b="MozAppearance"in m.style,x=b&&!!t.createRange().compareNode,y=x?m:f.parentNode,m=e.opera&&"[object Opera]"==g.call(e.opera),m=!!t.attachEvent&&!m,_=b?"object":m?"script":"img",k=m?"script":_,C=Array.isArray||function(e){return"[object Array]"==g.call(e)},T=[],S={},E={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};h=function(e){function t(e){var t,n,i,e=e.split("!"),a=T.length,s=e.pop(),o=e.length,s={url:s,origUrl:s,prefixes:e};for(n=0;o>n;n++)i=e[n].split("="),(t=E[i.shift()])&&(s=t(s,i));for(n=0;a>n;n++)s=T[n](s);return s}function o(e,a,s,o,r){var l=t(e),c=l.autoCallback;l.url.split(".").pop().split("?").shift(),l.bypass||(a&&(a=i(a)?a:a[e]||a[o]||a[e.split("/").pop().split("?")[0]]),l.instead?l.instead(e,a,s,o,r):(S[l.url]?l.noexec=!0:S[l.url]=1,s.load(l.url,l.forceCSS||!l.forceJS&&"css"==l.url.split(".").pop().split("?").shift()?"c":n,l.noexec,l.attrs,l.timeout),(i(a)||i(c))&&s.load(function(){d(),a&&a(l.origUrl,r,o),c&&c(l.origUrl,r,o),S[l.url]=2})))}function r(e,t){function n(e,n){if(e){if(a(e))n||(u=function(){var e=[].slice.call(arguments);h.apply(this,e),m()}),o(e,u,t,0,c);else if(Object(e)===e)for(l in r=function(){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}(),e)e.hasOwnProperty(l)&&(!n&&!--r&&(i(u)?u=function(){var e=[].slice.call(arguments);h.apply(this,e),m()}:u[l]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),m()}}(h[l])),o(e[l],u,t,l,c))}else!n&&m()}var r,l,c=!!e.test,d=e.load||e.both,u=e.callback||s,h=u,m=e.complete||s;n(c?e.yep:e.nope,!!d),d&&n(d)}var l,c,u=this.yepnope.loader;if(a(e))o(e,0,u,0);else if(C(e))for(l=0;e.length>l;l++)c=e[l],a(c)?o(c,0,u,0):C(c)?h(c):Object(c)===c&&r(c,u);else Object(e)===e&&r(e,u)},h.addPrefix=function(e,t){E[e]=t},h.addFilter=function(e){T.push(e)},h.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",u=function(){t.removeEventListener("DOMContentLoaded",u,0),t.readyState="complete"},0)),e.yepnope=d(),e.yepnope.executeStack=r,e.yepnope.injectJs=function(e,n,i,a,l,c){var d,u,m=t.createElement("script"),a=a||h.errorTimeout;m.src=e;for(u in i)m.setAttribute(u,i[u]);n=c?r:n||s,m.onreadystatechange=m.onload=function(){!d&&o(m.readyState)&&(d=1,n(),m.onload=m.onreadystatechange=null)},p(function(){d||(d=1,n(1))},a),l?m.onload():f.parentNode.insertBefore(m,f)},e.yepnope.injectCss=function(e,n,i,a,o,l){var c,a=t.createElement("link"),n=l?r:n||s;a.href=e,a.rel="stylesheet",a.type="text/css";for(c in i)a.setAttribute(c,i[c]);o||(f.parentNode.insertBefore(a,f),p(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("contenteditable","contentEditable"in document.documentElement),define("modernizr",function(e){return function(){var t;return t||e.Modernizr}}(this)),function(e,t){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,i,a){e.Backbone=t(e,a,n,i)});else if("undefined"!=typeof exports){var n=require("underscore");t(e,exports,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,i){var a=e.Backbone,s=[],o=s.slice;t.VERSION="1.1.2",t.$=i,t.noConflict=function(){return e.Backbone=a,this},t.emulateHTTP=!1,t.emulateJSON=!1;var r=t.Events={on:function(e,t,n){if(!c(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var i=this._events[e]||(this._events[e]=[]);return i.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,i){if(!c(this,"once",e,[t,i])||!t)return this;var a=this,s=n.once(function(){a.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,i)},off:function(e,t,i){var a,s,o,r,l,d,u,h;if(!this._events||!c(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events=void 0,this;for(r=e?[e]:n.keys(this._events),l=0,d=r.length;d>l;l++)if(e=r[l],o=this._events[e]){if(this._events[e]=a=[],t||i)for(u=0,h=o.length;h>u;u++)s=o[u],(t&&t!==s.callback&&t!==s.callback._callback||i&&i!==s.context)&&a.push(s);a.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!c(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&d(n,t),i&&d(i,arguments),this},stopListening:function(e,t,i){var a=this._listeningTo;if(!a)return this;var s=!t&&!i;i||"object"!=typeof t||(i=this),e&&((a={})[e._listenId]=e);for(var o in a)e=a[o],e.off(t,i,this),(s||n.isEmpty(e._events))&&delete this._listeningTo[o];return this}},l=/\s+/,c=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var a in n)e[t].apply(e,[a,n[a]].concat(i));return!1}if(l.test(n)){for(var s=n.split(l),o=0,r=s.length;r>o;o++)e[t].apply(e,[s[o]].concat(i));return!1}return!0},d=function(e,t){var n,i=-1,a=e.length,s=t[0],o=t[1],r=t[2];switch(t.length){case 0:for(;++i<a;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<a;)(n=e[i]).callback.call(n.ctx,s);return;case 2:for(;++i<a;)(n=e[i]).callback.call(n.ctx,s,o);return;case 3:for(;++i<a;)(n=e[i]).callback.call(n.ctx,s,o,r);return;default:for(;++i<a;)(n=e[i]).callback.apply(n.ctx,t);return}},u={listenTo:"on",listenToOnce:"once"};n.each(u,function(e,t){r[t]=function(t,i,a){var s=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=n.uniqueId("l"));return s[o]=t,a||"object"!=typeof i||(a=this),t[e](i,a,this),this}}),r.bind=r.on,r.unbind=r.off,n.extend(t,r);var h=t.Model=function(e,t){var i=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,r,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var a,s,o,r,l,c,d,u;if(null==e)return this;if("object"==typeof e?(s=e,i=t):(s={})[e]=t,i||(i={}),!this._validate(s,i))return!1;o=i.unset,l=i.silent,r=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=n.clone(this.attributes),this.changed={}),u=this.attributes,d=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(a in s)t=s[a],n.isEqual(u[a],t)||r.push(a),n.isEqual(d[a],t)?delete this.changed[a]:this.changed[a]=t,o?delete u[a]:u[a]=t;if(!l){r.length&&(this._pending=i);for(var h=0,m=r.length;m>h;h++)this.trigger("change:"+r[h],this,u[r[h]],i)}if(c)return this;if(!l)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,i=!1,a=this._changing?this._previousAttributes:this.attributes;for(var s in e)n.isEqual(a[s],t=e[s])||((i||(i={}))[s]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),void t.trigger("sync",t,n,e)):!1},I(this,e),this.sync("read",this,e)},save:function(e,t,i){var a,s,o,r=this.attributes;if(null==e||"object"==typeof e?(a=e,i=t):(a={})[e]=t,i=n.extend({validate:!0},i),a&&!i.wait){if(!this.set(a,i))return!1}else if(!this._validate(a,i))return!1;a&&i.wait&&(this.attributes=n.extend({},r,a)),void 0===i.parse&&(i.parse=!0);var l=this,c=i.success;return i.success=function(e){l.attributes=r;var t=l.parse(e,i);return i.wait&&(t=n.extend(a||{},t)),n.isObject(t)&&!l.set(t,i)?!1:(c&&c(l,e,i),void l.trigger("sync",l,e,i))},I(this,i),s=this.isNew()?"create":i.patch?"patch":"update","patch"===s&&(i.attrs=a),o=this.sync(s,this,i),a&&i.wait&&(this.attributes=r),o},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,a=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(n){(e.wait||t.isNew())&&a(),i&&i(t,n,e),t.isNew()||t.trigger("sync",t,n,e)},this.isNew())return e.success(),!1;I(this,e);var s=this.sync("delete",this,e);return e.wait||a(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||O();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)
},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,n.extend(t,{validationError:i})),!1):!0}});var m=["keys","values","pairs","invert","pick","omit"];n.each(m,function(e){h.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var p=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},f={add:!0,remove:!0,merge:!0},g={add:!0,remove:!1};n.extend(p.prototype,r,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,g))},remove:function(e,t){var i=!n.isArray(e);e=i?[e]:n.clone(e),t||(t={});var a,s,o,r;for(a=0,s=e.length;s>a;a++)r=e[a]=this.get(e[a]),r&&(delete this._byId[r.id],delete this._byId[r.cid],o=this.indexOf(r),this.models.splice(o,1),this.length--,t.silent||(t.index=o,r.trigger("remove",r,this,t)),this._removeReference(r,t));return i?e[0]:e},set:function(e,t){t=n.defaults({},t,f),t.parse&&(e=this.parse(e,t));var i=!n.isArray(e);e=i?e?[e]:[]:n.clone(e);var a,s,o,r,l,c,d,u=t.at,m=this.model,p=this.comparator&&null==u&&t.sort!==!1,g=n.isString(this.comparator)?this.comparator:null,v=[],w=[],b={},x=t.add,y=t.merge,_=t.remove,k=!p&&x&&_?[]:!1;for(a=0,s=e.length;s>a;a++){if(l=e[a]||{},o=l instanceof h?r=l:l[m.prototype.idAttribute||"id"],c=this.get(o))_&&(b[c.cid]=!0),y&&(l=l===r?r.attributes:l,t.parse&&(l=c.parse(l,t)),c.set(l,t),p&&!d&&c.hasChanged(g)&&(d=!0)),e[a]=c;else if(x){if(r=e[a]=this._prepareModel(l,t),!r)continue;v.push(r),this._addReference(r,t)}r=c||r,!k||!r.isNew()&&b[r.id]||k.push(r),b[r.id]=!0}if(_){for(a=0,s=this.length;s>a;++a)b[(r=this.models[a]).cid]||w.push(r);w.length&&this.remove(w,t)}if(v.length||k&&k.length)if(p&&(d=!0),this.length+=v.length,null!=u)for(a=0,s=v.length;s>a;a++)this.models.splice(u+a,0,v[a]);else{k&&(this.models.length=0);var C=k||v;for(a=0,s=C.length;s>a;a++)this.models.push(C[a])}if(d&&this.sort({silent:!0}),!t.silent){for(a=0,s=v.length;s>a;a++)(r=v[a]).trigger("add",r,this,t);(d||k&&k.length)&&this.trigger("sort",this,t)}return i?e[0]:e},reset:function(e,t){t||(t={});for(var i=0,a=this.models.length;a>i;i++)this._removeReference(this.models[i],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return o.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var a=e.reset?"reset":"set";i[a](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},I(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?n.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,a=t.success;return t.success=function(e,n){t.wait&&i.add(e,t),a&&a(e,n,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof h)return e;t=t?n.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_addReference:function(e){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(v,function(e){p.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var w=["groupBy","countBy","sortBy","indexBy"];n.each(w,function(e){p.prototype[e]=function(t,i){var a=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,a,i)}});var b=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,y)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},x=/^(\S+)\s*(.*)$/,y=["model","collection","el","id","attributes","className","tagName","events"];n.extend(b.prototype,r,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[e[t]]),i){var a=t.match(x),s=a[1],o=a[2];i=n.bind(i,this),s+=".delegateEvents"+this.cid,""===o?this.$el.on(s,i):this.$el.on(s,o,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var i=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,a){var s=k[e];n.defaults(a||(a={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};if(a.url||(o.url=n.result(i,"url")||O()),null!=a.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(a.attrs||i.toJSON(a))),a.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),a.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",a.emulateJSON&&(o.data._method=s);var r=a.beforeSend;a.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",s),r?r.apply(this,arguments):void 0}}"GET"===o.type||a.emulateJSON||(o.processData=!1),"PATCH"===o.type&&_&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=a.xhr=t.ajax(n.extend(o,a));return i.trigger("request",i,l,a),l};var _=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var C=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},T=/\((.*?)\)/g,S=/(\(\?)?:\w+/g,E=/\*\w+/g,F=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(C.prototype,r,{initialize:function(){},route:function(e,i,a){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(a=i,i=""),a||(a=this[i]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(a,o),s.trigger.apply(s,["route:"+i].concat(o)),s.trigger("route",i,o),t.history.trigger("route",s,i,o)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(F,"\\$&").replace(T,"(?:$1)?").replace(S,function(e,t){return t?e:"([^/?]+)"}).replace(E,"([^?]*?)"),RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e,t){return t===i.length-1?e||null:e?decodeURIComponent(e):null})}});var P=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},D=/^[#\/]|\s+$/g,M=/^\/+|\/+$/g,V=/msie [\w.]+/,A=/\/$/,R=/#.*$/;P.started=!1,n.extend(P.prototype,r,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(A,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(D,"")},start:function(e){if(P.started)throw Error("Backbone.history has already been started");P.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),a=document.documentMode,s=V.exec(navigator.userAgent.toLowerCase())&&(!a||7>=a);if(this.root=("/"+this.root+"/").replace(M,"/"),s&&this._wantsHashChange){var o=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(i)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var r=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&r.hash&&(this.fragment=this.getHash().replace(D,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),P.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!P.started)return!1;t&&t!==!0||(t={trigger:!!t});var n=this.root+(e=this.getFragment(e||""));if(e=e.replace(R,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new P;var N=function(e,t){var i,a=this;i=e&&n.has(e,"constructor")?e.constructor:function(){return a.apply(this,arguments)},n.extend(i,a,t);var s=function(){this.constructor=i};return s.prototype=a.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=a.prototype,i};h.extend=p.extend=C.extend=b.extend=P.extend=N;var O=function(){throw Error('A "url" property or function must be specified')},I=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}};return t}),function(e,t){if("function"==typeof define&&define.amd)define("backbone.wreqr",["backbone","underscore"],function(e,n){return t(e,n)});else if("undefined"!=typeof exports){var n=require("backbone"),i=require("underscore");module.exports=t(n,i)}else t(e.Backbone,e._)}(this,function(e,t){var n=e.Wreqr,i=e.Wreqr={};return e.Wreqr.VERSION="1.3.3",e.Wreqr.noConflict=function(){return e.Wreqr=n,this},i.Handlers=function(e,t){var n=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,n){var i=null;t.isObject(e)&&!t.isFunction(e)&&(i=e.context,e=e.callback),this.setHandler(n,e,i)},this)},setHandler:function(e,t,n){var i={callback:t,context:n};this._wreqrHandlers[e]=i,this.trigger("handler:add",e,t,n)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(t)return function(){return t.callback.apply(t.context,arguments)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(e,t),i.CommandStorage=function(){var n=function(e){this.options=e,this._commands={},t.isFunction(this.initialize)&&this.initialize(e)};return t.extend(n.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var n=this.getCommands(e);n.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),n}(),i.Commands=function(e,t){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this),e.Handlers.prototype.constructor.apply(this,arguments)},execute:function(e){e=arguments[0];var n=t.rest(arguments);this.hasHandler(e)?this.getHandler(e).apply(this,n):this.storage.addCommand(e,n)},_executeCommands:function(e,n,i){var a=this.storage.getCommands(e);t.each(a.instances,function(e){n.apply(i,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var n,i=e.storageType||this.storageType;n=t.isFunction(i)?new i:i,this.storage=n}})}(i,t),i.RequestResponse=function(e,t){return e.Handlers.extend({request:function(e){return this.hasHandler(e)?this.getHandler(e).apply(this,t.rest(arguments)):void 0}})}(i,t),i.EventAggregator=function(e,t){var n=function(){};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events),n}(e,t),i.Channel=function(){var n=function(t){this.vent=new e.Wreqr.EventAggregator,this.reqres=new e.Wreqr.RequestResponse,this.commands=new e.Wreqr.Commands,this.channelName=t};return t.extend(n.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(e,t){return this._connect("vent",e,t),this},connectCommands:function(e,t){return this._connect("commands",e,t),this},connectRequests:function(e,t){return this._connect("reqres",e,t),this},_connect:function(e,n,i){if(n){i=i||this;var a="vent"===e?"on":"setHandler";t.each(n,function(n,s){this[e][a](s,t.bind(n,i))},this)}}}),n}(i),i.radio=function(e,t){var n=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};t.extend(n.prototype,{channel:function(e){if(!e)throw Error("Channel must receive a name");return this._getChannel(e)},_getChannel:function(t){var n=this._channels[t];return n||(n=new e.Channel(t),this._channels[t]=n),n},_proxyMethods:function(){t.each(["vent","commands","reqres"],function(e){t.each(i[e],function(t){this[e][t]=a(this,e,t)},this)},this)}});var i={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},a=function(e,n,i){return function(a){var s=e._getChannel(a)[n];return s[i].apply(s,t.rest(arguments))}};return new n}(i,t),e.Wreqr}),function(e,t){if("function"==typeof define&&define.amd)define("backbone.babysitter",["backbone","underscore"],function(e,n){return t(e,n)});else if("undefined"!=typeof exports){var n=require("backbone"),i=require("underscore");module.exports=t(n,i)}else t(e.Backbone,e._)}(this,function(e,t){var n=e.ChildViewContainer;return e.ChildViewContainer=function(e,t){var n=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(n.prototype,{add:function(e,t){var n=e.cid;return this._views[n]=e,e.model&&(this._indexByModel[e.model.cid]=n),t&&(this._indexByCustom[t]=n),this._updateLength(),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var n=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){return e===n?(delete this._indexByCustom[t],!0):void 0},this),delete this._views[n],this._updateLength(),this},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,n){t.each(this._views,function(i){t.isFunction(i[e])&&i[e].apply(i,n||[])})},_updateLength:function(){this.length=t.size(this._views)}});var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return t.each(i,function(e){n.prototype[e]=function(){var n=t.values(this._views),i=[n].concat(t.toArray(arguments));return t[e].apply(t,i)}}),n}(e,t),e.ChildViewContainer.VERSION="0.1.8",e.ChildViewContainer.noConflict=function(){return e.ChildViewContainer=n,this},e.ChildViewContainer}),function(e,t){if("object"==typeof exports){var n=require("underscore"),i=require("backbone"),a=require("backbone.wreqr"),s=require("backbone.babysitter");module.exports=t(n,i,a,s)}else"function"==typeof define&&define.amd&&define("backbone-marionette",["underscore","backbone","backbone.wreqr","backbone.babysitter"],t)}(this,function(e,t){!function(e,t,n){function i(e,t){var n=Error(e);throw n.name=t||"Error",n}var a={};t.Marionette=a,a.$=t.$;var s=Array.prototype.slice;return a.extend=t.Model.extend,a.getOption=function(e,t){if(e&&t){var n;return n=e.options&&t in e.options&&void 0!==e.options[t]?e.options[t]:e[t]}},a.normalizeMethods=function(e){var t,i={};return n.each(e,function(e,a){t=e,n.isFunction(t)||(t=this[t]),t&&(i[a]=t)},this),i},a.normalizeUIKeys=function(e,t){return void 0!==e?(n.each(n.keys(e),function(n){var i=/@ui.[a-zA-Z_$0-9]*/g;n.match(i)&&(e[n.replace(i,function(e){return t[e.slice(4)]})]=e[n],delete e[n])}),e):void 0},a.triggerMethod=function(){function e(e,t,n){return n.toUpperCase()}var t=/(^|:)(\w)/gi,i=function(i){var a="on"+i.replace(t,e),s=this[a];return n.isFunction(this.trigger)&&this.trigger.apply(this,arguments),n.isFunction(s)?s.apply(this,n.tail(arguments)):void 0};return i}(),a.MonitorDOMRefresh=function(e){function t(e){e._isShown=!0,a(e)}function i(e){e._isRendered=!0,a(e)}function a(e){e._isShown&&e._isRendered&&s(e)&&n.isFunction(e.triggerMethod)&&e.triggerMethod("dom:refresh")}function s(t){return e.contains(t.el)}return function(e){e.listenTo(e,"show",function(){t(e)}),e.listenTo(e,"render",function(){i(e)})}}(document.documentElement),function(e){function t(e,t,a,s){var o=s.split(/\s+/);n.each(o,function(n){var s=e[n];s||i("Method '"+n+"' was configured as an event handler, but does not exist."),e.listenTo(t,a,s)})}function a(e,t,n,i){e.listenTo(t,n,i)}function s(e,t,i,a){var s=a.split(/\s+/);n.each(s,function(n){var a=e[n];e.stopListening(t,i,a)})}function o(e,t,n,i){e.stopListening(t,n,i)}function r(e,t,i,a,s){t&&i&&(n.isFunction(i)&&(i=i.call(e)),n.each(i,function(i,o){n.isFunction(i)?a(e,t,o,i):s(e,t,o,i)}))}e.bindEntityEvents=function(e,n,i){r(e,n,i,a,t)},e.unbindEntityEvents=function(e,t,n){r(e,t,n,o,s)}}(a),a.Callbacks=function(){this._deferred=a.$.Deferred(),this._callbacks=[]},n.extend(a.Callbacks.prototype,{add:function(e,t){this._callbacks.push({cb:e,ctx:t}),this._deferred.done(function(n,i){t&&(n=t),e.call(n,i)})},run:function(e,t){this._deferred.resolve(t,e)},reset:function(){var e=this._callbacks;this._deferred=a.$.Deferred(),this._callbacks=[],n.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),a.Controller=function(e){this.triggerMethod=a.triggerMethod,this.options=e||{},n.isFunction(this.initialize)&&this.initialize(this.options)},a.Controller.extend=a.extend,n.extend(a.Controller.prototype,t.Events,{close:function(){this.stopListening();var e=Array.prototype.slice.call(arguments);this.triggerMethod.apply(this,["close"].concat(e)),this.unbind()}}),a.Region=function(e){if(this.options=e||{},this.el=a.getOption(this,"el"),this.el||i("An 'el' must be specified for a region.","NoElError"),this.initialize){var t=Array.prototype.slice.apply(arguments);this.initialize.apply(this,t)}},n.extend(a.Region,{buildRegion:function(e,t){var a=n.isString(e),s=n.isString(e.selector),o=n.isUndefined(e.regionType),r=n.isFunction(e);r||a||s||i("Region must be specified as a Region type, a selector string or an object with selector property");var l,c;a&&(l=e),e.selector&&(l=e.selector,delete e.selector),r&&(c=e),!r&&o&&(c=t),e.regionType&&(c=e.regionType,delete e.regionType),(a||r)&&(e={}),e.el=l;var d=new c(e);return e.parentEl&&(d.getEl=function(t){var i=e.parentEl;return n.isFunction(i)&&(i=i()),i.find(t)}),d}}),n.extend(a.Region.prototype,t.Events,{show:function(e){this.ensureEl();var t=e.isClosed||n.isUndefined(e.$el),i=e!==this.currentView;i&&this.close(),e.render(),a.triggerMethod.call(this,"before:show",e),a.triggerMethod.call(e,"before:show"),(i||t)&&this.open(e),this.currentView=e,a.triggerMethod.call(this,"show",e),a.triggerMethod.call(e,"show")},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(e){return a.$(e)},open:function(e){this.$el.empty().append(e.el)},close:function(){var e=this.currentView;e&&!e.isClosed&&(e.close?e.close():e.remove&&e.remove(),a.triggerMethod.call(this,"close",e),delete this.currentView)},attachView:function(e){this.currentView=e},reset:function(){this.close(),delete this.$el}}),a.Region.extend=a.extend,a.RegionManager=function(e){var t=e.Controller.extend({constructor:function(t){this._regions={},e.Controller.prototype.constructor.call(this,t)},addRegions:function(e,t){var i={};return n.each(e,function(e,a){n.isString(e)&&(e={selector:e}),e.selector&&(e=n.defaults({},e,t));var s=this.addRegion(a,e);i[a]=s},this),i},addRegion:function(t,i){var a,s=n.isObject(i),o=n.isString(i),r=!!i.selector;return a=o||s&&r?e.Region.buildRegion(i,e.Region):n.isFunction(i)?e.Region.buildRegion(i,e.Region):i,this._store(t,a),this.triggerMethod("region:add",t,a),a},get:function(e){return this._regions[e]},removeRegion:function(e){var t=this._regions[e];this._remove(e,t)},removeRegions:function(){n.each(this._regions,function(e,t){this._remove(t,e)},this)},closeRegions:function(){n.each(this._regions,function(e){e.close()},this)},close:function(){this.removeRegions(),e.Controller.prototype.close.apply(this,arguments)},_store:function(e,t){this._regions[e]=t,this._setLength()},_remove:function(e,t){t.close(),delete this._regions[e],this._setLength(),this.triggerMethod("region:remove",e,t)},_setLength:function(){this.length=n.size(this._regions)}}),i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return n.each(i,function(e){t.prototype[e]=function(){var t=n.values(this._regions),i=[t].concat(n.toArray(arguments));return n[e].apply(n,i)}}),t}(a),a.TemplateCache=function(e){this.templateId=e},n.extend(a.TemplateCache,{templateCaches:{},get:function(e){var t=this.templateCaches[e];return t||(t=new a.TemplateCache(e),this.templateCaches[e]=t),t.load()},clear:function(){var e,t=s.call(arguments),n=t.length;if(n>0)for(e=0;n>e;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),n.extend(a.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var e=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(e)},loadTemplate:function(e){var t=a.$(e).html();return t&&0!==t.length||i("Could not find template: '"+e+"'","NoTemplateError"),t},compileTemplate:function(e){return n.template(e)}}),a.Renderer={render:function(e,t){e||i("Cannot render the template since it's false, null or undefined.","TemplateNotFoundError");var n;return(n="function"==typeof e?e:a.TemplateCache.get(e))(t)}},a.View=t.View.extend({constructor:function(e){n.bindAll(this,"render"),n.isObject(this.behaviors)&&new a.Behaviors(this),this.options=n.extend({},n.result(this,"options"),n.isFunction(e)?e.call(this):e),this.events=this.normalizeUIKeys(n.result(this,"events")),t.View.prototype.constructor.apply(this,arguments),a.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled)},triggerMethod:a.triggerMethod,normalizeMethods:a.normalizeMethods,getTemplate:function(){return a.getOption(this,"template")},mixinTemplateHelpers:function(e){e=e||{};var t=a.getOption(this,"templateHelpers");return n.isFunction(t)&&(t=t.call(this)),n.extend(e,t)},normalizeUIKeys:function(e){var t=n.result(this,"ui");return a.normalizeUIKeys(e,t)},configureTriggers:function(){if(this.triggers){var e={},t=this.normalizeUIKeys(n.result(this,"triggers"));return n.each(t,function(t,i){var a=n.isObject(t),s=a?t.event:t;e[i]=function(e){if(e){var n=e.preventDefault,i=e.stopPropagation,o=a?t.preventDefault:n,r=a?t.stopPropagation:i;o&&n&&n.apply(e),r&&i&&i.apply(e)}var l={view:this,model:this.model,collection:this.collection};this.triggerMethod(s,l)}},this),e}},delegateEvents:function(e){this._delegateDOMEvents(e),a.bindEntityEvents(this,this.model,a.getOption(this,"modelEvents")),a.bindEntityEvents(this,this.collection,a.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(e){e=e||this.events,n.isFunction(e)&&(e=e.call(this));var i={},a=n.result(this,"behaviorEvents")||{},s=this.configureTriggers();n.extend(i,a,e,s),t.View.prototype.delegateEvents.call(this,i)},undelegateEvents:function(){var e=Array.prototype.slice.call(arguments);t.View.prototype.undelegateEvents.apply(this,e),a.unbindEntityEvents(this,this.model,a.getOption(this,"modelEvents")),a.unbindEntityEvents(this,this.collection,a.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(!this.isClosed){var e=Array.prototype.slice.call(arguments),t=this.triggerMethod.apply(this,["before:close"].concat(e));t!==!1&&(this.isClosed=!0,this.triggerMethod.apply(this,["close"].concat(e)),this.unbindUIElements(),this.remove())}},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var e=n.result(this,"_uiBindings");this.ui={},n.each(n.keys(e),function(t){var n=e[t];this.ui[t]=this.$(n)},this)}},unbindUIElements:function(){this.ui&&this._uiBindings&&(n.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings)}}),a.ItemView=a.View.extend({constructor:function(){a.View.prototype.constructor.apply(this,arguments)},serializeData:function(){var e={};return this.model?e=this.model.toJSON():this.collection&&(e={items:this.collection.toJSON()}),e},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var e=this.serializeData();e=this.mixinTemplateHelpers(e);var t=this.getTemplate(),n=a.Renderer.render(t,e);return this.$el.html(n),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){this.isClosed||(this.triggerMethod("item:before:close"),a.View.prototype.close.apply(this,arguments),this.triggerMethod("item:closed"))}}),a.CollectionView=a.View.extend({itemViewEventPrefix:"itemview",constructor:function(){this._initChildViewStorage(),a.View.prototype.constructor.apply(this,arguments),this._initialEvents(),this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment(),this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.isBuffering=!1,this.appendBuffer(this,this.elBuffer),this._triggerShowBufferedChildren(),this.initRenderBuffer()},_triggerShowBufferedChildren:function(){this._isShown&&(n.each(this._bufferedChildren,function(e){a.triggerMethod.call(e,"show")}),this._bufferedChildren=[])},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView),this.listenTo(this.collection,"remove",this.removeItemView),this.listenTo(this.collection,"reset",this.render))},addChildView:function(e){this.closeEmptyView();var t=this.getItemView(e),n=this.collection.indexOf(e);this.addItemView(e,t,n)},onShowCalled:function(){this.children.each(function(e){a.triggerMethod.call(e,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this._renderChildren(),this.triggerRendered(),this},_renderChildren:function(){this.startBuffering(),this.closeEmptyView(),this.closeChildren(),this.isEmpty(this.collection)?this.showEmptyView():this.showCollection(),this.endBuffering()},showCollection:function(){var e;this.collection.each(function(t,n){e=this.getItemView(t),this.addItemView(t,e,n)},this)},showEmptyView:function(){var e=this.getEmptyView();if(e&&!this._showingEmptyView){this._showingEmptyView=!0;var n=new t.Model;this.addItemView(n,e,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getEmptyView:function(){return a.getOption(this,"emptyView")},getItemView:function(){var e=a.getOption(this,"itemView");return e||i("An `itemView` must be specified","NoItemViewError"),e},addItemView:function(e,t,i){var s=a.getOption(this,"itemViewOptions");n.isFunction(s)&&(s=s.call(this,e,i));var o=this.buildItemView(e,t,s);return this.addChildViewEventForwarding(o),this.triggerMethod("before:item:added",o),this.children.add(o),this.renderItemView(o,i),this._isShown&&!this.isBuffering&&a.triggerMethod.call(o,"show"),this.triggerMethod("after:item:added",o),o
},addChildViewEventForwarding:function(e){var t=a.getOption(this,"itemViewEventPrefix");this.listenTo(e,"all",function(){var i=s.call(arguments),o=i[0],r=this.normalizeMethods(this.getItemEvents());i[0]=t+":"+o,i.splice(1,0,e),void 0!==r&&n.isFunction(r[o])&&r[o].apply(this,i),a.triggerMethod.apply(this,i)},this)},getItemEvents:function(){return n.isFunction(this.itemEvents)?this.itemEvents.call(this):this.itemEvents},renderItemView:function(e,t){e.render(),this.appendHtml(this,e,t)},buildItemView:function(e,t,i){var a=n.extend({model:e},i);return new t(a)},removeItemView:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},removeChildView:function(e){e&&(this.stopListening(e),e.close?e.close():e.remove&&e.remove(),this.children.remove(e)),this.triggerMethod("item:removed",e)},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},appendBuffer:function(e,t){e.$el.append(t)},appendHtml:function(e,t){e.isBuffering?(e.elBuffer.appendChild(t.el),e._bufferedChildren.push(t)):e.$el.append(t.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},close:function(){this.isClosed||(this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed"),a.View.prototype.close.apply(this,arguments))},closeChildren:function(){this.children.each(function(e){this.removeChildView(e)},this),this.checkEmpty()}}),a.CompositeView=a.CollectionView.extend({constructor:function(){a.CollectionView.prototype.constructor.apply(this,arguments)},_initialEvents:function(){this.once("render",function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView),this.listenTo(this.collection,"remove",this.removeItemView),this.listenTo(this.collection,"reset",this._renderChildren))})},getItemView:function(){var e=a.getOption(this,"itemView")||this.constructor;return e||i("An `itemView` must be specified","NoItemViewError"),e},serializeData:function(){var e={};return this.model&&(e=this.model.toJSON()),e},render:function(){this.isRendered=!0,this.isClosed=!1,this.resetItemViewContainer(),this.triggerBeforeRender();var e=this.renderModel();return this.$el.html(e),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this._renderChildren(),this.triggerMethod("composite:rendered"),this.triggerRendered(),this},_renderChildren:function(){this.isRendered&&(this.triggerMethod("composite:collection:before:render"),a.CollectionView.prototype._renderChildren.call(this),this.triggerMethod("composite:collection:rendered"))},renderModel:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e);var t=this.getTemplate();return a.Renderer.render(t,e)},appendBuffer:function(e,t){var n=this.getItemViewContainer(e);n.append(t)},appendHtml:function(e,t){if(e.isBuffering)e.elBuffer.appendChild(t.el),e._bufferedChildren.push(t);else{var n=this.getItemViewContainer(e);n.append(t.el)}},getItemViewContainer:function(e){if("$itemViewContainer"in e)return e.$itemViewContainer;var t,s=a.getOption(e,"itemViewContainer");if(s){var o=n.isFunction(s)?s.call(this):s;t=e.$(o),0>=t.length&&i("The specified `itemViewContainer` was not found: "+e.itemViewContainer,"ItemViewContainerMissingError")}else t=e.$el;return e.$itemViewContainer=t,t},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),a.Layout=a.ItemView.extend({regionType:a.Region,constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),a.ItemView.prototype.constructor.call(this,e)},render:function(){return this.isClosed&&this._initializeRegions(),this._firstRender?this._firstRender=!1:this.isClosed||this._reInitializeRegions(),a.ItemView.prototype.render.apply(this,arguments)},close:function(){this.isClosed||(this.regionManager.close(),a.ItemView.prototype.close.apply(this,arguments))},addRegion:function(e,t){var n={};return n[e]=t,this._buildRegions(n)[e]},addRegions:function(e){return this.regions=n.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},_buildRegions:function(e){var t=this,n={regionType:a.getOption(this,"regionType"),parentEl:function(){return t.$el}};return this.regionManager.addRegions(e,n)},_initializeRegions:function(e){var t;this._initRegionManager(),t=n.isFunction(this.regions)?this.regions(e):this.regions||{},this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.closeRegions(),this.regionManager.each(function(e){e.reset()})},_initRegionManager:function(){this.regionManager=new a.RegionManager,this.listenTo(this.regionManager,"region:add",function(e,t){this[e]=t,this.trigger("region:add",e,t)}),this.listenTo(this.regionManager,"region:remove",function(e,t){delete this[e],this.trigger("region:remove",e,t)})}}),a.Behavior=function(e,t){function n(t,n){this.view=n,this.defaults=e.result(this,"defaults")||{},this.options=e.extend({},this.defaults,t),this.$=function(){return this.view.$.apply(this.view,arguments)},this.initialize.apply(this,arguments)}return e.extend(n.prototype,{initialize:function(){},triggerMethod:a.triggerMethod}),e.extend(n,{extend:t.View.extend}),n}(n,t),a.Behaviors=function(e,t){function n(e){this.behaviors=n.parseBehaviors(e,e.behaviors),n.wrap(e,this.behaviors,["bindUIElements","unbindUIElements","delegateEvents","undelegateEvents","onShow","onClose","behaviorEvents","triggerMethod","setElement"])}var i={setElement:function(e,n){e.apply(this,t.tail(arguments,2)),t.each(n,function(e){e.$el=this.$el},this)},onShow:function(n,i){var a=t.tail(arguments,2);t.each(i,function(t){e.triggerMethod.apply(t,["show"].concat(a))}),t.isFunction(n)&&n.apply(this,a)},onClose:function(n,i){var a=t.tail(arguments,2);t.each(i,function(t){e.triggerMethod.apply(t,["close"].concat(a))}),t.isFunction(n)&&n.apply(this,a)},bindUIElements:function(e,n){e.apply(this),t.invoke(n,e)},unbindUIElements:function(e,n){e.apply(this),t.invoke(n,e)},triggerMethod:function(e,n){var i=t.tail(arguments,2);e.apply(this,i),t.each(n,function(t){e.apply(t,i)})},delegateEvents:function(n,i){var a=t.tail(arguments,2);n.apply(this,a),t.each(i,function(t){e.bindEntityEvents(this,this.model,e.getOption(t,"modelEvents")),e.bindEntityEvents(this,this.collection,e.getOption(t,"collectionEvents"))},this)},undelegateEvents:function(n,i){var a=t.tail(arguments,2);n.apply(this,a),t.each(i,function(t){e.unbindEntityEvents(this,this.model,e.getOption(t,"modelEvents")),e.unbindEntityEvents(this,this.collection,e.getOption(t,"collectionEvents"))},this)},behaviorEvents:function(n,i){var a={},s=t.result(this,"ui");return t.each(i,function(n,i){var o={},r=t.result(n,"events")||{},l=t.result(n,"ui"),c=t.extend({},s,l);r=e.normalizeUIKeys(r,c),t.each(t.keys(r),function(e){var a=Array(i+2).join(" "),s=e+a,l=t.isFunction(r[e])?r[e]:n[r[e]];o[s]=t.bind(l,n)}),a=t.extend(a,o)}),a}};return t.extend(n,{behaviorsLookup:function(){throw Error("You must define where your behaviors are stored. See https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.behaviors.md#behaviorslookup")},getBehaviorClass:function(e,i){return e.behaviorClass?e.behaviorClass:t.isFunction(n.behaviorsLookup)?n.behaviorsLookup.apply(this,arguments)[i]:n.behaviorsLookup[i]},parseBehaviors:function(e,i){return t.map(i,function(t,i){var a=n.getBehaviorClass(t,i);return new a(t,e)})},wrap:function(e,n,a){t.each(a,function(a){e[a]=t.partial(i[a],e[a],n)})}}),n}(a,n),a.AppRouter=t.Router.extend({constructor:function(e){t.Router.prototype.constructor.apply(this,arguments),this.options=e||{};var n=a.getOption(this,"appRoutes"),i=this._getController();this.processAppRoutes(i,n)},appRoute:function(e,t){var n=this._getController();this._addAppRoute(n,e,t)},processAppRoutes:function(e,t){if(t){var i=n.keys(t).reverse();n.each(i,function(n){this._addAppRoute(e,n,t[n])},this)}},_getController:function(){return a.getOption(this,"controller")},_addAppRoute:function(e,t,a){var s=e[a];s||i("Method '"+a+"' was not found on the controller"),this.route(t,a,n.bind(s,e))}}),a.Application=function(e){this._initRegionManager(),this._initCallbacks=new a.Callbacks,this.vent=new t.Wreqr.EventAggregator,this.commands=new t.Wreqr.Commands,this.reqres=new t.Wreqr.RequestResponse,this.submodules={},n.extend(this,e),this.triggerMethod=a.triggerMethod},n.extend(a.Application.prototype,t.Events,{execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("initialize:before",e),this._initCallbacks.run(e,this),this.triggerMethod("initialize:after",e),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(e){this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},module:function(e,t){var n=a.Module.getClass(t),i=s.call(arguments);return i.unshift(this),n.create.apply(n,i)},_initRegionManager:function(){this._regionManager=new a.RegionManager,this.listenTo(this._regionManager,"region:add",function(e,t){this[e]=t}),this.listenTo(this._regionManager,"region:remove",function(e){delete this[e]})}}),a.Application.extend=a.extend,a.Module=function(e,t,i){this.moduleName=e,this.options=n.extend({},this.options,i),this.initialize=i.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,this.startWithParent=!0,this.triggerMethod=a.triggerMethod,n.isFunction(this.initialize)&&this.initialize(this.options,e,t)},a.Module.extend=a.extend,n.extend(a.Module.prototype,t.Events,{initialize:function(){},addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){this._isInitialized||(n.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e))},stop:function(){this._isInitialized&&(this._isInitialized=!1,a.triggerMethod.call(this,"before:stop"),n.each(this.submodules,function(e){e.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),a.triggerMethod.call(this,"stop"))},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,i){if(e){var s=n.flatten([this,this.app,t,a,a.$,n,i]);e.apply(this,s)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new a.Callbacks,this._finalizerCallbacks=new a.Callbacks}}),n.extend(a.Module,{create:function(e,t,i){var a=e,o=s.call(arguments);o.splice(0,3),t=t.split(".");var r=t.length,l=[];return l[r-1]=i,n.each(t,function(t,n){var s=a;a=this._getModule(s,t,e,i),this._addModuleDefinition(s,a,l[n],o)},this),a},_getModule:function(e,t,i,a){var s=n.extend({},a),o=this.getClass(a),r=e[t];return r||(r=new o(t,i,s),e[t]=r,e.submodules[t]=r),r},getClass:function(e){var t=a.Module;return e?e.prototype instanceof t?e:e.moduleClass||t:t},_addModuleDefinition:function(e,t,n,i){var a=this._getDefine(n),s=this._getStartWithParent(n,t);a&&t.addDefinition(a,i),this._addStartWithParent(e,t,s)},_getStartWithParent:function(e,t){var i;return n.isFunction(e)&&e.prototype instanceof a.Module?(i=t.constructor.prototype.startWithParent,n.isUndefined(i)?!0:i):n.isObject(e)?(i=e.startWithParent,n.isUndefined(i)?!0:i):!0},_getDefine:function(e){return!n.isFunction(e)||e.prototype instanceof a.Module?n.isObject(e)?e.define:null:e},_addStartWithParent:function(e,t,n){t.startWithParent=t.startWithParent&&n,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)}))}}),a}(this,t,e);return t.Marionette}),function(e,t){"function"==typeof define&&define.amd?define("handlebars",[],t):"object"==typeof exports?module.exports=t():e.Handlebars=e.Handlebars||t()}(this,function(){var e=function(){function e(e){this.string=e}var t;return e.prototype.toString=function(){return""+this.string},t=e}(),t=function(e){function t(e){return l[e]}function n(e){for(var t=1;arguments.length>t;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}function i(e){return e instanceof r?""+e:null==e?"":e?(e=""+e,d.test(e)?e.replace(c,t):e):e+""}function a(e){return e||0===e?m(e)&&0===e.length?!0:!1:!0}function s(e,t){return(e?e+".":"")+t}var o={},r=e,l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},c=/[&<>"'`]/g,d=/[&<>"'`]/;o.extend=n;var u=Object.prototype.toString;o.toString=u;var h=function(e){return"function"==typeof e};h(/x/)&&(h=function(e){return"function"==typeof e&&"[object Function]"===u.call(e)});var h;o.isFunction=h;var m=Array.isArray||function(e){return e&&"object"==typeof e?"[object Array]"===u.call(e):!1};return o.isArray=m,o.escapeExpression=i,o.isEmpty=a,o.appendContextPath=s,o}(e),n=function(){function e(e,t){var i;t&&t.firstLine&&(i=t.firstLine,e+=" - "+i+":"+t.firstColumn);for(var a=Error.prototype.constructor.call(this,e),s=0;n.length>s;s++)this[n[s]]=a[n[s]];i&&(this.lineNumber=i,this.column=t.firstColumn)}var t,n=["description","fileName","lineNumber","message","name","number","stack"];return e.prototype=Error(),t=e}(),i=function(e,t){function n(e,t){this.helpers=e||{},this.partials=t||{},i(this)}function i(e){e.registerHelper("helperMissing",function(){if(1===arguments.length)return void 0;throw new o("Missing helper: '"+arguments[arguments.length-1].name+"'")}),e.registerHelper("blockHelperMissing",function(t,n){var i=n.inverse,a=n.fn;if(t===!0)return a(this);if(t===!1||null==t)return i(this);if(d(t))return t.length>0?(n.ids&&(n.ids=[n.name]),e.helpers.each(t,n)):i(this);if(n.data&&n.ids){var o=g(n.data);o.contextPath=s.appendContextPath(n.data.contextPath,n.name),n={data:o}}return a(t,n)}),e.registerHelper("each",function(e,t){if(!t)throw new o("Must pass iterator to #each");var n,i,a=t.fn,r=t.inverse,l=0,c="";if(t.data&&t.ids&&(i=s.appendContextPath(t.data.contextPath,t.ids[0])+"."),u(e)&&(e=e.call(this)),t.data&&(n=g(t.data)),e&&"object"==typeof e)if(d(e))for(var h=e.length;h>l;l++)n&&(n.index=l,n.first=0===l,n.last=l===e.length-1,i&&(n.contextPath=i+l)),c+=a(e[l],{data:n});else for(var m in e)e.hasOwnProperty(m)&&(n&&(n.key=m,n.index=l,n.first=0===l,i&&(n.contextPath=i+m)),c+=a(e[m],{data:n}),l++);return 0===l&&(c=r(this)),c}),e.registerHelper("if",function(e,t){return u(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||s.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),e.registerHelper("with",function(e,t){u(e)&&(e=e.call(this));var n=t.fn;if(s.isEmpty(e))return t.inverse(this);if(t.data&&t.ids){var i=g(t.data);i.contextPath=s.appendContextPath(t.data.contextPath,t.ids[0]),t={data:i}}return n(e,t)}),e.registerHelper("log",function(t,n){var i=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;e.log(i,t)}),e.registerHelper("lookup",function(e,t){return e&&e[t]})}var a={},s=e,o=t,r="2.0.0";a.VERSION=r;var l=6;a.COMPILER_REVISION=l;var c={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};a.REVISION_CHANGES=c;var d=s.isArray,u=s.isFunction,h=s.toString,m="[object Object]";a.HandlebarsEnvironment=n,n.prototype={constructor:n,logger:p,log:f,registerHelper:function(e,t){if(h.call(e)===m){if(t)throw new o("Arg not supported with multiple helpers");s.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){h.call(e)===m?s.extend(this.partials,e):this.partials[e]=t},unregisterPartial:function(e){delete this.partials[e]}};var p={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){if(e>=p.level){var n=p.methodMap[e];"undefined"!=typeof console&&console[n]&&console[n].call(console,t)}}};a.logger=p;var f=p.log;a.log=f;var g=function(e){var t=s.extend({},e);return t._parent=e,t};return a.createFrame=g,a}(t,n),a=function(e,t,n){function i(e){var t=e&&e[0]||1,n=h;if(t!==n){if(n>t){var i=m[n],a=m[t];throw new u("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+i+") or downgrade your runtime to an older version ("+a+").")}throw new u("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function a(e,t){if(!t)throw new u("No environment passed to template");if(!e||!e.main)throw new u("Unknown template object: "+typeof e);t.VM.checkRevision(e.compiler);var n=function(n,i,a,s,o,r,l,c,h){o&&(s=d.extend({},s,o));var m=t.VM.invokePartial.call(this,n,a,s,r,l,c,h);if(null==m&&t.compile){var p={helpers:r,partials:l,data:c,depths:h};l[a]=t.compile(n,{data:void 0!==c,compat:e.compat},t),m=l[a](s,p)}if(null!=m){if(i){for(var f=m.split("\n"),g=0,v=f.length;v>g&&(f[g]||g+1!==v);g++)f[g]=i+f[g];m=f.join("\n")}return m}throw new u("The partial "+a+" could not be compiled when running in runtime-only mode")},i={lookup:function(e,t){for(var n=e.length,i=0;n>i;i++)if(e[i]&&null!=e[i][t])return e[i][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:d.escapeExpression,invokePartial:n,fn:function(t){return e[t]},programs:[],program:function(e,t,n){var i=this.programs[e],a=this.fn(e);return t||n?i=s(this,e,a,t,n):i||(i=this.programs[e]=s(this,e,a)),i},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=d.extend({},t,e)),n},noop:t.VM.noop,compilerInfo:e.compiler},a=function(t,n){n=n||{};var s=n.data;a._setup(n),!n.partial&&e.useData&&(s=l(t,s));var o;return e.useDepths&&(o=n.depths?[t].concat(n.depths):[t]),e.main.call(i,t,i.helpers,i.partials,s,o)};return a.isTop=!0,a._setup=function(n){n.partial?(i.helpers=n.helpers,i.partials=n.partials):(i.helpers=i.merge(n.helpers,t.helpers),e.usePartial&&(i.partials=i.merge(n.partials,t.partials)))},a._child=function(t,n,a){if(e.useDepths&&!a)throw new u("must pass parent depths");return s(i,t,e[t],n,a)},a}function s(e,t,n,i,a){var s=function(t,s){return s=s||{},n.call(e,t,e.helpers,e.partials,s.data||i,a&&[t].concat(a))};return s.program=t,s.depth=a?a.length:0,s}function o(e,t,n,i,a,s,o){var r={partial:!0,helpers:i,partials:a,data:s,depths:o};if(void 0===e)throw new u("The partial "+t+" could not be found");return e instanceof Function?e(n,r):void 0}function r(){return""}function l(e,t){return t&&"root"in t||(t=t?p(t):{},t.root=e),t}var c={},d=e,u=t,h=n.COMPILER_REVISION,m=n.REVISION_CHANGES,p=n.createFrame;return c.checkRevision=i,c.template=a,c.program=s,c.invokePartial=o,c.noop=r,c}(t,n,i),s=function(e,t,n,i,a){var s,o=e,r=t,l=n,c=i,d=a,u=function(){var e=new o.HandlebarsEnvironment;return c.extend(e,o),e.SafeString=r,e.Exception=l,e.Utils=c,e.escapeExpression=c.escapeExpression,e.VM=d,e.template=function(t){return d.template(t,e)},e},h=u();return h.create=u,h["default"]=h,s=h}(i,e,n,t,a);return s}),define("handlebars.partials",["handlebars"],function(e){e.registerPartial("activityFooterDefaultActions",e.template({1:function(){return'<span class="icon-lock icon-tiny spacing-right-small"></span>\n'},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"1 Comment",{name:"gettext",hash:{},data:i}))+"\n"},5:function(e,t,n,i){var a,s=this.escapeExpression;return s(t.gettext.call(e,"%(countOf)s Comments",{name:"gettext",hash:{countOf:null!=(a=null!=e?e.thread:e)?a.posts:a},data:i}))+"\n"},7:function(e,t,n,i){var a,s='<li class="action">\n';return a=t["if"].call(e,null!=e?e.favorited:e,{name:"if",hash:{},fn:this.program(8,i),inverse:this.program(10,i),data:i}),null!=a&&(s+=a),s+"</li>\n"},8:function(e,t,n,i){var a=this.escapeExpression;return'<a class="action-favorite active" href="#" data-action="favorite">'+a(t.gettext.call(e,"Recommended",{name:"gettext",hash:{},data:i}))+' <span class="icon icon-heart"></span></a>\n'},10:function(e,t,n,i){var a=this.escapeExpression;return'<a class="action-favorite" href="#" data-action="favorite">'+a(t.gettext.call(e,"Recommend",{name:"gettext",hash:{},data:i}))+' <span class="icon icon-heart"></span></a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<li class="action">\n<a class="action-comments"\nhref="'+o(s(null!=e?e.discussionRoute:e,e))+'"\ndata-link-name="comment_count"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n';return a=t["if"].call(e,null!=(a=null!=e?e.thread:e)?a.isClosed:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+="\n",a=t["if"].call(e,t.eq.call(e,null!=(a=null!=e?e.thread:e)?a.posts:a,1,{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(3,i),inverse:this.program(5,i),data:i}),null!=a&&(r+=a),r+='<span class="icon icon-comment"></span>\n</a>\n</li>\n',a=t["if"].call(e,null!=e?e.authenticated:e,{name:"if",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r},useData:!0})),e.registerPartial("boostTimeRemaining",e.template({1:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Boost ends in %(relativeTime)s",{name:"gettext",hash:{relativeTime:t.getPartial.call(e,"timeSelector",{name:"getPartial",hash:{},data:i})},data:i}))+"\n"},3:function(e,t,n,i){var a=this.escapeExpression;return'<span data-action="choose-boost-time" class="link">\n'+a(t.gettext.call(e,"Boost ends %(relativeTime)s",{name:"gettext",hash:{relativeTime:null!=e?e.boostTimeRemaining:e},data:i}))+"\n</span>\n"},5:function(e,t,n,i){var a=this.escapeExpression;return'<span title="Remove Boost" class="link pull-right" data-action="unboost">\n<span class="icon icon-arrow"></span>\n'+a(t.gettext.call(e,"Remove Boost",{name:"gettext",hash:{},data:i}))+"\n</span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<span class="icon icon-megaphone"></span>\n';return a=t["if"].call(e,null!=e?e.showBoostTimeSelector:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),a=t["if"].call(e,null!=e?e.showUnboost:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},useData:!0})),e.registerPartial("cardContentImage",e.template({1:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<a href="'+i(n(null!=(t=null!=e?e.thread:e)?t.link:t,e))+'"\nclass="card-content__media"\ndata-link-name="image"\ndata-link-out="'+i(n(null!=(t=null!=e?e.thread:e)?t.signedLink:t,e))+'"\ndata-thread-id="'+i(n(null!=(t=null!=e?e.thread:e)?t.id:t,e))+'">\n<div style="background-image: url('+i(n(null!=(t=null!=e?e.image:e)?t.src:t,e))+')" class="img-cards"></div>\n</a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},useData:!0})),e.registerPartial("cardReasonDisqusPicks",e.template({1:function(e,t,n,i){var a=this.escapeExpression,s=this.lambda;return'<div class="card__reason link-gray-dark">\n<span class="icon-heart icon__position -inline text-smaller text-gray-light"></span>\n'+a(t.gettext.call(e,"%(disqusTeamLink)s recommended",{name:"gettext",hash:{disqusTeamLink:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"%(disqus)s Team",{name:"gettext",hash:{disqus:"Disqus"},data:i}),"class":"text-semibold","data-channel-slug":"disquspicks","data-link-name":"forum_name",href:"/home/channel/disquspicks/"},data:i})},data:i}))+'\n\n<time class="bullet text-gray">'+a(s(null!=e?e.relativeTime:e,e))+"</time>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.isBestOfDisqus:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},useData:!0})),e.registerPartial("cardReasonForum",e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a class="spacing-right align__item"\nhref="/home/channel/'+o(s(null!=(a=null!=e?e.channel:e)?a.slug:a,e))+'/"\ndata-link-name="forum_avatar"\ndata-forum-pk="'+o(s(null!=e?e.pk:e,e))+'">\n';return a=t["if"].call(e,null!=e?e.channelAvatar:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.program(4,i),data:i}),null!=a&&(r+=a),r+"</a>\n"},2:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<img class="img-round-sm img-block" src="'+o(s(null!=e?e.channelAvatar:e,e))+'" alt="';return a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+'">\n'},4:function(e){var t=this.lambda,n=this.escapeExpression;return'<div class="channel-avatar '+n(t(null!=e?e.bannerColorClass:e,e))+'">\n<p class="channel-avatar__name">'+n(t(null!=e?e.channelInitial:e,e))+"</p>\n</div>\n"},6:function(e,t,n,i){var a,s="";return a=t["with"].call(e,null!=(a=null!=e?e.thread:e)?a.forum:a,{name:"with",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},7:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a class="spacing-right align__item"\nhref="/home/forum/'+o(s(null!=e?e.id:e,e))+'/"\ndata-link-name="forum_avatar"\ndata-forum-pk="'+o(s(null!=e?e.pk:e,e))+'">\n<img src="'+o(s(null!=e?e.faviconImage:e,e))+'" alt="';return a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+'" class="img-round-sm img-block" />\n</a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="card__reason align align--middle">\n';return a=t["if"].call(e,null!=e?e.channel:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(6,i),data:i}),null!=a&&(r+=a),r+='<div class="align__item">\n<strong>',a=this.invokePartial(n.forumLink,"","forumLink",null!=(a=null!=e?e.thread:e)?a.forum:a,void 0,t,n,i),null!=a&&(r+=a),r+'</strong>\n<time class="bullet text-gray">'+o(s(null!=e?e.threadCreated:e,e))+"</time>\n</div>\n</div>\n"},usePartial:!0,useData:!0})),e.registerPartial("cardTitle",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="card-title">\n<h2 class="discussion-title">\n<a href="'+o(s(null!=(a=null!=e?e.thread:e)?a.link:a,e))+'"\nclass="link-gray-darker"\ndata-role="thread-link"\ndata-link-out="'+o(s(null!=(a=null!=e?e.thread:e)?a.signedLink:a,e))+'"\ndata-link-name="title"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n\n'+o(s(null!=(a=null!=e?e.thread:e)?a.clean_title:a,e))+'\n</a>\n</h2>\non\n<a href="/home/'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.forumRoute:a,e))+'"\nclass="link-gray-darker discussion-community"\ndata-link-name="forum_name"\ndata-forum-pk="'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.pk:a,e))+'">\n\n';return a=this.invokePartial(n.forumName,"","forumName",null!=(a=null!=e?e.thread:e)?a.forum:a,void 0,t,n,i),null!=a&&(r+=a),r+"</a>\n</div>\n"},usePartial:!0,useData:!0})),e.registerPartial("cards",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return"cards here\n"},useData:!0})),e.registerPartial("channelAvatar",e.template({1:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<img class="favicon" src="'+i(n(null!=(t=null!=e?e.options:e)?t.favicon:t,e))+'" alt="'+i(n(null!=e?e.name:e,e))+'"/>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a class="discussion-origin-name" href="/home/channel/'+o(s(null!=e?e.slug:e,e))+'/">\n';return a=t["if"].call(e,null!=(a=null!=e?e.options:e)?a.favicon:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+"</a>\n"},useData:!0})),e.registerPartial("channelAvatarWithDefault",e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<img class="forum-favicon" src="'+o(s(null!=e?e.channelAvatar:e,e))+'" alt="';return a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+'">\n'},3:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.defaultChannelAvatar,"","defaultChannelAvatar",e,void 0,t,n,i),null!=a&&(s+=a),s},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.channelAvatar:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s},usePartial:!0,useData:!0})),e.registerPartial("channelAwareForumLink",e.template({1:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.channelLink,"","channelLink",null!=(a=null!=e?e.forum:e)?a.channelInfo:a,void 0,t,n,i),null!=a&&(s+=a),s},3:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.forumLink,"","forumLink",null!=e?e.forum:e,void 0,t,n,i),null!=a&&(s+=a),s},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=(a=null!=e?e.forum:e)?a.channelInfo:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s},usePartial:!0,useData:!0})),e.registerPartial("channelAwareForumName",e.template({1:function(e){var t,n=this.lambda,i=this.escapeExpression;return i(n(null!=(t=null!=e?e.channelInfo:e)?t.name:t,e))+"\n"},3:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(s+=a),s},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.channelInfo:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s},usePartial:!0,useData:!0})),e.registerPartial("channelCardContent",e.template({1:function(){return" has-image"},3:function(){return" hidden-md"},5:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.forumFriendlyUrl:e,{name:"if",hash:{},fn:this.program(6,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},6:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<p class="spacing-narrow text-smaller">\n<a href="'+i(n(null!=(t=null!=e?e.thread:e)?t.link:t,e))+'"\ndata-link-out="'+i(n(null!=(t=null!=e?e.thread:e)?t.signedLink:t,e))+'"\nclass="link-gray"\ndata-link-name="external_thread"\ndata-thread-id="'+i(n(null!=(t=null!=e?e.thread:e)?t.id:t,e))+'">\n\n<span class="icon icon-communities icon__position -inline icon-tiny"></span>\n'+i(n(null!=e?e.forumFriendlyUrl:e,e))+"\n</a>\n</p>\n"},8:function(){return'<div class="card__additional">\n<div class="card-comment-band" data-role="posts"></div>\n</div>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="card__content -default';return a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n',a=this.invokePartial(n.cardContentImage,"","cardContentImage",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="card-content__body">\n<div class="card-content__topics">\n<div data-role="topics"></div>\n</div>\n',a=this.invokePartial(n.threadTitle,"","threadTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="card-content__summary',a=t["if"].call(e,null!=e?e.recentPostCount:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="truncate" data-truncate-lines="3" dir="auto">\n'+o(s(null!=e?e.threadDescription:e,e))+"\n</div>\n</div>\n",a=t.unless.call(e,null!=e?e.channel:e,{name:"unless",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</div>\n</div>\n<div class="card__footer text-small" data-role="footer"></div>\n',a=t["if"].call(e,null!=e?e.recentPostCount:e,{name:"if",hash:{},fn:this.program(8,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r},usePartial:!0,useData:!0})),e.registerPartial("channelCardMenu",e.template({1:function(){return" open"
},3:function(e,t,n,i){var a,s=this.escapeExpression,o='<li>\n<a href="#" class="dropdown--follow-lnk';return a=t["if"].call(e,null!=(a=null!=e?e.thread:e)?a.userSubscription:a,{name:"if",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='"\ndata-action="menuitem-click" data-menu-item="toggle-subscription">\n<span class="text-default">'+s(t.gettext.call(e,"Subscribe to discussion",{name:"gettext",hash:{},data:i}))+'</span>\n<span class="text-following">'+s(t.gettext.call(e,"Unsubscribe from discussion",{name:"gettext",hash:{},data:i}))+"</span>\n</a>\n</li>\n",a=t["if"].call(e,null!=e?e.isBestOfDisqus:e,{name:"if",hash:{},fn:this.program(6,i),inverse:this.noop,data:i}),null!=a&&(o+=a),a=t["if"].call(e,null!=e?e.canCurate:e,{name:"if",hash:{},fn:this.program(8,i),inverse:this.noop,data:i}),null!=a&&(o+=a),a=t["if"].call(e,null!=e?e.canEdit:e,{name:"if",hash:{},fn:this.program(10,i),inverse:this.noop,data:i}),null!=a&&(o+=a),a=t["if"].call(e,null!=e?e.canDelete:e,{name:"if",hash:{},fn:this.program(12,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o},4:function(){return" active"},6:function(e,t,n,i){var a=this.escapeExpression;return'<li>\n<a href="#" class="dropdown--follow-lnk" data-action="menuitem-click"\ndata-menu-item="toggle-follow-targetchannel">\n<span class="text-default">'+a(t.gettext.call(e,"Unfollow %(disqus)s Team Picks",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+"</span>\n</a>\n</li>\n"},8:function(e,t,n,i){var a=this.lambda,s=this.escapeExpression;return'<li>\n<a href="'+s(a(null!=e?e.curationRoute:e,e))+'" class="dropdown--follow-lnk">\n'+s(t.gettext.call(e,"Curation tools",{name:"gettext",hash:{},data:i}))+"\n</a>\n</li>\n"},10:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression;return'<li>\n<a href="/home/edit/'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.id:a,e))+"/"+o(s(null!=(a=null!=e?e.thread:e)?a.slug:a,e))+'/" class="dropdown--follow-lnk">\n'+o(t.gettext.call(e,"Edit discussion",{name:"gettext",hash:{},data:i}))+"\n</a>\n</li>\n"},12:function(e,t,n,i){var a=this.escapeExpression;return'<li>\n<a href="#" class="dropdown--follow-lnk text-error" data-action="menuitem-click"\ndata-menu-item="delete-thread">\n'+a(t.gettext.call(e,"Delete discussion",{name:"gettext",hash:{},data:i}))+"\n</a>\n</li>\n"},14:function(e,t,n,i){var a=this.escapeExpression;return'<li>\n<a href="#" class="dropdown--follow-lnk" data-action="menuitem-click"\ndata-menu-item="restore-thread">\n'+a(t.gettext.call(e,"Undo delete",{name:"gettext",hash:{},data:i}))+"\n</a>\n</li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="card__subnav pull-right dropdown';return a=t["if"].call(e,null!=e?e.menuOpen:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+='" data-role="menu">\n<a href="#" class="dropdown-toggle link-gray-light" data-toggle="dropdown">\n<span class="icon icon-show-more text-small"></span>\n</a>\n<ul class="dropdown-menu dropdown--card-actions" role="menu" aria-labeledby="drop-discover">\n',a=t.unless.call(e,null!=(a=null!=e?e.thread:e)?a.isDeleted:a,{name:"unless",hash:{},fn:this.program(3,i),inverse:this.program(14,i),data:i}),null!=a&&(s+=a),s+"</ul>\n</div>\n"},useData:!0})),e.registerPartial("channelCoverLogo",e.template({1:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<div class="channel-cover__logo">\n<img src="'+i(n(null!=(t=null!=(t=null!=e?e.options:e)?t.titleLogo:t)?t.cache:t,e))+'" class="img-responsive img-block" />\n</div>\n'},3:function(e){var t=this.lambda,n=this.escapeExpression;return'<h1 class="channel-cover__heading">'+n(t(null!=e?e.name:e,e))+"</h1>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=(a=null!=e?e.options:e)?a.titleLogo:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s},useData:!0})),e.registerPartial("channelLink",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="/home/channel/'+o(s(null!=e?e.slug:e,e))+'/"\nclass="link-community"\ndata-link-name="channel_name"\ndata-channel-slug="'+o(s(null!=e?e.slug:e,e))+'">\n\n';return a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+"</a>\n"},usePartial:!0,useData:!0})),e.registerPartial("channelRules",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<strong>tl;dr</strong>\n<ol class="list-num spacing-bottom">\n<li>Make It Specific</li>\n<li>No Self-promotion</li>\n<li>No Hateful Topics</li>\n<li>Keep It Clean (And Legal)</li>\n<li>English Only</li>\n</ol>\n\n<p><strong>Make It Specific</strong></p>\n<p>Choosing a specific topic will make it easier for others to join, and for you to keep people on topic once they start creating their own discussions on your channel.</p>\n\n<p><strong>No Self-promotion</strong></p>\n<p>Channels are a place for discussion, not for selling or promoting websites, products, events or petitions.</p>\n\n<p><strong>No Hateful Topics</strong></p>\n<p>Channels created with the sole purpose of promoting sexist, racist, misogynist, homophobic, or generally offensive content are simply not allowed. </p>\n\n<p><strong>Keep It Clean (And Legal)</strong></p>\n<p>Explicit material and pirated content are not permitted. Channels supporting or pointing to this type of content will be removed. </p>\n\n<p><strong>English Only</strong></p>\n<p>We currently support English-only channels. Non-English channels will be removed.</p>\n'},useData:!0})),e.registerPartial("channelsModuleHeader",e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.moduleTitle:e,e))+"\n"},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Channels on %(disqus)s",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<a href="/home/channels/explore/" class="link-gray-darker" data-mix-location="header">\n<div class="module-header__icon icon-colorful">\n<svg class="icon-discover" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 18 18" enable-background="new 0 0 18 18" xml:space="preserve" width="26" height="26"><rect x="14" width="4" height="4" class="dot"/><rect x="14" y="7" width="4" height="4" class="dot"/><rect x="14" y="14" width="4" height="4" class="dot"/><rect x="7" width="4" height="4" class="dot"/><rect x="7" y="7" width="4" height="4" class="dot"/><rect x="7" y="14" width="4" height="4" class="dot"/><rect width="4" height="4" class="dot"/><rect y="7" width="4" height="4" class="dot"/><rect y="14" width="4" height="4" class="dot"/></g></svg>\n</div>\n<div class="module-header__title">\n<h2 class="module-header__heading">\n';return a=t["if"].call(e,null!=e?e.moduleTitle:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s+"</h2>\n</div>\n</a>\n"},useData:!0})),e.registerPartial("channelsModuleMoreFooter",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<footer class="module-footer">\n<a href="/home/channels/explore/" class="nav-lnk -color-muted -flushed">\n<div class="nav-lnk__blk">'+a(t.gettext.call(e,"Explore More Channels",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</footer>\n'},useData:!0})),e.registerPartial("defaultChannelAvatar",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e){var t=this.lambda,n=this.escapeExpression;return'<div class="channel-avatar '+n(t(null!=e?e.bannerColorClass:e,e))+'">\n<p class="channel-avatar__name">'+n(t(null!=e?e.channelInitial:e,e))+"</p>\n</div>\n"},useData:!0})),e.registerPartial("defaultForumAvatar",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e){var t=this.lambda,n=this.escapeExpression;return'<a href="/home/forum/'+n(t(null!=e?e.id:e,e))+'/"\nclass="avatar"\ndata-link-name="forum_avatar"\ndata-forum-pk="'+n(t(null!=e?e.pk:e,e))+'">\n\n<svg class="art-forum-blank" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 50 50" enable-background="new 0 0 50 50" xml:space="preserve"><path d="M22.9 38c5.9 0 10.6-4.9 10.6-11s-4.8-11-10.6-11 s-10.6 4.9-10.6 11c0 1.6 0.3 3.2 1 4.6L11.5 36l4.5-0.6C17.9 37 20.3 38 22.9 38z" class="style0"/><path d="M31.2 29c-4.8 0-8.7-4-8.7-9s3.9-9 8.7-9s8.7 4 8.7 9 c0 1.3-0.3 2.6-0.8 3.7l1.4 3.7l-3.7-0.5C35.3 28.2 33.3 29 31.2 29z" class="style1"/></svg>\n</a>\n'},useData:!0})),e.registerPartial("discussionModerationActions",e.template({1:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="align module__wrapper--moderation">\n<div class="link--moderation dropdown" data-role="menu">\n<button class="link-gray-dark text-medium" data-toggle="dropdown">\n<span class="block__item icon-cog"></span>\n<strong>'+s(t.gettext.call(e,"Moderate",{name:"gettext",hash:{},data:i}))+'</strong>\n</button>\n<ul class="dropdown-menu dropdown--cards dropdown--moderation-action" role="menu" aria-labeledby="drop-blacklist">\n<li>\n<a href="#" class="link text-semibold" data-action="blacklist-forum">\n'+s(t.gettext.call(e,"Ban %(author)s on %(forum)s",{name:"gettext",hash:{forum:null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.name:a,author:null!=(a=null!=(a=null!=e?e.thread:e)?a.author:a)?a.name:a},data:i}))+"\n</a>\n</li>\n";return a=t["if"].call(e,null!=e?e.isGlobalAdmin:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<li>\n<a href="https://'+s(o(null!=(a=null!=(a=null!=e?e.channel:e)?a.primaryForum:a)?a.id:a,e))+".disqus.com/admin/moderate/#/approved/search/thread:"+s(o(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'" data-action="moderate-thread" class="link text-semibold">'+s(t.gettext.call(e,"Moderate comments",{name:"gettext",hash:{},data:i}))+"</a>\n</li>\n</ul>\n</div>\n",a=t["if"].call(e,null!=(a=null!=e?e.thread:e)?a.isClosed:a,{name:"if",hash:{},fn:this.program(7,i),inverse:this.program(9,i),data:i}),null!=a&&(r+=a),r+'<a href="#" data-action="delete-thread" class="link--moderation link-gray-dark text-medium">\n<span class="icon icon-trash"></span>\n'+s(t.gettext.call(e,"Delete",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n"},2:function(e,t,n,i){var a,s='<li>\n<a href="#" class="link text-semibold" data-action="blacklist-global">\n';return a=t["if"].call(e,null!=(a=null!=(a=null!=e?e.thread:e)?a.author:a)?a.isOnGlobalBlacklist:a,{name:"if",hash:{},fn:this.program(3,i),inverse:this.program(5,i),data:i}),null!=a&&(s+=a),s+"</a>\n</li>\n"},3:function(e,t,n,i){var a,s=this.escapeExpression;return s(t.gettext.call(e,"Remove ban on %(author)s across %(Disqus)s",{name:"gettext",hash:{Disqus:"Disqus",author:null!=(a=null!=(a=null!=e?e.thread:e)?a.author:a)?a.name:a},data:i}))+"\n"},5:function(e,t,n,i){var a,s=this.escapeExpression;return s(t.gettext.call(e,"Ban %(author)s across %(Disqus)s",{name:"gettext",hash:{Disqus:"Disqus",author:null!=(a=null!=(a=null!=e?e.thread:e)?a.author:a)?a.name:a},data:i}))+"\n"},7:function(e,t,n,i){var a=this.escapeExpression;return'<a href="#" data-action="open-thread" class="link--moderation link-gray-dark text-medium">\n<span class="icon icon-open"></span>\n'+a(t.gettext.call(e,"Open Thread",{name:"gettext",hash:{},data:i}))+"\n</a>\n"},9:function(e,t,n,i){var a=this.escapeExpression;return'<a href="#" data-action="close-thread" class="link--moderation link-gray-dark text-medium">\n<span class="icon icon-close"></span>\n'+a(t.gettext.call(e,"Close Thread",{name:"gettext",hash:{},data:i}))+"\n</a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.canDelete:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},useData:!0})),e.registerPartial("discussionOnboardAlert",e.template({1:function(){return" hidden-lg"},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"You already follow this channel! This affects your homepage.",{name:"gettext",hash:{},data:i}))+"\n"},5:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Follow this channel to get more great discussions like this one.",{name:"gettext",hash:{},data:i}))+"\n"},7:function(e,t,n,i){var a=this.escapeExpression;return'<a href="/home/" class="button button-inverted button-semi-wide">\n'+a(t.gettext.call(e,"Let's go to your homepage.",{name:"gettext",hash:{},data:i}))+"\n</a>\n"},9:function(e,t,n,i){var a=this.escapeExpression;return'<strong class="button">\n'+a(t.gettext.call(e,"Go ahead and try it!",{name:"gettext",hash:{},data:i}))+"\n</strong>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="follow-onboard notch-down -onboarding text-center">\n<div class="follow-onboard__content">\n<h1 class="text-large spacing-narrow hidden-lg">\n'+s(t.gettext.call(e,"Voila, your first discussion",{name:"gettext",hash:{},data:i}))+'\n</h1>\n<p class="spacing-narrow';return a=t["if"].call(e,null!=e?e.isFollowing:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='">\n',a=t.if_all.call(e,null!=e?e.previouslyFollowing:e,null!=e?e.isFollowing:e,{name:"if_all",hash:{},fn:this.program(3,i),inverse:this.program(5,i),data:i}),null!=a&&(o+=a),o+="</p>\n",a=t["if"].call(e,null!=e?e.isFollowing:e,{name:"if",hash:{},fn:this.program(7,i),inverse:this.program(9,i),data:i}),null!=a&&(o+=a),o+"</div>\n</div>\n"},useData:!0})),e.registerPartial("forumAvatar",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<img class="forum-favicon" src="'+o(s(null!=e?e.faviconImage:e,e))+'" alt="';return a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+'">\n'},usePartial:!0,useData:!0})),e.registerPartial("forumAvatarLink",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="/home/forum/'+o(s(null!=e?e.id:e,e))+'/"\nclass="avatar"\ndata-link-name="forum_avatar"\ndata-forum-pk="'+o(s(null!=e?e.pk:e,e))+'">\n\n';return a=this.invokePartial(n.forumAvatar,"","forumAvatar",e,void 0,t,n,i),null!=a&&(r+=a),r+"</a>\n"},usePartial:!0,useData:!0})),e.registerPartial("forumLink",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="/home/forum/'+o(s(null!=e?e.id:e,e))+'/"\nclass="link-community"\ndata-link-name="forum_name"\ndata-forum-pk="'+o(s(null!=e?e.pk:e,e))+'">\n\n';return a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+"</a>\n"},usePartial:!0,useData:!0})),e.registerPartial("forumName",e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.name:e,e))},3:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.id:e,e))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.name:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s},useData:!0})),e.registerPartial("homeFooter",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<strong>The web’s community of communities</strong>\n<span class="bullet">Disqus &copy; '+a(t.now.call(e,"YYYY",{name:"now",hash:{},data:i}))+'</span>\n<br />\n\n<a href="/about/" class="link-gray">'+a(t.gettext.call(e,"About",{name:"gettext",hash:{},data:i}))+'</a>\n<span class="bullet"></span>\n<a href="/jobs/" class="link-gray">'+a(t.gettext.call(e,"Jobs",{name:"gettext",hash:{},data:i}))+'</a>\n<span class="bullet"></span>\n<a href="//business.disqus.com/" class="link-gray">'+a(t.gettext.call(e,"Business",{name:"gettext",hash:{},data:i}))+'</a>\n<span class="bullet"></span>\n<a href="//help.disqus.com/" class="link-gray">'+a(t.gettext.call(e,"Help",{name:"gettext",hash:{},data:i}))+'</a>\n<span class="bullet"></span>\n<a href="//help.disqus.com/customer/portal/articles/466260-terms-of-service" class="link-gray">'+a(t.gettext.call(e,"Terms",{name:"gettext",hash:{},data:i}))+'</a>\n<span class="bullet"></span>\n<a href="//help.disqus.com/customer/portal/articles/466259-privacy-policy" class="link-gray">'+a(t.gettext.call(e,"Privacy",{name:"gettext",hash:{},data:i}))+'</a>\n<br />\n<a href="http://publishers.disq.us/engage?utm_source=New-Site" class="link-gray">'+a(t.gettext.call(e,"Add Disqus to your site",{name:"gettext",hash:{},data:i}))+"</a>\n"},useData:!0})),e.registerPartial("homeRules",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<strong>tl;dr</strong>\n<ol class="list-num spacing-bottom">\n<li>'+a(t.gettext.call(e,"Stay On-topic",{name:"gettext",hash:{},data:i}))+"</li>\n<li>"+a(t.gettext.call(e,"No Self-promotion",{name:"gettext",hash:{},data:i}))+"</li>\n<li>"+a(t.gettext.call(e,"Choose Your (Curse) Words Wisely",{name:"gettext",hash:{},data:i}))+"</li>\n<li>"+a(t.gettext.call(e,"Don’t Be a Jerk",{name:"gettext",hash:{},data:i}))+"</li>\n<li>"+a(t.gettext.call(e,"Don’t Copy and Paste",{name:"gettext",hash:{},data:i}))+"</li>\n<li>"+a(t.gettext.call(e,"English Only",{name:"gettext",hash:{},data:i}))+"</li>\n</ol>\n\n<p><strong>"+a(t.gettext.call(e,"Stay On-topic",{name:"gettext",hash:{},data:i}))+"</strong></p>\n<p>"+a(t.gettext.call(e,"Be sure your topic matches the general theme of the channel. For example, all discussions on %(talkShop)s should pertain to fashion and beauty. Not sure if you’re posting to the right channel? Check the channel’s About section, or recently-added discussions to get an idea of what subjects are appropriate.",{name:"gettext",hash:{talkShop:t.tag.call(e,"a",{name:"tag",hash:{text:"Talk Shop",target:"_blank",href:"https://disqus.com/home/channel/talkshop/"},data:i})},data:i}))+"\n</p>\n\n<p><strong>"+a(t.gettext.call(e,"No Self-promotion",{name:"gettext",hash:{},data:i}))+"</strong></p>\n<p>"+a(t.gettext.call(e,"A discussion or comment that contains only a link to your blog, a product, or your article on another site will almost always be removed.",{name:"gettext",hash:{},data:i}))+"</p>\n\n<p><strong>"+a(t.gettext.call(e,"Choose Your (Curse) Words Wisely",{name:"gettext",hash:{},data:i}))+"</strong></p>\n<p>"+a(t.gettext.call(e,"Comments that contain profanity are automatically held for moderator review before being posted. Depending on the context of the comment, it may be removed. Profanity used to insult, antagonize, or inflame will always be removed.",{name:"gettext",hash:{},data:i}))+"</p>\n\n<p><strong>"+a(t.gettext.call(e,"Don’t Be a Jerk",{name:"gettext",hash:{},data:i}))+"</strong></p>\n<p>"+a(t.gettext.call(e,"Personal attacks and harassment will not be tolerated. Sexist, racist, misogynist, homophobic, and broad, offensive generalizations about groups of people are simply not allowed. Comments or discussions written intentionally to provoke will also be removed.",{name:"gettext",hash:{},data:i}))+"</p>\n\n<p><strong>"+a(t.gettext.call(e,"Don’t Copy and Paste",{name:"gettext",hash:{},data:i}))+"</strong></p>\n<p>"+a(t.gettext.call(e,"If you didn’t write it, or haven’t properly cited the article you’re quoting, don’t post it.",{name:"gettext",hash:{},data:i}))+"</p>\n\n<p><strong>"+a(t.gettext.call(e,"English Only",{name:"gettext",hash:{},data:i}))+"</strong></p>\n<p>"+a(t.gettext.call(e,"We currently only support English-only discussions on %(disqus)s channels. Non-English comments and discussions will be removed.",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+"</p>\n\n<p><em>"+a(t.gettext.call(e,"Have questions about these rules? Think we’ve missed something? Email us at %(emailHome)s",{name:"gettext",hash:{emailHome:t.tag.call(e,"a",{name:"tag",hash:{text:"channelhelp@disqus.com",href:"mailto:channelhelp@disqus.com"},data:i})},data:i}))+"</em></p>\n"},useData:!0})),e.registerPartial("navLogo",e.template({1:function(e,t,n,i){var a=this.escapeExpression,s=this.lambda;return'<img class="site-nav__logo"\nsrc="'+a(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/disqus-logo-dev.svg"\nalt="Disqus" />\n<div class="site-nav__logo__debug">'+a(s(null!=e?e.customBase:e,e))+"</div>\n"},3:function(){return'<img class="site-nav__logo"\nsrc="//a.disquscdn.com/dotcom/d-9c2c241/img/brand/disqus-logo-blue-white.svg"\nalt="Disqus" />\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<a href="/" class="nav__lnk nav__lnk--logo">\n';return a=t["if"].call(e,null!=e?e.customBase:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s+"</a>\n"},useData:!0})),e.registerPartial("navUserIcon",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<a href="/by/'+i(n(null!=e?e.username:e,e))+'/" class="nav__lnk" data-page-icon="/by/'+i(n(null!=e?e.username:e,e))+'/">\n<img src="'+i(n(null!=(t=null!=e?e.avatar:e)?t.cache:t,e))+'" alt="'+i(n(null!=e?e.username:e,e))+'" class="img-avatar--site-nav">\n</a>\n'},useData:!0})),e.registerPartial("profileCardReason",e.template({1:function(e,t,n,i){var a,s=this.escapeExpression;return s(t.gettext.call(e,"Discussion on %(forum)s",{name:"gettext",hash:{forum:t.getPartial.call(e,"channelLink",null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.channelInfo:a,{name:"getPartial",hash:{},data:i})},data:i}))+"\n"},3:function(e,t,n,i){var a,s=this.escapeExpression;return s(t.gettext.call(e,"Discussion on %(forum)s",{name:"gettext",hash:{forum:t.getPartial.call(e,"forumLink",null!=(a=null!=e?e.thread:e)?a.forum:a,{name:"getPartial",hash:{},data:i})},data:i}))+"\n"},5:function(){return'<span class="icon-lock icon-tiny spacing-right-small text-gray"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="card-reason">\n';return a=t["if"].call(e,null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.channelInfo:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+='<a href="'+o(s(null!=e?e.discussionRoute:e,e))+'"\nclass="bullet link-discussion"\ndata-link-name="comment_count"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n',a=t["if"].call(e,null!=(a=null!=e?e.thread:e)?a.isClosed:a,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+="\n",a=s(null!=(a=null!=e?e.thread:e)?a.posts:a,e),null!=a&&(r+=a),r+" comments\n</a>\n</div>\n"},useData:!0})),e.registerPartial("profileCoverAttributes",e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return'<div class="text-medium profile-cover-about">\n<div class="truncate" data-truncate-lines="'+n(t(null!=e?e.numLines:e,e))+'">\n'+n(t(null!=e?e.about:e,e))+"\n</div>\n</div>\n"},3:function(e,t,n,i){var a=this.escapeExpression;return'<li class="truncate-line text-small">\n<span class="icon-arrow-up text-smaller icon__position -inline"></span>\n'+a(t.gettext.call(e,"%(upvoteCount)s Upvotes",{name:"gettext",hash:{upvoteCount:t.tag.call(e,"strong",{name:"tag",hash:{text:null!=e?e.numLikesReceived:e},data:i})},data:i}))+"\n</li>\n"},5:function(e){var t=this.lambda,n=this.escapeExpression;return'<li class="truncate-line text-small hidden-cover">\n<span class="icon-location text-smaller icon__position -inline"></span>\n'+n(t(null!=e?e.location:e,e))+"\n</li>\n"},7:function(e){var t=this.lambda,n=this.escapeExpression;return'<li class="truncate-line text-small">\n<span class="icon-link text-smaller icon__position -inline"></span>\n<a href="'+n(t(null!=e?e.url:e,e))+'">'+n(t(null!=e?e.url:e,e))+"</a>\n</li>\n"},9:function(e,t,n,i){var a=this.escapeExpression;return'<li class="truncate-line text-small">\n<span class="icon-clock text-smaller icon__position -inline"></span>\n'+a(t.gettext.call(e,"Joined %(joinedAt)s",{name:"gettext",hash:{joinedAt:null!=e?e.joinDate:e},data:i}))+"\n</li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<p class="text-large text-gray profile-cover-username">\n@'+o(s(null!=e?e.username:e,e))+'\n</p>\n<div class="profile-user-info">\n';return a=t["if"].call(e,null!=e?e.about:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<ul class="profile-cover-list">\n',a=t["if"].call(e,null!=e?e.numLikesReceived:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t["if"].call(e,null!=e?e.location:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t["if"].call(e,null!=e?e.url:e,{name:"if",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t["if"].call(e,null!=e?e.joinDate:e,{name:"if",hash:{},fn:this.program(9,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+"</ul>\n</div>\n"},useData:!0})),e.registerPartial("replyOrEditLink",e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression;return'<a href="'+o(s(null!=e?e.discussionRoute:e,e))+"#edit-"+o(s(null!=e?e.id:e,e))+'"\nclass="edit link-gray"\ndata-link-name="edit"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n\n'+o(t.gettext.call(e,"Edit",{name:"gettext",hash:{},data:i}))+"\n</a>\n"},3:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.isLoggedIn:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},4:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=(a=null!=e?e.thread:e)?a.isClosed:a,{name:"if",hash:{},fn:this.program(5,i),inverse:this.program(7,i),data:i}),null!=a&&(s+=a),s},5:function(e,t,n,i){var a=this.escapeExpression;return'<a class="reply-disabled link-gray">\n<span class="icon icon-lock icon-tiny spacing-right-small text-gray"></span>\n'+a(t.gettext.call(e,"Reply",{name:"gettext",hash:{},data:i}))+"\n</a>\n"},7:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression;return'<a href="'+o(s(null!=e?e.discussionRoute:e,e))+"#reply-"+o(s(null!=e?e.id:e,e))+'"\ndata-action="reply"\nclass="reply link-gray"\ndata-link-name="reply"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n\n'+o(t.gettext.call(e,"Reply",{name:"gettext",hash:{},data:i}))+"\n</a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.wasAuthoredBySessionUser:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s},useData:!0})),e.registerPartial("settingsAccountSocialLink",e.template({1:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Connected as %(displayName)s",{name:"gettext",hash:{displayName:t.tag.call(e,"a",{name:"tag",hash:{text:null!=e?e.display_name:e,target:"_blank",href:null!=e?e.url:e},data:i})},data:i}))+"\n"},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Connected as %(displayName)s",{name:"gettext",hash:{displayName:null!=e?e.display_name:e},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.url:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s},useData:!0})),e.registerPartial("threadImage",e.template({1:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<a href="'+i(n(null!=(t=null!=e?e.thread:e)?t.link:t,e))+'"\nclass="discussion-image"\ndata-link-name="image"\ndata-link-out="'+i(n(null!=(t=null!=e?e.thread:e)?t.signedLink:t,e))+'"\ndata-thread-id="'+i(n(null!=(t=null!=e?e.thread:e)?t.id:t,e))+'">\n\n<img src="'+i(n(null!=(t=null!=e?e.image:e)?t.src:t,e))+'" alt="'+i(n(null!=(t=null!=e?e.image:e)?t.title:t,e))+'">\n</a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},useData:!0})),e.registerPartial("threadLink",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<a href="'+i(n(null!=(t=null!=e?e.thread:e)?t.link:t,e))+'"\nclass="name-thread"\ndata-role="article-link"\ndata-mix-location="title"\ndata-link-out="'+i(n(null!=(t=null!=e?e.thread:e)?t.signedLink:t,e))+'"\ndata-link-name="title"\ndata-thread-id="'+i(n(null!=(t=null!=e?e.thread:e)?t.id:t,e))+'">\n\n'+i(n(null!=(t=null!=e?e.thread:e)?t.clean_title:t,e))+"\n</a>\n"},useData:!0})),e.registerPartial("threadPostActivity",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression,s=this.lambda;return'<div class="discussion-activity align align--between">\n<div data-role="thread-actions"></div>\n<div class="discussion-activity__nav">\n<a href="#" class="dropdown-toggle visible-md text-medium text-semibold link-gray" data-toggle="dropdown">\n<span data-action="switch-tab" data-tab="best" class="dropdown-toggle__selection">\n'+a(t.gettext.call(e,"Sort by Best",{name:"gettext",hash:{},data:i}))+'\n</span>\n<span data-action="switch-tab" data-tab="newest" class="dropdown-toggle__selection">\n'+a(t.gettext.call(e,"Sort by Newest",{name:"gettext",hash:{},data:i}))+'\n</span>\n<span data-action="switch-tab" data-tab="oldest" class="dropdown-toggle__selection">\n'+a(t.gettext.call(e,"Sort by Oldest",{name:"gettext",hash:{},data:i}))+'\n</span>\n<span class="icon-arrow icon__position -caret"></span>\n</a>\n<ul class="nav--discussion">\n<li data-action="switch-tab" data-tab="best" class="nav__item">\n<a href="'+a(s(null!=e?e.discussionRoute:e,e))+'best/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n<span class="button__text">'+a(t.gettext.call(e,"Best",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__checkmark">\n<span class="icon icon-checkmark icon__position text-smaller"></span>\n</div>\n</a>\n</li>\n<li data-action="switch-tab" data-tab="newest" class="nav__item">\n<a href="'+a(s(null!=e?e.discussionRoute:e,e))+'newest/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n<span class="button__text">'+a(t.gettext.call(e,"Newest",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__checkmark">\n<span class="icon icon-checkmark icon__position text-smaller"></span>\n</div>\n</a>\n</li>\n<li data-action="switch-tab" data-tab="oldest" class="nav__item">\n<a href="'+a(s(null!=e?e.discussionRoute:e,e))+'oldest/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n<span class="button__text">'+a(t.gettext.call(e,"Oldest",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__checkmark">\n<span class="icon icon-checkmark icon__position text-smaller"></span>\n</div>\n</a>\n</li>\n</ul>\n</div>\n</div>\n'},useData:!0})),e.registerPartial("threadTitle",e.template({1:function(e){var t,n=this.lambda,i=this.escapeExpression;return i(n(null!=(t=null!=e?e.threadOverrides:e)?t.title:t,e))+"\n"},3:function(e){var t,n=this.lambda,i=this.escapeExpression;return i(n(null!=(t=null!=e?e.thread:e)?t.clean_title:t,e))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<h2 class="discussion-title" dir="auto">\n<a href="'+o(s(null!=(a=null!=e?e.thread:e)?a.link:a,e))+'"\nclass="link-gray-darker truncate"\ndata-truncate-lines="'+o(s(null!=e?e.numTitleLines:e,e))+'"\ndata-role="thread-link"\ndata-link-out="'+o(s(null!=(a=null!=e?e.thread:e)?a.signedLink:a,e))+'"\ndata-link-name="title"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n\n';return a=t["if"].call(e,null!=(a=null!=e?e.threadOverrides:e)?a.title:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+"</a>\n</h2>\n"},useData:!0})),e.registerPartial("timeSelector",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<select name="time">\n<option></option>\n<option value="3600">'+a(t.gettext.call(e,"1 hour",{name:"gettext",hash:{},data:i}))+'</option>\n<option value="10800">'+a(t.gettext.call(e,"3 hours",{name:"gettext",hash:{},data:i}))+'</option>\n<option value="21600">'+a(t.gettext.call(e,"6 hours",{name:"gettext",hash:{},data:i}))+'</option>\n<option value="43200">'+a(t.gettext.call(e,"12 hours",{name:"gettext",hash:{},data:i}))+'</option>\n<option value="86400">'+a(t.gettext.call(e,"1 day",{name:"gettext",hash:{},data:i}))+'</option>\n<option value="259200">'+a(t.gettext.call(e,"3 days",{name:"gettext",hash:{},data:i}))+'</option>\n<option value="432000">'+a(t.gettext.call(e,"5 days",{name:"gettext",hash:{},data:i}))+'</option>\n<option value="604800">'+a(t.gettext.call(e,"1 week",{name:"gettext",hash:{},data:i}))+'</option>\n<option value="1209600">'+a(t.gettext.call(e,"2 weeks",{name:"gettext",hash:{},data:i}))+"</option>\n</select>\n"
},useData:!0})),e.registerPartial("topicTag",e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.topicRoute:e,e))},3:function(){return"#"},5:function(){return'data-action="remove-tag"'},7:function(){return'<span class="icon icon-cancel"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="';return a=t["if"].call(e,null!=e?e.topicRoute:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+='" ',a=t.unless.call(e,null!=e?e.topicRoute:e,{name:"unless",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='\nclass="button--tag">\n'+o(s(null!=e?e.displayName:e,e))+"\n",a=t.unless.call(e,null!=e?e.topicRoute:e,{name:"unless",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+"</a>\n"},useData:!0})),e.registerPartial("userAvatar",e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="/by/'+o(s(null!=e?e.username:e,e))+'/" class="avatar" data-link-name="user_avatar">\n';return a=this.invokePartial(n.userAvatarNoLink,"","userAvatarNoLink",e,void 0,t,n,i),null!=a&&(r+=a),r+"</a>\n"},3:function(e,t,n,i){var a,s='<span class="avatar">\n';return a=this.invokePartial(n.userAvatarNoLink,"","userAvatarNoLink",e,void 0,t,n,i),null!=a&&(s+=a),s+"</span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.username:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s},usePartial:!0,useData:!0})),e.registerPartial("userAvatarNoLink",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<img src="'+i(n(null!=(t=null!=e?e.avatar:e)?t.cache:t,e))+'" alt="'+i(n(null!=e?e.displayName:e,e))+'">\n'},useData:!0})),e.registerPartial("userCardBody",e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return'<p class="description truncate-line">'+n(t(null!=e?e.about:e,e))+"</p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.userAvatar,"","userAvatar",e,void 0,t,n,i),null!=a&&(s+=a),s+='<div class="user-info">\n',a=this.invokePartial(n.userName,"","userName",e,void 0,t,n,i),null!=a&&(s+=a),a=t["if"].call(e,null!=e?e.about:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+"</div>\n"},usePartial:!0,useData:!0})),e.registerPartial("userFollowButton",e.template({1:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.isPrivate:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.program(4,i),data:i}),null!=a&&(s+=a),s},2:function(e,t,n,i){var a=this.escapeExpression;return'<button class="button button-disabled -small">\n'+a(t.gettext.call(e,"Private",{name:"gettext",hash:{},data:i}))+'<span class="icon-lock icon-small spacing-left-small"></span>\n</button>\n'},4:function(e,t,n,i){var a,s='<span class="btn-follow--mobile">\n';return a=this.invokePartial(n.genericFollowButton,"","genericFollowButton",e,void 0,t,n,i),null!=a&&(s+=a),s+"</span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t.unless.call(e,null!=e?e.isSessionUser:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},usePartial:!0,useData:!0})),e.registerPartial("userGroup",e.template({1:function(e,t,n,i){var a,s='<span class="actor">\n';return a=this.invokePartial(n.userPreview,"","userPreview",e,void 0,t,n,i),null!=a&&(s+=a),s+"</span>\n"},3:function(e,t,n,i){var a=this.escapeExpression;return'<a href="#" class="actor name link-gray-darker" data-role="actors">\n'+a(t.gettext.call(e,"%(numUsers)s others",{name:"gettext",hash:{numUsers:null!=e?e.numRemainingActors:e},data:i}))+"\n</a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<span class="actors">\n';return a=t.each.call(e,null!=e?e.shownActors:e,{name:"each",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),a=t["if"].call(e,null!=e?e.numRemainingActors:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+"</span>\n"},usePartial:!0,useData:!0})),e.registerPartial("userGroupNames",e.template({1:function(e,t,n,i){var a,s='<span class="actor-group" data-role="actors">\n';return a=t["if"].call(e,t.gt.call(e,null!=e?e.numRemainingActors:e,1,{name:"gt",hash:{},data:i}),{name:"if",hash:{},fn:this.program(2,i),inverse:this.program(4,i),data:i}),null!=a&&(s+=a),s+"</span>\n"},2:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"%(numUsers)s others",{name:"gettext",hash:{numUsers:null!=e?e.numRemainingActors:e},data:i}))+"\n"},4:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"1 other",{name:"gettext",hash:{},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<span class="actors">\n<span class="actor">\n';return a=this.invokePartial(n.userName,"","userName",null!=e?e.firstActor:e,void 0,t,n,i),null!=a&&(s+=a),s+="</span>\n",a=t["if"].call(e,t.gt.call(e,null!=e?e.numRemainingActors:e,0,{name:"gt",hash:{},data:i}),{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+"</span>\n"},usePartial:!0,useData:!0})),e.registerPartial("userName",e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return'<a href="/by/'+n(t(null!=e?e.username:e,e))+'/" class="name" data-link-name="user_name">'+n(t(null!=e?e.name:e,e))+"</a>\n"},3:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.name:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.program(6,i),data:i}),null!=a&&(s+=a),s},4:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.name:e,e))+"\n"},6:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Guest",{name:"gettext",hash:{},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.username:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s},useData:!0})),e.registerPartial("userNameNoLink",e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.name:e,e))+"\n"},3:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.username:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.program(6,i),data:i}),null!=a&&(s+=a),s},4:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.username:e,e))+"\n"},6:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Guest",{name:"gettext",hash:{},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.name:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s},useData:!0})),e.registerPartial("userPreview",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.userAvatar,"","userAvatar",e,void 0,t,n,i),null!=a&&(s+=a),a=this.invokePartial(n.userName,"","userName",e,void 0,t,n,i),null!=a&&(s+=a),s+"\n"},usePartial:!0,useData:!0})),e.registerPartial("userSpan",e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e){var t=this.lambda,n=this.escapeExpression;return'<span data-username="'+n(t(null!=e?e.username:e,e))+'" data-role="username">'+n(t(null!=e?e.name:e,e))+"</span>\n"},useData:!0})),e.registerPartial("cardGuestUpvoterText",e.template({1:function(e,t,n,i){var a=this.escapeExpression;return" "+a(t.gettext.call(e,"%(guestCount)s Guest Votes",{name:"gettext",hash:{guestCount:null!=e?e.guestCount:e},data:i}))+" "},3:function(e,t,n,i){var a=this.escapeExpression;return" "+a(t.gettext.call(e,"1 Guest Vote",{name:"gettext",hash:{},data:i}))+" "},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,t.gt.call(e,null!=e?e.guestCount:e,1,{name:"gt",hash:{},data:i}),{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s+"\n"},useData:!0})),e.registerPartial("cardGuestUser",e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<li class="user ';return a=t["if"].call(e,null!=e?e.highlight:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'" data-role="guest">\n<span class="avatar" title="'+o(s(null!=e?e.guestText:e,e))+'">\n<img src="'+o(s(null!=e?e.guestAvatarUrl:e,e))+'" alt="'+o(t.gettext.call(e,"Avatar",{name:"gettext",hash:{},data:i}))+'" />\n</span>\n<span class="username" title="'+o(s(null!=e?e.guestText:e,e))+'">\n'+o(s(null!=e?e.guestText:e,e))+"\n</span>\n</li>\n"},2:function(){return"highlight"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.guestCount:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},useData:!0})),e.registerPartial("cardOtherUserText",e.template({1:function(e,t,n,i){var a=this.escapeExpression;return" "+a(t.gettext.call(e,"%(guestCount)s Others",{name:"gettext",hash:{guestCount:null!=e?e.guestCount:e},data:i}))+" "},3:function(e,t,n,i){var a=this.escapeExpression;return" "+a(t.gettext.call(e,"1 Other",{name:"gettext",hash:{},data:i}))+" "},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,t.gt.call(e,null!=e?e.guestCount:e,1,{name:"gt",hash:{},data:i}),{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s+"\n"},useData:!0})),e.registerPartial("cardUser",e.template({1:function(){return"highlight"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<li class="user ';return a=t["if"].call(e,null!=e?e.highlight:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'" data-action="profile" data-username="'+o(s(null!=e?e.username:e,e))+'">\n<a class="avatar" href="'+o(s(null!=e?e.profileUrl:e,e))+'" title="'+o(s(null!=e?e.name:e,e))+'">\n<img src="'+o(s(null!=(a=null!=e?e.avatar:e)?a.cache:a,e))+'" alt="'+o(t.gettext.call(e,"Avatar",{name:"gettext",hash:{},data:i}))+'" />\n</a>\n<a class="username" href="'+o(s(null!=e?e.profileUrl:e,e))+'" title="'+o(s(null!=e?e.name:e,e))+'">\n'+o(s(null!=e?e.name:e,e))+"\n</a>\n</li>\n"},useData:!0})),e.registerPartial("genericFollowButton",e.template({1:function(){return" active"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<button class="btn-follow';return a=t["if"].call(e,null!=e?e.isFollowing:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+'" data-action="toggle-follow">\n<span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">'+s(t.gettext.call(e,"Follow",{name:"gettext",hash:{},data:i}))+'</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">'+s(t.gettext.call(e,"Following",{name:"gettext",hash:{},data:i}))+"</span>\n</button>\n"},useData:!0}))}),function(e){function t(e,t,n){switch(arguments.length){case 2:return null!=e?e:t;case 3:return null!=e?e:null!=t?t:n;default:throw Error("Implement me")}}function n(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function i(e){vt.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function a(e,t){var n=!0;return u(function(){return n&&(i(e),n=!1),t.apply(this,arguments)},t)}function s(e,t){pn[e]||(i(t),pn[e]=!0)}function o(e,t){return function(n){return p(e.call(this,n),t)}}function r(e,t){return function(n){return this.localeData().ordinal(e.call(this,n),t)}}function l(){}function c(e,t){t!==!1&&D(e),h(this,e),this._d=new Date(+e._d)}function d(e){var t=k(e),n=t.year||0,i=t.quarter||0,a=t.month||0,s=t.week||0,o=t.day||0,r=t.hour||0,l=t.minute||0,c=t.second||0,d=t.millisecond||0;this._milliseconds=+d+1e3*c+6e4*l+36e5*r,this._days=+o+7*s,this._months=+a+3*i+12*n,this._data={},this._locale=vt.localeData(),this._bubble()}function u(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return t.hasOwnProperty("toString")&&(e.toString=t.toString),t.hasOwnProperty("valueOf")&&(e.valueOf=t.valueOf),e}function h(t,n){var i,a,s;if(e!==n._isAMomentObject&&(t._isAMomentObject=n._isAMomentObject),e!==n._i&&(t._i=n._i),e!==n._f&&(t._f=n._f),e!==n._l&&(t._l=n._l),e!==n._strict&&(t._strict=n._strict),e!==n._tzm&&(t._tzm=n._tzm),e!==n._isUTC&&(t._isUTC=n._isUTC),e!==n._offset&&(t._offset=n._offset),e!==n._pf&&(t._pf=n._pf),e!==n._locale&&(t._locale=n._locale),Mt.length>0)for(i in Mt)a=Mt[i],s=n[a],e!==s&&(t[a]=s);return t}function m(e){return 0>e?Math.ceil(e):Math.floor(e)}function p(e,t,n){for(var i=""+Math.abs(e),a=e>=0;t>i.length;)i="0"+i;return(a?n?"+":"":"-")+i}function f(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function g(e,t){var n;return t=N(t,e),e.isBefore(t)?n=f(e,t):(n=f(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function v(e,t){return function(n,i){var a,o;return null===i||isNaN(+i)||(s(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),o=n,n=i,i=o),n="string"==typeof n?+n:n,a=vt.duration(n,i),w(this,a,e),this}}function w(e,t,n,i){var a=t._milliseconds,s=t._days,o=t._months;i=null==i?!0:i,a&&e._d.setTime(+e._d+a*n),s&&ut(e,"Date",dt(e,"Date")+s*n),o&&ct(e,dt(e,"Month")+o*n),i&&vt.updateOffset(e,s||o)}function b(e){return"[object Array]"===Object.prototype.toString.call(e)}function x(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function y(e,t,n){var i,a=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),o=0;for(i=0;a>i;i++)(n&&e[i]!==t[i]||!n&&T(e[i])!==T(t[i]))&&o++;return o+s}function _(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=rn[e]||ln[t]||t}return e}function k(e){var t,n,i={};for(n in e)e.hasOwnProperty(n)&&(t=_(n),t&&(i[t]=e[n]));return i}function C(t){var n,i;if(0===t.indexOf("week"))n=7,i="day";else{if(0!==t.indexOf("month"))return;n=12,i="month"}vt[t]=function(a,s){var o,r,l=vt._locale[t],c=[];if("number"==typeof a&&(s=a,a=e),r=function(e){var t=vt().utc().set(i,e);return l.call(vt._locale,t,a||"")},null!=s)return r(s);for(o=0;n>o;o++)c.push(r(o));return c}}function T(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=t>=0?Math.floor(t):Math.ceil(t)),n}function S(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function E(e,t,n){return st(vt([e,11,31+t-n]),t,n).week}function F(e){return P(e)?366:365}function P(e){return e%4===0&&e%100!==0||e%400===0}function D(e){var t;e._a&&-2===e._pf.overflow&&(t=0>e._a[Ct]||e._a[Ct]>11?Ct:1>e._a[Tt]||e._a[Tt]>S(e._a[kt],e._a[Ct])?Tt:0>e._a[St]||e._a[St]>23?St:0>e._a[Et]||e._a[Et]>59?Et:0>e._a[Ft]||e._a[Ft]>59?Ft:0>e._a[Pt]||e._a[Pt]>999?Pt:-1,e._pf._overflowDayOfYear&&(kt>t||t>Tt)&&(t=Tt),e._pf.overflow=t)}function M(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&0>e._pf.overflow&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length)),e._isValid}function V(e){return e?e.toLowerCase().replace("_","-"):e}function A(e){for(var t,n,i,a,s=0;e.length>s;){for(a=V(e[s]).split("-"),t=a.length,n=V(e[s+1]),n=n?n.split("-"):null;t>0;){if(i=R(a.slice(0,t).join("-")))return i;if(n&&n.length>=t&&y(a,n,!0)>=t-1)break;t--}s++}return null}function R(e){var t=null;if(!Dt[e]&&Vt)try{t=vt.locale(),require("./locale/"+e),vt.locale(t)}catch(n){}return Dt[e]}function N(e,t){return t._isUTC?vt(e).zone(t._offset||0):vt(e).local()}function O(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function I(e){var t,n,i=e.match(Ot);for(t=0,n=i.length;n>t;t++)i[t]=mn[i[t]]?mn[i[t]]:O(i[t]);return function(a){var s="";for(t=0;n>t;t++)s+=i[t]instanceof Function?i[t].call(a,e):i[t];return s}}function U(e,t){return e.isValid()?(t=L(t,e.localeData()),cn[t]||(cn[t]=I(t)),cn[t](e)):e.localeData().invalidDate()}function L(e,t){function n(e){return t.longDateFormat(e)||e}var i=5;for(It.lastIndex=0;i>=0&&It.test(e);)e=e.replace(It,n),It.lastIndex=0,i-=1;return e}function q(e,t){var n,i=t._strict;switch(e){case"Q":return Yt;case"DDDD":return Kt;case"YYYY":case"GGGG":case"gggg":return i?Xt:qt;case"Y":case"G":case"g":return Zt;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return i?Qt:Ht;case"S":if(i)return Yt;case"SS":if(i)return Jt;case"SSS":if(i)return Kt;case"DDD":return Lt;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return jt;case"a":case"A":return t._locale._meridiemParse;case"X":return Wt;case"Z":case"ZZ":return zt;case"T":return Bt;case"SSSS":return $t;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return i?Jt:Ut;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return Ut;case"Do":return Gt;default:return n=RegExp(J(Y(e.replace("\\","")),"i"))}}function H(e){e=e||"";var t=e.match(zt)||[],n=t[t.length-1]||[],i=(n+"").match(sn)||["-",0,0],a=+(60*i[1])+T(i[2]);return"+"===i[0]?-a:a}function $(e,t,n){var i,a=n._a;switch(e){case"Q":null!=t&&(a[Ct]=3*(T(t)-1));break;case"M":case"MM":null!=t&&(a[Ct]=T(t)-1);break;case"MMM":case"MMMM":i=n._locale.monthsParse(t),null!=i?a[Ct]=i:n._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(a[Tt]=T(t));break;case"Do":null!=t&&(a[Tt]=T(parseInt(t,10)));break;case"DDD":case"DDDD":null!=t&&(n._dayOfYear=T(t));break;case"YY":a[kt]=vt.parseTwoDigitYear(t);break;case"YYYY":case"YYYYY":case"YYYYYY":a[kt]=T(t);break;case"a":case"A":n._isPm=n._locale.isPM(t);break;case"H":case"HH":case"h":case"hh":a[St]=T(t);break;case"m":case"mm":a[Et]=T(t);break;case"s":case"ss":a[Ft]=T(t);break;case"S":case"SS":case"SSS":case"SSSS":a[Pt]=T(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=H(t);break;case"dd":case"ddd":case"dddd":i=n._locale.weekdaysParse(t),null!=i?(n._w=n._w||{},n._w.d=i):n._pf.invalidWeekday=t;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":e=e.substr(0,1);case"gggg":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(n._w=n._w||{},n._w[e]=T(t));break;case"gg":case"GG":n._w=n._w||{},n._w[e]=vt.parseTwoDigitYear(t)}}function j(e){var n,i,a,s,o,r,l;n=e._w,null!=n.GG||null!=n.W||null!=n.E?(o=1,r=4,i=t(n.GG,e._a[kt],st(vt(),1,4).year),a=t(n.W,1),s=t(n.E,1)):(o=e._locale._week.dow,r=e._locale._week.doy,i=t(n.gg,e._a[kt],st(vt(),o,r).year),a=t(n.w,1),null!=n.d?(s=n.d,o>s&&++a):s=null!=n.e?n.e+o:o),l=ot(i,a,s,r,o),e._a[kt]=l.year,e._dayOfYear=l.dayOfYear}function z(e){var n,i,a,s,o=[];if(!e._d){for(a=W(e),e._w&&null==e._a[Tt]&&null==e._a[Ct]&&j(e),e._dayOfYear&&(s=t(e._a[kt],a[kt]),e._dayOfYear>F(s)&&(e._pf._overflowDayOfYear=!0),i=tt(s,0,e._dayOfYear),e._a[Ct]=i.getUTCMonth(),e._a[Tt]=i.getUTCDate()),n=0;3>n&&null==e._a[n];++n)e._a[n]=o[n]=a[n];for(;7>n;n++)e._a[n]=o[n]=null==e._a[n]?2===n?1:0:e._a[n];e._d=(e._useUTC?tt:et).apply(null,o),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()+e._tzm)}}function B(e){var t;e._d||(t=k(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],z(e))}function W(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function G(t){if(t._f===vt.ISO_8601)return X(t),e;t._a=[],t._pf.empty=!0;var n,i,a,s,o,r=""+t._i,l=r.length,c=0;for(a=L(t._f,t._locale).match(Ot)||[],n=0;a.length>n;n++)s=a[n],i=(r.match(q(s,t))||[])[0],i&&(o=r.substr(0,r.indexOf(i)),o.length>0&&t._pf.unusedInput.push(o),r=r.slice(r.indexOf(i)+i.length),c+=i.length),mn[s]?(i?t._pf.empty=!1:t._pf.unusedTokens.push(s),$(s,i,t)):t._strict&&!i&&t._pf.unusedTokens.push(s);t._pf.charsLeftOver=l-c,r.length>0&&t._pf.unusedInput.push(r),t._isPm&&12>t._a[St]&&(t._a[St]+=12),t._isPm===!1&&12===t._a[St]&&(t._a[St]=0),z(t),D(t)}function Y(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,i,a){return t||n||i||a})}function J(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function K(t){var i,a,s,o,r;if(0===t._f.length)return t._pf.invalidFormat=!0,t._d=new Date(0/0),e;for(o=0;t._f.length>o;o++)r=0,i=h({},t),i._pf=n(),i._f=t._f[o],G(i),M(i)&&(r+=i._pf.charsLeftOver,r+=10*i._pf.unusedTokens.length,i._pf.score=r,(null==s||s>r)&&(s=r,a=i));u(t,a||i)}function X(e){var t,n,i=e._i,a=en.exec(i);if(a){for(e._pf.iso=!0,t=0,n=nn.length;n>t;t++)if(nn[t][1].exec(i)){e._f=nn[t][0]+(a[6]||" ");break}for(t=0,n=an.length;n>t;t++)if(an[t][1].exec(i)){e._f+=an[t][0];break}i.match(zt)&&(e._f+="Z"),G(e)}else e._isValid=!1}function Q(e){X(e),e._isValid===!1&&(delete e._isValid,vt.createFromInputFallback(e))}function Z(t){var n,i=t._i;i===e?t._d=new Date:x(i)?t._d=new Date(+i):null!==(n=At.exec(i))?t._d=new Date(+n[1]):"string"==typeof i?Q(t):b(i)?(t._a=i.slice(0),z(t)):"object"==typeof i?B(t):"number"==typeof i?t._d=new Date(i):vt.createFromInputFallback(t)}function et(e,t,n,i,a,s,o){var r=new Date(e,t,n,i,a,s,o);return 1970>e&&r.setFullYear(e),r}function tt(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function nt(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function it(e,t,n,i,a){return a.relativeTime(t||1,!!n,e,i)}function at(e,t,n){var i=vt.duration(e).abs(),a=_t(i.as("s")),s=_t(i.as("m")),o=_t(i.as("h")),r=_t(i.as("d")),l=_t(i.as("M")),c=_t(i.as("y")),d=dn.s>a&&["s",a]||1===s&&["m"]||dn.m>s&&["mm",s]||1===o&&["h"]||dn.h>o&&["hh",o]||1===r&&["d"]||dn.d>r&&["dd",r]||1===l&&["M"]||dn.M>l&&["MM",l]||1===c&&["y"]||["yy",c];return d[2]=t,d[3]=+e>0,d[4]=n,it.apply({},d)}function st(e,t,n){var i,a=n-t,s=n-e.day();return s>a&&(s-=7),a-7>s&&(s+=7),i=vt(e).add(s,"d"),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function ot(e,t,n,i,a){var s,o,r=tt(e,0,1).getUTCDay();return r=0===r?7:r,n=null!=n?n:a,s=a-r+(r>i?7:0)-(a>r?7:0),o=7*(t-1)+(n-a)+s+1,{year:o>0?e:e-1,dayOfYear:o>0?o:F(e-1)+o}}function rt(t){var n=t._i,i=t._f;return t._locale=t._locale||vt.localeData(t._l),null===n||i===e&&""===n?vt.invalid({nullInput:!0}):("string"==typeof n&&(t._i=n=t._locale.preparse(n)),vt.isMoment(n)?new c(n,!0):(i?b(i)?K(t):G(t):Z(t),new c(t)))}function lt(e,t){var n,i;if(1===t.length&&b(t[0])&&(t=t[0]),!t.length)return vt();for(n=t[0],i=1;t.length>i;++i)t[i][e](n)&&(n=t[i]);return n}function ct(e,t){var n;return"string"==typeof t&&(t=e.localeData().monthsParse(t),"number"!=typeof t)?e:(n=Math.min(e.date(),S(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e)}function dt(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function ut(e,t,n){return"Month"===t?ct(e,n):e._d["set"+(e._isUTC?"UTC":"")+t](n)}function ht(e,t){return function(n){return null!=n?(ut(this,e,n),vt.updateOffset(this,t),this):dt(this,e)}}function mt(e){return 400*e/146097}function pt(e){return 146097*e/400}function ft(e){vt.duration.fn[e]=function(){return this._data[e]}}function gt(e){"undefined"==typeof ender&&(wt=yt.moment,yt.moment=e?a("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",vt):vt)}for(var vt,wt,bt,xt="2.8.1",yt="undefined"!=typeof global?global:this,_t=Math.round,kt=0,Ct=1,Tt=2,St=3,Et=4,Ft=5,Pt=6,Dt={},Mt=[],Vt="undefined"!=typeof module&&module.exports,At=/^\/?Date\((\-?\d+)/i,Rt=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Nt=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,Ot=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,It=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,Ut=/\d\d?/,Lt=/\d{1,3}/,qt=/\d{1,4}/,Ht=/[+\-]?\d{1,6}/,$t=/\d+/,jt=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,zt=/Z|[\+\-]\d\d:?\d\d/gi,Bt=/T/i,Wt=/[\+\-]?\d+(\.\d{1,3})?/,Gt=/\d{1,2}/,Yt=/\d/,Jt=/\d\d/,Kt=/\d{3}/,Xt=/\d{4}/,Qt=/[+-]?\d{6}/,Zt=/[+-]?\d+/,en=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tn="YYYY-MM-DDTHH:mm:ssZ",nn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],an=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],sn=/([\+\-]|\d\d)/gi,on=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),rn={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},ln={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},cn={},dn={s:45,m:45,h:22,d:26,M:11},un="DDD w W M D d".split(" "),hn="M D H h m s w W".split(" "),mn={M:function(){return this.month()+1},MMM:function(e){return this.localeData().monthsShort(this,e)},MMMM:function(e){return this.localeData().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.localeData().weekdaysMin(this,e)},ddd:function(e){return this.localeData().weekdaysShort(this,e)},dddd:function(e){return this.localeData().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return p(this.year()%100,2)},YYYY:function(){return p(this.year(),4)},YYYYY:function(){return p(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+p(Math.abs(e),6)},gg:function(){return p(this.weekYear()%100,2)},gggg:function(){return p(this.weekYear(),4)},ggggg:function(){return p(this.weekYear(),5)},GG:function(){return p(this.isoWeekYear()%100,2)},GGGG:function(){return p(this.isoWeekYear(),4)},GGGGG:function(){return p(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return T(this.milliseconds()/100)},SS:function(){return p(T(this.milliseconds()/10),2)},SSS:function(){return p(this.milliseconds(),3)},SSSS:function(){return p(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+p(T(e/60),2)+":"+p(T(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+p(T(e/60),2)+p(T(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},pn={},fn=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];un.length;)bt=un.pop(),mn[bt+"o"]=r(mn[bt],bt);for(;hn.length;)bt=hn.pop(),mn[bt+bt]=o(mn[bt],2);mn.DDDD=o(mn.DDD,3),u(l.prototype,{set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,i;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(n=vt.utc([2e3,t]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=RegExp(i.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,i;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(n=vt([2e3,1]).day(t),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=RegExp(i.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,i){var a=this._relativeTime[n];return"function"==typeof a?a(e,t,n,i):a.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return st(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),vt=function(t,i,a,s){var o;return"boolean"==typeof a&&(s=a,a=e),o={},o._isAMomentObject=!0,o._i=t,o._f=i,o._l=a,o._strict=s,o._isUTC=!1,o._pf=n(),rt(o)},vt.suppressDeprecationWarnings=!1,vt.createFromInputFallback=a("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i)}),vt.min=function(){var e=[].slice.call(arguments,0);return lt("isBefore",e)},vt.max=function(){var e=[].slice.call(arguments,0);return lt("isAfter",e)},vt.utc=function(t,i,a,s){var o;return"boolean"==typeof a&&(s=a,a=e),o={},o._isAMomentObject=!0,o._useUTC=!0,o._isUTC=!0,o._l=a,o._i=t,o._f=i,o._strict=s,o._pf=n(),rt(o).utc()},vt.unix=function(e){return vt(1e3*e)},vt.duration=function(e,t){var n,i,a,s,o=e,r=null;return vt.isDuration(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(o={},t?o[t]=e:o.milliseconds=e):(r=Rt.exec(e))?(n="-"===r[1]?-1:1,o={y:0,d:T(r[Tt])*n,h:T(r[St])*n,m:T(r[Et])*n,s:T(r[Ft])*n,ms:T(r[Pt])*n}):(r=Nt.exec(e))?(n="-"===r[1]?-1:1,a=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*n},o={y:a(r[2]),M:a(r[3]),d:a(r[4]),h:a(r[5]),m:a(r[6]),s:a(r[7]),w:a(r[8])}):"object"==typeof o&&("from"in o||"to"in o)&&(s=g(vt(o.from),vt(o.to)),o={},o.ms=s.milliseconds,o.M=s.months),i=new d(o),vt.isDuration(e)&&e.hasOwnProperty("_locale")&&(i._locale=e._locale),i},vt.version=xt,vt.defaultFormat=tn,vt.ISO_8601=function(){},vt.momentProperties=Mt,vt.updateOffset=function(){},vt.relativeTimeThreshold=function(t,n){return dn[t]===e?!1:n===e?dn[t]:(dn[t]=n,!0)
},vt.lang=a("moment.lang is deprecated. Use moment.locale instead.",function(e,t){return vt.locale(e,t)}),vt.locale=function(t,n){var i;return t&&(i=e!==n?vt.defineLocale(t,n):vt.localeData(t),i&&(vt.duration._locale=vt._locale=i)),vt._locale._abbr},vt.defineLocale=function(e,t){return null!==t?(t.abbr=e,Dt[e]||(Dt[e]=new l),Dt[e].set(t),vt.locale(e),Dt[e]):(delete Dt[e],null)},vt.langData=a("moment.langData is deprecated. Use moment.localeData instead.",function(e){return vt.localeData(e)}),vt.localeData=function(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return vt._locale;if(!b(e)){if(t=R(e))return t;e=[e]}return A(e)},vt.isMoment=function(e){return e instanceof c||null!=e&&e.hasOwnProperty("_isAMomentObject")},vt.isDuration=function(e){return e instanceof d};for(bt=fn.length-1;bt>=0;--bt)C(fn[bt]);vt.normalizeUnits=function(e){return _(e)},vt.invalid=function(e){var t=vt.utc(0/0);return null!=e?u(t._pf,e):t._pf.userInvalidated=!0,t},vt.parseZone=function(){return vt.apply(null,arguments).parseZone()},vt.parseTwoDigitYear=function(e){return T(e)+(T(e)>68?1900:2e3)},u(vt.fn=c.prototype,{clone:function(){return vt(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=vt(this).utc();return 0<e.year()&&e.year()<=9999?U(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):U(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return M(this)},isDSTShifted:function(){return this._a?this.isValid()&&y(this._a,(this._isUTC?vt.utc(this._a):vt(this._a)).toArray())>0:!1},parsingFlags:function(){return u({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(e){return this.zone(0,e)},local:function(e){return this._isUTC&&(this.zone(0,e),this._isUTC=!1,e&&this.add(this._d.getTimezoneOffset(),"m")),this},format:function(e){var t=U(this,e||vt.defaultFormat);return this.localeData().postformat(t)},add:v(1,"add"),subtract:v(-1,"subtract"),diff:function(e,t,n){var i,a,s=N(e,this),o=6e4*(this.zone()-s.zone());return t=_(t),"year"===t||"month"===t?(i=432e5*(this.daysInMonth()+s.daysInMonth()),a=12*(this.year()-s.year())+(this.month()-s.month()),a+=(this-vt(this).startOf("month")-(s-vt(s).startOf("month")))/i,a-=6e4*(this.zone()-vt(this).startOf("month").zone()-(s.zone()-vt(s).startOf("month").zone()))/i,"year"===t&&(a/=12)):(i=this-s,a="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?(i-o)/864e5:"week"===t?(i-o)/6048e5:i),n?a:m(a)},from:function(e,t){return vt.duration({to:this,from:e}).locale(this.locale()).humanize(!t)},fromNow:function(e){return this.from(vt(),e)},calendar:function(e){var t=e||vt(),n=N(t,this).startOf("day"),i=this.diff(n,"days",!0),a=-6>i?"sameElse":-1>i?"lastWeek":0>i?"lastDay":1>i?"sameDay":2>i?"nextDay":7>i?"nextWeek":"sameElse";return this.format(this.localeData().calendar(a,this))},isLeapYear:function(){return P(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=nt(e,this.localeData()),this.add(e-t,"d")):t},month:ht("Month",!0),startOf:function(e){switch(e=_(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(e){return e=_(e),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")},isAfter:function(t,n){return n=e!==n?n:"millisecond",+this.clone().startOf(n)>+vt(t).startOf(n)},isBefore:function(t,n){return n=e!==n?n:"millisecond",+this.clone().startOf(n)<+vt(t).startOf(n)},isSame:function(e,t){return t=t||"ms",+this.clone().startOf(t)===+N(e,this).startOf(t)},min:a("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(e){return e=vt.apply(null,arguments),this>e?this:e}),max:a("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(e){return e=vt.apply(null,arguments),e>this?this:e}),zone:function(e,t){var n,i=this._offset||0;return null==e?this._isUTC?i:this._d.getTimezoneOffset():("string"==typeof e&&(e=H(e)),Math.abs(e)<16&&(e=60*e),!this._isUTC&&t&&(n=this._d.getTimezoneOffset()),this._offset=e,this._isUTC=!0,null!=n&&this.subtract(n,"m"),i!==e&&(!t||this._changeInProgress?w(this,vt.duration(i-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,vt.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?vt(e).zone():0,(this.zone()-e)%60===0},daysInMonth:function(){return S(this.year(),this.month())},dayOfYear:function(e){var t=_t((vt(this).startOf("day")-vt(this).startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},quarter:function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},weekYear:function(e){var t=st(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")},isoWeekYear:function(e){var t=st(this,1,4).year;return null==e?t:this.add(e-t,"y")},week:function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},isoWeek:function(e){var t=st(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},weekday:function(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return E(this.year(),1,4)},weeksInYear:function(){var e=this.localeData()._week;return E(this.year(),e.dow,e.doy)},get:function(e){return e=_(e),this[e]()},set:function(e,t){return e=_(e),"function"==typeof this[e]&&this[e](t),this},locale:function(t){return t===e?this._locale._abbr:(this._locale=vt.localeData(t),this)},lang:a("moment().lang() is deprecated. Use moment().localeData() instead.",function(t){return t===e?this.localeData():(this._locale=vt.localeData(t),this)}),localeData:function(){return this._locale}}),vt.fn.millisecond=vt.fn.milliseconds=ht("Milliseconds",!1),vt.fn.second=vt.fn.seconds=ht("Seconds",!1),vt.fn.minute=vt.fn.minutes=ht("Minutes",!1),vt.fn.hour=vt.fn.hours=ht("Hours",!0),vt.fn.date=ht("Date",!0),vt.fn.dates=a("dates accessor is deprecated. Use date instead.",ht("Date",!0)),vt.fn.year=ht("FullYear",!0),vt.fn.years=a("years accessor is deprecated. Use year instead.",ht("FullYear",!0)),vt.fn.days=vt.fn.day,vt.fn.months=vt.fn.month,vt.fn.weeks=vt.fn.week,vt.fn.isoWeeks=vt.fn.isoWeek,vt.fn.quarters=vt.fn.quarter,vt.fn.toJSON=vt.fn.toISOString,u(vt.duration.fn=d.prototype,{_bubble:function(){var e,t,n,i=this._milliseconds,a=this._days,s=this._months,o=this._data,r=0;o.milliseconds=i%1e3,e=m(i/1e3),o.seconds=e%60,t=m(e/60),o.minutes=t%60,n=m(t/60),o.hours=n%24,a+=m(n/24),r=m(mt(a)),a-=m(pt(r)),s+=m(a/30),a%=30,r+=m(s/12),s%=12,o.days=a,o.months=s,o.years=r},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return m(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*T(this._months/12)},humanize:function(e){var t=at(this,!e,this.localeData());return e&&(t=this.localeData().pastFuture(+this,t)),this.localeData().postformat(t)},add:function(e,t){var n=vt.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=vt.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=_(e),this[e.toLowerCase()+"s"]()},as:function(e){var t,n;if(e=_(e),t=this._days+this._milliseconds/864e5,"month"===e||"year"===e)return n=this._months+12*mt(t),"month"===e?n:n/12;switch(t+=pt(this._months/12),e){case"week":return t/7;case"day":return t;case"hour":return 24*t;case"minute":return 24*t*60;case"second":return 24*t*60*60;case"millisecond":return 24*t*60*60*1e3;default:throw Error("Unknown unit "+e)}},lang:vt.fn.lang,locale:vt.fn.locale,toIsoString:a("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),i=Math.abs(this.hours()),a=Math.abs(this.minutes()),s=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(i||a||s?"T":"")+(i?i+"H":"")+(a?a+"M":"")+(s?s+"S":""):"P0D"},localeData:function(){return this._locale}});for(bt in on)on.hasOwnProperty(bt)&&ft(bt.toLowerCase());vt.duration.fn.asMilliseconds=function(){return this.as("ms")},vt.duration.fn.asSeconds=function(){return this.as("s")},vt.duration.fn.asMinutes=function(){return this.as("m")},vt.duration.fn.asHours=function(){return this.as("h")},vt.duration.fn.asDays=function(){return this.as("d")},vt.duration.fn.asWeeks=function(){return this.as("weeks")},vt.duration.fn.asMonths=function(){return this.as("M")},vt.duration.fn.asYears=function(){return this.as("y")},vt.locale("en",{ordinal:function(e){var t=e%10,n=1===T(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),Vt?module.exports=vt:"function"==typeof define&&define.amd?(define("moment",["require","exports","module"],function(e,t,n){return n.config&&n.config()&&n.config().noGlobal===!0&&(yt.moment=wt),vt}),gt(!0)):gt()}.call(this),function(e,t){"object"==typeof module&&module.exports&&"function"==typeof require?module.exports=t():"function"==typeof define&&"object"==typeof define.amd?define("loglevel",t):e.log=t()}(this,function(){function e(e){return typeof console===l?!1:void 0!==console[e]?t(console,e):void 0!==console.log?t(console,"log"):r}function t(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(i){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function n(e,t){return function(){typeof console!==l&&(i(t),o[e].apply(o,arguments))}}function i(e){for(var t=0;c.length>t;t++){var n=c[t];o[n]=e>t?r:o.methodFactory(n,e)}}function a(e){var t=(c[e]||"silent").toUpperCase();try{return void(window.localStorage.loglevel=t)}catch(n){}try{window.document.cookie="loglevel="+t+";"}catch(n){}}function s(){var e;try{e=window.localStorage.loglevel}catch(t){}if(typeof e===l)try{e=/loglevel=([^;]+)/.exec(window.document.cookie)[1]}catch(t){}void 0===o.levels[e]&&(e="WARN"),o.setLevel(o.levels[e],!1)}var o={},r=function(){},l="undefined",c=["trace","debug","info","warn","error"];o.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},o.methodFactory=function(t,i){return e(t)||n(t,i)},o.setLevel=function(e,t){if("string"==typeof e&&void 0!==o.levels[e.toUpperCase()]&&(e=o.levels[e.toUpperCase()]),!("number"==typeof e&&e>=0&&o.levels.SILENT>=e))throw"log.setLevel() called with invalid level: "+e;return t!==!1&&a(e),i(e),typeof console===l&&o.levels.SILENT>e?"No console available for logging":void 0},o.enableAll=function(e){o.setLevel(o.levels.TRACE,e)},o.disableAll=function(e){o.setLevel(o.levels.SILENT,e)};var d=typeof window!==l?window.log:void 0;return o.noConflict=function(){return typeof window!==l&&window.log===o&&(window.log=d),o},s(),o}),define("core/strings",["loglevel"],function(e){var t={translations:{}};return t.get=function(e){var n=t.translations[e];return void 0!==n?n:e},t.interpolate=function(t,n){function i(i){var a="";return i in n?a=void 0!==n[i]&&null!==n[i]?""+n[i]:"":e.error("Key `"+i+"` not found in context for: ",t),a}return t.replace(/%\(\w+\)s/g,function(e){return i(e.slice(2,-2))})},t}),define("core/config/urls",[],function(){return{jester:"https://referrer."+document.location.host+"/juggler",cdn:void 0}}),define("core/extensions/handlebars.helpers",["handlebars","moment","core/strings","core/config/urls"],function(e,t,n,i){var a=e.Utils;return e.registerHelper("any",function(){for(var e=arguments.length,t=0;e-1>t;t++)if(arguments[t])return arguments[t]}),e.registerHelper("eq",function(e,t){return e===t}),e.registerHelper("ne",function(e,t){return e!==t}),e.registerHelper("gt",function(e,t){return e>t}),e.registerHelper("lt",function(e,t){return t>e}),e.registerHelper("ge",function(e,t){return e>=t}),e.registerHelper("le",function(e,t){return t>=e}),e.registerHelper("typeof",function(e,t){return typeof e===t}),e.registerHelper("notNull",function(e){return null!==e}),e.registerHelper("if_any",function(){for(var e=arguments.length,t=arguments[e-1],n=0;e-1>n;n++)if(arguments[n])return t.fn(this);return t.inverse(this)}),e.registerHelper("if_all",function(){for(var e=arguments.length,t=arguments[e-1],n=0;e-1>n;n++)if(!arguments[n])return t.inverse(this);return t.fn(this)}),e.registerHelper("getPartial",function(t,n,i){return void 0===i&&(i=n,n=this,e.Utils.extend(n,i.hash)),new e.SafeString(e.partials[t](n,i))}),e.registerHelper("gettext",function(){var t,i,s,o,r=arguments.length,l=arguments[r-1],c=l.hash,d=arguments[0],u=e.partials;d=n.get(d);for(s in c)c.hasOwnProperty(s)&&(i=RegExp("%\\(("+s+")\\)s","gm"),t=c[s],o=t&&t.executePartial,o&&(t=u[t.partial].call(this,t.context,l)),void 0===t||null===t||"number"==typeof t&&isNaN(t)?t="":o||(t=a.escapeExpression(t)),d=d.replace(i,""+t));return new e.SafeString(d)}),e.registerHelper("urlfor",function(e){for(var t=e.split("."),n=t.length,a=i,s=0;a.hasOwnProperty(t[s])&&n>s;)a=a[t[s]],s++;return a}),e.registerHelper("html",function(t){return new e.SafeString(t||"")}),e.registerHelper("partial",function(t,n){e.registerPartial(t,n.fn)}),e.registerHelper("with",function(){var e=arguments.length,t=arguments[e-1],n=arguments[0];return 3===e?(n={},n[arguments[0]]=arguments[1]):"_window_"===n&&(n=window),t.fn(n)}),e.registerHelper("each",function(t,n){var i,a=n.fn,s=n.inverse,o=0,r="";if(n.data&&(i=e.createFrame(n.data)),t&&"object"==typeof t)if("[object Array]"===Object.prototype.toString.call(t))for(var l=t.length;l>o;o++)i&&(i.index=o,i.length=t.length),r+=a(t[o],{data:i});else for(var c in t)t.hasOwnProperty(c)&&(i&&(i.key=c),r+=a(t[c],{data:i}),o++);return 0===o&&(r=s(this)),r}),e.registerHelper("log",function(e){window.console.log(e,this)}),e.registerHelper("debug",function(){}),e.registerHelper("geturl",function(e){return e}),e.registerHelper("truncate",function(t,n){return n>=t.length?t:new e.SafeString(a.escapeExpression(t.slice(0,n))+"&hellip;")}),e.registerHelper("tag",function(t,n){var i=["<"+t],a=n.hash.text;delete n.hash.text;for(var s in n.hash)n.hash.hasOwnProperty(s)&&i.push(" "+s+'="'+n.hash[s]+'"');return i.push(">"+a+"</"+t+">"),new e.SafeString(i.join(""))}),e.registerHelper("now",function(e){return t().format(e)}),e}),define("home/templates/preload",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return"<p></p>\n"},useData:!0})}),define("core/utils/urls",[],function(){var e={},t=document.createElement("a");return e.getOrigin=function(e){t.href=e;var n=t.href.split("/");return n[0]+"//"+n[2]},e.getHostName=function(e){return t.href=e,t.hostname},e}),define("core/frameBus",["jquery","underscore","backbone","core/utils/urls"],function(e,t,n,i){function a(e){return e.hash.slice(1).replace(/(^\d+).*/,"$1")}var s=a(window.location),o=window.opener||window.parent,r=document.referrer,l={};l.client=i.getOrigin(document.location.href),l.host=r?i.getOrigin(r):l.client;var c={getUID:a,origins:l,messageHandler:function(e){e=e.originalEvent;var t;try{t=JSON.parse(e.data)}catch(n){return}if(!t.name||"!"!==t.name[0]||e.origin===l.client)switch(t.scope){case"host":break;case"client":c.trigger(t.name,t.data)}},postMessage:function(e){e.sender=s,e=JSON.stringify(e),o.postMessage(e,"*")},sendHostMessage:function(e,t){t=t||[],c.postMessage({scope:"host",name:e,data:t})}};return t.extend(c,n.Events),e(window).on("message",c.messageHandler),e(window).on("unload",function(){c.sendHostMessage("die")}),window.DISQUS=window.DISQUS||{},window.DISQUS.Bus=c,c}),define("core/bus",["backbone","underscore","core/frameBus"],function(e,t,n){var i=t.extend({},e.Events);return i.frame=n,i}),define("core/utils/html",["jquery","underscore"],function(e,t){var n=function(){var n=e("<div>");return t.bind(n.html,n)}(),i=/<\/?p>|<br\/?>/gi;return{stripTags:function(t){return t=t.replace(i," ").replace(/<[\/\w!\[][^>]*>/g,"​"),e.trim(n(t).text().replace(/\u200b/g,""))},replaceAnchors:function(e,n){var i;try{i=(new DOMParser).parseFromString(e,"text/html")}catch(a){}return i||(i=document.implementation.createHTMLDocument(""),i.body.innerHTML=e),t.each(i.querySelectorAll("a"),function(e){var t=e.getAttribute("href")||"",i=e.innerHTML,a=n(e);0===t.indexOf(i.slice(0,-3))?i=a:t.length&&-1!==i.indexOf(t)?i=i.replace(t,a):i+=" "+a,e.insertAdjacentHTML("afterend",i),e.parentNode.removeChild(e)}),i.body.innerHTML.trim()}}}),define("core/utils/metatags",["jquery","underscore","backbone","core/utils/html","core/strings"],function(e,t,n,i,a){var s=a.get,o={type:['property="og:type"'],title:['property="og:title"','name="twitter:title"'],description:['name="twitter:description"','property="og:description"','name="description"'],image:['property="og:image"','name="twitter:image"'],url:['property="og:url"','name="twitter:url"'],_card:['name="twitter:card"']},r=function(e){return 0===e.indexOf("//")&&(e="https:"+e),e},l={type:1,title:"Disqus",description:s("The web's community of communities now has one central hub."),image:r("//a.disquscdn.com/home/current/img/brand/favicon-192x192.png"),url:"https://disqus.com/",_card:"summary"},c=t.extend({DEFAULTS:l,META_TAGS:o,set:function(n){n=n||{},t.isString(n)&&(n={title:n}),n.title&&(n.title=i.stripTags(n.title)),n.title&&(n.title=n.title+" · Disqus"),n.url||(n.url=(document.location+"").split("?")[0]),n.url=r(n.url),n.image&&(n.image=r(n.image)),n.description&&(n.description=i.stripTags(n.description));var a=e("head");t.each(o,function(i,s){t.each(i,function(t){var i=a.find("["+t+"]");i.length||(i=e("<meta "+t+">"),a.append(i)),i.attr("content",n[s]||l[s])})}),document.title=n.title||l.title,c.trigger("change:metatags")}},n.Events);return c}),define("core/config",[],function(){return{urls:{avatar:{generic:"//a.disquscdn.com/current/images/noavatar92.png"},api:"//disqus.com/api/3.0/",apiSecure:"https://disqus.com/api/3.0/",apiSettings:"https://disqus.com/users/self/",oauth:{twitter:"https://disqus.com/_ax/twitter/begin/",google:"https://disqus.com/_ax/google/begin/",facebook:"https://disqus.com/_ax/facebook/begin/"},oauthDestroy:function(e){return"https://disqus.com/_ax/"+e+"/unmerge/"},oauthStatus:function(e){return"https://disqus.com/_ax/"+e+"/merged/"},userDelete:"https://disqus.com/auth/json/user_delete/",verifyEmail:"https://disqus.com/next/verify/"},keys:{api:"E8Uh5l5fHZ6gD8U3KycjAIAk46f68Zw7C6eW8WSjZvCLXebZ7p0r1yrYDrLilk2F"},apiVersion:"3",debug:!1}}),define("core/utils",["underscore","core/config"],function(e,t){function n(e){function t(e){return e=(+e).toString(16),1===e.length?"0"+e:e}if("#"===e.substr(0,1))return e;var n=/.*?rgb\((\d+),\s*(\d+),\s*(\d+)\)/.exec(e);if(!n||4!==n.length)return"";var i=t(n[1]),a=t(n[2]),s=t(n[3]);return"#"+i+a+s}function i(e){return n(e).replace(/[^#A-Fa-f0-9]/g,"")}function a(e){return function(t){return t&&t.preventDefault&&t.preventDefault(),e.apply(this,arguments)}}function s(e){return function(t){return t&&t.stopPropagation&&t.stopPropagation(),e.apply(this,arguments)}}function o(e){return a(s(e))}function r(e){if(!e)return"";e="http://"+e.replace(/^([a-z+.-]+:)?\/+/i,"");var t=document.createElement("a");t.href=e;var n=t.hostname.replace(/^www\d*\./i,"");return n=n.toLowerCase()}function l(t){var n=[];return e.each(t,function(e,t){void 0!==e&&n.push(t+(null!==e?"="+encodeURIComponent(e):""))}),n.join("&")}function c(e,t,n){if(t&&(-1===e.indexOf("?")?e+="?":"&"!==e.charAt(e.length-1)&&(e+="&"),e+=this.serializeArgs(t)),n){var i={};return i[(new Date).getTime()]=null,this.serialize(e,i)}var a=e.length;return"&"===e.charAt(a-1)?e.slice(0,a-1):e}function d(t,n,i){i?e.extend(i,{location:1,status:1,resizable:1,scrollbars:1}):i={},i.width&&i.height&&e.defaults(i,{left:window.screen.width/2-i.width/2,top:window.screen.height/2-i.height/2});var a=e.map(i,function(e,t){return t+"="+e}).join(",");return window.open(t,n,a)}function u(){return e.reduce(document.location.search.substr(1).split("&"),function(e,t){var n=t.split("=").map(decodeURIComponent);return n[0]&&(e[n[0]]=n[1]),e},{})}function h(e,t,n){0>t&&(t=0);var i=e.substring(0,t),a=e.substring(t);return i.length&&!/\s$/.test(i)&&(i+=" "),/^\s/.test(a)||(a=" "+a),i+n+a}var m=/^[a-zA-Z0-9.!#$%&'*+-\/=?\^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,p=function(e){return m.test(e)},f=t.TLDS||"zw|zuerich|zone|zm|zip|za|yt|youtube|yokohama|yoga|yodobashi|ye|yandex|yachts|xyz|xxx|xin|xerox|wtf|wtc|ws|world|works|work|wme|win|williamhill|wiki|wien|whoswho|wf|weir|wedding|wed|website|webcam|watch|wang|wales|vu|voyage|voto|voting|vote|vodka|vn|vlaanderen|vision|villas|video|viajes|vi|vg|vet|versicherung|ventures|vegas|ve|vc|vacations|va|uz|uy|us|uol|uno|university|uk|ug|ua|tz|tw|tv|tui|tt|trust|travel|training|trading|trade|tr|toys|town|tours|toshiba|toray|top|tools|tokyo|today|to|tn|tm|tl|tk|tj|tirol|tires|tips|tienda|tickets|theater|th|tg|tf|tennis|temasek|tel|technology|tech|team|td|tc|taxi|tax|tattoo|tatar|taipei|sz|systems|sydney|sy|sx|swiss|sv|suzuki|surgery|surf|support|supply|supplies|sucks|su|style|study|st|sr|spreadbetting|spiegel|space|soy|sony|solutions|solar|sohu|software|social|so|sn|sm|sl|sky|sk|sj|site|singles|si|shriram|show|shoes|shiksha|sh|sg|sexy|sex|sew|services|sener|seat|se|sd|scot|science|schwarz|schule|school|scholarships|schmidt|scb|sca|sc|sb|saxo|sarl|sap|samsung|sale|saarland|sa|ryukyu|rw|run|ruhr|ru|rsvp|rs|rodeo|rocks|ro|rip|rio|rich|reviews|review|restaurant|rest|republican|report|repair|rentals|rent|ren|reit|reisen|reise|rehab|redstone|red|recipes|realtor|re|racing|quebec|qpon|qa|py|pw|pub|pt|ps|property|properties|prof|productions|prod|pro|press|praxi|pr|post|porn|poker|pohl|pn|pm|plus|plumbing|place|pl|pk|pizza|pink|pictures|pictet|pics|piaget|physio|photos|photography|photo|philips|pharmacy|ph|pg|pf|pe|party|parts|partners|paris|panerai|page|pa|ovh|otsuka|osaka|organic|org|oracle|ooo|online|onl|ong|one|om|okinawa|nz|nyc|nu|ntt|nrw|nra|nr|np|no|nl|nissan|ninja|nico|ni|nhk|ngo|ng|nf|nexus|news|new|neustar|network|net|nec|ne|nc|navy|name|nagoya|nadex|na|mz|my|mx|mw|mv|museum|mu|mtpc|mtn|mt|ms|mr|mq|mp|movie|mov|motorcycles|moscow|mortgage|mormon|money|monash|moe|moda|mobi|mo|mn|mma|mm|ml|mk|mini|mil|miami|mh|mg|menu|memorial|meme|melbourne|meet|media|me|md|mc|marriott|markets|marketing|market|mango|management|maison|maif|madrid|ma|ly|lv|luxury|luxe|lu|ltda|lt|ls|lr|love|lotto|lotte|london|lol|loans|loan|lk|link|limo|limited|lighting|life|lidl|liaison|li|lgbt|legal|leclerc|lease|lds|lc|lb|lawyer|latrobe|lat|land|lacaixa|la|kz|kyoto|ky|kw|kred|krd|kr|kp|komatsu|koeln|kn|km|kiwi|kitchen|kim|ki|kh|kg|ke|kddi|kaufen|juegos|jp|joburg|jobs|jo|jm|jewelry|jetzt|je|jcb|java|iwc|it|is|irish|ir|iq|io|investments|international|int|insure|institute|ink|ing|info|infiniti|industries|in|immobilien|immo|im|il|ifm|ie|id|icu|ibm|hu|ht|hr|how|house|hosting|host|horse|honda|homes|holiday|holdings|hockey|hn|hm|hk|hiv|hitachi|hiphop|hermes|here|help|healthcare|haus|hangout|hamburg|gy|gw|guru|guitars|guide|guge|gu|gt|gs|gripe|green|gratis|graphics|gr|gq|gp|gov|gop|google|goog|goo|golf|goldpoint|gold|gn|gmx|gmo|gmail|gm|globo|global|gle|glass|gl|gives|gifts|gift|gi|gh|ggee|gg|gf|gent|ge|gdn|gd|gbiz|gb|garden|gallery|gal|ga|futbol|furniture|fund|frogans|frl|fr|foundation|forsale|forex|football|foo|fo|fm|fly|flsmidth|flowers|florist|flights|fk|fj|fitness|fit|fishing|fish|firmdale|financial|finance|film|fi|feedback|fashion|farm|fans|fan|faith|fail|express|exposed|expert|exchange|everbank|events|eus|eurovision|eu|et|estate|esq|es|erni|er|equipment|epson|enterprises|engineering|engineer|energy|emerck|email|eg|ee|education|edu|ec|eat|dz|dvag|durban|download|doosan|domains|doha|dog|docs|do|dnp|dm|dk|dj|discount|directory|direct|digital|diet|diamonds|dev|design|desi|dentist|dental|democrat|delivery|degree|deals|de|dclk|day|datsun|dating|date|dance|dad|dabur|cz|cyou|cymru|cy|cx|cw|cv|cuisinella|cu|cruises|crs|cricket|creditcard|credit|cr|courses|country|coop|cool|cooking|contractors|consulting|construction|condos|computer|company|community|com|cologne|college|coffee|codes|coach|co|cn|cm|club|clothing|clinic|click|cleaning|claims|cl|ck|city|citic|ci|church|chrome|christmas|chloe|cheap|chat|channel|ch|cg|cfd|cfa|cf|cern|ceo|center|cd|cc|cbn|catering|cat|casino|cash|casa|cartier|cars|careers|career|care|cards|caravan|capital|capetown|canon|cancerresearch|camp|camera|cal|cafe|cab|ca|bzh|bz|by|bw|bv|buzz|business|builders|build|budapest|bt|bs|brussels|brother|broker|bridgestone|br|boutique|boo|bond|boats|bo|bnpparibas|bn|bmw|bm|blue|bloomberg|blackfriday|black|bj|biz|bio|bingo|bike|bid|bi|bh|bg|bf|best|berlin|beer|be|bd|bbc|bb|bayern|bauhaus|bargains|barclays|barclaycard|bar|bank|band|ba|az|axa|ax|aw|autos|auto|audio|auction|au|attorney|at|associates|asia|as|arpa|army|archi|ar|aquarelle|aq|apartments|ao|android|an|amsterdam|am|alsace|allfinanz|al|airforce|aig|ai|agency|ag|afl|af|aero|ae|adult|ads|ad|actor|active|accountants|accountant|accenture|academy|ac|abogado|abbott|abb",g=RegExp("([^@.]|^)\\b(?:\\w[\\w-]*:/{0,3}(?:(?:\\w+:)?\\w+@)?)?([\\w-]+\\.)+(?:"+f+')(?!\\.\\w)\\b(?::\\d+)?(?:[/?][^\\s\\{\\}\\|\\\\\\^\\[\\]`<>"\\x80-\\xFF\\x00-\\x1F\\x7F]*)?',"g"),v=function(e){return!!e.match(g)},w=/^[\w-]+:\/{0,3}/,b=/([\.,]+)$/g,x=function(e){var t,n,i,a,s,o=[];if(!e)return o;for(;t=g.exec(e);){n=t[0],s=t[1],n=n.slice(s.length),b.lastIndex=0,i=b.exec(n),i&&(n=n.slice(0,n.length-i[0].length)),a=w.test(n)?n:"http://"+n;var r=t.index+s.length;o.push({text:n,url:a,index:r,endIndex:r+n.length})}return o},y=RegExp("[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u00A1-\\u00BF\\u2010-\\u2027\\u2030-\\u205E\\u2300-\\u23FF\\u2E00-\\u2E7F\\u3001-\\u303F\\uFE10-\\uFE19\\uFE30-\\uFE4F\\uFE50-\\uFE6B\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60\\uFF5F-\\uFF64]+$"),_=function(e,t){if(t>=e.length)return e;e=e.slice(0,t-1);var n=e,i=/(^.*\S)\s/.exec(e);i&&(e=i[1]);var a=y.exec(e);return a&&(e=e.slice(0,e.length-a[0].length)),.5*n.length>e.length&&(e=n),e+"…"},k=function(){var e=document.createElement("fakeelement");return function(t,n){return void 0!==e.style[n]}}(),C=function(){var t={transition:"transitionend",OTransition:"otransitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};return e.find(t,k)||null}(),T=function(){var t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};return e.find(t,k)||null}(),S=function(e){return e=e||window,/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/i.test(e.navigator.userAgent||e.navigator.vendor||e.opera)};return{validateEmail:p,isUrl:v,bleachFindUrls:x,niceTruncate:_,transitionEndEvent:C,animationEndEvent:T,isMobileUserAgent:S,escapeColor:i,preventDefaultHandler:a,stopPropagationHandler:s,stopEventHandler:o,getDomain:r,serializeArgs:l,serialize:c,openWindow:d,getQueryParams:u,insertWithWhitespace:h}}),define("core/api",["jquery","underscore","backbone","core/config","core/utils"],function(e,t,n,i,a){function s(e){return p.href=e,t.pick(p,"hostname","protocol","port")}function o(e){return v.xhrSupportsCredentialedRequests?!1:r(window.location,e.url)}function r(e,t){var n=s(e),i=s(t),a=window.location.protocol;return":"===n.protocol&&(n.protocol=a),":"===i.protocol&&(i.protocol=a),i.protocol!==n.protocol||i.hostname!==n.hostname||i.port!==n.port}function l(e){return'<iframe name="'+e+'"></iframe>'}function c(n){function a(t){var r=t.originalEvent.origin;if(i.urls.apiSecure.slice(0,r.length)===r){var c=JSON.parse(t.originalEvent.data);if(c.requestId===o){var d;0===c.code?(u.resolve(c),d=n.success):(u.reject(c),d=n.error),d=d||function(){},delete c.requestId,d(c),document.body.removeChild(s),document.body.removeChild(l),e(window).off("message",a)}}}n=t.defaults(n,f),n.secure&&(n.url=d(n.url));var s,o=t.uniqueId("ft_"),r=document.createElement("div"),l=document.createElement("form"),c="frame_"+o,u=new e.Deferred;return r.innerHTML=v.getIframe(c),s=r.childNodes[0],l.target=c,l.action=n.url.replace(".json",".pm"),l.method=n.method||"GET",n.data=t.extend(n.data,{callback:o,referrer:document.referrer}),t.each(n.data,function(e,n){e===!0?e=[1]:e===!1?e=[0]:null===e?e=[""]:t.isArray(e)||(e=[e]),t.each(e,function(e){var t=document.createElement("input");t.type="hidden",t.name=n,t.value=e,l.appendChild(t)})}),e(window).on("message",a),document.body.appendChild(s),document.body.appendChild(l),l.submit(),u.promise()}function d(e){return e.replace(/^(http\:)?\/\//,"https://")}function u(n){n=t.defaults(n,f),n.secure&&(n.url=d(n.url)),n.traditional=!0;var s=window.location;p.href=n.url,(s.host!==p.host||s.protocol!==p.protocol)&&(n.xhrFields={withCredentials:!0}),n.omitDisqusApiKey||(n.data=n.data||{},window.FormData&&n.data instanceof window.FormData?n.url=a.serialize(n.url,{api_key:i.keys.api}):n.data.api_key=i.keys.api);var o=n.error;return n.error=function(e){v.trigger("error",e),t.isFunction(o)&&o(e)},e.ajax(n)}function h(e,n){n=n||{},n.url=m(e,{secure:n.secure}),n.data=t.extend(n.data||{},{api_key:i.keys.api}),v.trigger("call",n);var a=(o(n)?c:u)(n);return a&&a.always(t.bind(this.trigger,this,"complete",n)),a}function m(e,t){return t=t||{},/(https?\:)?\/\//.test(e)?e:(void 0!==t.secure?t.secure:f.secure)||"https:"===window.location.protocol?i.urls.apiSecure+e:i.urls.api+e}var p=document.createElement("a"),f={},g="withCredentials"in new XMLHttpRequest,v={ajax:u,call:h,getURL:m,defaults:function(e){var n,i,a;for(n in e)i=e[n],a=f[n],t.isObject(i)&&t.isObject(a)?t.extend(a,i):f[n]=i},headers:function(e){var n=t.extend({},f.headers,e);return f.headers=t.pick(n,Boolean)},useFormTransport:o,xhrSupportsCredentialedRequests:g,makeHttps:d,formTransport:c,getIframe:l};return t.extend(v,n.Events),v}),define("core/utils/cookies",[],function(){var e={getCookieDomain:function(e){return e.split("/")[2].replace(/\:[0-9]+/,"")},deprecated:{create:function(t,n){var i=31536e6;e.create(t,n,{domain:e.getCookieDomain(window.location+""),expiresIn:i})},erase:function(t){e.erase(t,{domain:e.getCookieDomain(window.location+"")})}},create:function(e,t,n){var i,a=e+"="+t+"; path="+(n.path||"/");n.domain&&(a+="; domain=."+n.domain),n.expiresIn&&(i=new Date,i.setTime(i.getTime()+n.expiresIn),a+="; expires="+i.toGMTString()),document.cookie=a},read:function(e){for(var t,n=e+"=",i=document.cookie.split(";"),a=0;i.length>a;a++){for(t=i[a];" "===t.charAt(0);)t=t.substring(1,t.length);
if(0===t.indexOf(n))return t.substring(n.length,t.length)}return null},erase:function(e,t){var n,i=new Date;i.setTime(i.getTime()+-864e5),n=e+"=; path=/;expires="+i.toGMTString(),t.domain&&(n+="; domain=."+t.domain),document.cookie=n}};return e}),define("core/time",[],function(){function e(e){return e.indexOf("+")>=0?e:e+"+00:00"}var t="YYYY-MM-DDTHH:mm:ssZ";return{ISO_8601:t,assureTzOffset:e}}),define("core/utils/fingerprint",[],function(){function e(){try{var e=(new Date).getTimezoneOffset(),t=1,n=window.screen;n&&n.availWidth?t=n.availWidth*n.availHeight+n.colorDepth:n&&n.width&&(t=n.width*n.height);var i=document.documentElement,a=i.clientWidth*i.clientHeight;return Math.abs(17*e+25*t-a)}catch(s){return 1}}return{get:e}}),define("core/utils/guid",["core/utils/fingerprint"],function(e){function t(){try{var e=new Uint32Array(1);return window.crypto.getRandomValues(e)[0]}catch(t){return Math.floor(1e9*Math.random())}}function n(){if(window.performance&&window.performance.timing){var e=window.performance.timing,t=e.domainLookupEnd-e.domainLookupStart,n=e.connectEnd-e.connectStart,i=e.responseStart-e.navigationStart;return 11*t+13*n+17*i}return 1e5}function i(){var i=+(""+(new Date).getTime()).substring(3),a=Math.abs(i+n()-e.get()).toString(32);return a+=t().toString(32)}return{generate:i}}),define("core/models/BaseUser",["backbone","core/config"],function(e,t){var n=e.Model.extend({defaults:{about:null,avatar:{cache:t.urls.avatar.generic,permalink:t.urls.avatar.generic},connections:{},email:null,isAnonymous:!0,isFollowedBy:null,isFollowing:null,joinedAt:null,name:null,profileUrl:null,url:null,username:null,numPosts:null,numFollowing:null,numForumsFollowing:null,numFollowers:null,numLikesReceived:null},hasValidAvatar:function(e){var t=e?e.avatar:this.get("avatar");return t&&t.cache},isAnonymous:function(){return!this.get("id")},isRegistered:function(){return!this.isAnonymous()},validate:function(e){return this.hasValidAvatar(e)?void 0:"None of the avatar related properties can be null, undefined or empty on User models."},toJSON:function(){var t=e.Model.prototype.toJSON.apply(this,arguments);return t.thread={},this.hasValidAvatar()||(t.avatar=this.defaults.avatar),t.isRegistered=this.isRegistered(),t}});return n}),define("core/models/User",["jquery","underscore","backbone","moment","core/config","core/time","core/utils","core/strings","core/api","core/models/BaseUser"],function(e,t,n,i,a,s,o,r,l,c){function d(e,t,n){e[t]=e[t]||[],e[t].push(n)}var u=r.get,h=c.extend({url:l.getURL("users/details"),validate:function(n){var i={};return n.display_name&&(n.display_name=e.trim(n.display_name)),n.display_name||d(i,"display_name",u("Please enter your name.")),n.email||d(i,"email",u("Please enter your email address.")),o.validateEmail(n.email)||d(i,"email",u("Invalid email address.")),this.isNew()&&(n.password?h.MIN_PASSWORD_LEN>n.password.length&&d(i,"password",u("Password must have at least 6 characters.")):d(i,"password",u("Please enter a password."))),n.name&&(h.MIN_NAME_LEN>n.name.length&&d(i,"name",r.interpolate(u("Name must have at least %(minLength)s characters."),{minLength:h.MIN_NAME_LEN})),n.name.length>h.MAX_NAME_LEN&&d(i,"name",r.interpolate(u("Name must have less than %(maxLength)s characters."),{maxLength:h.MAX_NAME_LEN}))),n.location&&n.location.length>h.MAX_LOCATION_LEN&&d(i,"location",r.interpolate(u("Location must have less than %(maxLength)s characters."),{maxLength:h.MAX_LOCATION_LEN})),n.url&&(n.url.length>h.MAX_URL_LEN&&d(i,"url",r.interpolate(u("Site must have less than %(maxLength)s characters."),{maxLength:h.MAX_URL_LEN})),o.isUrl(n.url)||d(i,"url",u("Please enter a valid site."))),t.isEmpty(i)?void 0:i},prepareFetchOptions:function(e){e=e?t.clone(e):{};var n={};return this.get("id")?n.user=this.get("id"):this.get("username")&&(n.user="username:"+this.get("username")),t.extend(n,e.data),e.data=n,e},fetch:function(e){return e=this.prepareFetchOptions(e),c.prototype.fetch.call(this,e)},parse:function(e){return e.response||e},register:function(e){var t=this;return e=e||{},l.call("internal/users/register.json",{secure:!0,data:this.toRegisterJSON(),method:"POST",success:function(n){t.set(n.response),e.success&&e.success(n)},error:e.error})},saveAvatar:function(e){var t=new FormData;return t.append("avatar_file",e),t.append("api_key",a.keys.api),l.call("internal/users/updateAvatar.json",{method:"post",data:t,cache:!1,contentType:!1,processData:!1})},saveProfile:function(){return l.call("users/updateProfile.json",{method:"POST",data:{name:this.get("name"),about:this.get("about"),location:this.get("location"),url:this.get("url")}})},toRegisterJSON:function(){return t.pick(this.toJSON(),"display_name","email","password")},isSession:function(e){return e.user.id&&e.user.id===this.id},isEditable:function(e){return this.isSession(e)&&!this.get("remote")},toJSON:function(e){e=e||{};var t=c.prototype.toJSON.call(this),n=this.collection&&this.collection.thread;return t.thread.canModerate=!!n&&n.isModerator(this),e.session&&(t.isSession=this.isSession(e.session),t.isEditable=this.isEditable(e.session)),t},_changeFollowState:function(e){this.set({isFollowing:e,numFollowers:Math.max(0,this.get("numFollowers")+(e?1:-1))});var t="users/"+(e?"follow":"unfollow"),n=this;return l.call(t+".json",{data:{target:this.get("id")},method:"POST",success:function(e){n.trigger("sync",n,e,{})}})},follow:function(){return this._changeFollowState(!0)},unfollow:function(){return this._changeFollowState(!1)},toggleFollowState:function(){return this._changeFollowState(!this.get("isFollowing"))},registeredLessThan:function(e,t){var n=s.assureTzOffset(this.get("joinedAt")),a=i().subtract(e,t);return i(n).isAfter(a)},registeredToday:function(){return this.registeredLessThan(1,"day")},registeredThisWeek:function(){return this.registeredLessThan(1,"week")}},{MIN_PASSWORD_LEN:6,MIN_NAME_LEN:2,MAX_NAME_LEN:30,MAX_LOCATION_LEN:255,MAX_URL_LEN:200});return h}),define("core/models/Session",["underscore","backbone","moment","core/api","core/config","core/time","core/utils","core/utils/cookies","core/utils/guid","core/models/BaseUser","core/models/User"],function(e,t,n,i,a,s,o,r,l,c,d){var u="disqusauth",h=t.Model.extend({initialize:function(){this._fromCookie=e.once(this._fromCookie,this),this.user=this.getAnonUserInstance()},setUser:function(e){this.user&&this.stopListening(this.user),this.user=e,this.setIfNewUser(),this.listenTo(e,"all",this.trigger),this.trigger("change:id",e)},isLoggedOut:function(){return!this.isLoggedIn()},isKnownToBeLoggedOut:function(){return!this._fromCookie().id},_fromCookie:function(){var e=(r.read(u)||"").replace(/$\"|\"$/g,"").split("|");return e[1]&&e[6]&&e[8]?{username:e[1],id:parseInt(e[6],10),isModerator:parseInt(e[8],10)>0}:(e&&r.erase(u,{}),{username:void 0,id:0,isModerator:!1})},isLoggedIn:function(){return!!this.user.get("id")},fetch:function(t){t=t||{};var n={};return n["_"+(new Date).getTime()]=1,i.call("users/details.json",{data:n,success:e.bind(function(e){e=e.response,e.id&&this.setUser(this.getUserInstance(e)),t.success&&t.success(e),t.complete&&t.complete(e)},this),error:e.bind(function(e){t.error&&t.error(e),t.complete&&t.complete(e)},this)})},getAnonUserInstance:function(e){return new c(e)},getUserInstance:function(e){return new d(e)},getCsrfToken:function(){var e=r.read("csrftoken");return e||(e=l.generate().replace(/\W/g,""),r.create("csrftoken",e,{expiresIn:31536e6})),e},setIfNewUser:function(){var e=this.user.get("joinedAt");if(this.user.get("isAnonymous")||!e)return void this.user.set("joinedRecently",!1);var t=s.assureTzOffset(e);this.user.set("joinedRecently",n().subtract(10,"seconds").isBefore(t))}});return h}),define("core/UniqueModel",["underscore"],function(e){function t(e,n,i){var a=t.pool(e),s=n&&n[e.prototype.idAttribute];if(!s)return new e(n,i);var o=t.get(e,s);return o?a[s].set(n):a[s]=new e(n,i),a[s]}return t.pool={},t.pool=function(e){var n=t.pool[e.__type__];if(!n)throw Error("Model not registered. Use UniqueModel.addType");return n},t.get=function(e,n){return t.pool(e)[n]},t.set=function(e,n){var i=t.pool(e),a=n&&n.get(e.prototype.idAttribute);if(!a)return n;var s=t.get(e,a);return s?s.set(n.attributes):s=i[a]=n,s},t.addType=function(e,n){n.__type__&&t.pool[e]||(n.__type__=e,t.pool[e]={})},t.boundModel=function(n){var i=e.bind(t,t,n);return i.prototype=n.prototype,i},t.wrap=t.boundModel,t}),define("home/utils/backboneUtils",["jquery"],function(e){return{memoizedFetch:function(){if(this.fetchPromise)return this.fetchPromise;var e=this;return this.fetchPromise=this.constructor.__super__.fetch.apply(this,arguments).then(function(){return e.fetchPromise=null,e.fetched=!0,arguments},function(t){return e.fetchPromise=null,t})},getPromiseFor:function(t,n){var i=e.Deferred();return t.has(n)?i.resolve(t.get(n)):t.once("change:"+n,function(e,t){i.resolve(t)}),i.promise()}}}),define("home/templates/confirmModal",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" modal-dialog--light"},3:function(){return'<button class="text-smaller modal-close" data-dismiss="modal">\n<span class="icon-cancel"></span>\n</button>\n'},5:function(e,t,n,i){var a=this.escapeExpression;return'<div class="modal-footer">\n<button type="button" class="button button-outline -small" data-dismiss="modal">\n'+a(t.gettext.call(e,"Cancel",{name:"gettext",hash:{},data:i}))+'\n</button>\n<button type="button" class="button button-inverted-fill -small" data-dismiss="modal" data-action="confirm">\n'+a(t.gettext.call(e,"Confirm",{name:"gettext",hash:{},data:i}))+"\n</button>\n</div>\n"},7:function(e,t,n,i){var a=this.escapeExpression;return'<div class="modal-footer">\n<button type="button" class="button button-outline -small" data-dismiss="modal">\n'+a(t.gettext.call(e,"Close",{name:"gettext",hash:{},data:i}))+"\n</button>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">\n<div class="modal-dialog';return a=t["if"].call(e,t.eq.call(e,null!=e?e.type:e,null!=(a=null!=e?e.types:e)?a.CLOSE_LIGHT:a,{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+='">\n<div class="modal-content">\n',a=t["if"].call(e,t.eq.call(e,null!=e?e.type:e,null!=(a=null!=e?e.types:e)?a.CLOSE_ICON:a,{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+='<div data-role="content">\n</div>\n</div>\n',a=t["if"].call(e,t.eq.call(e,null!=e?e.type:e,null!=(a=null!=e?e.types:e)?a.CONFIRM_CANCEL:a,{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(s+=a),a=t["if"].call(e,t.eq.call(e,null!=e?e.type:e,null!=(a=null!=e?e.types:e)?a.CLOSE:a,{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+"</div>\n</div>\n"},useData:!0})}),define("home/utils/confirmModal",["jquery","home/templates/confirmModal"],function(e,t){function n(){var t=e("<div>").addClass("modal-scrollbar-measure")[0];e("body").append(t);var n=t.offsetWidth-t.clientWidth;return e(t).remove(),n}function i(t){var n=e("<style>").attr("type","text/css")[0];n.styleSheet?n.styleSheet.cssText=t:n.innerHTML=t,e("head").append(n)}function a(n){n=n||{},n.modal=n.modal||{};var i=e(t({type:n.modal.type||o.CLOSE_ICON,types:o}));return i.on("shown.bs.modal",function(){e("body").addClass("scroll-fix")}).on("hidden.bs.modal",function(){e("body").removeClass("scroll-fix"),i.remove()}),e("body").append(i),i}function s(t,n){t=t||o.CLOSE;var i=e.Deferred(),s=a({modal:{type:t}});return s.on("click","[data-action=confirm]",function(){i.resolve(!0)}).on("hidden.bs.modal",function(){i.resolve(!1)}).find("[data-role=content]").html(n),s.modal("show"),i.promise()}var o={CLOSE:1,CONFIRM_CANCEL:2,CLOSE_ICON:3,CLOSE_LIGHT:4};return e(function(){var e=n(),t=["@media only screen and (min-width: 480px) {","body.scroll-fix { margin-right: "+e+"px; }","body.scroll-fix .compensation { margin-right: "+e+"px; }","}"].join(" ");i(t)}),{TYPES:o,getModal:a,confirmationPromise:s}}),define("home/templates/confirmBlacklistUser",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="modal-header">\n<h4 class="modal-title">'+a(t.gettext.call(e,"Blacklist %(username)s?",{name:"gettext",hash:{username:t.tag.call(e,"b",{name:"tag",hash:{text:null!=e?e.username:e},data:i})},data:i}))+'</h4>\n</div>\n<div class="modal-body">\n<p>'+a(t.gettext.call(e,"Click Confirm to blacklist and remove this user's recent comments and discussions. This user will no longer be able to post comments.",{name:"gettext",hash:{},data:i}))+"</p>\n</div>\n"},useData:!0})}),define("home/models/User",["underscore","remote/config","core/api","core/config","core/strings","core/models/User","home/utils/backboneUtils","home/utils/confirmModal","home/templates/confirmBlacklistUser","core/UniqueModel"],function(e,t,n,i,a,s,o,r,l,c){var d=s,u=d.prototype,h=a.get,m=d.extend({defaults:e.defaults({numChannelsFollowing:null},u.defaults),idAttribute:"username",initialize:function(e,t){u.initialize.call(this,e,t);var n=require("home/models/Session");this.session=n.get(),this.listenTo(this,"followed:user",this.handleFollowedUser),this.listenTo(this,"unfollowed:user",this.handleUnfollowedUser),this.listenTo(this,"followed:forum",this.handleFollowedForum),this.listenTo(this,"unfollowed:forum",this.handleUnfollowedForum),this.listenTo(this,"followed:channel",this.handleFollowedChannel),this.listenTo(this,"unfollowed:channel",this.handleUnfollowedChannel)},shouldFetch:function(){return!(this.get("name")&&this.has("numFollowers")&&this.has("numFollowing")&&this.has("numForumsFollowing"))},isSessionUser:function(){return this.isSession(this.session)},isDisqusNetMod:function(){return e.contains(t.lounge.NET_MOD_LIST,this.get("username"))},getUserReputationLabel:function(){var e=this.get("rep");return.25>e?"Low 1":.8>e?"Low 2":2.9>e?"Average":"High"},fetch:function(e){return e=this.prepareFetchOptions(e),o.memoizedFetch.call(this,e)},getNumTotalFollowing:function(){return this.get("numFollowing")+this.getNumCommunitiesFollowing()},getNumCommunitiesFollowing:function(){return this.get("numForumsFollowing")+this.get("numChannelsFollowing")},toggleFollowed:function(){return this.get("isFollowing")?this.unfollow():this.follow()},follow:function(){return this.session.user.trigger("followed:user",this),u.follow.call(this)},unfollow:function(){return this.session.user.trigger("unfollowed:user",this),u.unfollow.call(this)},removeFollower:function(e){if(this.isSessionUser()){var t=this.get("numFollowers")-1;return this.set("numFollowers",Math.max(0,t)),n.call("users/removeFollower",{type:"POST",data:{follower:e.get("id")}})}},handleFollowedUser:function(){this.set({numFollowing:this.get("numFollowing")+1})},handleUnfollowedUser:function(){this.set({numFollowing:Math.max(0,this.get("numFollowing")-1)})},handleFollowedForum:function(){this.set({numForumsFollowing:this.get("numForumsFollowing")+1})},handleUnfollowedForum:function(){this.set({numForumsFollowing:Math.max(0,this.get("numForumsFollowing")-1)})},handleFollowedChannel:function(){this.set({numChannelsFollowing:this.get("numChannelsFollowing")+1})},handleUnfollowedChannel:function(){this.set({numChannelsFollowing:Math.max(0,this.get("numChannelsFollowing")-1)})},confirmBlacklist:function(t){r.confirmationPromise(r.TYPES.CONFIRM_CANCEL,l(this.toJSON())).then(e.bind(function(e){e&&this.addToBlacklist(t)},this))},addToBlacklist:function(t){t=t||{};var i=e.extend({},t,{user:this.get("id"),retroactive:t&&t.retroactive?1:0}),a=i.forum?"blacklists/add.json":"blacklists/global/add.json";n.call(a,{method:"POST",data:i}).done(e.bind(function(e){e&&(i.forum?this.trigger("blacklist:add",i.forum):this.set("isOnGlobalBlacklist",!0),window.alert(h("User was added to the blacklist")))},this)).error(function(e){e&&e.responseJSON&&window.alert(e.responseJSON.response)})},removeFromBlacklist:function(t){t=t||{};var i=e.extend({},t,{user:this.get("id")}),a=i.forum?"blacklists/remove.json":"blacklists/global/remove.json";n.call(a,{method:"POST",data:i}).done(e.bind(function(e){e&&(i.forum?this.trigger("blacklist:remove",i.forum):this.set("isOnGlobalBlacklist",!1),window.alert(h("User was removed from the blacklist")))},this)).error(function(e){e&&e.responseJSON&&window.alert(e.responseJSON.response)})},updateFlags:function(t){return this.set(t),n.call("internal/users/updateFlags.json",{data:e.mapObject(t,function(e){return e?1:0}),method:"POST"})},getDisplayName:function(e){return e=e||this.attributes,e.name||e.username||"Guest"},toJSON:function(){var e=u.toJSON.apply(this,arguments);return e.displayName=this.getDisplayName(e),e}});return c.addType("User",m),m}),define("core/utils/releaseUtils",["underscore","exports","remote/config"],function(e,t,n){t.DISQUS_ADMIN_USERNAMES=["Jason","danielha","ryanvalentin","kimskitchensink","TaltonFiggins","gabalafou","SamParker","noodlezrulez","davidericfleck","NorthIsUp","nfluxx","mpattyfly","mls888","jono","tkaemming","madBYK","fuziontech","SteveRoy44","mandytong","chaseneil","iamfrancisyo","mattrobenolt","chazcb","podlipensky","qarly","met48","davidzabowski","Rsadi","ernestwaynewong","kalail610","jimwaggoner","alec_schmidt","zaizhuang","nicoleallard","annmony","brandenr","cynthiacgutierrez88","kaelibain","sayshelen","vexillifer","wedamija","ryan04","ProductNate","tonyhue","Bravado_General","michaelmaltese","paulivanov","Jameslm86","min_diesel","anna_vu","colekowalski","tithonis","SteiNYSF","webrender","kaitlynnonaka","jeff_lien","saeedoday","jason_heron","katfs"],t.isDisqusAdmin=function(i){return e.contains(t.DISQUS_ADMIN_USERNAMES,i.get("username"))||e.contains(n.lounge.home_other_admin_accounts,i.get("username"))}}),define("core/collections/PaginatedCollection",["underscore","backbone"],function(e,t){var n=t.Collection.extend({PER_PAGE:30,initialize:function(e,t){t=t||{},this.cursor=t.cursor||{}},fetch:function(n){return n=n||{},n.data=e.defaults(n.data||{},{cursor:n.cursor||"",limit:n.PER_PAGE||this.PER_PAGE}),t.Collection.prototype.fetch.call(this,n)},hasNext:function(){return this.cursor.hasNext},more:function(t){function n(e){a.push(e)}var i=this;if(t=t||{},!this.cursor.hasNext)return void i.trigger("nodata");var a=[];return this.on("add",n),this.fetch(e.extend({},t,{add:!0,remove:!1,cursor:this.cursor.next,limit:this.PER_PAGE,success:function(){i.trigger("add:many",a,i,t),i.off("add",n),t.success&&t.success.apply(this,arguments)}}))},parse:function(e){return this.cursor=e.cursor||{hasNext:!1},e.response},getLength:function(){return this.length}});return n}),define("home/collections/PaginatedUserCollection",["underscore","require","core/collections/PaginatedCollection","core/UniqueModel","home/models/User"],function(e,t,n,i,a){var s=n.extend({model:i.boundModel(a),initialize:function(e,t){t&&t.url&&(this.url=t.url)}});return s}),define("core/advice",["underscore"],function(e){function t(){e.each(["before","after","around"],function(e){this[e]=function(t,i){return this[t]="function"==typeof this[t]?n[e](this[t],i):i}},this)}var n={around:function(t,n){return function(){var i=e.toArray(arguments);return n.apply(this,[e.bind(t,this)].concat(i))}},before:function(t,i){return n.around(t,function(){var t=e.toArray(arguments),n=t.shift();return i.apply(this,t),n.apply(this,t)})},after:function(t,i){return n.around(t,function(){var t=e.toArray(arguments),n=t.shift(),a=n.apply(this,t);return i.apply(this,t),a})}};return{withAdvice:t}}),define("core/models/mixins",["underscore","moment","core/time"],function(e,t,n){function i(){this._getCreatedMoment=e.memoize(function(){var e=this.get("createdAt");if(e)return t(n.assureTzOffset(e),n.ISO_8601)},function(){return this.get("createdAt")}),this.getRelativeCreatedAt=function(){var e=this._getCreatedMoment();return e&&e.from(+new Date)},this.getFormattedCreatedAt=e.memoize(function(){var e=this._getCreatedMoment();return e&&e.format("LLLL")},function(){return this.get("createdAt")})}return{withCreatedAt:i}}),define("core/collections/UserCollection",["jquery","underscore","backbone","core/models/User"],function(e,t,n,i){var a=n.Collection.extend({model:i,initialize:function(e,t){n.Collection.prototype.initialize.apply(this,arguments),this.thread=t&&t.thread},fetch:function(){return e.when(!0)}});return a}),define("core/collections/UpvotersUserCollection",["underscore","backbone","core/api","core/collections/UserCollection"],function(e,t,n,i){var a=i.extend({LIMIT:50,url:function(){return n.getURL("posts/listUsersVotedPost")},initialize:function(e,t){this.postId=t.postId,this.threadId=t.threadId},fetch:function(n){return t.Collection.prototype.fetch.call(this,e.extend({data:{post:this.postId,thread:this.threadId,vote:1,limit:this.LIMIT}},n))}});return a}),define("core/models/Vote",["backbone"],function(e){var t=e.Model.extend({defaults:{score:0}});return t}),define("core/collections/VoteCollection",["backbone","core/models/Vote"],function(e,t){var n=e.Collection.extend({model:t});return n}),define("core/models/Post",["jquery","underscore","backbone","moment","core/api","core/strings","core/time","core/utils","core/utils/html","core/advice","core/models/mixins","core/models/User","core/collections/UserCollection","core/collections/UpvotersUserCollection","core/collections/VoteCollection"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p){var f=1e3,g=0,v=function(){var t=e.now();return f>t-g?!1:(g=t,!0)},w=s.get,b=n.Model.extend({upvotersCollectionClass:m,defaults:function(){return{createdAt:i().format(o.ISO_8601),dislikes:0,isApproved:!0,isDeleted:!1,isEdited:!1,isFlagged:!1,isFlaggedByUser:!1,isHighlighted:!1,isRealtime:!1,isImmediateReply:!1,isMinimized:null,hasMedia:!1,message:null,raw_message:null,likes:0,media:[],parent:null,points:0,depth:0,userScore:0}},initialize:function(){this.votes=new p},messageText:function(){var e=this.get("message");return e&&l.stripTags(e)},relatedIds:function(){var e=this.get("forum");t.isObject(e)&&(e=e.id);var n=this.get("thread");return t.isObject(n)&&(n=n.id),{forum:e,thread:n,post:this.id}},permalink:function(e,t){var n=this.id;if(!n||!e)return"";var i=t!==!1&&e.currentUrl||e.permalink(),a=document.createElement("a");return a.href=i,a.hash="#comment-"+n,a.href},twitterText:function(e){var t=140,n=this.author.get("name")||this.author.get("username");t-=n.length+3,t-=e.length+1,t-=2;var i=r.niceTruncate(this.messageText(),t);return'"'+i+'" — '+n},toJSON:function(e){var t=n.Model.prototype.toJSON.call(this);if(e){var i=e.session,a=e.thread;t.canBeEdited=this.canBeEdited(i,a),t.canBeRepliedTo=this.canBeRepliedTo(i,a),t.canBeShared=this.canBeShared(),t.permalink=this.permalink(a)}return t.isMinimized=this.isMinimized(),t.plaintext=this.messageText(),t.relativeCreatedAt=this.getRelativeCreatedAt(),t.formattedCreatedAt=this.getFormattedCreatedAt(),t.cid=this.cid,t},isPublic:function(){return this.get("isHighlighted")||this.get("isSponsored")?!0:this.get("isDeleted")?!1:this.get("isApproved")},isMinimized:function(){return this.get("isHighlighted")?!1:this.get("isMinimized")===!1?!1:!this.get("isApproved")},isAuthorSessionUser:function(){return!1},canBeEdited:function(){return!1},canBeRepliedTo:function(){return!1},canBeShared:function(){return!1},validate:function(n){if(!this.id&&!n.id){if(t.isString(n.raw_message)){if(""===n.raw_message)return w("Comments can't be blank.");if(2>n.raw_message.length)return w("Comments must have at least 2 characters.")}return n.author_email&&(n.author_email=e.trim(n.author_email)),n.author_name&&(n.author_name=e.trim(n.author_name)),""===n.author_email&&""===n.author_name?w("Please sign in or enter a name and email address."):""===n.author_email||""===n.author_name?w("Please enter both a name and email address."):t.isString(n.author_email)&&!this.validateEmail(n.author_email)?w("Invalid email address format."):void 0}},validateEmail:function(e){return r.validateEmail(e)},report:function(){this.set("isFlagged",!0),a.call("posts/report.json",{data:{post:this.id},method:"POST"})},_highlight:function(e){this.set("isHighlighted",e),a.call("posts/"+(e?"highlight":"unhighlight")+".json",{data:{post:this.id},method:"POST"})},highlight:function(){this._highlight(!0)},unhighlight:function(){this._highlight(!1)},getThreadId:function(){return this.get("thread")},getUpvotersUserCollection:t.memoize(function(){var e=this.upvotersCollectionClass;return new e(void 0,{postId:this.id,threadId:this.getThreadId()})},function(){return this.id}),_vote:function(e,t,n){var i=e-t,a={likes:this.get("likes"),dislikes:this.get("dislikes"),points:this.get("points")};return 0===i?i:(e>0?(a.likes+=e,a.dislikes+=t):0>e?(a.dislikes-=e,a.likes-=t):t>0?a.likes-=t:a.dislikes+=t,a.points+=i,n&&this.getUpvotersUserCollection()[e>0?"add":"remove"](n),this.set(a),i)},vote:function(e){if(!v())return 0;var t=this,n=t._vote(e,t.get("userScore"));0!==n&&(t.set("userScore",e),a.call("posts/vote.json",{data:{post:t.id,vote:e},method:"POST",success:function(n){t.votes.add({id:n.response.id,score:e},{merge:!0})}}))},_delete:function(){return this.set({isApproved:!1,isDeleted:!0}),a.call("posts/remove.json",{data:{post:this.id},method:"POST"})},spam:function(){this.set({isApproved:!1,isDeleted:!0,isSpam:!0}),this.trigger("spam"),a.call("posts/spam.json",{data:{post:this.id},method:"POST"})},_create:function(e,t){var n=this,i=e.attributes,s={thread:i.thread,message:i.raw_message};i.parent&&(s.parent=i.parent),i.author_name&&(s.author_name=i.author_name,s.author_email=i.author_email);var o=t.uploadTokens;return o&&o.length&&(s.upload_token=o),a.call("posts/create.json",{data:s,method:"POST",success:function(e){n.set(e.response),t.success&&t.success()},error:t.error})},_update:function(e,t){var n=this,i=e.attributes,s={post:i.id,message:i.raw_message};return a.call("posts/update.json",{data:s,method:"POST",success:function(e){n.set(e.response),t.success&&t.success()},error:t.error})},_read:function(e,t){var n=this;return t=t||{},a.call("posts/details.json",{data:{post:n.id},method:"GET",success:function(e){n.set(e.response),t.success&&t.success()},error:t.error})},sync:function(e,t,n){n=n||{};var i=n.error;switch(i&&(n.error=function(e){i(JSON.parse(e.responseText||"{}"))}),e){case"create":return this._create(t,n);case"update":return this._update(t,n);case"delete":return this._delete();case"read":return this._read(t,n)}},storageKey:function(e){return this.isNew()&&this.getThreadId()?[e||"drafts","thread",this.getThreadId(),"parent",this.get("parent")||0].join(":"):void 0}},{formatMessage:function(){var e=/(?:\r\n|\r|\n){2,}/,n=/\r\n|\r|\n/;return function(i){var a=t.chain(i.split(e)).compact().value(),s=t.map(a,function(e){return t.chain(e.split(n)).compact().map(t.escape).join("<br>").value()}).join("</p><p>");return"<p>"+s+"</p>"}}()});return d.withCreatedAt.call(b.prototype),c.withAdvice.call(b.prototype),b.withAuthor=function(e){this.around("set",function(n,i,a,s){var o;if(null==i)return this;"object"==typeof i?(o=i,s=a):(o={},o[i]=a);var r=o.author;if(r){if(t.isString(r)||t.isNumber(r)){var l=r;r={},r[e.prototype.idAttribute||"id"]=l}this.author=new e(r),delete o.author}return n.call(this,o,s)}),this.around("toJSON",function(e){var n=e.apply(this,t.rest(arguments));return this.author&&(n.author=this.author.toJSON()),n})},b.withMediaCollection=function(e){this.after("set",function(n){n&&"string"!=typeof n&&(t.isUndefined(n.media)||(this.media?this.media.reset(n.media):this.media=new e(n.media),delete n.media))}),this.around("toJSON",function(e){var n=e.apply(this,t.rest(arguments));return this.media&&(n.media=this.media.toJSON()),n})},b}),define("core/models/Thread",["underscore","backbone","loglevel","core/utils","core/api","core/config","core/advice","core/UniqueModel","core/models/User"],function(e,t,n,i,a,s,o,r,l){var c=t.Model,d=c.prototype,u=c.extend({defaults:{author:null,category:null,createdAt:null,forum:null,identifiers:[],ipAddress:null,isClosed:!1,isDeleted:!1,hasStreaming:!1,link:null,message:null,slug:null,title:null,userSubscription:!1,posts:0,likes:0,dislikes:0,userScore:0},initialize:function(e,t){t=t||{},this.moderators=t.moderators,this.forum=t.forum,this.on("change:userScore",function(){var e=this.get("userScore");e>0&&0===this.get("likes")&&this.set("likes",e)},this)},_vote:function(e,t){var n=e-t;return 0===n?n:(this.set("likes",this.get("likes")+n),n)},vote:function(e){var t=this,n=t._vote(e,t.get("userScore"));0!==n&&(this.set("userScore",e),a.call("threads/vote.json",{data:{thread:this.id,vote:e},method:"POST",success:function(e){e.response.id&&t.trigger("vote:success",e)}}))},fetch:function(e){var t,i=this,o=i.attributes;e=e||{},t=o.identifier?"ident:"+o.identifier:"link:"+o.url,a.call("threads/details.json",{data:{thread:t,forum:o.forum},success:function(t){i.set(t.response),e.success&&e.success()},error:function(){s.debug?i.save({},{success:e.success}):n.info("Couldn't find thread; not creating in production.")}})},_toggleState:function(e,t){t||(t={});var n=e?"open.json":"close.json";return this.set("isClosed",!e),a.call("threads/"+n,{method:"POST",data:{thread:this.id},success:t.success,error:t.error})},open:function(e){return this._toggleState(!0,e)},close:function(e){return this._toggleState(!1,e)},sync:function(){var e=this,t=e.attributes;a.call("threads/create.json",{data:{title:t.title,forum:t.forum,identifier:t.identifier,url:t.url},method:"POST",success:function(t){e.set(t.response)}})},incrementPostCount:function(e){var t=this.get("posts")+e;this.set("posts",t>0?t:0)},isModerator:function(t){var n;if(this.moderators)return n=t instanceof l||e.isObject(t)?t.id:t,n=parseInt(n,10),e(this.moderators).contains(n)},subscribe:function(e,t){e=e!==!1;var n=this.get("userSubscription");if(n!==e){e?this.set("userSubscription",t||!0):this.set("userSubscription",!1);var i=e?"subscribe.json":"unsubscribe.json",s={thread:this.id};return t?s.email=t:e||"string"!=typeof n||(s.email=n),a.call("threads/"+i,{data:s,method:"POST"})}},relatedIds:function(){var t=this.get("forum");return e.isObject(t)&&(t=t.id),{forum:this.get("forum"),thread:this.id}},twitterText:function(e){var t=140-(e.length+1),n=this.get("clean_title");return n=i.niceTruncate(n,t)},permalink:function(){return this.get("url")||this.get("link")||this.currentUrl},toJSON:function(){var e=d.toJSON.call(this);return e.permalink=this.permalink(),e},getDiscussionRoute:function(e){var t=["","home","discussion",this.forum.id,this.get("slug"),""];return e=e||this.forum.channel,e&&(e=e.attributes||e,t.splice(2,0,"channel",e.slug)),t.join("/")}});return o.withAdvice.call(u.prototype),u.withThreadVoteCollection=function(e){this.after("initialize",function(){this.votes=new e,this.on("vote:success",function(e){this.votes.get(e.response.id)||this.votes.add({id:e.response.id,score:e.response.vote,currentUser:!0})},this)})},u.withPostCollection=function(t){this.after("initialize",function(n){n=n||{},this.posts=new t(n.posts,{thread:this,cursor:n.postCursor,order:n.order,perPage:this.postsPerPage}),this.listenTo(this.posts,"add reset",function(t){t=t.models?t.models:[t],this.users&&e.each(t,function(e){this.users.get(e.author.id)||this.users.add(e.author)}),this.recalculatePostCount()}),this.listenTo(this.posts,"change:isDeleted change:isFlagged",function(e,t){t&&this.incrementPostCount(-1)})}),this.recalculatePostCount=function(){var e=this.get("posts");e>50||(e=this.posts.reduce(function(e,t){return t.isPublic()?e+1:e},0),this.set("posts",e))}},r.addType("Thread",u),u}),define("home/collections/common/ExtensibleCollection",["underscore","backbone","core/collections/PaginatedCollection"],function(e,t,n){var i=n.extend({PER_PAGE:10,initialize:function(){n.prototype.initialize.call(this,arguments),this.once("sync",this.extendData,this),this.on("add:many",this.extendData,this),this.on("nodata",this.onNoData,this)
},extendData:function(e){var n;if(e.models?n=e.models:e instanceof t.Model?(n=[e],this.once("sync",this.extendData,this)):n=e,!n.length)return this.cursor.hasNext=!1,void this.trigger("nodata");var i=0;this.extensionRequestsCount=0;do{var a=Math.min(i+10,n.length),s=n.slice(i,a);this.requestExData(s),i+=10,this.extensionRequestsCount++}while(n.length-1>=i)},getThreadFromModel:function(e){if(!e.getThread)throw Error("Any model that is in an ExtensibleCollection must define function getThread");return e.getThread()},requestExData:function(t,n){n=n||0;var a={};e.each(t,function(e){var t=this.getThreadFromModel(e),n=t&&t.getLinks()||[],i=1===n.length?n[0]:null;return this.shouldExtend(t,i)?(t.set({extending:!0}),void(a[i]=e)):void(t&&t.set({extending:!1}))},this);var s=e.chain(a).keys().map(escape).value();if(s.length){var o="urls="+s.join(",")+"&words=200&image_width=320";$.ajax({url:i.EXTRACT_URL,data:o,processData:!1,dataType:"jsonp",success:function(e){t.timeouts=0,this.onExtendData(e,a)},error:function(e){this.extendDataFailed(e,t,n)},context:this,timeout:3e3,complete:this.checkExtendDataComplete})}},shouldExtend:function(t,n){return t&&n&&!e.any(t.getMedia(),function(e){return e.url===n})},onExtendData:function(t,n){this.extensionRequestsCount--,e.each(t,function(e){var t=n[e.original_url];if(t){var i=this.getThreadFromModel(t);i.setEmbedlyData(e),i.set({extending:!1})}},this)},extendDataFailed:function(t,n,i){return"timeout"===t.statusText&&3>i?void this.handleTimeout(n,i):(this.trackError(t),e.each(n,function(e){var t=this.getThreadFromModel(e);t.set({extending:!1})},this),void this.extensionRequestsCount--)},handleTimeout:function(e,t){var n=require("home/utils/mixpanelUtils");n.trackError("timeout: load",null,{properties:{url:i.EXTRACT_URL}}),this.requestExData(e,t+1)},trackError:function(e){var t=require("home/utils/mixpanelUtils");t.trackError("error loading",null,{properties:{resp:e.statusText,url:i.EXTRACT_URL}})},checkExtendDataComplete:function(){this.extensionRequestsCount||this.finalizeExtendingData(this.cursor.hasNext)},finalizeExtendingData:function(e){this.trigger("extend",e)},onNoData:function(){this.finalizeExtendingData()}},{EXTRACT_URL:"//extract.services.disqus.com"});return i}),define("home/models/Topic",["underscore","backbone","core/strings","core/UniqueModel"],function(e,t,n,i){var a=n.get,s=t.Model.extend({idAttribute:"identifier",defaults:{identifier:null,displayName:null},validate:function(e){var t=e.displayName;if(!t)return{attrName:"displayName",message:a("Topic name cannot be empty.")};var i=s.TOPIC_NAME_RANGES;return t.length>i.maxLength||i.minLength>t.length?{attrName:"displayName",message:n.interpolate(a("A topic must be between %(minLength)s and %(maxLength)s characters."),{minLength:i.minLength,maxLength:i.maxLength})}:void 0}},{TOPIC_NAME_RANGES:{minLength:2,maxLength:30},cleanTopicName:function(e){return e.replace(/\s+/g," ").trim()},getOrCreateTopic:function(t){var n=s.cleanTopicName(t);if(!n)return null;var a=n.toLowerCase(),o=e.find(i.pool(s),function(e){return e.get("displayName").toLowerCase()===a});return o?o:new i(s,{displayName:n})}});return i.addType("Topic",s),s}),define("home/collections/TopicCollection",["underscore","backbone","home/models/Topic","core/UniqueModel","core/api","core/strings"],function(e,t,n,i,a,s){var o=s.get,r=t.Collection.extend({model:i.boundModel(n),initialize:function(e,t){t&&t.thread&&(this.thread=t.thread)},getCategoryTopics:function(){var t=this.thread.forum.channel,i=t.getCategories();return i?(i=i&&e.keys(i),this.filter(function(t){var a=t.get("displayName").toLowerCase();return e.find(i,function(e){return n.cleanTopicName(e).toLowerCase()===a})})):[]},isValid:function(){var e=this.validationError=this.validate()||null;return e?(this.trigger("invalid",this,e,{validationError:e}),!1):!0},validate:function(){var t=this.find(function(e){return!e.isValid()});if(t)return t.validationError;if(this.thread){var n=this.countBy(function(e){return e.get("hidden")?"hidden":"visible"});if(n.visible>r.MAX_LENGTH)return{attrName:"topics",message:s.interpolate(o("You may not have more than %(num)s topics"),{num:r.MAX_LENGTH})};var i=this.thread.forum.channel,a=i&&i.getCategories();if(a){var l=this.getCategoryTopics();if(1>l.length)return{attrName:"category",message:o("You must choose a category")};if(e.any(l,function(e){return!e.get("hidden")}))return{attrName:"topics",message:o("You may not enter a category as a topic")}}}},_syncTopicsOnThread:function(n,i){var a={url:this.urls[i],type:"POST",processData:!0,emulateHTTP:!0,data:{thread:this.thread.id,topics:e.map(n,function(e){return e.get("displayName")})}};return t.sync(i,this,a)},urls:{addTopicsToThread:a.getURL("timelines/curation/addTopicsToThread"),removeTopicsFromThread:a.getURL("timelines/curation/removeTopicsFromThread")},save:function(){if(this.thread&&this.isValid()){var t=this.thread.topics.models,a=e.difference(this.models,t),s=e.difference(t,this.models),o=this.thread;a.length&&this._syncTopicsOnThread(a,"addTopicsToThread").then(function(t){t.response&&o.topics.add(e.map(t.response,function(e){return new i(n,e)}))}),s.length&&this._syncTopicsOnThread(s,"removeTopicsFromThread").then(function(){o.topics.remove(s)})}},parse:function(e){return e.response}},{MAX_LENGTH:5});return r}),define("core/models/Forum",["backbone","core/UniqueModel","core/api"],function(e,t,n){var i=e.Model.extend({defaults:{settings:{},followUrl:"forums/follow",unfollowUrl:"forums/unfollow",isFollowing:!1},initialize:function(e,t){t&&t.channel&&(this.channel=t.channel)},_changeFollowingState:function(e){return n.call(e,{method:"POST",data:{target:this.get("id")}})},follow:function(){return this.set("isFollowing",!0),this._changeFollowingState(this.get("followUrl"))},unfollow:function(){return this.set("isFollowing",!1),this._changeFollowingState(this.get("unfollowUrl"))},toggleFollowed:function(){return this.channel&&this.channel.get("options").isCurationOnlyChannel?this.channel.toggleFollowed():this.get("isFollowing")?this.unfollow():this.follow()}});return t.addType("Forum",i),i}),define("home/models/Forum",["jquery","underscore","backbone","require","home/utils/backboneUtils","core/utils/html","core/models/Forum","core/api","core/utils"],function(e,t,n,i,a,s,o,r,l){var c=o.extend({getFriendlyUrl:function(){var e=l.getDomain(this.get("url"));return e.indexOf("disqus.com")>-1?"disqus.com":e},initialize:function(e,n){if(!this.get("id"))throw Error("Forum must be initialized with an id");o.prototype.initialize.call(this,e,n),this.fetch=t.memoize(t.bind(this.fetch,this)),this.buildChannel(n),this.listenTo(this,"change:channel",this.updateChannel)},buildChannel:function(n){if(!this.channel){var a=n&&n.channel||this.get("channel");if(a){e.isPlainObject(a)?a.primaryForum=this:n=t.defaults({primaryForum:this},n);var s=i("home/models/Channel");this.initializeRelated("channel",n,s)}}},updateChannel:function(){var e=this.get("channel");this.unset("channel"),e&&(this.channel?this.channel.shouldFetch()&&t.isObject(e)&&this.channel.set(e):this.buildChannel({channel:e}))},url:function(){return r.getURL("forums/details?forum="+this.get("id"))},parse:function(e){return e.response||e},shouldFetch:function(){return!this.get("name")},hasFavicon:function(){var e=this.getFavicon();return e&&!e.match(/favicon-default\.png/)},getFavicon:function(){var e=(this.get("favicon")||{}).cache;return this.channel&&this.channel.get("options").favicon||e},hasGuidelines:function(){return!!e(this.get("guidelines")).text().length},follow:function(){var e=o.prototype.follow.call(this),t=i("home/models/Session"),n=t.get().user;return n.trigger("followed:forum",this),e},unfollow:function(){var e=o.prototype.unfollow.call(this),t=i("home/models/Session"),n=t.get().user;return n.trigger("unfollowed:forum",this),e},toJSON:function(){var e=n.Model.prototype.toJSON.apply(this,arguments),i=t.defaults({forumRoute:this.getForumRoute(),faviconImage:this.getFavicon()},e);return this.channel&&(i.channelInfo=t.pick(this.channel.attributes,["name","slug"])),i},getPlainDescription:function(){var e=this.get("description");if(e)return s.stripTags(e)},getForumRoute:function(){var e=this.channel?["channel",this.channel.id]:["forum",this.id];return e.join("/")}});return c}),define("home/templates/confirmDeleteThread",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="modal-header">\n<h4 class="modal-title">'+a(t.gettext.call(e,"Remove %(discussionTitle)s?",{name:"gettext",hash:{discussionTitle:t.tag.call(e,"b",{name:"tag",hash:{text:null!=e?e.title:e},data:i})},data:i}))+'</h4>\n</div>\n<div class="modal-body">\n<p>'+a(t.gettext.call(e,"Click Confirm to remove and close the discussion so it can't be easily found. This prevents new comments from being posted.",{name:"gettext",hash:{},data:i}))+"</p>\n</div>\n"},useData:!0})}),define("home/utils/datetimeUtils",["moment"],function(e){var t="YYYY-MM-DDTHH:mm:ssZ",n=function(e){return e.indexOf("+")>=0?e:e+"+00:00"},i=function(i){return i&&1/0!==i?(i=n(i),e.utc(i,t).local().fromNow()):null};return{getRelativeDatetime:i}}),define("home/utils/sidebarUtils",[],function(){var e={};return e.isSidebar=function(){try{return window.self!==window.top}catch(e){return!0}},e}),define("home/utils/navigationUtils",["jquery","underscore","backbone","home/utils/sidebarUtils","home/config"],function(e,t,n,i,a){var s=/^#/,o=/\/$/,r=!0,l=/^[#\/]|\s+$/g,c=function(){e("body").html('<div class="spinner"></div>'),window.top.location="https://disqus.com/profile/login/?next="+encodeURIComponent("https://disqus.com"+window.location.pathname+window.location.search)},d={scrollPositions:{},lastNavigateTime:null,handleLinkClicks:function(n){var a=n.currentTarget;if(!this.shouldNotHandleLinkClick(n,a)){var o=e(a),r=o.attr("href");if(s.test(r)&&a.hash)return void this.scrollToElement(n);if(i.isSidebar()||!this.matchesRoute(a)){var l=o.attr("data-link-out");if(l){var c=o.attr("href");t.delay(function(){o.attr("href",c)},500),o.attr("href",l)}return void o.attr("target","_blank")}n.preventDefault(),this.navigate(a,!0)}},coerceTrailingSlash:function(e){o.test(e.pathname)||this.navigate(decodeURI(e.pathname+"/"+e.search+e.hash),{replace:!0})},getFragmentFromLink:function(e){var t=decodeURI(e.pathname+e.search),n=a.appRoot.replace(o,"");return t.indexOf(n)||(t=t.slice(n.length)),t.replace(l,"")},isInbound:function(e){return"#"===e.href[0]||this.matchesRoute(e)},matchesRoute:function(e){if(e.host!==location.host)return!1;var i=this.getFragmentFromLink(e);return t.any(n.history.handlers,function(e){return e.route.test(i)})},shouldNotHandleLinkClick:function(t,n){return t.isDefaultPrevented()||e(n).attr("target")||this.hasModifierKey(t)},hasModifierKey:function(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey},linkClickChangesPage:function(t,n){return"_blank"===e(n).attr("target")?!1:this.hasModifierKey(t)?!1:!this.isInbound(n)&&!r},scrollToElement:function(t){if(t){var n=e(t.currentTarget).attr("href"),i=e(n);if(i.length){t.preventDefault();var a=e("header.site-nav--wrapper"),s=a.height();e("body").scrollTop(i.offset().top-s)}}},navigate:function(t,i){i=i||{};var a,s=i.trigger,o="";return t.pathname&&(o=t.hash,t=this.getFragmentFromLink(t)),"home/"===t&&(t="/"),-1!==t.indexOf("home/user")&&(t=t.replace("home/user","by")),this.storeScrollPosition(),i.replace||(d.lastNavigateTime=e.now()),a=n.history.navigate(t+o,i),s&&this.applyScrollPosition(),a},notFoundRouteHandler:function(){d.navigate("/",{trigger:!0,replace:!0})},storeScrollPosition:function(){this.scrollPositions[n.history.getFragment()]=window.pageYOffset||document.documentElement.scrollTop},applyScrollPosition:function(){window.scrollTo(0,this.scrollPositions[n.history.getFragment()])},navigateToLoginOnAuthFail:function(e){if(!e.responseText)return e;var t=JSON.parse(e.responseText);return"/home/welcome"!==window.location.pathname&&(4===t.code||2===t.code&&/authenticate/.test(t.response))&&c(),e},navigateToLogin:c};return d}),define("home/models/Thread",["jquery","underscore","backbone","core/api","core/bus","core/models/mixins","core/models/Thread","core/UniqueModel","core/utils","core/utils/html","core/utils/releaseUtils","home/collections/common/ExtensibleCollection","home/collections/TopicCollection","home/models/Forum","home/models/User","home/models/Post","home/models/Topic","home/templates/confirmDeleteThread","home/utils/backboneUtils","home/utils/datetimeUtils","home/utils/confirmModal","home/utils/navigationUtils"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f,g,v,w,b,x,y){var _=/^https:\/\/[^.]+\.disqus\.com\/thread\//,k=o,C=k.prototype,T=k.extend({defaults:t.defaults({id:null,content:{title:"",description:"",keywords:[],image:{url:"",height:"",width:""}},message:void 0,canModerate:!1},C.defaults),initialize:function(e,t){C.initialize.call(this,e,t),this.initializeRelated("forum",t,m,"name"),this.listenTo(this,"change:forum",function(e,t){t instanceof n.Model||this.forum.set(t)}),this.listenTo(this,"change:author",function(e,t){this.setAuthor(t)}),this.listenTo(this,"change:message",this._clearDescriptions),this.topics=new h([],{thread:this});var i=this;w.getPromiseFor(this,"topics").then(function(e){i.topics.add(e),i.unset("topics")}),this.checkUserGenerated(t),this.listenTo(this,"change:userSubscription",this.onChangeUserSubscription)},onChangeUserSubscription:function(e,n){var i=require("home/models/Session"),a=i.get();a.loadPromise().always(t.bind(function(){a.user.trigger(n?"subscribe:thread":"unsubscribe:thread",this)},this))},validate:function(e){if(!e.title||!e.title.trim())return{attrName:"title",message:"Please enter a title for your discussion."};if(e.title.length>200)return{attrName:"title",message:"Please shorten your title."};if(!e.message||e.message.trim().length<2)return{attrName:"message",message:"Please enter a longer discussion body"};var n=this.forum.channel&&this.forum.channel.getCategories();if(n){var i=t.chain(n).keys().find(function(t){return 0===e.title.indexOf(t)}).value();if(i&&!e.title.match(RegExp(i+".*\\w+")))return{attrName:"title",message:"Your title must contain more than just a category."}}},checkUserGenerated:function(e){return e=e||{},this.shouldFetch()?void this.listenToOnce(this,"sync",t.bind(this.checkUserGenerated,this,e)):this.forum.channel?(this.setAuthor(e.author),this.initializeRecentPosts(e),void this.set({isUserGenerated:!0})):void this.set({isUserGenerated:!1})},setAuthor:function(e){e=e||this.get("author"),this.author?t.isObject(e)&&this.author.set(e):t.isObject(e)?this.initializeRelated("author",{author:e},p):(e=this.getAuthorFromUniqueModel(e),e&&(this.author=e))},getAuthorFromUniqueModel:function(e){return t.isString(e)&&e.length?t.find(r.pool(p),function(t){return t.get("id")===e}):void 0},fetchAuthor:function(){var n,i=this.get("author");return(n=this.getAuthorFromUniqueModel(i))?(this.setAuthor(n),e.Deferred().resolve(n).promise()):(n=new p({id:i}),n.fetch().then(t.bind(function(){this.setAuthor(n.attributes)},this)))},initializeRecentPosts:function(e){f||(f=require("home/models/Post")),this.recentPosts=new n.Collection(t.map(e.recentPosts,function(e){return e instanceof f?e:new r(f,e,{thread:this})},this))},getLinks:function(){var e=[];return e=this.get("isUserGenerated")?this.getLinksFromMessage():[this.get("link")]},getFriendlySourceUrl:function(){var e=l.getDomain(this.get("link"));return e.indexOf("disqus.com")>-1?"disqus.com":e},getLinksFromMessage:t.memoize(function(){var t=e("<div>").html(this.get("message"));return t.find("a[href]").map(function(t,n){return e(n).attr("href")})},function(){return this.id}),shouldFetch:function(){return!this.get("clean_title")},url:function(e){return this.urls[e]||this.urls.read},urls:{read:i.getURL("threads/details"),create:i.getURL("threads/create"),update:i.getURL("threads/update"),"delete":i.getURL("threads/remove"),restore:i.getURL("threads/restore"),inviteUserGroup:i.getURL("threads/inviteUserGroup")},buildFetchData:function(e){var n;if(this.get("id"))n={thread:this.get("id")};else{if(!this.get("slug")||!this.forum.id)throw Error("Cannot fetch thread without an id or a slug plus forum");n={thread:"slug:"+this.get("slug"),forum:this.forum.id}}return t.extend(n,e)},fetch:function(e){if(this.fetchPromise)return this.fetchPromise;e=e||{},e.data=t.extend(this.buildFetchData(),e.data),e.data.attach=e.data.attach||[],e.data.attach.push("topics"),this.forum.shouldFetch()&&(e.data.related=e.data.related||[],e.data.related.push("forum")),this.fetchPromise=n.Model.prototype.fetch.call(this,e);var i=this;return this.fetchPromise.always(function(){i.fetchPromise=null}),this.fetchPromise},sync:function(e,i,a){var s=i.attributes;switch(a=a||{},a.url=this.url(e),a.processData=!0,a.emulateHTTP=!0,e){case"create":var o=s.forum;s.forum||(o=this.forum.id),a.data=t.extend({title:s.title,forum:o,message:s.message},a.data);break;case"update":var r={title:s.title,message:s.message};a.data=t.extend({thread:s.id},r);break;case"delete":a.data=t.extend({thread:s.id},a.data);break;case"restore":case"inviteUserGroup":a.data=t.extend({thread:s.id},a.data),a.type="POST"}return n.sync(e,i,a)},parse:function(e){return e.response||e},toJSON:function(){var e=C.toJSON.call(this);return t.extend(e,{forum:this.forum.toJSON(),author:this.author?this.author.toJSON():void 0}),e.link?_.test(e.link)&&(e.link=this.getDiscussionRoute()):e.slug&&(e.link=this.getDiscussionRoute()),e},getThread:function(){return this},getHostname:function(){var t=this.get("link");if(!t)return"";var n=e("<a>").attr("href",t)[0];return n.hostname||t},getRelativeCreatedAt:function(){return b.getRelativeDatetime(this.get("createdAt"))},getRelativeCommentTimestamp:function(){return b.getRelativeDatetime(this.get("most_recent_comment_timestamp"))},getMostRecentCommenter:function(){var e=this.get("most_recent_commenter");return e&&!e.isAnonymous?e:void 0},setEmbedlyData:function(e){this.set({content:{title:e.title,description:e.description,image:e.images&&e.images[0]||{},keywords:e.keywords.length?e.keywords.slice(0,3):[]}})},getImage:function(){var e;return this.get("isUserGenerated")&&(e=this.getUserGeneratedImage()),e||this.getEmbedlyImage()},getEmbedlyImage:function(){var e=this.get("content");return e&&e.image&&e.image.url?{src:e.image.url,title:this.get("title")}:void 0},getUserGeneratedImage:function(){var e=this.getMedia(),t=e&&e[0];return t&&t.thumbnailUrl?{src:t.thumbnailUrl,title:t.title}:void 0},getMedia:function(){return this.get("media")},hasPreview:function(){var e=this.get("content");return!(!e||!e.image.url&&!e.description)},toggleFavorited:function(){var e=this.get("userScore")?0:1;1===e&&a.trigger("threadFavorited",this),C.vote.call(this,e)},getDefaultDescription:function(){return this._getDescription(70)},getShortDescription:function(){return this._getDescription(50)},getLongDescription:function(){return this._getDescription(200)},getFullDescription:function(){return this._getDescription(1/0)},getPlainDescription:function(){return this._truncate(c.stripTags(this.getFullDescription()),50)},_getDescription:function(e){if(this.descriptions&&this.descriptions[e])return this.descriptions[e];var t;if(this.get("isUserGenerated")?t=this.get("message"):this.has("content")&&(t=this.get("content").description),!t||!e)return"";var n=this._truncate(t,e);return this._storeDescription(n,e),n},_truncate:function(e,t){var n=e.split(" "),i=n.length;if(t>=i)return e;var a,s,o;for(a=0;(t-1-a>=0||i>t+a-1)&&(s=t-1+a,o=n[s],!o||"."!==o.slice(-1))&&(s=t-1-a,o=n[s],!o||"."!==o.slice(-1));a++)s=i-1;return n.slice(0,s+1).join(" ")},_storeDescription:function(e,t){this.descriptions||(this.descriptions={}),this.descriptions[t]=e},_clearDescriptions:function(){this.descriptions={}},confirmDelete:function(e){x.confirmationPromise(x.TYPES.CONFIRM_CANCEL,v(this.toJSON())).then(t.bind(function(t){t&&(this.removeThread(),e||y.navigate("/home/channel/"+this.forum.channel.id+"/",{trigger:!0,replace:!0}))},this))},removeThread:function(){if(this.topics.length>0){var e=new h([],{thread:this});e.save()}this.get("isDeleted")||this.sync("delete",this).then(t.bind(this.set,this,{isDeleted:!0})),this.get("isClosed")||this.sync("close",this).then(t.bind(this.set,this,{isClosed:!0}))},restore:function(){(this.get("isDeleted")||this.get("isClosed"))&&(this.sync("restore",this).then(t.bind(this.set,this,{isDeleted:!1})),this.sync("open",this).then(t.bind(this.set,this,{isClosed:!1})))},toggleSubscription:function(){return this.subscribe(!this.get("userSubscription"))},inviteUserGroup:function(e){return this.sync("inviteUserGroup",this,{data:{userGroup:e}})},canEdit:function(e){var n=this.author?this.author.get("id"):this.get("author"),i=this.get("canModerate")||t.contains(e.moderatedForums,this.forum.id)||d.isDisqusAdmin(e.user);return!this.get("isDeleted")&&(i||e.user.get("id")===n)},getQualifiedHomeUrl:function(){return"https://disqus.com"+this.getDiscussionRoute(this.forum.channel)},shareThread:function(e){var t,n,i=this.getQualifiedHomeUrl(),a=this.get("clean_title");switch(e){case"twitter":t="https://twitter.com/intent/tweet",n=t+"?text="+window.encodeURIComponent(a)+"&url="+window.encodeURIComponent(i);break;case"facebook":t="https://www.facebook.com/sharer.php",n=t+"?u="+window.encodeURIComponent(i);break;default:return}this._showSharePopup(n)},_showSharePopup:function(e,t){return window.open(e,"_blank",t||"width=550,height=520")},storageKey:function(){return this.isNew()&&this.forum.id?["drafts:forum",this.forum.id].join(":"):void 0}},{CATEGORY_TITLE_SEPARATOR:": ",getOrCreateThread:function(e,n,i){var a=r.pool(T),s=t.find(a,function(t){return t.get("slug")===n&&t.forum.get("id")===e});if(!s){var o=new u;s=new T({slug:n,forum:{id:e}}),o.add(s),s.fetch(i).then(function(){r.set(T,s)})}return s}});return r.addType("Thread",T),s.withCreatedAt.call(T.prototype),T}),define("home/collections/UpvotersUserCollection",["core/UniqueModel","home/models/User","core/collections/UpvotersUserCollection"],function(e,t,n){return n.extend({model:e.boundModel(t),parse:function(e){return e.response}})}),define("home/models/Post",["jquery","underscore","core/models/Post","core/UniqueModel","home/models/Thread","home/models/User","home/collections/UpvotersUserCollection"],function(e,t,n,i,a,s,o){var r=n,l=r.prototype,c=n.extend({upvotersCollectionClass:o,initialize:function(e,n){l.initialize.call(this,e,n),this.set({state:this._getPostState()}),this.initializeRelated("thread",t.extend({forum:e.forum},n),a)},toJSON:function(){var e=l.toJSON.apply(this,arguments);return e.thread=this.thread.toJSON(),e},getLinks:t.memoize(function(){var t=e("<div>").html(this.get("message"));return t.find("a[href]").map(function(t,n){return e(n).attr("href")})},function(){return this.id}),getThreadId:function(){return this.thread.id},_getPostState:function(){return this.get("isSpam")?"spam":this.get("isDeleted")?"deleted":this.get("isFlagged")&&!this.get("isApproved")?"flagged":this.get("isApproved")?"visible":"pending"}});return n.withAuthor.call(c.prototype,i.boundModel(s)),i.addType("Post",c),c}),define("home/collections/UserPostCollection",["underscore","core/collections/PaginatedCollection","core/UniqueModel","home/models/Post","core/api"],function(e,t,n,i,a){var s=t.extend({url:a.getURL("users/listPosts"),fetch:function(n){n=n||{},n.data=n.data||{},e.extend(n.data,{related:["thread","forum"]}),t.prototype.fetch.call(this,n)},parse:function(a){return a.response=e.map(a.response,function(e){return new n(i,e,{forum:e.forum})}),t.prototype.parse.apply(this,arguments)}});return s}),define("home/collections/PostCollection",["core/collections/PaginatedCollection","core/UniqueModel","home/models/Post"],function(e,t,n){return e.extend({model:t.boundModel(n)})}),define("home/models/Feed",["underscore","jquery","backbone"],function(e,t,n){var i=n.Model.extend({defaults:function(){return{fetching:!1,fetched:!1,hasNext:!0,error:!1,items:null,numPages:0,fetchOptions:{},active:!1}},initialize:function(t,n){if(!n||!n.collectionClass&&!n.collection)throw Error("Feed must specify the type of collection it maintains, or pass the collection");var i=n.collection||new n.collectionClass([],n.collectionOptions);i.cursor&&e.has(i.cursor,"hasNext")&&this.set("hasNext",i.cursor.hasNext),n.collectionUrl&&(i.url=n.collectionUrl),this.set({items:i}),this.items=i,i.on("extend",this.onExtendComplete,this),i.on("sync",this.onSync,this),this.listenTo(i,"all",this.propagateCollectionEvents),this.on("change:active",this.activeChanged,this)},propagateCollectionEvents:function(){var e=Array.prototype.slice.apply(arguments);e[0]="items:"+e[0],this.trigger.apply(this,e)},activeChanged:function(){this.get("active")&&!this.get("items").length&&this.fetchItems()},fetchItems:function(n){if(n=n||{},!n.reset&&!this.get("hasNext"))return t.Deferred().resolve();if(this.get("fetching")&&!this.get("timeouts"))return this.fetchPromise;this.set({fetching:!0}),n.reset&&this.set({fetched:!1}),n.data=n.data||{},e.extend(n.data,this.get("fetchOptions"));var i=n.error,a=n.success,s=this,o=require("home/utils/mixpanelUtils");n.error=function(n,a){return"timeout"===a.statusText&&(s.get("timeouts")||0)<3?(o.trackError("timeout: load",null,{properties:{url:e.result(n,"url"),params:t.param(s.get("fetchOptions"))}}),s.set({timeouts:(s.get("timeouts")||0)+1}),void s.fetchItems()):(o.trackError("error loading",null,{properties:{resp:a.responseText,url:e.result(n,"url"),params:t.param(s.get("fetchOptions"))}}),s.set({fetching:!1,error:!0,hasNext:!1,timeouts:0}),void(i&&i.apply(this,arguments)))},n.success=function(){s.set({error:!1,timeouts:0,numPages:s.get("numPages")+1}),a&&a.apply(this,arguments)};var r=t.isEmptyObject(s.get("items").cursor)||n.reset;return r||o.track("fetched more feed items",null,{properties:{url:n.url||e.result(s.get("items"),"url"),params:t.param(s.get("fetchOptions"))}}),this.fetchPromise=s.get("items")[r?"fetch":"more"](n)},onSync:function(e,t){this.set({fetched:!0,fetching:!1,hasNext:t.cursor&&t.cursor.hasNext})},ensureFetched:function(){return this.get("fetched")||this.get("fetching")||this.fetchPromise||this.fetchItems({reset:!0}),this.fetchPromise?this.fetchPromise:t.Deferred().resolve()},onExtendComplete:function(e){this.set({hasNext:e})}});return i}),define("home/models/ActivityFeedItem",["jquery","underscore","backbone","core/api","home/collections/PostCollection","home/models/Thread","home/models/Feed","home/utils/datetimeUtils"],function(e,t,n,i,a,s,o,r){var l=n.Model.extend({initialize:function(e,t){t.thread&&this.initializeRelated("thread",t,s),this.activities=t.activities,this.id||(this.id=l.buildId(this.activities)),this.set({isUnread:this.activities[0].get("isUnread")}),this.handleBoostEnd(),this.on("change:fixedUntil",this.handleBoostEnd)},parse:function(e){var n=e.score;return n&&(n={score:n.value,naturalScore:n.calculated||n.value,boostedScore:n.boost,fixedUntil:n.fixedUntil}),t.extend(e,n)},url:function(e){return i.getURL("timelines/curation/"+this.urls[e])},urls:{boost:"boostThreadInChannel",unboost:"unboostThreadInChannel",share:"shareThreadToChannel",hide:"hideThreadFromChannel"},sync:function(e,i,a){switch(a=a||{},a.url=i.url(e),a.processData=!0,a.emulateHTTP=!0,e){case"boost":a.type="POST",a.data=t.extend({score:i.get("score"),fixedUntil:i.get("fixedUntil")},a.data);break;case"unboost":a.type="POST";break;case"share":case"hide":a.type="POST"}return a.data=t.defaults({thread:i.thread.id},a.data),n.sync(e,i,a)},toJSON:function(){return t.defaults({activities:t.invoke(this.activities,"toJSON"),actors:t.invoke(this.actors,"toJSON"),thread:this.thread&&this.thread.toJSON(),relativeTime:this.getRelativeTimestamp()},n.Model.prototype.toJSON.apply(this,arguments))},getThread:function(){return this.thread},getPosts:function(){if(!this.posts){var e={collectionClass:a,collectionUrl:i.getURL("threads/listPosts")};this.posts={desc:new o({fetchOptions:{thread:this.thread.id,order:"desc"}},e),asc:new o({fetchOptions:{thread:this.thread.id,order:"asc"}},e)}}return this.posts},hasThreadImage:function(){var t=e.Deferred(),n=this.thread,i=n&&n.getImage();return n?i?t.resolve(!0):n.get("extending")===!1?t.resolve(!1):n.on("change:extending",function(e,n){n===!1&&(i=e.getImage(),t.resolve(i?!0:!1))}):t.resolve(!1),t.promise()},getBackendId:function(){return this.activities[0].get("backendId")},getRelativeTimestamp:function(){return r.getRelativeDatetime(this.get("published"))},getRelativeBoostTimeRemaining:function(){var e=this.get("fixedUntil");return e&&r.getRelativeDatetime(e)},getSelectedPost:function(){return this.activities[0].get("selectedPost")},setSelectedPost:function(e){this.activities[0].set({selectedPost:e})},getThreadOverrides:function(){return this.activities[0].get("threadOverrides")||{}},setThreadOverrides:function(e){this.activities[0].set({threadOverrides:e})},getPostsPreviewCollection:function(){if(!this.previewPostsCollection){var e=this.getSelectedPost(),t=this.thread.recentPosts;this.previewPostsCollection=t.clone(),e&&this.previewPostsCollection.add(e,{at:0})}return this.previewPostsCollection},handleBoostEnd:function(){if(this.boostEndTimeout&&(window.clearTimeout(this.boostEndTimeout),this.boostEndTimeout=null),this.get("fixedUntil")){var e=new Date(this.get("fixedUntil")).getTime(),n=e-(new Date).getTime();1>n?this.unboost():this.boostEndTimeout=window.setTimeout(t.bind(this.unboost,this),n)}},boostInChannel:function(e,t,n){var i=n?new Date((new Date).getTime()+n).toISOString():this.get("fixedUntil");return this.set({boostedScore:t,fixedUntil:i,score:t}),i?this.sync("boost",this,{data:{channel:e,fixedUntil:i}}):void 0},unboost:function(){this.set({score:this.get("naturalScore"),boostedScore:null,fixedUntil:null})},unboostInChannel:function(e){return this.unboost(),this.sync("unboost",this,{data:{channel:e}})},shareThreadToChannel:function(e,n,i,a){var s={channel:e};return n&&(s.selectedPost=n.id,s.selectedPostExcerpt=i||n.get("excerpt")),t.extend(s,a),this.sync("share",this,{data:s})},hideThreadFromChannel:function(e){return this.sync("hide",this,{data:{channel:e}})}},{buildId:function(e){return t.pluck(e,"id").join("|")},DEFAULT_BOOST_TIME_MS:36e5,DEFAULT_DECAY_RATE_SEC:1800});return l}),define("home/models/UnreadCounter",["underscore","backbone","core/api","core/config"],function(e,t,n,i){var a=t.Model,s=a.prototype;return a.extend({initialize:function(e,t){t=t||{},this.uniqueTogether={type:t.type,index:t.index,target:t.target},this.prepareFetchOptions=t.prepareFetchOptions},defaults:{numUnread:void 0},url:n.getURL("timelines/getUnreadCount"),fetch:function(e){return this.prepareFetchOptions&&(e=this.prepareFetchOptions(e)),e.data.routingVersion=i.apiVersion,s.fetch.call(this,e)},parse:function(e,t){return t.initializeOnly&&this.has("numUnread")?void 0:{numUnread:e.response}}})}),define("core/models/Channel",["underscore","backbone","remote/config","core/UniqueModel","core/api","core/models/Forum","core/strings"],function(e,t,n,i,a,s,o){var r=o.get,l=t.Model.extend({defaults:{primaryForum:{},slug:null,name:null,options:{},followUrl:"channels/follow",unfollowUrl:"channels/unfollow"},idAttribute:"slug",initialize:function(e,t){this.buildPrimaryForum(t),this.listenTo(this,"change:primaryForum",this.updatePrimaryForum)},buildPrimaryForum:function(){if(!this.primaryForum){var e=this.get("primaryForum");e&&(this.primaryForum=new i(s,e,{channel:this}),this.unset("primaryForum"))}},updatePrimaryForum:function(){var e=this.get("primaryForum");e&&(this.primaryForum||this.buildPrimaryForum(),this.primaryForum.set(e),this.unset("primaryForum"))},fetch:function(n){return n=n?e.clone(n):{},n.data=this.buildFetchData(n.data),t.Model.prototype.fetch.call(this,n)},buildFetchData:function(t){var n=t?e.clone(t):{};return this.id&&(n.channel=this.id),n},url:function(e){return a.getURL(this.constructor.URLS[e]||this.constructor.URLS.read)},sync:function(n,i,a){var s=i.attributes;
a=e.extend({url:this.url(n),emulateHTTP:!0},a);var o={bannerColor:s.bannerColor,description:s.description};switch("default"===a.avatarType?o.avatar="":s.avatar&&!e.isString(s.avatar)&&(o.avatar=s.avatar),n){case"create":a.processData=!1,a.contentType=!1,o.name=s.name,a.data=this.toFormData(e.extend({},o,a.data));break;case"update":a.processData=!1,a.contentType=!1,o.channel=s.slug,a.data=this.toFormData(e.extend({},o,a.data))}return t.sync(n,i,a)},toFormData:function(t){return e.reduce(t,function(t,n,i){return t.append(i,e.isString(n)?n.trim():n),t},new FormData)},parse:function(e){return e.response||e},shouldFetch:function(){return!this.get("name")||!this.get("dateAdded")},ensureFetched:function(){this.shouldFetch()&&this.fetch()},validate:function(t){var n=[],i=t.name.trim();this.constructor.MIN_NAME_LENGTH>i.length?n.push({attrName:"name",message:o.interpolate(r("Name must have at least %(minLength)s characters."),{minLength:this.constructor.MIN_NAME_LENGTH})}):i.length>this.constructor.MAX_NAME_LENGTH&&n.push({attrName:"name",message:o.interpolate(r("Name must have less than %(maxLength)s characters."),{maxLength:this.constructor.MAX_NAME_LENGTH})});var a=t.description.trim();return this.constructor.MIN_DESCRIPTION_LENGTH>a.length?n.push({attrName:"description",message:o.interpolate(r("Description must have at least %(minLength)s characters."),{minLength:this.constructor.MIN_DESCRIPTION_LENGTH})}):a.length>this.constructor.MAX_DESCRIPTION_LENGTH&&n.push({attrName:"description",message:o.interpolate(r("Description must have less than %(maxLength)s characters."),{maxLength:this.constructor.MAX_DESCRIPTION_LENGTH})}),this.constructor.BANNER_COLORS[t.bannerColor]||n.push({attrName:"bannerColor",message:o.interpolate(r("Banner color must be one of "+e.invoke(e.values(this.constructor.BANNER_COLORS),"toLowerCase").join(", "))+".")}),e.isEmpty(n)?void 0:n},_changeFollowingState:function(t,n){return n=n||{},n.type="POST",n.data=e.extend({target:this.get("slug")},n.data),a.call(t,n)},follow:function(e){return this.primaryForum.set("isFollowing",!0),this._changeFollowingState(this.get("followUrl"),e)},unfollow:function(e){return this.primaryForum.set("isFollowing",!1),this._changeFollowingState(this.get("unfollowUrl"),e)},toggleFollowed:function(){return this.get("options").isCurationOnlyChannel&&this.primaryForum?this.primaryForum.get("isFollowing")?this.unfollow():this.follow():void 0}},{URLS:{read:"channels/details",create:"channels/create",update:"channels/update"},BANNER_COLORS:{gray:r("Gray"),blue:r("Blue"),green:r("Green"),yellow:r("Yellow"),orange:r("Orange"),red:r("Red"),purple:r("Purple")},MIN_NAME_LENGTH:3,MAX_NAME_LENGTH:100,MIN_DESCRIPTION_LENGTH:5,MAX_DESCRIPTION_LENGTH:200});return i.addType("Channel",l),l}),define("core/utils/objectExpander",["underscore","backbone","core/UniqueModel","core/models/Channel","core/models/Thread"],function(e,t,n,i,a){return{Channel:i,Thread:a,parseObject:function(t,n){return e.isString(n)?t[n]:n},buildThread:function(t,i){if(i instanceof this.Thread)return i;if(i=this.parseObject(t,i),e.isString(i.author)){var a=i.author.replace("auth.User?id=","");i.author=t["auth.User?id="+a]||a}return new n(this.Thread,i,{forum:this.parseObject(t,i.forum),author:i.author})},buildChannel:function(e,t){return t instanceof this.Channel?t:(t=this.parseObject(e,t),new n(this.Channel,t))}}}),define("core/utils/hash",[],function(){var e=function(e){var t,n,i,a=0;if(0===e.length)return a;for(t=0,n=e.length;n>t;t++)i=e.charCodeAt(t),a=(a<<5)-a+i,a|=0;return a};return{calculate:e}}),define("core/analytics/identity",["backbone","core/utils/cookies","core/utils/guid","core/utils/hash","core/utils/fingerprint"],function(e,t,n,i,a){var s=function(){var i=e.Model.extend({COOKIE_NAME:"__jid",TTL:18e5,initialize:function(){this.prevImp=t.read(this.COOKIE_NAME),this.impId=n.generate(),this.persist()},persist:function(){t.create(this.COOKIE_NAME,this.impId,{expiresIn:this.TTL})}});return new i}(),o=function(){var i=e.Model.extend({COOKIE_NAME:"disqus_unique",isPersistent:function(){return t.read(this.COOKIE_NAME)===this.get("value")},initialize:function(){var e=t.read(this.COOKIE_NAME);e||(e=n.generate()),t.deprecated.create(this.COOKIE_NAME,e),this.set("value",e)}});return new i}(),r=function(){var e,t=o;return t.isPersistent()&&(e=t.get("value")),e||""+a.get()},l=function(){return Math.abs(i.calculate(this.clientId())%100)};return{unique:o,impression:s,clientId:r,clientPercent:l}}),define("core/utils/storage",[],function(){var e=function(e){var t="_dsqstorage_";try{return e.localStorage.setItem(t,t),e.localStorage.getItem(t),e.localStorage.removeItem(t),!0}catch(n){return!1}}(window),t=function(){var e={};return{getItem:function(t){return e.hasOwnProperty(t)?e[t]:null},setItem:function(t,n){e[t]=""+n},removeItem:function(t){delete e[t]},clear:function(){e={}}}}();return{get:function(e){var t=null;try{return t=this.backend.getItem(e),JSON.parse(t)}catch(n){return t}},set:function(e,t){try{this.backend.setItem(e,JSON.stringify(t))}catch(n){}},remove:function(e){this.backend.removeItem(e)},clear:function(){this.backend.clear()},backend:e?window.localStorage:t,isPersistent:e}}),define("core/switches",["underscore","remote/config","core/analytics/identity","core/utils/cookies","core/utils/storage"],function(e,t,n,i,a){var s="switch:",o="disqusauth",r={};return r._getKey=function(e){return s+e},r.getDisqusAuth=function(){var e=(i.read(o)||"").replace(/\"/g,"").split("|");return e[1]&&e[6]?{username:e[1],id:parseInt(e[6],10),staff:!!parseInt(e[2],10)}:{}},r.disableFeature=function(e){a.set(this._getKey(e),!1)},r.unsetFeature=function(e){a.remove(this._getKey(e),!0)},r.forceFeature=function(e){a.set(this._getKey(e),!0)},r.isFeatureActive=function(i,s){var o=this._getKey(i),l=a.get(o);if(e.isBoolean(l))return l;var c=(t.lounge&&t.lounge.switches||{})[i];if(!c)return!1;var d=r.getDisqusAuth();return s=e.defaults(s||{},{percent:n.clientPercent()+1,user_id:d.id,username:d.username,is_staff:d.staff}),e.any(c,function(t,n){return/percent$/.test(n)&&e.isNumber(t)?t>=s[n]:e.isArray(t)?e.contains(t,s[n]):t===s[n]})},r}),define("home/models/Channel",["underscore","backbone","core/UniqueModel","core/api","core/switches","core/models/Channel","core/utils/releaseUtils","home/models/Forum","remote/config"],function(e,t,n,i,a,s,o,r,l){var c=s.extend({buildPrimaryForum:function(t){var n=t&&t.primaryForum||this.get("primaryForum");return e.isEmpty(n)?void this.listenToOnce(this,"change:primaryForum",e.bind(this.buildPrimaryForum,this,t)):(r||(r=require("home/models/Forum")),this.initializeRelated("primaryForum",e.defaults({channel:this},t),r),void this.trigger("changeRelated:primaryForum"))},getCategories:function(){var t=this.get("options"),n=t&&t.categories;return e.isEmpty(n)?null:n},shouldFetch:function(){return s.prototype.shouldFetch.call(this)||!this.primaryForum},userCanCreate:function(t){if(this.get("options").isCurationOnlyChannel)return!1;if(a.isFeatureActive("home_admin_channel",this.attributes))return o.isDisqusAdmin(t);var n=l.lounge&&l.lounge.home_channel_creator_whitelists&&l.lounge.home_channel_creator_whitelists[this.id];return!n||o.isDisqusAdmin(t)||e.contains(n,t.get("username"))},toJSON:function(){var n=t.Model.prototype.toJSON.apply(this,arguments);return e.defaults({primaryForum:this.primaryForum?this.primaryForum.toJSON():{}},n)},follow:function(e){var t=s.prototype.follow.call(this,e),n=require("home/models/Session"),i=n.get().user;return i.trigger("followed:channel",this),t},unfollow:function(t){var n=require("home/models/Session"),i=n.get().user;t=t||{},t.success=e.bind(function(){this.get("options").isCurationOnlyChannel&&!this.primaryForum.get("isFollowing")&&i.trigger("unfollowed:curationchannel",this)},this);var a=s.prototype.unfollow.call(this,t);return i.trigger("unfollowed:channel",this),a}},{getOrCreate:function(e,t){var i=e[c.prototype.idAttribute];if(i){var a=n.get(c,i);if(a)return a}return new n(c,e,t)}});return c}),define("home/activityExpander",["underscore","backbone","core/UniqueModel","core/utils/objectExpander","home/models/User","home/models/Post","home/models/Thread","home/models/Forum","home/models/Channel"],function(e,t,n,i,a,s,o,r,l){return e.extend(i,{Channel:l,Thread:o,buildPost:function(e,t){if(t instanceof s)return t;t=this.parseObject(e,t);var i=this.parseObject(e,t.thread)||e["forums.Thread?id="+t.thread]||n.pool(o)[t.thread];return new n(s,t,{author:this.parseObject(e,t.author),thread:this.buildThread(e,i)})},buildNote:function(e,n){return new t.Model(this.parseObject(e,n))},buildUser:function(e,t){return t instanceof a?t:(t=this.parseObject(e,t),new n(a,t))},buildForum:function(e,t){return t instanceof r?t:(t=this.parseObject(e,t),new n(r,t))}})}),define("home/models/Activity",["require","underscore","backbone","home/utils/datetimeUtils","core/UniqueModel"],function(e,t,n,i,a){var s=n.Model.extend({defaults:{version:0,verb:null},buildId:function(e){return e=e||this.attributes,this.constructor.buildId(e.actor,e.verb||this.constructor.prototype.defaults.verb,e.target,e.object)},parse:function(e,t){return e.id&&t&&t.objects&&(e=this.parseRelatedModels(e,t.objects),e.backendId=e.id,e.id=this.buildId(e)),e},toJSON:function(){return t.defaults({actor:this.actor&&this.actor.toJSON(),target:this.target&&this.target.toJSON(),object:this.object&&this.object.toJSON(),thread:this.thread&&this.thread.toJSON(),forum:this.thread&&this.thread.forum.toJSON()},n.Model.prototype.toJSON.call(this))},getThread:function(){return this.thread},getRelativeCreatedAt:function(){return i.getRelativeDatetime(this.object.get("createdAt"))}},{buildId:function(e,t,n,i){return[e?e.id:"",t,n?n.id:"",i?i.id:""].join("|")}});return a.addType("Activity",s),s}),define("home/models/activities/ThreadActivity",["underscore","home/models/Activity","home/activityExpander"],function(e,t,n){return t.extend({initialize:function(e){this.target=e.target,this.thread=this.target,this.targetChannel=e.targetChannel},parseRelatedModels:function(t,i){t.target&&"TrendingThreadOnChannel"===t.type&&(t.targetChannel=n.buildChannel(i,t.target)),t.target=n.buildThread(i,t.object);var a=t.thread=t.target;if(t.selectedPost){var s=t.selectedPost.excerpt;t.selectedPost=n.buildPost(i,t.selectedPost.post),t.selectedPost.set({excerpt:s})}return a.initializeRecentPosts({recentPosts:e.map(t.recentPosts,e.bind(n.buildPost,n,i))}),t}})}),define("home/models/activities/FavoriteChannelThreadActivity",["home/models/activities/ThreadActivity","home/activityExpander"],function(e,t){var n=e.extend({defaults:{verb:"recommend"},initialize:function(t){e.prototype.initialize.call(this,t),this.actor=t.actor},parseRelatedModels:function(n,i){return e.prototype.parseRelatedModels.call(this,n,i),n.actor=t.buildUser(i,n.actor),n}});return n}),define("home/models/activities/ChannelPostActivity",["home/models/Activity","home/activityExpander"],function(e,t){var n=e.extend({defaults:{verb:"channel-post"},initialize:function(e){this.actor=e.actor,this.target=e.target,this.thread=this.target.thread},parseRelatedModels:function(e,n){return e.actor=t.buildUser(n,e.actor),e.target=t.buildPost(n,e.object),e}});return n}),define("home/models/activities/FavoriteThreadActivity",["home/models/activities/ThreadActivity","home/activityExpander"],function(e,t){var n=e.extend({defaults:{verb:"favorite"},initialize:function(t){e.prototype.initialize.call(this,t),this.actor=t.actor},parseRelatedModels:function(n,i){return e.prototype.parseRelatedModels.call(this,n,i),n.actor=t.buildUser(i,n.actor),n}});return n}),define("home/models/activities/ReplyActivity",["home/models/Activity","home/activityExpander"],function(e,t){return e.extend({defaults:{verb:"reply"},initialize:function(e){this.actor=e.actor,this.object=e.object,this.target=e.target,this.thread=this.object.thread},parseRelatedModels:function(e,n){return e.object=t.buildPost(n,e.object),e.actor=e.actor?t.buildUser(n,e.actor):e.object.author,e.target=t.buildPost(n,e.object.get("parent_post")),e}})}),define("home/models/activities/PostActivity",["home/models/Activity","home/activityExpander"],function(e,t){var n=e.extend({defaults:{verb:"post"},initialize:function(e){this.actor=e.actor,this.object=e.object,this.target=this.object.thread,this.thread=this.object.thread},parseRelatedModels:function(e,n){return e.actor=t.buildUser(n,e.actor),e.object=t.buildPost(n,e.object),e.target=e.object.thread,e}});return n}),define("home/models/activities/LikePostActivity",["home/models/Activity","home/activityExpander"],function(e,t){return e.extend({defaults:{verb:"favorite"},initialize:function(e){this.actor=e.actor,this.target=e.target,this.thread=this.target.thread},parseRelatedModels:function(e,n){return e.actor=t.buildUser(n,e.actor),e.target=t.buildPost(n,e.object),e}})}),define("home/models/activities/TrendingThreadActivity",["home/models/activities/ThreadActivity"],function(e){return e.extend({defaults:{verb:"trending"}})}),define("home/models/activities/FollowUserActivity",["home/models/Activity","home/activityExpander"],function(e,t){return e.extend({defaults:{verb:"follow"},initialize:function(e){this.actor=e.actor,this.target=e.target},parseRelatedModels:function(e,n){return e.actor=t.buildUser(n,e.actor),e.target=t.buildUser(n,e.object),e}})}),define("home/models/activities/NoteActivity",["home/models/Activity","home/activityExpander"],function(e,t){return e.extend({defaults:{verb:"send"},initialize:function(e){this.object=e.object},parseRelatedModels:function(e,n){return e.object=t.buildNote(n,e.object),e}})}),define("home/models/activities/CreateThreadActivity",["home/models/activities/ThreadActivity"],function(e){return e.extend({defaults:{verb:"create"}})}),define("home/models/activities/ShareThreadActivity",["home/models/activities/ThreadActivity"],function(e){return e.extend({defaults:{verb:"share"}})}),define("home/models/activities/InviteUserActivity",["home/models/Activity","home/activityExpander"],function(e,t){return e.extend({defaults:{verb:"invite"},initialize:function(e){this.actor=e.actor,this.thread=e.target},parseRelatedModels:function(e,n){return e.actor=t.buildUser(n,e.actor),e.target=t.buildThread(n,e.target),e}})}),define("home/ActivityFactory",["underscore","backbone","home/activityExpander","core/UniqueModel","home/models/Activity","home/models/activities/FavoriteChannelThreadActivity","home/models/activities/ChannelPostActivity","home/models/activities/FavoriteThreadActivity","home/models/activities/ReplyActivity","home/models/activities/PostActivity","home/models/activities/LikePostActivity","home/models/activities/TrendingThreadActivity","home/models/activities/FollowUserActivity","home/models/activities/NoteActivity","home/models/activities/CreateThreadActivity","home/models/activities/ShareThreadActivity","home/models/activities/InviteUserActivity"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f,g){var v=function(){},w={createActivity:function(e,t){var n=this.getActivityClass(e,t);if(!n)return null;var s=new n(e,t);return i.set(a,s)},getActivityClass:function(e,t){switch(e.type){case"RegisteredUserFavoriteThread":case"AnonymousUserFavoriteThread":return"ThreadAuthorRelation"===e.routings[0].type?(e.verb=s.prototype.defaults.verb,s):(e.verb=r.prototype.defaults.verb,r);case"RegisteredUserSubmitPost":case"AnonymousUserSubmitPost":var i=n.buildPost(t.objects,e.object);return e.object=i,"ThreadAuthorRelation"===e.routings[0].type?(e.verb=o.prototype.defaults.verb,o):i.get("parent_post")?(e.verb=l.prototype.defaults.verb,l):(e.verb=c.prototype.defaults.verb,c);case"RegisteredUserLikePost":case"AnonymousUserLikePost":return e.verb=d.prototype.defaults.verb,d;case"RegisteredUserCreateThread":return e.verb=p.prototype.defaults.verb,p;case"SendNoteToUser":return m;case"TrendingThread":case"TrendingThreadOnChannel":return e.verb=u.prototype.defaults.verb,u;case"UserFollowUser":return e.verb=h.prototype.defaults.verb,h;case"UserSendNoteToUserGroup":return m;case"UserSendNoteToUser":return m;case"UserShareThreadToChannel":return e.verb=f.prototype.defaults.verb,f;case"UserInviteUserToThread":case"UserInviteUserGroupToThread":return e.verb=g.prototype.defaults.verb,g;case"UserFollowForum":return null}}};return e.extend(v.prototype,w),v}),define("home/collections/FeedItemCollection",["underscore","backbone","home/collections/common/ExtensibleCollection","home/models/ActivityFeedItem","home/models/UnreadCounter","home/ActivityFactory","home/activityExpander","core/api"],function(e,t,n,i,a,s,o,r){var l="timelines/activities",c=n,d=c.prototype,u=c.extend({url:r.getURL(l),initialize:function(t,n){d.initialize.call(this,t,n),n=n||{},this.uniqueTogether={type:n.type,index:n.index,target:n.target},this.unreadCounter=new a(null,e.extend({prepareFetchOptions:this.prepareFetchOptions},this.uniqueTogether))},prepareFetchOptions:function(t){return t=t?e.clone(t):{},t.data=e.extend({},this.uniqueTogether,t.data),t},fetch:function(e){return e=this.prepareFetchOptions(e),d.fetch.call(this,e)},canUpdate:function(){return this.length&&this.url.indexOf(l)>0},updateUnreadCount:function(){this.canUpdate()&&this.unreadCounter.fetch({data:{readPosition:this.latestPosition}}).then(e.bind(function(){this.fetchUnread(this.unreadCounter.get("numUnread"))},this))},fetchUnread:function(t){0>=t||(this.unreadQueue=this.unreadQueue||new this.constructor(null,e.clone(this.uniqueTogether)),this.unreadQueue.fetch({reset:!0,data:{limit:t}}).then(e.bind(function(){var e=this.unreadQueue.length;this.unreadCounter.set("numUnread",e),this.trigger("unreadItemsReady",e)},this)))},addUnread:function(){this.latestPosition=this.unreadQueue.latestPosition,this.unreadQueue.invoke("set","isFromUnreadQueue",!0),this.add(this.unreadQueue.models,{at:0}),this.unreadQueue.reset(),this.unreadCounter.set("numUnread",0)},parse:function(t,n){n=n||{},(!this.latestPosition||n.reset)&&(this.latestPosition=t.response.latestPosition);var i=e.bind(u.transform,u,t.response.objects);return t.response=e.chain(t.response.activities).map(i).compact().value(),d.parse.call(this,t,n)}},{activityFactory:new s,transform:function(e,t){return t.items?this.buildFeedItemFromGroupedActivities(e,t):this.buildFeedItemFromSingleActivity(e,t)},buildFeedItemFromGroupedActivities:function(t,n){n.actors=n.actors||{items:[]};var a=e.chain(n.items).map(e.bind(this.buildActivity,this,t)).compact().value(),s=e.map(n.actors.items,e.bind(o.buildUser,o,t)),r=a[0],l=r&&r.get("verb");if(r){!s.length&&r.actor&&(n.actors.totalItems=1,s=[r.actor]);var c=i.buildId(a),d=i.prototype.parse.call(null,{id:c,verb:"reply"===l&&a.length>1?"post":l,published:n.published,totalActors:n.actors&&n.actors.totalItems||0,totalActivities:n.totalItems,score:n.score}),u={activities:a,thread:r.thread},h=new i(d,u);return h.actors=s,h}},buildFeedItemFromSingleActivity:function(t,n){var a=this.buildActivity(t,n);if(a){var s=[a],o=i.buildId(s),r=e.defaults({id:o,totalActors:1,totalActivities:1,verb:a.get("verb")},n),l={activities:s,thread:a.thread},c=new i(r,l);return c.actors=a.actor?[a.actor]:[],c}},buildActivity:function(e,t){try{return this.activityFactory.createActivity(t,{objects:e,parse:!0})}catch(n){return void(window.Raven&&window.Raven.captureMessage("error parsing activity item",{extra:t}))}}});return u}),define("home/collections/ForumCollection",["underscore","core/collections/PaginatedCollection","core/UniqueModel","home/models/Forum"],function(e,t,n,i){var a=t.extend({model:n.boundModel(i)});return a}),define("home/collections/FollowingForumCollection",["underscore","home/utils/backboneUtils","core/collections/PaginatedCollection","home/collections/ForumCollection","core/api"],function(e,t,n,i,a){var s=i.extend({url:a.getURL("users/listFollowingForums"),initialize:function(){this.on("add",this.completeModel)},completeModel:function(e){e.get("name")||e.fetch()},fetch:function(n){return n=n||{},n.data=e.defaults({limit:100},n.data),t.memoizedFetch.call(this,n)}});return s}),define("core/collections/ChannelCollection",["underscore","core/collections/PaginatedCollection","core/UniqueModel","core/api","core/models/Channel","core/utils/objectExpander"],function(e,t,n,i,a,s){var o=t.extend({url:i.getURL("channels/list"),model:n.boundModel(a),initialize:function(e,t){t=t||{},this.listName=t.listName},fetch:function(n){return n=n||{},this.listName&&(n.data=e.extend({listName:this.listName},n.data)),t.prototype.fetch.call(this,n)},parse:function(n){return n=t.prototype.parse.call(this,n),n.items?e.map(n.items,function(e){return s.buildChannel(n.objects,e.reference)}):n}});return o}),define("home/collections/ChannelCollection",["core/collections/ChannelCollection","core/UniqueModel","home/models/Channel"],function(e,t,n){var i=e.extend({model:t.boundModel(n)});return i}),define("home/collections/FollowingChannelCollection",["underscore","home/utils/backboneUtils","core/collections/PaginatedCollection","home/collections/ChannelCollection","core/api"],function(e,t,n,i,a){var s=i.extend({url:a.getURL("users/listFollowingChannels"),initialize:function(){this.on("add",this.completeModel)},completeModel:function(e){e.shouldFetch&&e.fetch()},fetch:function(n){return n=n||{},n.data=e.defaults({limit:100},n.data),t.memoizedFetch.call(this,n)}});return s}),define("home/collections/FollowingUserCollection",["home/collections/PaginatedUserCollection","core/api"],function(e,t){return e.extend({url:t.getURL("users/listFollowing")})}),define("home/collections/MostActiveForumCollection",["backbone","home/models/Forum","core/UniqueModel","core/api"],function(e,t,n,i){var a=e.Collection.extend({url:i.getURL("users/listMostActiveForums"),model:n.boundModel(t),parse:function(e){return e.response}});return a}),define("home/collections/UserManagedChannelCollection",["underscore","core/api","home/collections/ChannelCollection"],function(e,t,n){var i=n.extend({url:t.getURL("users/listModeratedChannels"),initialize:function(e,t){this.user=t.user,this.listenTo(this.user,"change:id",this.sort)},comparator:function(e,t){var n=this.user.get("id"),i=e.get("owner_id")===n,a=t.get("owner_id")===n;return i===a?e.get("name").toLowerCase()<t.get("name").toLowerCase()?-1:1:i?-1:1},fetch:function(t){return n.prototype.fetch.call(this,e.defaults({data:{user:"username:"+this.user.get("username"),excludeOwned:0}},t))}});return i}),define("home/models/UserModerationDetails",["backbone","home/utils/backboneUtils","core/api"],function(e,t,n){var i=e.Model.extend({idAttribute:"username",url:n.getURL("internal/users/moderationDetails"),initialize:function(e){e=e||{},this.forum=e.forum,this.network=e.network},shouldFetch:function(){return!this.get("username")||!this.get("forumsPostedIn")},fetch:function(){var e={data:{user:"username:"+this.get("username"),forum:this.forum||null,network:this.network?"username:"+this.network:null}};return t.memoizedFetch.call(this,e)},ensureFetched:function(){this.shouldFetch()&&this.fetch()},parse:function(e){return e.response}});return i}),define("home/models/UserProfile",["jquery","underscore","backbone","core/utils/releaseUtils","home/utils/backboneUtils","home/collections/PaginatedUserCollection","home/collections/UserPostCollection","home/collections/FeedItemCollection","home/collections/FollowingForumCollection","home/collections/FollowingChannelCollection","home/collections/FollowingUserCollection","home/collections/MostActiveForumCollection","home/collections/UserManagedChannelCollection","core/UniqueModel","home/models/User","home/models/Feed","home/models/UserModerationDetails","core/api"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f,g,v){var w=n.Model.extend({idAttribute:"username",initialize:function(e,n){this.initializeRelated("user",t.defaults({user:{username:this.get("username")}},n),p),this.listenTo(this.user,"change:isFollowing",this.updateFollowers);var i="username:"+this.user.get("username"),a={user:i,order:"desc"};this.forumsFollowing=new f({fetchOptions:a},{collectionClass:l}),this.channelsFollowing=new f({fetchOptions:a},{collectionClass:c}),this.listenToOnce(this.channelsFollowing,"items:sync",function(){this.user.set({numChannelsFollowing:this.channelsFollowing.items.length})}),this.syncFollowingCommunities(),this.following=new f({fetchOptions:a},{collectionClass:d}),this.followers=new f({fetchOptions:a},{collectionClass:s,collectionUrl:v.getURL("users/listFollowers")}),this.mostActiveForums=new f({fetchOptions:{user:i,limit:5}},{collectionClass:u}),this.managedChannels=new f(void 0,{collectionClass:h,collectionOptions:{user:this.user}}),this.followedChannels=new f({fetchOptions:{user:i,includeFollowedPrimaryForums:1,excludeModerated:1,excludeOwned:1}},{collectionClass:c,collectionOptions:{url:v.getURL("users/listFollowingChannels")}});var o="user:"+i;this.posts=new f(void 0,{collectionClass:r,collectionOptions:{type:"profile",index:"comments",target:o}}),this.favorites=new f(void 0,{collectionClass:r,collectionOptions:{type:"profile",index:"favorites",target:o}}),this.threads=new f(void 0,{collectionClass:r,collectionOptions:{type:"profile",index:"threads",target:o}}),this.profileFeed=new f(void 0,{collectionClass:r,collectionOptions:{type:"profile",target:o}}),this.moderationDetails=new g({username:this.user.get("username")}),this.listenTo(this.user,"change:isOnGlobalBlacklist",this.handleChangeGlobalBlacklist),this.listenTo(this.user,"blacklist:add",this.removeUserDiscussions)},syncFollowingCommunities:function(){var e=this.forumsFollowing.items,n=this.channelsFollowing.items;this.listenTo(n,{reset:function(){e.add(t.pluck(n.models,"primaryForum"),{at:0})},add:function(t){e.add(t.primaryForum,{at:0})},remove:function(t){e.remove(t.primaryForum)}}),this.listenTo(e,"reset",function(){e.add(t.pluck(n.models,"primaryForum"),{at:0})})},handleChangeGlobalBlacklist:function(){this.user.get("isOnGlobalBlacklist")&&this.removeUserDiscussions()},removeUserDiscussions:function(e){var n=this.threads.get("fetched")?this.threads.fetchItems():this.threads.ensureFetched();n.then(t.bind(function(){this.threads.items.each(function(t){var n=t.thread;e&&n.forum.id!==e||n.removeThread()}),this.threads.get("hasNext")&&this.removeUserDiscussions(e)},this))},isPrivate:function(){return!this.user.isSessionUser()&&this.user.get("isPrivate")},ensureFetched:function(){var n=require("home/models/Session"),i=n.get();i.loadPromise().always(t.bind(function(){var n=i.user.isDisqusNetMod();a.getPromiseFor(this.user,"isPrivate").then(t.bind(function(){if(!this.isPrivate()||n){this.favorites.ensureFetched(),this.posts.ensureFetched(),this.threads.ensureFetched(),this.mostActiveForums.ensureFetched(),this.channelsFollowing.ensureFetched();var t=this;n&&(t.moderationDetails.ensureFetched(),e.when(t.moderationDetails.fetchPromise).then(function(){t.trigger("moderationDetailsReady")}))}},this))},this)),this.fetchUser()},ensureFetchedAllChannels:function(){this.managedChannels.ensureFetched(),this.followedChannels.ensureFetched()},toJSON:function(){return t.defaults({user:this.user.toJSON(),following:this.following.toJSON(),followers:this.followers.toJSON(),mostActiveForums:this.mostActiveForums.toJSON(),posts:this.posts.toJSON(),threads:this.threads.toJSON(),profileFeed:this.profileFeed.toJSON(),moderationDetails:this.moderationDetails.toJSON()},n.Model.prototype.toJSON.call(this))},fetchUser:function(){if(!this.user.get("username"))throw Error("UserProfile requires a username or id in order to be fetched");this.user.shouldFetch()&&this.user.fetch({data:{user:"username:"+this.user.get("username")}})},fetchFollowing:function(){this.following.fetchItems({reset:!0})},fetchForumsFollowing:function(){this.forumsFollowing.fetchItems({reset:!0})},fetchChannelsFollowing:function(){this.channelsFollowing.fetchItems({reset:!0})},updateFollowers:function(){var e=require("home/models/Session"),t=e.get();if(!t.isAnonymous()){var n=t.user,i=this.user.get("isFollowing")?"add":"remove";this.followers.get("items")[i](n)}}});return m.addType("UserProfile",w),w}),define("home/collections/NotificationCollection",["underscore","backbone","backbone-marionette","core/api","core/config","home/collections/FeedItemCollection"],function(e,t,n,i,a,s){var o=s,r=o.prototype,l=o.extend({fetch:function(t){return t=t?e.clone(t):{},t.data=t.data?e.clone(t.data):{},t.data.readPosition=this.readPosition,t.data.routingVersion=a.apiVersion,r.fetch.call(this,t)},parse:function(t,n){(!this.readPosition||n.reset)&&(this.readPosition=t.response.readPosition);var i=r.parse.apply(this,arguments),a=require("home/views/NotificationCardCollectionView");return e.filter(i,function(t){return e.chain(a.ITEM_VIEWS).keys().contains(t.get("verb")).value()?!0:void(window.Raven&&window.Raven.captureMessage("unsupported activity item",{extra:t}))})},syncReadPosition:function(){var n=this.latestPosition;n&&n!==this.previousLatestPosition&&n!==this.readPosition&&(this.previousLatestPosition=n,t.ajax({url:i.getURL("timelines/setReadPosition"),type:"POST",data:e.extend({},this.uniqueTogether,{position:n})}))}});return l}),define("home/models/TimelineFilter",["jquery","backbone","underscore","core/api","core/config"],function(e,t,n,i,a){return t.Model.extend({urls:{update:i.getURL("timelines/filters/add"),"delete":i.getURL("timelines/filters/remove")},parse:function(e){return e.response||e},serializeData:function(){return{filter:this.id,api_key:a.keys.api}},sync:function(e,n,i){return i.emulateHTTP=!0,i.emulateJSON=!1,i.processData=!0,("update"===e||"delete"===e)&&(i.data=n.serializeData()),i.url=this.urls[e],t.Model.prototype.sync.call(this,e,n,i)}},{FILTER_LIKEPOST:"likepost",FILTER_INVITE:"invite",FILTER_RECOMMEND:"favoritethread",FILTER_THREADREPLIES:"threadreplies"})}),define("home/collections/TimelineFiltersCollection",["jquery","backbone","underscore","core/api","core/config","home/models/TimelineFilter"],function(e,t,n,i,a,s){return t.Collection.extend({model:s,initialize:function(e,t){t=t||{},this.type=t.type},url:function(){return i.getURL("timelines/filters/list")+"?"+e.param({type:this.type})},addFilter:function(e){var t=this.get(e);return t||(t=this.add({id:e})),t.save()},removeFilter:function(e){var t=this.get(e);return t||(t=new s({id:e})),t.destroy()},parse:function(e){return e.response||e}})}),define("home/models/FollowRecommendation",["backbone","core/UniqueModel"],function(e,t){var n=e.Model.extend({defaults:{reason:""},initialize:function(){this.object=this.get("object"),this.unset("object")}});return t.addType("FollowRecommendation",n),n}),define("home/collections/FollowRecommendationCollection",["underscore","backbone","core/UniqueModel","home/models/FollowRecommendation"],function(e,t,n,i){return t.Collection.extend({model:n.boundModel(i),initialize:function(e,t){this.expander=t.expander},parse:function(t){return t=t.response,e.map(t.items,function(e){return{object:this.expander(t.objects,e.id),reason:e.reason}},this)}})}),define("home/models/FollowRecommendationFeed",["underscore","core/api","home/activityExpander","home/models/Feed","home/collections/FollowRecommendationCollection"],function(e,t,n,i,a){var s=i.extend({defaults:{fetchOptions:{limit:3}},initialize:function(e,t){return t=t||{},t.collectionClass=a,i.prototype.initialize.call(this,e,t)}},{createUserFollowRecommendationFeed:function(i){return i=i||{},new s(i,{collectionOptions:{expander:e.bind(n.buildUser,n)},collectionUrl:t.getURL("users/interestingUsers")})},createForumFollowRecommendationFeed:function(i){return i=i||{},new s(i,{collectionOptions:{expander:e.bind(n.buildForum,n)},collectionUrl:t.getURL("forums/interestingForums")})}});return s}),define("home/models/Notifications",["underscore","backbone","home/models/Feed","home/collections/NotificationCollection","home/collections/TimelineFiltersCollection","home/models/FollowRecommendationFeed"],function(e,t,n,i,a,s){var o=t.Model.extend({initialize:function(e){this.session=e.session;var t=function(e){return-1*new Date(e.get("published")).getTime()};this.all=new n({},{collectionClass:i,collectionOptions:{comparator:t,type:"notifications"}}),this.replies=new n({},{collectionClass:i,collectionOptions:{comparator:t,type:"notifications",index:"replies"}}),this.interestingForums=s.createForumFollowRecommendationFeed(),this.interestingUsers=s.createUserFollowRecommendationFeed(),this.unreadCounter=this.all.items.unreadCounter,this.filters=new a,this.listenTo(this.all,"clearUnreadCount",this.clearUnreadCount)
},ensureFetchedRecommendations:function(){this.interestingForums.ensureFetched(),this.interestingUsers.ensureFetched()},ensureFetched:function(){this.session.isKnownToBeLoggedOut()||this.all.fetched||(this.unreadCounter.fetch({initializeOnly:!0}),this.all.fetchItems())},clearUnreadCount:function(){this.unreadCounter.set({numUnread:0}),this.all.items.syncReadPosition()}});return o}),define("home/models/AnonUser",["core/models/BaseUser","home/utils/navigationUtils"],function(e,t){var n=e.extend({initialize:function(){this.listenTo(this,"followed:user",this.promptLogin),this.listenTo(this,"unfollowed:user",this.promptLogin),this.listenTo(this,"followed:forum",this.promptLogin),this.listenTo(this,"unfollowed:forum",this.promptLogin),this.listenTo(this,"followed:channel",this.promptLogin),this.listenTo(this,"unfollowed:channel",this.promptLogin),this.listenTo(this,"subscribe:thread",this.promptLogin),this.listenTo(this,"unsubscribe:thread",this.promptLogin)},promptLogin:function(){t.navigateToLogin()},isDisqusNetMod:function(){return!1}});return function(){var e;return function(){return e||(e=new n),e}}()}),define("home/models/Session",["jquery","underscore","backbone","modernizr","core/api","core/utils/cookies","core/models/Session","core/UniqueModel","home/models/User","home/models/UserProfile","home/models/Notifications","home/models/AnonUser","home/utils/backboneUtils","home/utils/sidebarUtils"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m){var p,f=o.extend({initialize:function(){o.prototype.initialize.apply(this,arguments),this.moderatedForums=[],this._load=e.Deferred(),this._loadPromise=this._load.promise(),this.load=t.once(this.load,this),this.loadModeratedForums=t.once(this.loadModeratedForums,this)},getAnonUserInstance:function(e){return new u(e)},isAnonymous:function(){return this.user.get("isAnonymous")},setUser:function(e){return this.user&&this.stopListening(this.user),this.listenTo(e,"all",this.trigger),o.prototype.setUser.apply(this,arguments)},loadModeratedForums:function(){var t=this.user,i=this;return this._fromCookie().isModerator?n.ajax({url:a.getURL("internal/users/details"),success:function(e){var n=e.response.moderated_forums;i.moderatedForums=n,i.trigger("setModeratedForums",n),t.set({isModerator:!!n.length,moderatedForums:n})},context:t}):e.Deferred().resolve().promise()},provider:function(){var e=this._fromCookie().username;return e?-1===e.indexOf("-")?"disqus":e.split("-")[0]:""},fromSessionStorage:function(){var e;try{e=JSON.parse(window.sessionStorage[f.STORAGE_KEY]),delete window.sessionStorage[f.STORAGE_KEY]}catch(n){}return t.isObject(e)?e:void 0},load:function(){var e=this._load,t=this.fromSessionStorage();if(m.isSidebar()&&t&&t.username&&t.id)this.setUser(this.getUserInstance(t)),this.fetched=!0,e.resolve(this);else if(this.isKnownToBeLoggedOut())e.reject(this);else{var n=this;n.fetch().done(function(){e.resolve(n)}).fail(function(){e.reject(n)})}},loadPromise:function(){return this._loadPromise},fetch:function(){if(this.fetchPromise)return this.fetchPromise;var e=this,t=h.memoizedFetch.apply(this,arguments);return t.then(function(){e.trigger("fetch:success")},function(){e.trigger("fetch:error")}),t},getUserInstance:function(e){return new r(l,e)},getUserProfile:function(){return this.isAnonymous()?void 0:this.userProfile},getOrCreateNotifications:function(){return this.notifications||(this.notifications=new d({session:this}),this.notifications.ensureFetched()),this.notifications},toJSON:function(){return this.user.toJSON.apply(this.user,arguments)},initUserProfile:function(e){if(e){this.userProfile&&this.userProfile.stopListening(this),this.userProfile=new r(c,{username:e});var i=function(e){e instanceof n.Model&&(e=t([e])),e.each(function(e){e.primaryForum&&(e=e.primaryForum),e.set("isFollowing",!0)})};this.userProfile.forumsFollowing.on("items:sync",i),this.userProfile.channelsFollowing.on("items:sync",i);var a=this.userProfile.following.get("items"),s=this.userProfile.forumsFollowing.get("items"),o=this.userProfile.channelsFollowing.get("items");this.userProfile.listenTo(this,"followed:user",t.bind(a.add,a)),this.userProfile.listenTo(this,"unfollowed:user",t.bind(a.remove,a)),this.userProfile.listenTo(this,"followed:forum",t.bind(s.add,s)),this.userProfile.listenTo(this,"unfollowed:forum",t.bind(s.remove,s)),this.userProfile.listenTo(this,"followed:channel",t.bind(o.add,o)),this.userProfile.listenTo(this,"unfollowed:channel",t.bind(o.remove,o)),this.fetchFollowedForums(),this.fetchFollowedChannels()}},fetchFollowedForums:function(){this.userProfile.fetchForumsFollowing()},fetchFollowedChannels:function(){this.userProfile.fetchChannelsFollowing()},logout:function(){this.setUser(this.getAnonUserInstance()),window.top.location="//disqus.com/logout/?redirect=http%3A%2F%2Fdisqus.com"}},{STORAGE_KEY:"home.session"});return f.get=function(){return p=p||new f},f.forget=function(){p&&(p.stopListening(),p.off(),p=null)},f}),define("home/utils/mixpanelUtils",["jquery","underscore","home/models/Session","home/utils/backboneUtils","home/utils/navigationUtils"],function(e,t,n,i,a){var s=[];return{queue:s,buildProductProperties:function(){return{product:require("home/utils/trackingUtils").productName()}},buildLocationProperties:function(t,n){if(!t)return{};var i={},a=e(t.target),s=a.parents("[data-mix-location],[data-mix-location-dtl]");return(a.data("mixLocation")||a.data("mixLocationDtl"))&&s.splice(0,0,a[0]),i.location=s.map(function(t,n){return e(n).data("mixLocation")}).toArray().reverse().join(" "),n&&(i.detailedLocation=s.map(function(t,n){return e(n).data("mixLocation")||e(n).data("mixLocationDtl")}).toArray().reverse()),i},buildUserProperties:function(i){this.session||(this.session=n.get());var a=[];!i&&this.session.fetchPromise&&a.push(this.session.fetchPromise);var s=t.bind(function(){var e=this.session.user,t=[];return this.session.isAnonymous()?t.push("anon"):(e.get("numPosts")>0&&t.push("commenter"),e.get("numFollowing")>0&&t.push("userFollower"),e.get("numForumsFollowing")>0&&t.push("forumFollower"),this.isFollowingChannel(e)&&t.push("channelFollower"),t.length||t.push("inactive"),e.get("isVerified")&&t.push("verified")),{user:t.join(",")}},this);return e.when.apply(this,a).then(t.bind(this.ensureChannelFollowingDetails,this)).then(s,s)},ensureChannelFollowingDetails:function(){return this.session.isAnonymous()?void 0:e.when(this.ensureForumsFollowing(),this.ensureNumChannelsFollowing())},ensureForumsFollowing:function(){return this.session.userProfile.forumsFollowing.ensureFetched()},ensureNumChannelsFollowing:function(){return i.getPromiseFor(this.session.user,"numChannelsFollowing")},isFollowingChannel:function(e){return e.get("numChannelsFollowing")>0||this.session.userProfile.forumsFollowing.items.any(function(e){return!!e.channel})},trackUser:function(e){window.mixpanel&&(window.mixpanel.identify(e.get("id")),window.mixpanel.people.set({name:e.get("name"),username:e.get("username"),joinedAt:e.get("joinedAt")}))},trackError:function(){return this.track.apply(this,arguments)},isLinkClick:function(t){return t&&t.target&&e(t.target).attr("href")},shouldDelayLinkClick:function(e,t){return!t.callback&&!a.shouldNotHandleLinkClick(e,e.target)&&a.linkClickChangesPage(e,e.target)},delayLinkClick:function(t,n){var i=e(t.target).attr("href");t.preventDefault(),n.callback=function(){window.top.location=i}},track:function(e,n,i){if(window.mixpanel){i=i||{},i.properties=t.extend({version:"2"},i.properties),this.isLinkClick(n)&&this.shouldDelayLinkClick(n,i)&&this.delayLinkClick(n,i),i.properties=t.extend(this.buildLocationProperties(n,i.includeDetails),i.properties),t.extend(i.properties,this.buildProductProperties());var a=!!i.callback||i.skipUserProperties;this.buildUserProperties(a).always(function(n){t.defaults(i.properties,n),window.mixpanel.track(e,i.properties,i.callback)})}},trackOnce:function(e,t,n,i){var a=i?e+i:e;this.tracked&&this.tracked[a]||(this.tracked=this.tracked||{},this.tracked[a]=!0,this.track(e,t,n))}}}),define("home/mixins/asEmbedLayout",["jquery","underscore","backbone","core/frameBus","core/utils","home/utils/mixpanelUtils"],function(e,t,n,i,a,s){var o=function(){var n=this.events||{};this.events=t.extend({"click [data-action=close-drawer]":"closeDrawer","click .viewport":"closeDrawerOnClick","click [data-action=full-home]":"openFullHome","click [data-action=full-root]":"openFullRoot","click [data-action=refresh-drawer]":"handleRefresh","wheel .scrollable-measure-selector":"handleScroll","wheel .viewport":"handleViewportScroll","mousewheel .scrollable-measure-selector":"handleScroll","mousewheel .viewport":"handleViewportScroll"},n),this.handleRefresh=function(t){t.preventDefault();var n=e(t.currentTarget);n.addClass("loading");var i=this.session.getOrCreateNotifications(),a=e.Deferred(),s=e.Deferred();e.when(a,s).done(function(){n.removeClass("loading"),i.all.trigger("clearUnreadCount")}),i.all.fetchItems({reset:!0,success:function(){a.resolve()}}),i.replies.fetchItems({reset:!0,success:function(){s.resolve()}})},this.openFullHome=function(e){s.track("click full home",e),e.preventDefault(),window.open(window.location.href,"_blank")},this.openFullRoot=function(e){s.track("click full root",e)},this.closeDrawerOnClick=function(t){e(t.target).hasClass("viewport")&&this.closeDrawer(t)},this.isIE10=function(){return 10===document.documentMode},this.closeDrawer=function(n){n.preventDefault();var s=e("body");s.removeClass("active"),this.isIE10()||!a.transitionEndEvent?t.delay(t.bind(i.sendHostMessage,this,"close"),300):s.one(a.transitionEndEvent,function(){i.sendHostMessage("close")})};var o=this.onRender;this.onRender=function(){o.apply(this,arguments),t.defer(t.bind(i.trigger,i,"mainlayoutRendered"))},this.getScrollableContainer=function(){return this.scrollableContainer&&e.contains(document.documentElement,this.scrollableContainer[0])||(this.scrollableContainer=this.$(".scrollable-measure-selector")),this.scrollableContainer},this.handleViewportScroll=function(e){e.preventDefault()},this.handleScroll=function(e){var t=e.originalEvent,n=t.wheelDeltaY||-t.deltaY,i=this.getScrollableContainer();i&&(0===i.scrollTop()&&n>0&&e.preventDefault(),i.scrollTop()+i.innerHeight()>=i[0].scrollHeight&&0>n&&e.preventDefault(),e.stopPropagation())}};return o}),define("home/mixins/withClickLinkTracking",["jquery","underscore","core/bus"],function(e,t,n){var i=t.debounce(function(e,t){n.trigger("uiAction:clickLink",e,t)},500,!0);return function(t){this.trackClickLink=function(n){var a=e(n.currentTarget),s={adjective:a.attr("data-link-name")};s.area=t?t:a.closest("[data-jester-area]").attr("data-jester-area"),i(n,s)}}}),define("home/utils/chartbeatUtils",["jquery","underscore"],function(e,t){var n=["zone","subZone","channel_slug","forum","author","title"],i=[],a=e.Deferred().resolve().promise(),s=function(e){return t.chain(e).pick(n).omit(["author","title"]).values().compact().value().join(", ")},o=function(e,n,i,a){window._sf_async_config={uid:59352,domain:(window.IS_DEV?"dev.":"")+"disqus.com",useCanonical:!1,path:window.location.pathname,sections:e,authors:i,title:n},require(["//static.chartbeat.com/js/chartbeat.js"],t.bind(a.resolve,a),t.bind(a.reject,a))},r=t.debounce(function(){var n=e.Deferred(),s=t.clone(i),o=document.title;s.push(a.promise()),e.when.apply(e,s).then(function(){var e=t.extend.apply(t,arguments);e.title=e.title?"Disqus "+e.title:o,l(e,n)}),a=n.promise()},500),l=function(e,t){if("DNT"!==e.zone){var n=s(e),i=e.title,a=e.author;if(!window._sf_async_config)return void o(n,i,a,t);window._sf_async_config.sections=n,window._sf_async_config.authors=a,window.pSUPERFLY.virtualPage(window.location.pathname,i),t.resolve()}};return{init:function(){window._sf_endpt=(new Date).getTime(),this.handleRouteChange=r},handleRouteChange:e.noop,clearSections:function(){i=[]},updateSections:function(e){i.push(e)}}}),define("core/analytics/jester",["jquery","underscore","backbone","core/analytics/identity","core/config/urls"],function(e,t,n,i,a){var s=n.Model.extend({url:a.jester+"/event.js",defaults:{experiment:"default",variant:"control"},setHostReferrer:function(e){e&&-1!==e.indexOf("http")&&this.set("page_referrer",e)},decoratePayload:function(n){n.event||(n.event="activity"),n=t.extend(this.toJSON(),n),t.extend(n,{imp:i.impression.impId,prev_imp:i.impression.prevImp}),n.section||(n.section="default"),n.area||(n.area="n/a");var a=e.param(n).length;if(a>2048&&this.has("page_referrer")){var s=document.createElement("a");s.href=this.get("page_referrer");var o=s.hostname;o&&(n.page_referrer_domain=o),delete n.page_referrer}return n},emit:function(n){return e.ajax({url:t.result(this,"url"),data:this.decoratePayload(n),dataType:"script",cache:!0})}}),o=function(t){var n=new Image;return n.src=a.jester+"/stat.gif?"+e.param({event:t}),n},r=function(n,i){if(!t.any(i,function(e){return 0>=e})){t.each(i,function(e,t){i[t]=Math.round(e)});var s=new Image;return s.src=a.jester+"/telemetry/"+n+".gif?"+e.param(i),s}},l=new s;return{ActivityClient:s,client:l,logStat:o,telemetry:r}}),define("home/utils/trackingUtils",["jquery","underscore","backbone","remote/config","home/models/Session","home/utils/mixpanelUtils","home/utils/sidebarUtils","home/utils/chartbeatUtils","home/utils/navigationUtils","core/analytics/jester","core/config/urls","core/bus"],function(e,t,n,i,a,s,o,r,l,c,d,u){function h(t){if(!l.lastNavigateTime){var n=window.performance;if(n){var i=e.now()-n.timing.navigationStart,a={};return a[t]=i,c.telemetry("home",a)}}}function m(e,t){var n=t/100;return function(){Math.random()<n&&e.apply(this,arguments)}}var p=m(h,i.lounge.home_telemetry_sampling_percent),f={},g={showFirstCard:p,showDiscussionCover:p,openSection:function(){y({verb:"open",object_type:"section",object_id:c.client.get("zone")+"/"+c.client.get("section")})},viewSection:function(){y({verb:"view",object_type:"section",object_id:c.client.get("zone")+"/"+c.client.get("section")}),r.handleRouteChange()},viewTab:function(){r.handleRouteChange()},viewFeed:function(e){var t={verb:"open",object_type:"section",object_id:c.client.get("zone")+"/"+c.client.get("section")+"/page-1"};e.isError()?t.adjective="error":e.collection.length||(t.adjective="empty"),y(t)},viewMoreFeed:function(e){y({verb:"open",object_type:"section",object_id:c.client.get("zone")+"/"+c.client.get("section")+"/page-"+e})},removeFollower:function(e){y({verb:"remove-follower",object_type:"user",object_id:e.get("id")})},"uiCallback:postCreated":function(e,n){n=n||{},t.extend(n,{object_type:"post",object_id:e.id,verb:"post"}),e.has("parent")&&(n.target_type="comment",n.target_id=e.get("parent")),y(n)},"uiAction:postUpvote":function(e){y({verb:"like",object_type:"post",object_id:e.id})},"uiAction:postUnvote":function(e){y({verb:"unlike",object_type:"post",object_id:e.id})},"uiAction:postDownvote":function(e){y({verb:"dislike",object_type:"post",object_id:e.id})},"uiAction:clickLink":function(n,i){var a=e(n.currentTarget),s=l.isInbound(a[0]);t.each(v,function(e,t){var n=a.attr(e);n&&(i[t]=n)}),y(t.extend({verb:"click",object_type:"link",object_id:a.attr("href"),adverb:s?"internal":"external"},i))},threadFavorited:function(e){y({verb:"like",object_type:"thread",object_id:e.id})}},v={forum_id:"data-forum-pk",thread_id:"data-thread-id",channel_slug:"data-channel-slug"},w={user:"profile","/by/\\w+":"profile",inbox:"notifications","/welcome/?$":"welcome","/explore(/.+)?":"explore",discussion:"thread",discuss:"thread",edit:"thread",forum:"community",topic:"topic",settings:"settings",discover:"discover","/channels(\\/(yours|explore))?\\/?(\\?.+)?$":"discover","/channels?/\\w+":"channel","/home/?$":"activityfeed",preload:"DNT"},b=["channel_slug","forum"],x="n/a",y=function(n){"DNT"!==n.zone&&(n.zone||"DNT"!==c.client.get("zone"))&&e.when(f).then(function(e){c.client.emit(t.defaults(n,t.pick(e,b)))})};return{init:function(){var e={experiment:"V2",variant:"active",product:this.productName(),page_referrer_url:document.referrer};c.client.set(e),o.isSidebar()||r.init(),u.on(g)},productName:function(){return o.isSidebar()?"bridge":"home"},jesterEmit:y,pageChanged:function(){r.clearSections(),this.urlChanged(),this.setSection(),f={}},urlChanged:function(){var e=document.location.href,n=t.find(w,function(t,n){return RegExp(n).test(e)});c.client.set({page_url:e,zone:n||x}),r.updateSections({zone:n})},setSection:function(e){c.client.set({section:e||"default"}),r.updateSections({subZone:e})},setPageParams:function(e){f=e,r.updateSections(e)},initUser:function(e){e&&c.client.set("user_id",e)},trackVisit:function(){o.isSidebar()||s.track("visit",{target:e("body")}),c.client.has("zone")||this.urlChanged();var n=this.productName(),i=function(){y({verb:"view",object_type:"product",object_id:n})},r=a.get();r.loadPromise().always(t.bind(function(){this.initUser(r.user.get("id")),i()},this))},trackChannelVisit:function(t){s.trackOnce("visit_channel",{target:e("body")},{properties:{channel:t}},t)}}}),define("home/collections/UserCollection",["backbone","core/UniqueModel","home/models/User"],function(e,t,n){var i=e.Collection.extend({model:t.boundModel(n),initialize:function(e,t){t&&t.url&&(this.url=t.url)},parse:function(e){return e.response}});return i}),define("home/collections/ModeratorCollection",["underscore","home/collections/UserCollection"],function(e,t){var n=t.extend({parse:function(t){return e.pluck(t.response,"user")}});return n}),define("home/collections/SourceForumCollection",["underscore","core/api","home/collections/ForumCollection"],function(e,t,n){var i=n.extend({url:t.getURL("internal/channels/listSourceForums"),initialize:function(e,t){this.channelId=t&&t.channelId},fetch:function(t){return t=t||{},t.data=e.extend({channel:this.channelId},t.data),n.prototype.fetch.call(this,t)}});return i}),define("home/models/ChannelProfile",["jquery","underscore","backbone","remote/config","core/utils/storage","core/UniqueModel","home/models/Feed","home/models/Channel","home/models/Topic","home/collections/FeedItemCollection","home/collections/UserCollection","home/collections/ModeratorCollection","home/collections/TopicCollection","home/collections/SourceForumCollection","home/utils/backboneUtils","core/api","core/switches"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f,g){var v=g.isFeatureActive("channelComments"),w=n.Model.extend({defaults:{channel:void 0},initialize:function(e,n){n=n||{},this.initializeRelated("channel",n,r);var i,s=this.channel.id,l="channel:"+s;this.recentActivities=new o(n.recentActivitiesOptions,{collectionClass:c,collectionOptions:{type:"profile",target:l}}),a.get("channelSort")&&(n.topActivitiesOptions=n.topActivitiesOptions||{},n.topActivitiesOptions.fetchOptions=t.defaults({sort:a.get("channelSort")},n.topActivitiesOptions.fetchOptions)),this.topActivities=new o(n.topActivitiesOptions,{collectionClass:c,collectionUrl:f.getURL("timelines/ranked"),collectionOptions:{type:"default",target:l}}),this.comments=new o(n.commentsOptions,{collectionClass:c,collectionOptions:{type:"comments",target:l}}),this.sourceForums=new m([],{channelId:this.channel.id}),i={channel:this.channel.id,limit:10},this.leaders=new o({fetchOptions:i},{collectionClass:d,collectionUrl:f.getURL("channels/communityLeaders")}),this.channel.primaryForum?i={forum:this.channel.primaryForum.id}:(this.listenToOnce(this.channel,"changeRelated:primaryForum",function(){this.moderators.set({fetchOptions:{forum:this.channel.primaryForum.id}})}),i=null),this.moderators=new o({fetchOptions:i},{collectionClass:u,collectionUrl:f.getURL("forums/listModerators")}),this.trendingTopics=new o({fetchOptions:{channel:this.channel.id,limit:15}},{collectionClass:h,collectionUrl:f.getURL("channels/listTrendingTopics")}),this.topicFilteredFeeds={}},toJSON:function(){var e=n.Model.prototype.toJSON.apply(this,arguments);return t.defaults({channel:this.channel.toJSON(),recentActivities:this.recentActivities.toJSON(),topActivities:this.topActivities.toJSON(),trendingTopics:this.trendingTopics&&this.trendingTopics.items.toJSON()},e)},getFetchedTopicFilteredFeed:function(e){if(this.trendingTopics){var t=this.topicFilteredFeeds[e];return t||(t=this.topicFilteredFeeds[e]=new o({fetchOptions:{topic:e}},{collectionClass:c,collectionUrl:f.getURL("timelines/ranked"),collectionOptions:{type:"default",target:"channel:"+this.channel.id}})),t.ensureFetched(),t}},ensureFetched:function(){this.channel.ensureFetched(),this.recentActivities.ensureFetched(),this.ensureFetchedTopActivities(),v&&this.comments.ensureFetched(),this.ensureFetchedLeaders(),this.ensureFetchedModerators(),this.ensureFetchedTrendingTopics()},ensureFetchedTrendingTopics:function(){this.trendingTopics&&this.trendingTopics.ensureFetched()},ensureFetchedTopActivities:function(){this.topActivities.ensureFetched()},ensureFetchedLeaders:function(){return this.leaders.ensureFetched(),this.leadersPromise=this.leaders.fetchPromise},ensureFetchedModerators:function(){if(!this.moderatorsPromise){if(this.moderators.get("fetchOptions"))this.moderators.ensureFetched(),this.moderatorsPromise=this.moderators.fetchPromise;else{var e=this.moderators;this.moderatorsPromise=p.getPromiseFor(e,"fetchOptions").then(function(){return e.ensureFetched(),e.fetchPromise})}this.moderatorsPromise.then(t.bind(this.markModerators,this))}},ensureFetchedSourceForums:function(){return this.sourceForumsPromise||(this.sourceForumsPromise=this.sourceForums.fetch()),this.sourceForumsPromise},markModerators:function(){var e=this.channel.primaryForum.id;this.moderators.items.each(function(n){var i=n.get("moderatedForums")||[];n.set({moderatedForums:t.union(i,[e])})})}});return s.addType("ChannelProfile",w),w}),define("home/collections/ChannelProfileCollection",["underscore","core/collections/PaginatedCollection","core/UniqueModel","home/activityExpander","home/models/ChannelProfile"],function(e,t,n,i,a){var s=a,o=t.extend({model:n.boundModel(s),parse:function(n){return n=t.prototype.parse.call(this,n),n.items?e.map(n.items,function(e){var t=i.buildChannel(n.objects,e.reference),a={channel:t};return a[s.prototype.idAttribute]=t.id,{id:t.id,channel:t}}):n}});return o}),define("home/models/ChannelProfileFeed",["underscore","core/api","core/UniqueModel","home/collections/ChannelProfileCollection","home/models/Feed"],function(e,t,n,i,a){var s=a.extend({idAttribute:"listName",initialize:function(n,s){s=e.extend({collectionClass:i,collectionUrl:t.getURL("channels/list")},s),a.prototype.initialize.call(this,n,s),this.set("fetchOptions",e.extend({listName:this.get("listName")},this.get("fetchOptions")))}},{LIST_NAMES:{promoted:"promoted",explore:"explore"}});return n.addType("ChannelProfileFeed",s),s}),define("home/templates/nav",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<div class="align__item site-nav__item">\n<a class="nav-discover nav__lnk nav__lnk--primary hover-link"\ndata-role="explore" data-page-icon="explore exploreChannel" href="/home/explore/">\n<span class="site-nav__icon_wrapper">\n<svg class="icon-explore site-nav__icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 22 22" version="1.1" x="0px" y="0px"><g class="outline"><path d="M11,22 C17.0751325,22 22,17.0751325 22,11 C22,4.92486745 17.0751325,0 11,0 C4.92486745,0 0,4.92486745 0,11 C0,17.0751325 4.92486745,22 11,22 L11,22 Z M5.69559185,5.6975623 L9.23181625,12.7679396 L16.3021935,16.3041641 L12.7676954,9.2320604 L5.69559185,5.6975623 L5.69559185,5.6975623 Z M7.32147215,7.3591919 L11.9771118,10.0310669 L10.0346069,12.0039673 L7.32147215,7.3591919 L7.32147215,7.3591919 Z" class="fill"></path></g></svg>\n<strong>\n'+a(t.gettext.call(e,"Explore",{name:"gettext",hash:{},data:i}))+"\n</strong>\n</span>\n</a>\n</div>\n"},3:function(e,t,n,i){var a=this.escapeExpression;return'<a href="/admin/" data-action="admin-click">\n'+a(t.gettext.call(e,"Admin",{name:"gettext",hash:{},data:i}))+"\n</a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<nav class="site-nav section-contained  align align--between" data-mix-location="nav">\n<div class="align__item  align">\n<div class="align__item site-nav__item site-nav__logo-wrapper">\n';return a=this.invokePartial(n.navLogo,"","navLogo",e,void 0,t,n,i),null!=a&&(o+=a),o+='</div>\n<div class="site-nav--secondary align__item align">\n<div class="align__item site-nav__item">\n<a href="/" class="nav-home nav__lnk nav__lnk--primary hover-link" data-page-icon="home">\n<span class="site-nav__icon_wrapper">\n<svg class="icon-home site-nav__icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 16 18" enable-background="new 0 0 16 18" xml:space="preserve"><polygon points="6,18 6,12 10,12 10,18 16,18 16,7.9 8,0 0,7.9 0,18" class="fill" /></svg>\n<strong>'+s(t.gettext.call(e,"Home",{name:"gettext",hash:{},data:i}))+'</strong>\n</span>\n</a>\n</div>\n<div class="align__item site-nav__item">\n<a class="nav-notif nav__lnk nav__lnk--primary hover-link"\ndata-role="notifications" data-page-icon="inbox" href="/home/inbox/">\n<span class="site-nav__icon_wrapper">\n<div class="notif-count" data-role="unread-notification-count"></div>\n<svg class="icon-notif site-nav__icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"><path d="M10.4 20c5.3 0 9.6-4.5 9.6-10S15.7 0 10.4 0C5 0 0.7 4.5 0.7 10 c0 1.5 0.3 2.9 0.9 4.1L0 18.2l4.1-0.6C5.8 19.1 8 20 10.4 20z" class="icon-notif__fill" /><path d="M11 11.2v2.6l4-3.9L11 6v2.3C6.1 8.3 5 14 5 14 C6.4 11.4 8.3 11.2 11 11.2z" class="arrow"/></svg>\n<strong>'+s(t.gettext.call(e,"Notifications",{name:"gettext",hash:{},data:i}))+'</strong>\n</span>\n</a>\n</div>\n<div class="align__item site-nav__item">\n<a class="nav-discover nav__lnk nav__lnk--primary hover-link"\ndata-role="discover" data-page-icon="channels" href="/home/channels/">\n<span class="site-nav__icon_wrapper">\n<svg class="icon-discover site-nav__icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 18 18" enable-background="new 0 0 18 18" xml:space="preserve"><rect x="14" width="4" height="4" class="dot"/><rect x="14" y="7" width="4" height="4" class="dot"/><rect x="14" y="14" width="4" height="4" class="dot"/><rect x="7" width="4" height="4" class="dot"/><rect x="7" y="7" width="4" height="4" class="dot"/><rect x="7" y="14" width="4" height="4" class="dot"/><rect width="4" height="4" class="dot"/><rect y="7" width="4" height="4" class="dot"/><rect y="14" width="4" height="4" class="dot"/></g></svg>\n<strong>\n'+s(t.gettext.call(e,"Channels",{name:"gettext",hash:{},data:i}))+"\n</strong>\n</span>\n</a>\n</div>\n",a=t["if"].call(e,null!=e?e.showHomeOnboarding:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='</div>\n</div>\n<div class="site-nav--onboarding" data-role="onboarding-steps">\n<div class="site-nav__item text-center"\ndata-role="onboarding-steps-icon" data-onboarding-step="1">\n<div class="onboarding__label">'+s(t.gettext.call(e,"Step 1",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="onboarding__icon">\n<span class="icon-checkmark text-small text-success"></span>\n</div>\n<div class="onboarding__bar"></div>\n</div>\n<div class="site-nav__item text-center"\ndata-role="onboarding-steps-icon" data-onboarding-step="2">\n<div class="onboarding__label">'+s(t.gettext.call(e,"Step 2",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="onboarding__icon">\n<span class="icon-checkmark text-small text-success"></span>\n</div>\n<div class="onboarding__bar"></div>\n</div>\n<div class="site-nav__item text-center"\ndata-role="onboarding-steps-icon" data-onboarding-step="3">\n<div class="onboarding__label">'+s(t.gettext.call(e,"Step 3",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="onboarding__icon">\n<span class="icon-checkmark text-small text-success"></span>\n</div>\n<div class="onboarding__bar"></div>\n</div>\n</div>\n<div class="align__item align site-nav--user">\n<div class="align__item site-nav__item--discuss">\n<button class="button -small button-outline" data-action="create-discussion">\n<span class="icon-create-discussion icon-small"></span>\n<span class="text-medium spacing-left-small hidden-lg">'+s(t.gettext.call(e,"Discuss",{name:"gettext",hash:{},data:i}))+'</span>\n</button>\n</div>\n<div class="align__item tooltipped site-nav__item--profile"\ndata-role="user" data-page-icon="profile" data-toggle="tooltip" data-placement="bottom" title="'+s(t.gettext.call(e,"Profile",{name:"gettext",hash:{},data:i}))+'">\n',a=this.invokePartial(n.navUserIcon,"","navUserIcon",e,void 0,t,n,i),null!=a&&(o+=a),o+='</div>\n<div class="align__item tooltipped bottom-right site-nav__item--reverse"\ndata-toggle="tooltip" data-placement="bottom" title="'+s(t.gettext.call(e,"Settings",{name:"gettext",hash:{},data:i}))+'" data-role="settings">\n<div class="dropdown" data-action="toggle-dropdown" data-dropdown="settings">\n<a data-toggle="dropdown" class="dropdown-toggle nav__lnk nav__lnk--settings" href="#">\n<svg class="icon-settings site-nav__icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"><path d="M10 13.8c2.1 0 3.8-1.7 3.8-3.8S12.1 6.2 10 6.2S6.2 7.9 6.2 10 S7.9 13.8 10 13.8z M20 8.8v2.5c0 0.3-0.2 0.6-0.5 0.6l-2.3 0.3c-0.1 0.5-0.3 0.9-0.6 1.4l1.4 1.8c0.2 0.2 0.2 0.6-0.1 0.8L16.2 18 c-0.1 0.1-0.3 0.2-0.5 0.2c-0.1 0-0.3 0-0.4-0.1l-1.8-1.4c-0.4 0.2-0.9 0.4-1.4 0.6l-0.3 2.3c0 0.3-0.3 0.5-0.6 0.5H8.8 c-0.3 0-0.6-0.2-0.6-0.5l-0.3-2.3c-0.5-0.1-0.9-0.3-1.4-0.6L4.6 18c-0.1 0.1-0.2 0.1-0.4 0.1c-0.2 0-0.3-0.1-0.4-0.2L2 16.2 C1.8 16 1.8 15.6 2 15.4l1.4-1.8c-0.2-0.4-0.4-0.9-0.6-1.4l-2.3-0.3c-0.3 0-0.5-0.3-0.5-0.6V8.8c0-0.3 0.2-0.6 0.5-0.6l2.3-0.3 C3 7.3 3.2 6.9 3.4 6.5L2 4.6C1.8 4.4 1.8 4 2 3.8L3.8 2c0.1-0.1 0.3-0.2 0.4-0.2c0.1 0 0.3 0 0.4 0.1l1.8 1.4 C6.9 3.2 7.3 3 7.8 2.8l0.3-2.3C8.2 0.2 8.4 0 8.8 0h2.5c0.3 0 0.6 0.2 0.6 0.5l0.3 2.3c0.5 0.2 0.9 0.3 1.4 0.6L15.4 2 c0.1-0.1 0.2-0.1 0.4-0.1c0.2 0 0.3 0.1 0.5 0.2L18 3.8C18.2 4 18.2 4.4 18 4.6l-1.4 1.8c0.2 0.4 0.4 0.9 0.6 1.4l2.3 0.3 C19.8 8.2 20 8.4 20 8.8z" class="fill"/></svg>\n</a>\n<ul class="dropdown-menu dropdown-settings" data-mix-location="user menu">\n<li class="hidden-md">\n<a href="/home/settings/profile/">\n'+s(t.gettext.call(e,"Edit Profile",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li class="hidden-md">\n<a href="/home/settings/account/">\n'+s(t.gettext.call(e,"Settings",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li class="visible-md">\n<a href="/home/settings/">\n'+s(t.gettext.call(e,"Settings",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li role="presentation" class="divider hidden-md"></li>\n<li>\n<a href="/home/channels/new/">\n'+s(t.gettext.call(e,"Create a Channel",{name:"gettext",hash:{},data:i}))+"\n</a>\n</li>\n<li>\n",a=t["if"].call(e,null!=e?e.isModerator:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+'</li>\n<li>\n<a href="/follow/facebook/">\n'+s(t.gettext.call(e,"Find Friends",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li>\n<a href="http://publishers.disq.us/engage?utm_source=Home-Nav" class="hidden-md">\n'+s(t.gettext.call(e,"Add %(disqus)s To Site",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+'\n</a>\n</li>\n<li role="presentation" class="divider"></li>\n<li>\n<a href="https://help.disqus.com/" data-role="help">\n'+s(t.gettext.call(e,"Help",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li>\n<a href="https://disqusinquiry.wufoo.com/forms/disqus-channel-moderator-application/">\n'+s(t.gettext.call(e,"Become a Mod",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li>\n<a href="/logout/?redirect=https%3A%2F%2Fdisqus.com%2F" target="_self">\n'+s(t.gettext.call(e,"Log Out",{name:"gettext",hash:{},data:i}))+"\n</a>\n</li>\n</ul>\n</div>\n\n</div>\n</div>\n</nav>\n"
},usePartial:!0,useData:!0})}),define("home/templates/anonNav",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<div class="align__item">\n<div class="site-nav__btngroup">\n<a href="//disqus.com/profile/login/"\nclass="button button-outline text-small site-nav__btn"\ntarget="_self"\ndata-action="navigate-return">\n'+a(t.gettext.call(e,"Log In",{name:"gettext",hash:{},data:i}))+'\n</a>\n<a href="//disqus.com/profile/signup/"\nclass="button button-inverted button-inverted-fill text-small site-nav__btn"\ntarget="_self"\ndata-action="navigate-return">\n'+a(t.gettext.call(e,"Sign Up",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<nav class="site-nav  section-contained  align align--between" data-mix-location="nav">\n<div class="align__item  align">\n<div class="align__item site-nav__item site-nav__logo-wrapper">\n';return a=this.invokePartial(n.navLogo,"","navLogo",e,void 0,t,n,i),null!=a&&(o+=a),o+='</div>\n<div class="site-nav--secondary align__item align" data-role="icon-links">\n<div class="align__item site-nav__item">\n<a href="/" class="nav-home nav__lnk nav__lnk--primary hover-link" data-page-icon="home">\n<span class="site-nav__icon_wrapper">\n<svg class="icon-home site-nav__icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 16 18" enable-background="new 0 0 16 18" xml:space="preserve"><polygon points="6,18 6,12 10,12 10,18 16,18 16,7.9 8,0 0,7.9 0,18" class="fill" /></svg>\n<strong>'+s(t.gettext.call(e,"Home",{name:"gettext",hash:{},data:i}))+'</strong>\n</span>\n</a>\n</div>\n<div class="align__item site-nav__item">\n<a class="nav-notif nav__lnk nav__lnk--primary hover-link"\ndata-role="notifications" data-page-icon="inbox" href="/home/inbox/">\n<span class="site-nav__icon_wrapper">\n<div class="notif-count" data-role="unread-notification-count"></div>\n<svg class="icon-notif site-nav__icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"><path d="M10.4 20c5.3 0 9.6-4.5 9.6-10S15.7 0 10.4 0C5 0 0.7 4.5 0.7 10 c0 1.5 0.3 2.9 0.9 4.1L0 18.2l4.1-0.6C5.8 19.1 8 20 10.4 20z" class="fill" /><path d="M11 11.2v2.6l4-3.9L11 6v2.3C6.1 8.3 5 14 5 14 C6.4 11.4 8.3 11.2 11 11.2z" class="arrow"/></svg>\n<strong>'+s(t.gettext.call(e,"Notifications",{name:"gettext",hash:{},data:i}))+'</strong>\n</span>\n</a>\n</div>\n<div class="align__item site-nav__item">\n<a class="nav-discover nav__lnk nav__lnk--primary hover-link"\ndata-role="discover" data-page-icon="channels" href="/home/channels/">\n<span class="site-nav__icon_wrapper">\n<svg class="icon-discover site-nav__icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 18 18" enable-background="new 0 0 18 18" xml:space="preserve"><rect x="14" width="4" height="4" class="dot"/><rect x="14" y="7" width="4" height="4" class="dot"/><rect x="14" y="14" width="4" height="4" class="dot"/><rect x="7" width="4" height="4" class="dot"/><rect x="7" y="7" width="4" height="4" class="dot"/><rect x="7" y="14" width="4" height="4" class="dot"/><rect width="4" height="4" class="dot"/><rect y="7" width="4" height="4" class="dot"/><rect y="14" width="4" height="4" class="dot"/></g></svg>\n<strong>\n'+s(t.gettext.call(e,"Channels",{name:"gettext",hash:{},data:i}))+'\n</strong>\n</span>\n</a>\n</div>\n<div class="align__item site-nav__item hidden-md">\n<a class="nav-discover nav__lnk nav__lnk--primary hover-link"\ndata-role="explore" data-page-icon="explore exploreChannel" href="/home/explore/">\n<span class="site-nav__icon_wrapper">\n<svg class="icon-explore site-nav__icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 22 22" version="1.1" x="0px" y="0px"><g class="outline"><path d="M11,22 C17.0751325,22 22,17.0751325 22,11 C22,4.92486745 17.0751325,0 11,0 C4.92486745,0 0,4.92486745 0,11 C0,17.0751325 4.92486745,22 11,22 L11,22 Z M5.69559185,5.6975623 L9.23181625,12.7679396 L16.3021935,16.3041641 L12.7676954,9.2320604 L5.69559185,5.6975623 L5.69559185,5.6975623 Z M7.32147215,7.3591919 L11.9771118,10.0310669 L10.0346069,12.0039673 L7.32147215,7.3591919 L7.32147215,7.3591919 Z" class="fill"></path></g></svg>\n<strong>\n'+s(t.gettext.call(e,"Explore",{name:"gettext",hash:{},data:i}))+"\n</strong>\n</span>\n</a>\n</div>\n</div>\n</div>\n",a=t.unless.call(e,null!=e?e.sessionIsFetching:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+"</nav>\n"},usePartial:!0,useData:!0})}),define("home/templates/createDiscussionNav",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="discuss-tile__wrap align align--stretch">\n<a href="/home/discuss/'+o(s(null!=(a=null!=e?e.primaryForum:e)?a.id:a,e))+'/" data-action="confirm" alt="'+o(s(null!=e?e.name:e,e))+'"\nclass="discuss-tile__link text-center link-gray-dark align align--column">\n<div class="tile__wrapper">\n';return a=t["if"].call(e,null!=(a=null!=e?e.options:e)?a.tile:a,{name:"if",hash:{},fn:this.program(2,i),inverse:this.program(4,i),data:i}),null!=a&&(r+=a),r+'</div>\n<div class="discuss-tile__description align align--middle">\n<p>'+o(s(null!=(a=null!=e?e.options:e)?a.description:a,e))+"</p>\n</div>\n</a>\n</div>\n"},2:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<img src="'+i(n(null!=(t=null!=e?e.options:e)?t.tile:t,e))+'" class="img-responsive img-radius-sm img-block" />\n'},4:function(e){var t=this.lambda,n=this.escapeExpression;return'<div class="tile__overlay">\n<h1 class="tile__name">'+n(t(null!=e?e.name:e,e))+'</h1>\n</div>\n<img src="https://media.disquscdn.com/home/blank_tile.png"\nclass="img-responsive img-radius-sm img-block" />\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<button class="text-smaller modal-close -light" data-dismiss="modal">\n<span class="icon-cancel"></span>\n</button>\n<div class="text-center padding-default">\n<h1 class="text-larger text-gray-darker spacing-top spacing-bottom-small">'+s(t.gettext.call(e,"Start a discussion",{name:"gettext",hash:{},data:i}))+'</h1>\n<p class="text-gray">'+s(t.gettext.call(e,"Pick the channel that best fits your discussion topic",{name:"gettext",hash:{},data:i}))+'</p>\n</div>\n<div class="padding-default align align--wrap">\n';return a=t.each.call(e,null!=e?e.channels:e,{name:"each",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+'\n<div class="discuss-tile__wrap align align--stretch">\n<a href="/home/channels/new/" data-action="confirm" alt='+s(t.gettext.call(e,"Create a Channel",{name:"gettext",hash:{},data:i}))+'\nclass="discuss-tile__link text-center link-gray-dark align align--column">\n<div class="tile__wrapper">\n<div class="tile__overlay">\n<h1 class="tile__name">\n<p><span class="icon-plus"></span><p>\n<p>'+s(t.gettext.call(e,"Create a new channel",{name:"gettext",hash:{},data:i}))+'</p>\n</h1>\n</div>\n<img src="https://media.disquscdn.com/home/blank_tile.png"\nclass="img-responsive img-radius-sm img-block" />\n</div>\n<div class="discuss-tile__description align align--middle">\n<p>'+s(t.gettext.call(e,"Don't see a channel that fits your discussion?",{name:"gettext",hash:{},data:i}))+"</p>\n</div>\n</a>\n</div>\n</div>\n"},useData:!0})}),define("home/mixins/withOnboarding",["underscore","core/switches"],function(e,t){var n=["onboarding","explore","exploreChannel","channelDiscussion"],i=4,a=function(a){return{getStepNumber:function(){return e.indexOf(n,a.call(this).getCurrentRouteName())+1},isInOnboarding:function(e){var n=this.getStepNumber();return e.isLoggedIn()&&!e.user.get("homeOnboardingComplete")&&t.isFeatureActive("homeOnboarding")&&n>0&&(n!==i||this.onLastStep())},onLastStep:function(){var e=a.call(this);return this.getStepNumber()===i&&"channelDiscussion"===e.getCurrentRouteName()&&"exploreChannel"===e.getPreviousRouteName()}}};return function(e){var t=a(e);this.getStepNumber=t.getStepNumber,this.isInOnboarding=t.isInOnboarding,this.onLastStep=t.onLastStep}}),define("home/mixins/withSubviews",["underscore","jquery","backbone-marionette"],function(e,t,n){function i(e){this.selector=e,this.el=null,this.currentView=null}function a(e){var n=e&&e.currentView;return n&&t.contains(this.el,n.el)&&n.$el.detach()}function s(e){var t=e.selector,n=this.$(t);if(!n.length)return void e.close();var i=e.currentView.$el;i.is(t)?(n.replaceWith(i),e.setElement(i)):(n.append(i),e.setElement(n))}function o(){n.triggerMethod.call(this,"show")}function r(e,t){e&&(e.close(),this._regions[t]=null)}i.prototype={setElement:function(e){this.$el=e instanceof t?e:t(e),this.el=this.$el[0]},render:function(e){if(!this.currentView){var t=this.el,n=this.$el;t&&(this.currentView=e,e.$el.is(t)||n.append(e.el),e.render())}},close:function(){var e=this.currentView;this.el=null,this.currentView=null,e&&(e.close?e.close():e.remove&&e.remove())}};var l={initialize:function(e,t){this._regions={},this.initializeRegions(),e.call(this,t)},initializeRegions:function(){e.each(this.regions,function(e,t){this[t]=this.addRegion(e)},this)},addRegion:function(e){var t=this._regions[e];return t||(t=new i(e),this._regions[e]=t),t},activateRegion:function(e,t){var n=e.currentView;return n?n:(e.setElement(this.$(e.selector)),n=t.call(this),e.render(n),n.listenTo(this,"show",o),this._isShown&&o.call(n),n)},render:function(t){var n=e.filter(this._regions,a,this);return t.call(this),e.each(n,s,this),this},close:function(t){return e.each(this._regions,r,this),t.call(this)}};return function(){this.initializeRegions&&this.addRegion||(this.initialize=e.wrap(this.initialize,l.initialize),this.render=e.wrap(this.render,l.render),this.close=e.wrap(this.close,l.close),e.extend(this,e.pick(l,"initializeRegions","addRegion","activateRegion")))}}),define("home/views/NavView",["underscore","jquery","backbone","backbone-marionette","handlebars","core/switches","core/UniqueModel","core/utils","home/utils/confirmModal","home/utils/mixpanelUtils","home/utils/navigationUtils","home/models/Channel","home/models/Session","home/models/ChannelProfileFeed","home/templates/nav","home/templates/anonNav","home/templates/createDiscussionNav","home/mixins/withClickLinkTracking","home/mixins/withOnboarding","home/mixins/withSubviews"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f,g,v,w,b){var x=i.ItemView,y=x.prototype,_=s.isFeatureActive("homeOnboarding"),k=x.extend({className:"compensation",template:function(e){return e.id?p(e):f(e)},templateHelpers:function(){return{customBase:this.devBase,sessionIsFetching:this.session.fetchPromise,showHomeOnboarding:_}},events:{"show.bs.dropdown [data-action=toggle-dropdown][data-dropdown=settings]":"trackOpenedSettings","show.bs.dropdown [data-action=toggle-dropdown]":"removeTooltip","hide.bs.dropdown [data-action=toggle-dropdown]":"addTooltip","click [data-role=user]":"trackOpenedProfile","click [data-role=discover]":"trackOpenedDiscover","click [data-action=admin-click]":"trackOpenedAdmin","click [data-role=settings] a[data-link-name]":"trackClickLinkWithArea","click [data-role=unread-notification-count]":"handleNotificationCountClick","click [data-action=navigate-return]":"navigateAndReturn","click [data-action=create-discussion]":"handleCreateDiscussionNavClick"},initialize:function(e){this.session=h.get(),this.app=e.app,this.notifications=this.session.getOrCreateNotifications(),this.promotedChannels=new o(m,{listName:m.LIST_NAMES.promoted}),this.promotedChannels.ensureFetched(),this.listenTo(this.session,"change:id fetch:error fetch:success change:isModerator",this.debouncedRender),this.listenTo(this.notifications.unreadCounter,"change:numUnread",this.updateNotifications),this.listenTo(this.app,"route",this.activatePageIcon),this.listenTo(this.app,"route",this.toggleIconLinks),this.listenTo(this.app,"route",this.updateOnboardingSteps),this.devBase=t("body").attr("data-disqus-dev-base")},debouncedRender:e.debounce(function(){this.render.apply(this,arguments)},300),render:function(){this.model=this.session.user;var e=y.render.apply(this,arguments);return this.updateOnboardingSteps(),this.updateNotifications(),e},onDomRefresh:function(){t(".tooltipped").tooltip()},updateNotifications:function(){var e=this.notifications.unreadCounter.get("numUnread");this.$("[data-role=notifications]").toggleClass("has-notifs",!!e),this.$("[data-role=unread-notification-count]").text(e>9?"9+":e)},handleNotificationCountClick:function(){this.notifications.unreadCounter.set("numUnread",0),this.notifications.all.addUnread()},navigateAndReturn:function(e){if(e){e.preventDefault();var n=t(e.currentTarget).attr("href");if(n){var i=/(\?|&)next=[^&]+/,a="next="+encodeURIComponent("https://disqus.com"+window.location.pathname),s=!1;n=n.replace(i,function(e,t){return s=!0,t+a}),s||(-1===n.indexOf("?")?n+="?":"&"!==n.charAt(n.length-1)&&(n+="&"),n+=a),window.top.location=n}}},getDiscussChannels:function(){return this.promotedChannels.ensureFetched().then(e.bind(function(){var t=this.promotedChannels.items.map(function(e){return e.channel}),n=this.session.getUserProfile(),i=e.pluck(n.forumsFollowing.items.models,"channel"),a=this.app.getCurrentView().model||{},s=a instanceof u?a:a.channel;s&&!s.id&&(s=null);var o=this.session.user;return e.chain([s,t,i]).flatten().compact().filter(function(e){return e.userCanCreate(o)}).uniq(!1,function(e){return e.id}).invoke("toJSON").value()},this))},handleCreateDiscussionNavClick:function(){this.getDiscussChannels().then(function(e){var n={channels:e};l.confirmationPromise(l.TYPES.CLOSE_LIGHT,g(n)).then(function(e){e&&t(".modal").remove()})},this)},activatePageIcon:function(t,n){this.reactivatePageIcon&&this.stopListening(this,"render",this.reactivatePageIcon),this.reactivatePageIcon=e.bind(this.activatePageIcon,this,t,n),this.listenTo(this,"render",this.reactivatePageIcon),this.$("[data-page-icon].active").removeClass("active"),("profile"!==t||n[0]===this.session.user.id)&&this.$('[data-page-icon~="'+t+'"]').addClass("active")},toggleIconLinks:function(e){"home"===e&&this.session.isLoggedOut()?t("[data-role=icon-links]").hide():t("[data-role=icon-links]").show()},updateOnboardingSteps:function(){e.defer(e.bind(function(){var t=this.getStepNumber(),n=this.isInOnboarding(this.session);this.$("[data-role=onboarding-steps-icon]").removeClass("is-active is-complete"),this.$el.toggleClass("is-onboarding",n),n&&(this.$("[data-role=onboarding-steps-icon][data-onboarding-step="+t+"]").addClass("is-active"),e.each(e.range(1,t),e.bind(function(e){this.$("[data-role=onboarding-steps-icon][data-onboarding-step="+e+"]").addClass("is-complete")},this)),this.onLastStep()&&(this.transitionToNormalNav(),e.defer(e.bind(this.completeHomeOnboarding,this))))},this))},transitionToNormalNav:function(){var t=r.transitionEndEvent,n=this.$el;this.$el.one(t,'[data-onboarding-step="3"] .onboarding__label',function(){e.delay(function(){n.removeClass("is-onboarding")},1e3)})},completeHomeOnboarding:function(){this.session.user.updateFlags({homeOnboardingComplete:!0})},removeTooltip:function(e){e&&t(e.currentTarget).closest(".tooltipped").tooltip("destroy")},addTooltip:function(e){e&&t(e.currentTarget).closest(".tooltipped").tooltip()},trackOpenedDiscover:function(e){c.track("open discover",e)},trackOpenedSettings:function(e){c.track("open user menu",e)},trackOpenedProfile:function(e){c.track("open profile",e)},trackOpenedAdmin:function(e){c.track("open admin",e)}}),C=k.prototype;return v.call(C,"top_nav_user"),b.call(C),w.call(C,function(){return this.app}),k}),define("home/templates/message",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.lambda,s=this.escapeExpression;return'<div class="alert-message-success">\n<div class="section-contained alert-message">\n'+s(a(null!=e?e.message:e,e))+'\n<button class="close" aria-hidden="true" title="'+s(t.gettext.call(e,"Don't show this message again",{name:"gettext",hash:{},data:i}))+'" data-action="hide-message">\n<span class="icon-cancel"></span>\n</button>\n</div>\n</div>\n'},useData:!0})}),define("home/views/MessageView",["backbone-marionette","home/templates/message"],function(e,t){var n=e.ItemView.extend({template:t,events:{"click [data-action=hide-message]":"close"},close:function(e){e.preventDefault(),this.remove()}});return n}),define("home/views/MessageCollectionView",["underscore","backbone","backbone-marionette","home/views/MessageView"],function(e,t,n,i){var a=n.CollectionView.extend({itemView:i});return a}),define("home/templates/mainLayout",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression,s=this.lambda;return'<div class="drawer-footer">\n<a href="/" data-action="full-root" target="_blank" class="nav-logo">\n<img src="//a.disquscdn.com/dotcom/d-9c2c241/img/brand/disqus-logo-blue-white.svg" alt="Disqus">\n</a>\n<button class="drawer-close button button-outline -muted" data-action="close-drawer"><span class="icon-cancel text-smaller"></span>'+a(t.gettext.call(e,"Close",{name:"gettext",hash:{},data:i}))+'</button>\n<div class="drawer-footer-right" data-jester-area="drawer_footer">\n<a class="nav-expand truncate-line" data-action="full-root" target="_blank" href="/">\n<svg class="icon-home" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve"><path d="M39.5 20.7L21.7 2.5c-0.9-1-2.4-1-3.3 0L0.5 20.7c-0.9 1-0.6 1.7 0.8 1.7H5v13.9c0 1 0 1.8 1.8 1.8h8.7v-14 h9.1v14h9.1c1.4 0 1.4-0.8 1.4-1.8V22.4h3.7C40.1 22.4 40.4 21.6 39.5 20.7z"/></svg>\n<span class="text-desktop">Disqus Home</span>\n</a>\n<a class="nav-feedback truncate-line" target="_blank" href="//www.surveymonkey.com/s/MMWLGSR?u='+a(s(null!=e?e.userId:e,e))+'" data-link-name="feedback">\n<span class="icon-checkmark"></span>\n<span class="text-desktop">'+a(t.gettext.call(e,"Feedback?",{name:"gettext",hash:{},data:i}))+'</span>\n</a>\n<a class="nav-help truncate-line" target="_blank" href="//help.disqus.com" data-link-name="help">\n<span class="icon-forward"></span>\n<span class="text-desktop">'+a(t.gettext.call(e,"Get Help",{name:"gettext",hash:{},data:i}))+'</span>\n</a>\n</div>\n</div>\n\n<div class="drawer-nav">\n<a class="drawer-nav-option drawer-nav-close" data-action="close-drawer" href="#"><span class="drawer-nav-option-text">'+a(t.gettext.call(e,"Close",{name:"gettext",hash:{},data:i}))+'</span><span class="icon-cancel"></span></a>\n<a class="drawer-nav-option drawer-nav-full" data-action="full-home" href="#"><span class="drawer-nav-option-text">'+a(t.gettext.call(e,"View on %(disqus)s",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+'</span><span class="icon-expand"></span></a>\n</div>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="viewport">\n<header class="site-nav--wrapper" data-role="nav-view">\n</header>\n\n';return a=t["if"].call(e,null!=e?e.isSidebar:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+'\n<div data-role="messages-view" class="alert-global">\n</div>\n\n<div id="container-main">\n</div>\n</div>\n'},useData:!0})}),define("home/views/MainLayout",["jquery","underscore","backbone","backbone-marionette","core/bus","core/utils/metatags","home/mixins/asEmbedLayout","home/mixins/withClickLinkTracking","home/utils/trackingUtils","home/utils/sidebarUtils","home/utils/mixpanelUtils","home/views/NavView","home/views/MessageCollectionView","home/templates/mainLayout"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m){var p=i.Layout,f=p.prototype,g=p.extend({id:"container-page",template:m,serializeData:function(){var e=f.serializeData.apply(this,arguments),n=this.session.user;n&&n.toJSON&&t.extend(e,n.toJSON());var i=this.session._fromCookie().id;return i&&(e.userId=i),e.isSidebar=c.isSidebar(),e.messages=this.app.messages,e},events:{"click [data-role=help]":"trackClickedHelp","click [data-role=faq]":"trackClickedFaq","click [data-jester-area=drawer_footer] a[data-link-name]":"trackClickLink","click [data-jester-area=mobile_sidebar] a[data-link-name]":"trackClickLink"},regions:{content:{selector:"#container-main"},nav:"[data-role=nav-view]",alerts:"[data-role=messages-view]"},initialize:function(n){this.container=n.container,this.session=n.session,this.app=n.app,this.windowHeight=e(window).height(),e(window).resize(t.bind(function(){this.windowHeight=e(window).height(),this.toggleHeight()},this))},onRender:function(){if(e(this.container).html(this.$el),!c.isSidebar()){this.nav.show(new u({app:this.app}));var t=new n.Collection(this.app.messages);this.alerts.show(new h({collection:t}))}},showView:function(t,n){this.rendered||(this.render(),this.rendered=!0),n=n||{},this.updateBackgroundClass(n.lightBackground),t.getPageTrackingParams&&l.setPageParams(t.getPageTrackingParams()),this.$(this.content.el).removeData("height"),this.content.currentView&&this.stopListening(this.content.currentView),this.listenTo(t,"all",this.handleContentEvents),this.content.show(t),e.when(t.getMetaAttrs?t.getMetaAttrs():{}).then(s.set),a.trigger("viewSection")},updateBackgroundClass:function(e){this.$el.toggleClass("bg--light",!!e)},handleContentEvents:function(e){"show"===e||"render"===e?this.toggleHeight():/toggleHeight/.test(e)&&this.toggleHeight(t.last(arguments))},toggleHeight:function(e){e||(e=this.content.$el.data("height")||"fill");var t;switch(e){case"fill":this.navHeight=this.navHeight||(this.nav.$el?this.nav.$el.height():0),t=this.windowHeight-this.navHeight+"px";break;case"content":t=""}this.content.$el.css({"min-height":t}).data({height:e})},trackClickedHelp:function(e){d.track("open help",e)},trackClickedFaq:function(e){d.track("open faq",e)}});return c.isSidebar()&&o.call(g.prototype),r.call(g.prototype),g}),define("home/collections/RecommendedUserCollection",["backbone","core/UniqueModel","home/models/User","core/api"],function(e,t,n,i){return e.Collection.extend({url:i.getURL("users/recommendedUsersToFollow"),model:t.boundModel(n),addSpecial:function(e){return e.unshift({username:"emma_hager",name:"Emma Hager",avatar:{cache:"//a.disquscdn.com/uploads/users/3111/3876/avatar92.jpg?1413818726"}}),e.splice(5,0,{username:"atdorsia",name:"Eliza",avatar:{cache:"//a.disquscdn.com/uploads/users/10794/5672/avatar92.jpg?1414190241"}}),e},parse:function(e){return this.addSpecial(e.response)}})}),define("home/views/common/TabbedView",["jquery","underscore","backbone","backbone-marionette","core/utils/metatags","core/bus","home/utils/trackingUtils","home/utils/navigationUtils"],function(e,t,n,i,a,s,o,r){var l=i.Layout.extend({defaultTab:void 0,getTabView:function(){throw Error("Not implemented")},getTrackingSection:function(){return null},regions:{contentRegion:"[data-role=content-area]"},events:{"click [data-action=switch-tab]":"switchTab"},initialize:function(e){this.activeTab=e&&e.activeTab,this.setTrackingSection()},switchTab:function(n){if(n){n.preventDefault();var i=e(n.currentTarget).data("tab");if(this.toggleDropdown(),i!==this.activeTab)return this.activeTab=i||t.result(this,"defaultTab"),r.navigate(e(n.target).closest("a")[0]),this.updateTab(),!1}},toggleDropdown:function(){var e=this.$(".nav__item");e.length>0&&e.toggleClass("dropdown-open")},updateTab:function(){this.activeTab||(this.activeTab=t.result(this,"defaultTab"));var e=this.activeTab,n=this.getTabView(e);n||(this.trigger("badTab"),e=this.activeTab=t.result(this,"defaultTab"),n=this.getTabView(e)),this.setTrackingSection(),this.updateTabContent(n),this.updateTabClasses(),this.trigger("change:activeTab",e),s.trigger("viewTab")},getTabs:function(){var e=this.contentRegion.currentView,t=this.$("[data-action=switch-tab]");return e&&e.getTabs&&(t=t.not(e.getTabs())),t},updateTabClasses:function(){this.activeTab||(this.activeTab=t.result(this,"defaultTab"));var e=this.getTabs();e.filter(".active").removeClass("active"),e.filter('[data-tab="'+this.activeTab+'"]').addClass("active")},updateTabContent:function(t){var n=this.contentRegion.currentView;if(n){n.onBeforeClose=function(){return!1};var i=e(window).scrollTop();if(i){var s=i+e(window).height()-n.$el.offset().top;t.$el.css("minHeight",s)}}this.contentRegion.show(t),this.getMetaAttrs&&e.when(this.getMetaAttrs()).then(a.set),n&&(n.onBeforeClose=null,n.close())},onDomRefresh:function(){this.$(this.contentRegion.el).length&&this.updateTab()},setTrackingSection:function(){o.setSection(this.getTrackingSection(this.activeTab)||t.result(this,"defaultTab"))}});return l}),define("home/templates/recommendation",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e){var t=this.lambda,n=this.escapeExpression;return'<div data-role="recommended-object"></div>\n<div class="recommended__reason"><em>'+n(t(null!=e?e.reason:e,e))+"</em></div>\n"},useData:!0})}),define("home/views/RecommendationView",["backbone-marionette","home/mixins/withSubviews","home/templates/recommendation"],function(e,t,n){var i=e.ItemView.extend({template:n,className:"recommended-wrap",regions:{recommendedObjectRegion:"[data-role=recommended-object]"},initialize:function(e){this.RecommendedObjectView=e&&e.RecommendedObjectView},onRender:function(){this.RecommendedObjectView&&this.activateRegion(this.recommendedObjectRegion,this.createRecommendedObjectView)},createRecommendedObjectView:function(){return new this.RecommendedObjectView({model:this.model.object})}});return t.call(i.prototype),i}),define("home/views/BaseSuggestionView",["backbone-marionette","home/utils/mixpanelUtils"],function(e,t){return e.ItemView.extend({events:{"click [data-action=toggle-follow]":"toggleFollow"},modelEvents:{"change:name":"render","change:isFollowing":"handleFollowedClass"},handleFollowedClass:function(){this.$("[data-action=toggle-follow]").toggleClass("active",this.model.get("isFollowing"))},toggleFollow:function(e,n){e&&e.preventDefault(),t.track(n,e,{properties:{follow:!this.model.get("isFollowing")}}),this.model.toggleFollowed()}})}),define("home/templates/userSuggestion",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.userAvatar,"","userAvatar",e,void 0,t,n,i),null!=a&&(s+=a),s+='<h3 class="recommended__name truncate-line">',a=this.invokePartial(n.userName,"","userName",e,void 0,t,n,i),null!=a&&(s+=a),s+="</h3>\n",a=this.invokePartial(n.genericFollowButton,"","genericFollowButton",e,void 0,t,n,i),null!=a&&(s+=a),s},usePartial:!0,useData:!0})}),define("home/views/UserSuggestionView",["home/views/BaseSuggestionView","home/templates/userSuggestion"],function(e,t){return e.extend({template:t,className:"recommended__item",toggleFollow:function(e){this.constructor.__super__.toggleFollow.call(this,e,"follow user")}})}),define("home/templates/forumSuggestion",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.forumAvatarLink,"","forumAvatarLink",e,void 0,t,n,i),null!=a&&(s+=a),s},3:function(e,t,n,i){var a,s='<div class="avatar--empty">\n';return a=this.invokePartial(n.defaultForumAvatar,"","defaultForumAvatar",e,void 0,t,n,i),null!=a&&(s+=a),s+"</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r="";return a=t["if"].call(e,null!=e?e.hasFavicon:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+='<h3 class="recommended__name truncate-line">\n<a href="/home/forum/'+o(s(null!=e?e.id:e,e))+'/"\ndata-link-name="forum_name"\ndata-forum-pk="'+o(s(null!=e?e.pk:e,e))+'">\n\n',a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+="</a>\n</h3>\n",a=this.invokePartial(n.genericFollowButton,"","genericFollowButton",e,void 0,t,n,i),null!=a&&(r+=a),r},usePartial:!0,useData:!0})}),define("home/views/ForumSuggestionView",["home/config","home/views/BaseSuggestionView","home/templates/forumSuggestion"],function(e,t,n){var i=t.extend({template:n,className:"recommended__item",templateHelpers:function(){return{hasFavicon:this.model.hasFavicon()}},toggleFollow:function(e){this.constructor.__super__.toggleFollow.call(this,e,"follow forum")}});return i}),define("home/templates/ProfileModuleEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="post-comments__wrapper">\n<div class="empty-message">\n<span class="icon-heart-break text-gray-light icon-huge"></span>\n<p class="text-gray-light">'+a(t.gettext.call(e,"Nothing to see.",{name:"gettext",hash:{},data:i}))+"</p>\n</div>\n</div>\n"},useData:!0})}),define("home/views/ProfileModuleEmptyView",["backbone-marionette","home/templates/ProfileModuleEmpty"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/templates/recommendedUsersModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<footer class="module-footer">\n<a href="/home/channels/explore/" class="nav-lnk -color-muted -flushed">\n<div class="nav-lnk__blk">'+a(t.gettext.call(e,"Discover More People",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</footer>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<header class="module-header text-center">\n<button data-action="refresh" class="icon__position--corner">\n<span class="icon icon-refresh text-gray-light text-small"></span>\n</button>\n<div class="module-header__icon">\n<span class="icon text-brand icon-interesting-commenters"></span>\n</div>\n<div class="module-header__title">\n<h2 class="module-header__heading">'+s(t.gettext.call(e,"Interesting Commenters",{name:"gettext",hash:{},data:i}))+'</h2>\n<p class="module-header__subheading">'+s(t.gettext.call(e,"Follow people from around the %(disqus)s Network.",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+'</p>\n</div>\n</header>\n<div data-role="items" class="module-body"></div>\n';return a=t.unless.call(e,null!=e?e.hideDiscoverLink:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o},useData:!0})}),define("home/templates/recommendedForumsModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<footer class="module-footer">\n<a href="/home/channels/explore/" class="nav-lnk -color-muted -flushed">\n<div class="nav-lnk__blk">'+a(t.gettext.call(e,"Discover More Communities",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</footer>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<header class="module-header text-center">\n<button data-action="refresh" class="icon__position--corner">\n<span class="icon icon-refresh text-gray-light text-small"></span>\n</button>\n<div class="module-header__icon">\n<span class="icon text-brand icon-communities"></span>\n</div>\n<div class="module-header__title">\n<h2 class="module-header__heading">'+s(t.gettext.call(e,"Lively Communities",{name:"gettext",hash:{},data:i}))+'</h2>\n<p class="module-header__subheading">'+s(t.gettext.call(e,"Follow sites from around the %(disqus)s Network.",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+'</p>\n</div>\n</header>\n<div data-role="items" class="module-body"></div>\n';
return a=t.unless.call(e,null!=e?e.hideDiscoverLink:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o},useData:!0})}),define("home/views/RecommendationsModuleView",["underscore","backbone-marionette","home/models/Feed","home/views/RecommendationView","home/views/UserSuggestionView","home/views/ForumSuggestionView","home/views/ProfileModuleEmptyView","home/templates/recommendedUsersModule","home/templates/recommendedForumsModule"],function(e,t,n,i,a,s,o,r,l){var c=t.CompositeView.extend({className:"aside__wrap -padded",itemView:i,emptyView:o,itemViewContainer:"[data-role=items]",events:{"click [data-action=refresh]":"refreshModule"},templateHelpers:function(){return{hideDiscoverLink:this.hideDiscoverLink}},initialize:function(e){this.collection=this.model&&this.model.items,this.hideDiscoverLink=e&&e.hideDiscoverLink},refreshModule:function(){var e=this.$el;e.addClass("is-refreshing");var t=function(){e.removeClass("is-refreshing")};this.model.fetchItems({reset:!0}).then(t)}},{createUserRecommendedModuleView:function(t){return new c(e.extend({template:r,itemViewOptions:{RecommendedObjectView:a}},t))},createForumRecommendedModuleView:function(t){return new c(e.extend({template:l,itemViewOptions:{RecommendedObjectView:s}},t))}});return c}),define("core/stance/utils",["underscore","exports"],function(e,t){t.getElement=function(t){return e.isElement(t)?t:t&&t.el},t.EL_ID_ATTR="data-visibility-id",t.OBJ_ID_PROP="_visibility_id",t.getId=function(n){var i=null;return e.isElement(n)?(i=n.getAttribute(t.EL_ID_ATTR)||null,i||(i=e.uniqueId(),n.setAttribute(t.EL_ID_ATTR,i))):n&&(i=n[t.OBJ_ID_PROP]||null,i||(i=n[t.OBJ_ID_PROP]=e.uniqueId())),i},t.visiblePercent=function(e,t){var n=0;if(!t)return n;var i=e.top,a=i+e.height,s=i>t.visibleTop,o=t.visibleBottom>a;return!s&&!o||s&&o?n=1:s?n=(t.height-(i-t.visibleTop))/t.height:o&&(n=(a-t.visibleTop)/t.height),Math.round(100*n)}}),define("core/stance/tracking",["underscore","jquery","./utils","exports"],function(e,t,n,i){i.events=[],i.lastPos=null,i.clearCache=function(e){if(void 0!==e){var t=n.getId(e);t&&(i.getElementOffset.cache[t]=null)}else i.getElementOffset.cache={}},i.calculateOffset=function(e){var n=t(e).filter(":visible").offset();return n?{top:n.top,height:t(e).height()}:null},i._getElementOffset=function(t){var a=n.getElement(t);if(!a)return null;var s=i.calculateOffset(a);return s?{visibleTop:s.top+(e.result(t,"topEdgeOffset")||0),visibleBottom:s.top+s.height-(e.result(t,"bottomEdgeOffset")||0),offsetTop:s.top,height:s.height}:null},i.getElementOffset=function(){var e=function(t){var a=e.cache,s=n.getId(t);if(s&&a[s])return a[s];var o=i._getElementOffset(t);return s&&o&&(a[s]=o),o};return e.cache={},e}(),i.EVENT_NAMES=["enter","exit","visible","invisible","all"],i.updateTracking=function(t){var n,a=function(t){return t?function(e){return t[e]}:e.constant(void 0)};e.any(i.EVENT_NAMES,a(t._events))?(n=e.indexOf(i.events,t),-1===n&&i.events.push(t)):(n=e.indexOf(i.events,t),-1!==n&&i.events.splice(n,1))},i.processEvents=function(e){i.lastPos=e;var t=i.events;if(t.length)for(var n=t.length-1;n>=0;--n){var a=t[n],s=a.isVisible(e);null!==s&&(s!==a.lastVisible&&a.trigger(s?"enter":"exit",a,e),a.trigger(s?"visible":"invisible",a,e),a.lastVisible=s)}}}),define("core/stance/main",["underscore","jquery","backbone","./tracking"],function(e,t,n,i){function a(e){return this instanceof a?(this.obj=e,void(this.lastVisible=!1)):new a(e)}var s=e.debounce(function(){i.processEvents(i.lastPos)},250);return e.extend(a.prototype,n.Events,{on:function(e){var t=!(this._events&&this._events[e]),a=n.Events.on.apply(this,arguments);return t&&i.updateTracking(this),s(),a},off:function(e){var t=n.Events.off.apply(this,arguments);return this._events&&this._events[e]||i.updateTracking(this),t},offset:function(){return i.getElementOffset(this.obj)},isVisible:function(e){if(e=e||i.lastPos,!e)return null;var t=e.top,n=t+e.height,a=this.offset();return a?a.offsetTop>=t&&n>a.visibleTop||n>=a.offsetTop+a.height&&a.visibleBottom>t:null},invalidate:function(){return i.clearCache(this.obj),this}}),e.extend(a,{invalidate:i.clearCache,scroll:i.processEvents,_windowScrollHandlerBound:!1,_windowScrollHandler:e.throttle(function(){i.processEvents({top:t(window).scrollTop(),height:t(window).height()})},250),bindWindowEvents:function(){this._windowScrollHandlerBound||(t(window).on("scroll",this._windowScrollHandler).on("resize",this._windowScrollHandler),this._windowScrollHandlerBound=!0)},unbindWindowEvents:function(){t(window).off("scroll",this._windowScrollHandler).off("resize",this._windowScrollHandler),this._windowScrollHandlerBound=!1}}),a}),define("home/views/FetchingView",["backbone-marionette"],function(e){var t=e.ItemView.extend({className:"spinner",template:function(){},initialize:function(t){e.ItemView.prototype.initialize.call(this,t),t=t||{},t.className&&(this.className=t.className)}});return t}),define("home/views/common/FetchableCollectionView",["underscore","jquery","backbone","backbone-marionette","core/stance/main","home/views/FetchingView","home/utils/layoutUtils"],function(e,t,n,i,a,s){var o=i.CollectionView.extend({fetchingView:s,emptyView:n.View,initialize:function(t){this.listenable=this.model||this.collection,this.listenTo(this.listenable,"change:fetching",this.render),this.listenTo(this.collection,"add",this.closeNonItemViews),this.listenTo(this.collection,"reset",this.closeViews),this.listenTo(this,"before:item:added",this.onFirstItem),t.infiniteScroll&&this.setupInfiniteScroll(),this.triggerRenderInitialContent=e.once(e.bind(this.trigger,this,"renderInitialContent"))},setupInfiniteScroll:function(){a.bindWindowEvents(),this.listenTo(this,"after:item:added",e.debounce(this.updateInfiniteScrollTrigger,0))},onFirstItem:function(e){this.collection.at(0)===e.model&&(this.stopListening(this,"before:item:added",this.onFirstItem),this.listenToOnce(e,"show",function(){this.trigger("showFirstItem",e)}))},infiniteScrollTriggerOffset:function(){return-t(window).height()},updateInfiniteScrollTrigger:function(){if(this.collection.length){var t=e.values(this.children._views);if(t.length){var n=e.findLastIndex(t,function(e){return!/(\s|^)hidden(\s|$)/.test(e.$el.attr("class"))});if(!(0>n)){var i=t[n];if(i){var s=this.infiniteScrollTrigger;s&&this.stopListening(s),s=a({el:i.el,topEdgeOffset:this.infiniteScrollTriggerOffset}),this.infiniteScrollTrigger=s,this.listenToOnce(s,"enter",this.loadMore)}}}}},loadMore:function(){var e=this.listenable;e.fetchItems?e.fetchItems():e.more&&e.more(),this.infiniteScrollTrigger=null},onCollectionBeforeClose:function(){this._showingEmptyView=!0},onCollectionClosed:function(){this._showingEmptyView=!1},render:function(){var e=!this.collection.length,t=this.isFetching(),n=this.isError();e?t?this.showFetchingView():n?(this.closeViews(),this.triggerRenderInitialContent()):this._showingEmptyView||(i.CollectionView.prototype.render.apply(this,arguments),this.triggerRenderInitialContent()):(!this.children.length||this.isShowingNonItemView())&&(this.closeViews(),i.CollectionView.prototype.render.apply(this,arguments),this.triggerRenderInitialContent())},buildItemView:function(t,n,a){var s=i.getOption(this,"emptyViewOptions");return this._showingEmptyView&&s&&(a=s,e.isFunction(a)&&(a=a.call(this))),i.CollectionView.prototype.buildItemView.call(this,t,n,a)},appendHtml:function(e,n,i){e.isBuffering&&e._bufferedChildren.push(n);var a=e.isBuffering?t(e.elBuffer):e.$el,s=a.children();s.size()<=i?a.append(n.el):s.eq(i).before(n.el)},isFetching:function(){return this.checkState("fetching")},isError:function(){return this.checkState("error")},checkState:function(t){return this.listenable.get?this.listenable.get(t):e.result(this.listenable,t)},bindViewClose:function(e,t){var n=this;e.on("close",function(){n[t]=!1})},closeNonItemViews:function(){this.isShowingNonItemView()&&this.closeViews()},isShowingNonItemView:function(){return this._showingFetchingView||this._showingEmptyView},closeViews:function(){this._showingEmptyView=!0,this.closeChildren(),this._showingEmptyView=!1,this._showingFetchingView=!1},showFetchingView:function(){var e=i.getOption(this,"fetchingView");if(e&&!this._showingFetchingView){this.closeViews(),this._showingFetchingView=!0;var t=this.model||new n.Model,a=this.addItemView(t,e,0);this.bindViewClose(a,"_showingFetchingView")}}});return o}),define("home/templates/threadCardDefaultFooter",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return'<span class="icon-lock icon-tiny spacing-right-small"></span>\n'},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"1 Comment",{name:"gettext",hash:{},data:i}))+"\n"},5:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"%(posts)s Comments",{name:"gettext",hash:{posts:null!=e?e.posts:e},data:i}))+"\n"},7:function(e,t,n,i){var a,s='<li class="action">\n<a href="#" data-action="favorite"\nclass="action-favorite ';return a=t["if"].call(e,null!=e?e.favorited:e,{name:"if",hash:{},fn:this.program(8,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+='">\n\n',a=t["if"].call(e,null!=e?e.favorited:e,{name:"if",hash:{},fn:this.program(10,i),inverse:this.program(12,i),data:i}),null!=a&&(s+=a),s+'\n<span class="icon icon-heart"></span>\n</a>\n</li>\n'},8:function(){return"active"},10:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Recommended",{name:"gettext",hash:{},data:i}))+"\n"},12:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Recommend",{name:"gettext",hash:{},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<ul class="actions">\n<li class="action">\n<a href="'+o(s(null!=e?e.discussionRoute:e,e))+'"\ndata-link-name="comment_count"\ndata-thread-id="'+o(s(null!=e?e.id:e,e))+'">\n';return a=t["if"].call(e,null!=e?e.isClosed:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+="\n",a=t["if"].call(e,t.eq.call(e,null!=e?e.posts:e,1,{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(3,i),inverse:this.program(5,i),data:i}),null!=a&&(r+=a),r+='<span class="icon icon-comment"></span>\n</a>\n</li>\n',a=t["if"].call(e,null!=e?e.authenticated:e,{name:"if",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+"</ul>\n"},useData:!0})}),define("home/mixins/withThreadSharing",["jquery","underscore","home/utils/mixpanelUtils"],function(e,t,n){var i=function(){return this.model.thread||this.model};return function(){this.events=t.extend({"click [data-action=share]":"handleShareThread"},this.events),this.handleShareThread=function(t){if(t){t.preventDefault();var a=i.call(this),s=e(t.currentTarget).attr("data-network");n.track("share thread",t,{properties:{network:s,forum:a.forum.get("id")}}),a.shareThread(s)}}}}),define("home/views/ThreadCardDefaultFooterView",["jquery","backbone-marionette","home/utils/mixpanelUtils","home/models/Session","home/templates/threadCardDefaultFooter","home/mixins/withThreadSharing"],function(e,t,n,i,a,s){var o=t.ItemView.extend({template:a,templateHelpers:function(){var e=i.get();return{favorited:this.model.get("userScore")>0,discussionRoute:this.model.getDiscussionRoute(this.channel),authenticated:!e.isAnonymous(),likes:this.model.get("likes")}},events:{"click [data-action=favorite]":"toggleThreadFavorited","click [data-action=toggle-subscription]":"toggleSubscription"},initialize:function(e){this.listenTo(this.model,"change:userScore",this.render),this.listenTo(this.model,"change:userSubscription",this.render),this.channel=e&&e.channel},toggleThreadFavorited:function(e){e&&e.preventDefault(),this.model.get("userScore")<1&&n.track("like thread",e),this.model.toggleFavorited()},toggleSubscription:function(e){e&&e.preventDefault(),this.model.toggleSubscription()}});return s.call(o.prototype),o}),define("home/mixins/withThreadCardDefaultFooter",["underscore","home/mixins/withSubviews","home/views/ThreadCardDefaultFooterView"],function(e,t,n){var i=function(){return this.model.thread||this.model},a={render:function(e){return e.call(this),this.footerRegion=this.addRegion("[data-role=footer]"),this.activateRegion(this.footerRegion,this.createThreadDefaultFooter),this},createThreadDefaultFooter:function(){var e=i.call(this);return new n({el:this.footerRegion.el,model:e,channel:this.channel})}};return function(){t.call(this),this.createThreadDefaultFooter=a.createThreadDefaultFooter,this.render=e.wrap(this.render,a.render)}}),define("home/mixins/withTruncate",["jquery","underscore"],function(e,t){var n={onDomRefresh:function(t){t&&t.call(this),this.$(".truncate").each(function(t,n){e(n).trunk8({lines:e(n).data("truncateLines")||1})}),this.trigger("truncate:complete")}};return function(){this.onDomRefresh=t.wrap(this.onDomRefresh,n.onDomRefresh)}}),define("home/mixins/asGenericCard",["jquery","underscore","home/utils/layoutUtils","home/mixins/withThreadCardDefaultFooter","home/mixins/withTruncate"],function(e,t,n,i,a){var s={className:function(e){return t.isFunction(e)&&(e=e.apply(this,t.rest(arguments))),e=e||"",["card card-generic","card-generic-"+this.model.get("verb"),e].join(" ")},initialize:function(e,t){t=t||{},e.call(this,t),this.channel=t.channel,this.hideImage=t.hideImage,this.listenTo(this.model.thread,"change:content",this.render),this.numTitleLines=t.numTitleLines||3},serializeData:function(e){var i=e.call(this),a=this.model.thread;return t.defaults(i,{discussionRoute:a.getDiscussionRoute(this.channel),threadDescription:a.getDefaultDescription(),image:!this.hideImage&&n.shouldShowImages()&&a.getImage(),numTitleLines:this.numTitleLines})}};return function(){i.apply(this,arguments),a.apply(this,arguments),this.className=t.wrap(this.className,s.className),this.initialize=t.wrap(this.initialize,s.initialize),this.serializeData=t.wrap(this.serializeData,s.serializeData)}}),define("core/utils/views",["underscore"],function(e){var t=function(t,n,i){var a=t.prototype,s=e.extend({},n,i);if(e.defaults(a,s),e.defaults(a.events,s.events),void 0!==a.initialize&&void 0!==s.initialize){var o=a.initialize;a.initialize=function(){var e=o.apply(this,arguments);return s.initialize.apply(this,arguments),e}}};return{mixin:t}}),define("core/views/common/HoverCard",["jquery","underscore","backbone","core/bus","core/utils"],function(e,t,n,i,a){var s=n.View.extend({events:{mouseenter:"enter",mouseleave:"leave"},initialize:function(){this._id=t.uniqueId(),this._rendered=!1,this._hoverState="out",this._visible=!1,this._enterTimeout=null,this._leaveTimeout=null,s.open={},this.events=this.events||{},this.events["click [data-action=profile]"]="handleShowProfile",this.listenTo(this,"authenticating",this.keepOpen)},render:function(){return this.hide(),e("body").append(this.el),this},target:function(e){e.on("mouseenter",t.bind(this.enter,this,e)),e.on("mouseleave",t.bind(this.leave,this))},enter:function(e){var n=this;e.originalEvent&&(e=null),e&&(n.$target=e),n._leaveTimeout&&clearTimeout(n._leaveTimeout),"in"!==n._hoverState&&(n._hoverState="in",n._enterTimeout=t.delay(function(){"in"===n._hoverState&&n.show(),n._enterTimeout=null},s.DELAY_ENTER),s.open[this.uid]=this)},leave:function(){var e=this;e._enterTimeout&&clearTimeout(e._enterTimeout),"out"!==e._hoverState&&(e._hoverState="out",e._leaveTimeout=t.delay(function(){"out"===e._hoverState&&e.hide(),e._leaveTimeout=null},s.DELAY_LEAVE),s.open[this.uid]&&delete s.open[this.uid])},show:function(){var e=this;e._rendered||(e._rendered=!0,e.render()),e.moveTo(e.$target),e.$el.show(),e._visible=!0,e.trigger("show")},moveTo:function(e){if(e){var t=s.POSITION_OFFSET,n=e.offset(),i=this.$el,a=i.height(),o=this.getContainerPosition();n.top-=t;var r=n.top+a+o.containerOffset.top,l=o.pageOffset+o.containerHeight;l>=r?i.css("top",n.top):i.css("top",n.top-a+2*t),i.css("left",n.left+t)}},getContainerPosition:function(){return{pageOffset:e(window).scrollTop(),containerOffset:{top:0,height:e(window).height()},containerHeight:e(window).height()}},hide:function(){this._keepOpen||(this._enterTimeout&&clearTimeout(this._enterTimeout),this.$el.hide(),this._visible=!1)},keepOpen:function(){this._keepOpen=!0,this.setupKeepOpenCanceler()},setupKeepOpenCanceler:function(){var n=this,a=function(){"out"===n._hoverState&&(n.stopListening(i,"window.click",a),e("body").off("click",a),n._keepOpen=!1,n.hide())};t.delay(function(){n.listenTo(i,"window.click",a),e("body").on("click",a)},100)},isVisible:function(){return this._visible},handleShowProfile:a.preventDefaultHandler(function(){this.hide()})},{open:{},instances:{},DELAY_ENTER:350,DELAY_LEAVE:175,POSITION_OFFSET:20,exitAll:function(){t.invoke(s.open,"leave")},create:function(e,t,n,i){var a=s.instances[n];a||(s.instances[n]=a={});var o=a[e];return o||(o=new i(t),a[e]=o),t.targetElement&&o.target(t.targetElement),o}});return function(){e(document).on("mouseout",t.debounce(function(e){var t=e.relatedTarget||e.toElement;t&&"HTML"!==t.nodeName||s.exitAll()},10))}(),s}),define("core/views/common/mixins/LocalScroll",[],function(){var e={events:{mousewheel:"handleScrollEvent",wheel:"handleScrollEvent"},scrollMeasureSelector:"",getScrollMeasure:function(){return this.scrollMeasure||(this.scrollMeasure=this.$el,this.scrollMeasureSelector&&(this.scrollMeasure=this.$el.find(this.scrollMeasureSelector))),this.scrollMeasure},handleScrollEvent:function(e){var t=e.originalEvent,n=t.wheelDeltaY||-t.deltaY,i=this.$el,a=i.height(),s=this.getScrollMeasure(),o=s.height(),r=s.parent()[0].scrollTop,l=r>=o-a,c=0===r;(l&&0>n||c&&n>0)&&e.preventDefault()}};return e}),define("core/templates/usersCard",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return"guests-only"},3:function(e,t,n,i){var a,s="";return a=t.each.call(e,null!=e?e.users:e,{name:"each",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},4:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.cardUser,"","cardUser",e,void 0,t,n,i),null!=a&&(s+=a),s},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="tooltip upvoters ';return a=t.unless.call(e,null!=(a=null!=e?e.users:e)?a.length:a,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+='">\n<ul class="scroll-measure" data-role="content">\n',a=t["if"].call(e,null!=(a=null!=e?e.users:e)?a.length:a,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+'</ul>\n</div>\n<div class="tooltip-point hidden"></div>\n'},usePartial:!0,useData:!0})}),define("core/views/UsersCard",["jquery","underscore","handlebars","core/config","core/bus","core/utils/views","core/views/common/HoverCard","core/views/common/mixins/LocalScroll","core/templates/usersCard"],function(e,t,n,i,a,s,o,r,l){var c=o.extend({guestTextPartialName:"cardOtherUserText",className:"tooltip-outer upvoters-outer",initialize:function(e){o.prototype.initialize.call(this,e),this.collection=this.collection||e.collection,this.session=e.session,this.numUsers=e.numUsers,this.listenTo(this.collection,"add",this.addUser),this.listenTo(this.collection,"remove",this.removeUser),this.listenTo(this.collection,"reset",this.render)},addUser:function(e){e.get("isAnonymous")?this.updateGuests():this.$listEl&&this.$listEl.length&&(this.$listEl.prepend(n.partials.cardUser(t.extend({highlight:!0},e.toJSON()))),this.stopHighlightUsername())},removeUser:function(e){if(e.get("isAnonymous"))this.updateGuests();else{var t=this.$el.find("[data-username="+e.get("username")+"]");t.length&&t.remove()}},stopHighlightUsername:t.debounce(function(){var e=this.$el.find(".highlight");e.removeClass("highlight")},1100),getGuestCount:function(){return Math.max(this.numUsers-this.collection.length,0)},updateGuests:function(){var e=this.$el.find("[data-role=guest]"),t=this.getGuestCount(),a=n.partials[this.guestTextPartialName]({guestCount:t}),s={guestCount:t,guestAvatarUrl:i.urls.avatar.generic,highlight:e.length,guestText:a},o=n.partials.cardGuestUser(s);e.length?(e.replaceWith(o),this.stopHighlightUsername()):this.$listEl&&this.$listEl.length&&this.$listEl.append(o)},render:function(){delete this.pointEl,this.$el.html(l({users:this.collection.toJSON(),highlight:!1})),o.prototype.render.call(this),this.$listEl=this.$el.find(".upvoters ul"),this.updateGuests()},show:function(){this.numUsers&&!this.isVisible()&&(o.prototype.show.call(this),a.trigger("uiAction:userCardShow"))},showPoint:function(e){var n=["tl","bl"];this.pointEl||(this.pointEl=this.$el.find(".tooltip-point"),this.pointEl.removeClass("hidden")),t.each(n,function(e){this.pointEl.removeClass("point-position-"+e)},this),this.pointEl.addClass("point-position-"+e)},moveTo:function(e,t){if(e){var n=o.POSITION_OFFSET,i=e.offset(),a=this.$el,s=a.height(),r=this.getContainerPosition();t&&(s+=a.find("li.user").height()+10),i.top-s-n>=0&&i.top-s+r.containerOffset.top>=r.pageOffset?(a.css({bottom:r.containerOffset.height-i.top+n,top:"inherit"}),this.showPoint("bl")):(a.css({bottom:"inherit",top:i.top+2*n}),this.showPoint("tl")),a.css("left",i.left-n)}},handleShowProfile:function(t){o.prototype.handleShowProfile.call(this,t);var n=e(t.currentTarget),i=n.attr("data-username");a.trigger("uiCallback:showProfile",i)}},{create:function(e,t){return o.create(e,t,"UsersCard",c)}});return s.mixin(c,r,{scrollMeasureSelector:"[data-role=content]"}),c}),define("home/utils/cardUtils",["backbone","core/bus","home/utils/navigationUtils","home/utils/sidebarUtils"],function(e,t,n,i){t.on({"uiCallback:showProfile":function(e){var t="/by/"+e+"/";i.isSidebar()?window.open(t):n.navigate(t,{trigger:!0})}})}),define("home/views/ActivityActorsHoverCard",["underscore","backbone","home/models/Session","core/views/UsersCard","core/views/common/HoverCard","home/utils/cardUtils"],function(e,t,n,i,a){var s=i.extend({initialize:function(a){var s=a.activityFeedItem,o=a.numShownActors;e.extend(a,{numUsers:s.get("totalActors")-o,session:n.get(),collection:new t.Collection(s.actors.slice(o))}),i.prototype.initialize.apply(this,arguments)},show:function(){i.prototype.show.apply(this,arguments),this.trigger("uiAction:activityActorsCardShow")}},{create:function(e){return a.create(e.activityId,e,"ActivityActorsHoverCard",s)}});return s}),define("home/mixins/withReason",["underscore","home/views/ActivityActorsHoverCard","core/utils"],function(e,t,n){var i=function(){if(!n.isMobileUserAgent()){var e=this.$("[data-role=actors]");e.length&&(this.hoverCard&&this.hoverCard.remove(),this.hoverCard=t.create({targetElement:e,activityFeedItem:this.model,activityId:this.model.id,numShownActors:1}))}},a=function(){if(!this.model.actors||1!==this.model.actors.length)return 0;var e=this.model.get("totalActivities");return e>1?e:0},s=function(){this.initialize=e.wrap(this.initialize,function(t){t.apply(this,e.rest(arguments)),this.listenTo(this,"render",i)});var t=this.templateHelpers;this.templateHelpers=function(){var n=this.options&&this.options.enableBestOfDisqusCallout,i=this.model.thread,s=this.model.activities[0],o=n&&"TrendingThreadOnChannel"===s.get("type")&&s.targetChannel&&s.targetChannel.get("options").isCurationOnlyChannel;return e.extend({relativeTime:this.model.getRelativeTimestamp(),numRemainingActors:this.model.get("totalActors")-1,numOccurences:a.call(this),firstActor:this.model.actors[0]&&this.model.actors[0].toJSON(),isBestOfDisqus:o,threadLikes:i&&i.get("likes")+(o?1:0)},e.isFunction(t)?t.apply(this,arguments):t)}};return s}),define("home/templates/postActions",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" active"},3:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.likes:e,e))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="#" class="vote-up';return a=t["if"].call(e,null!=e?e.sessionUserHasUpvoted:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='" data-action="vote" data-vote="1">\n<span class="vote__count text-gray text-small" data-role="upvotes">\n',a=t["if"].call(e,null!=e?e.likes:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='\n</span>\n<span class="icon-arrow-up icon-tiny"></span>\n</a>\n\n<a href="#" class="vote-down',a=t["if"].call(e,null!=e?e.sessionUserHasDownvoted:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='" data-action="vote" data-vote="-1">\n<span class="icon-arrow-down icon-tiny"></span>\n</a>\n\n',a=this.invokePartial(n.replyOrEditLink,"","replyOrEditLink",e,void 0,t,n,i),null!=a&&(r+=a),r+'\n<a href="'+o(s(null!=e?e.discussionRoute:e,e))+"#comment-"+o(s(null!=e?e.id:e,e))+'"\nclass="view-comment link-gray"\ndata-link-name="view_comment"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n\n<span class="text-mobile">'+o(t.gettext.call(e,"View",{name:"gettext",hash:{},data:i}))+'</span><span class="text-desktop">'+o(t.gettext.call(e,"View in discussion",{name:"gettext",hash:{},data:i}))+'</span><span class="icon-expand"></span>\n</a>\n'},usePartial:!0,useData:!0})}),define("home/utils/features",["modernizr"],function(e){var t={browser:{mobile:/iPhone|Android|iPod|iPad|webOS|Mobile Safari|Windows Phone|BlackBerry|Opera Mini|IEMobile/i.test(navigator.userAgent)}},n=e.contenteditable&&!t.browser.mobile&&!(window.opera&&window.opera.version);return{canUseContentEditable:function(){return n}}}),define("core/templates/alert",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return'<span class="icon icon-warning"></span>\n'},3:function(e){var t,n=this.lambda,i="";return t=n(null!=e?e.message:e,e),null!=t&&(i+=t),i+"\n"},5:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.message:e,e))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<a class="close" data-action="dismiss" title="'+s(t.gettext.call(e,"Dismiss",{name:"gettext",hash:{},data:i}))+'">×</a>\n<span>\n';return a=t["if"].call(e,null!=e?e.icon:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),a=t["if"].call(e,null!=e?e.safe:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.program(5,i),data:i}),null!=a&&(o+=a),o+"</span>\n"},useData:!0})}),define("core/views/AlertView",["underscore","backbone","core/templates/alert"],function(e,t,n){var i=t.View.extend({className:"alert",events:{"click [data-action=dismiss]":"dismiss"},initialize:function(e){this.options=e,this.message=e.message,this.safe=e.safe,this.type=e.type},render:function(){var e=this.$el;return e.html(n({message:this.message,safe:this.safe,icon:"error"===this.type})),e.attr("class",this.className),this.type&&e.addClass(this.type),this},dismiss:function(e){e&&e.preventDefault&&e.preventDefault(),this.remove(),this.trigger("dismiss")}});return i}),define("core/mixins/withAlert",["underscore","core/views/AlertView"],function(e,t){var n={alert:function(n,i){e.isObject(i)||(i={});var a=i.target||this._alertSelector;this.dismissAlert();var s=this._alert=new t(e.extend({message:n},i));return s.render(),a?this.$el.find(a).prepend(s.el):this.el.parentNode&&this.el.parentNode.insertBefore(s.el,this.el),s},dismissAlert:function(e){this._alert&&(!e||e(this._alert))&&this._alert.dismiss()},setAlertSelector:function(e){this._alertSelector=e}},i=function(){return e.extend(this,n)};return i}),function(e){e("when",[],function(){function e(e,n,i,a){return t(e).then(n,i,a)}function t(e){var t,n;return e instanceof i?t=e:r(e)?(n=o(),e.then(function(e){n.resolve(e)},function(e){n.reject(e)},function(e){n.progress(e)}),t=n.promise):t=a(e),t}function n(t){return e(t,s)}function i(e){this.then=e}function a(e){var n=new i(function(n){try{return t(n?n(e):e)}catch(i){return s(i)}});return n}function s(e){var n=new i(function(n,i){try{return i?t(i(e)):s(e)}catch(a){return s(a)}});return n}function o(){function e(e,t,n){return h(e,t,n)}function n(e){return p(e)}function a(e){return p(s(e))}function r(e){return m(e)}var l,c,d,u,h,m,p;return c=new i(e),l={then:e,resolve:n,reject:a,progress:r,promise:c,resolver:{resolve:n,reject:a,progress:r}},d=[],u=[],h=function(e,t,n){var i,a;return i=o(),a="function"==typeof n?function(e){try{i.progress(n(e))}catch(t){i.progress(t)}}:function(e){i.progress(e)},d.push(function(n){n.then(e,t).then(i.resolve,i.reject,a)}),u.push(a),i.promise},m=function(e){return f(u,e),e},p=function(e){return e=t(e),h=e.then,p=t,m=v,f(d,e),u=d=y,e},l}function r(e){return e&&"function"==typeof e.then}function l(t,n,i,a,s){return g(2,arguments),e(t,function(t){function r(e){f(e)}function l(e){p(e)}var c,d,u,h,m,p,f,g,w,b;if(w=t.length>>>0,c=Math.max(0,Math.min(n,w)),u=[],d=w-c+1,h=[],m=o(),c)for(g=m.progress,f=function(e){h.push(e),--d||(p=f=v,m.reject(h))},p=function(e){u.push(e),--c||(p=f=v,m.resolve(u))},b=0;w>b;++b)b in t&&e(t[b],l,r,g);else m.resolve(u);return m.then(i,a,s)})}function c(e,t,n,i){function a(e){return t?t(e[0]):e[0]}return l(e,1,a,n,i)}function d(e,t,n,i){return g(1,arguments),h(e,w).then(t,n,i)}function u(){return h(arguments,w)}function h(t,n){return e(t,function(t){var i,a,s,r,l,c;if(s=a=t.length>>>0,i=[],c=o(),s)for(r=function(t,a){e(t,n).then(function(e){i[a]=e,--s||c.resolve(i)},c.reject)},l=0;a>l;l++)l in t?r(t[l],l):--s;else c.resolve(i);return c.promise})}function m(t,n){var i=x.call(arguments,1);return e(t,function(t){var a;return a=t.length,i[0]=function(t,i,s){return e(t,function(t){return e(i,function(e){return n(t,e,s,a)})})},b.apply(t,i)})}function p(t,n,i){var a=arguments.length>2;return e(t,function(e){return e=a?i:e,n.resolve(e),e},function(e){return n.reject(e),s(e)},n.progress)}function f(e,t){for(var n,i=0;n=e[i++];)n(t)}function g(e,t){for(var n,i=t.length;i>e;)if(n=t[--i],null!=n&&"function"!=typeof n)throw Error("arg "+i+" must be a function")}function v(){}function w(e){return e}var b,x,y;return e.defer=o,e.resolve=t,e.reject=n,e.join=u,e.all=d,e.map=h,e.reduce=m,e.any=c,e.some=l,e.chain=p,e.isPromise=r,i.prototype={always:function(e,t){return this.then(e,e,t)},otherwise:function(e){return this.then(y,e)},spread:function(e){return this.then(function(t){return d(t,function(t){return e.apply(y,t)})})}},x=[].slice,b=[].reduce||function(e){var t,n,i,a,s;if(s=0,t=Object(this),a=t.length>>>0,n=arguments,1>=n.length)for(;;){if(s in t){i=t[s++];break}if(++s>=a)throw new TypeError}else i=n[1];for(;a>s;++s)s in t&&(i=e(i,t[s],s,t));return i},e})}("function"==typeof define&&define.amd?define:function(e){"object"==typeof exports?module.exports=e():this.when=e()}),define("core/models/Media",["underscore","backbone","core/api","core/UniqueModel"],function(e,t,n,i){var a=t.Model.extend({idAttribute:"url",defaults:{mediaType:null,html:"",htmlWidth:null,htmlHeight:null,thumbnailUrl:"",thumbnailWidth:null,thumbnailHeight:null,url:"",resolvedUrl:"",title:"",description:"",providerName:""},parse:function(e){return e.response},sync:function(t,i,a){if("read"!==t)throw Error('Media models do not support methods other than "read".');return n.call("media/details.json",e.extend({method:"POST",data:{url:this.get("url")}},a))}},{MEDIA_TYPES:{IMAGE:"1",IMAGE_UPLOAD:"2",YOUTUBE_VIDEO:"3",WEBPAGE:"4",TWITTER_STATUS:"5",FACEBOOK_PAGE:"6",FACEBOOK_POST:"7",FACEBOOK_PHOTO:"8",FACEBOOK_VIDEO:"9",SOUNDCLOUD_SOUND:"10",GOOGLE_MAP:"11",VIMEO_VIDEO:"12",VINE_VIDEO:"14"},WEBPAGE_TYPES:["4","6","7"]});return i.addType("Media",a),a}),define("core/models/MediaUpload",["backbone","core/models/Media"],function(e,t){var n=e.Model.extend({defaults:{token:null,original_url:null,thumbnail_url:null,expires:null},validate:function(e){if(null===e.expires)return Error("Upload is missing expiry timestamp");var t=+new Date;return t/1e3>e.expires?Error("Expired upload"):void 0},toMediaJSON:function(){return{mediaType:t.MEDIA_TYPES.IMAGE_UPLOAD,thumbnailUrl:this.get("original_url"),url:this.get("original_url")}
}});return n}),define("core/utils/media/upload",["jquery","underscore","when","exports","core/api","core/models/Media","core/models/MediaUpload","core/strings","core/UniqueModel"],function(e,t,n,i,a,s,o,r,l){i.uploadSupported=!!window.FormData,i._extractFirstImageFile=function(e){return t.find(e,function(e){return e.type.match(/^image\//)})},i._uploadViaApi=function(e,t,i){return n(a.call(e,{data:t,contentType:!1,processData:!1,method:"POST",xhr:function(){var e=new XMLHttpRequest,t=i&&i.onProgress;return t&&e.upload.addEventListener("progress",function(e){e.total&&t(100*e.loaded/e.total)}),e}}))},i.UPLOAD_URL="https://uploads.services.disqus.com/api/3.0/media/create.json",i.uploadMediaUrl=function(e,a){var o=new FormData,r=i._extractFirstImageFile(e);return r?(o.append("upload",r),o.append("permanent",1),i._uploadViaApi(i.UPLOAD_URL,o,a).then(function(e){var n=e.response,i=t.first(t.values(n));if(!i||!i.ok)throw Error("Upload failed");return new l(s,{mediaType:s.MEDIA_TYPES.IMAGE_UPLOAD,url:i.url,thumbnailUrl:i.url})})):n.reject(Error("No image file to upload"))},i.uploadMedia=function(e,t){var n=new FormData,a=i._extractFirstImageFile(e);return n.append("attachment",a),i._uploadViaApi("media/upload",n,t).otherwise(function(e){var t=e.responseJSON||{};throw Error(t.response||"Upload failed")}).then(function(e){return new o(e.response)})}}),define("core/views/media/DragDropUploadView",["underscore","backbone","core/utils"],function(e,t,n){var i=n.stopEventHandler,a=t.View.extend({events:{dragover:"_dragOn",dragenter:"_dragOn",dragleave:"_dragOff",dragexit:"_dragOff",drop:"_drop"},_dragOn:i(function(){this.trigger("uploader:dragEnter"),this._toggleDragPlaceholder(!0)}),_dragOff:i(function(){this._toggleDragPlaceholder(!1)}),_drop:i(function(e){this._toggleDragPlaceholder(!1);var t=e.originalEvent.dataTransfer.files;return t.length?void this.trigger("uploader:attachMedia",t):void this.trigger("uploader:dropError","No files")}),_toggleDragPlaceholder:e.throttle(function(e){this.trigger(e?"uploader:showPlaceholder":"uploader:hidePlaceholder")},50)});return a}),define("core/templates/postMediaUploadButton",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<a href="#" tabindex="-1" data-action="attach" class="attach" title="'+a(t.gettext.call(e,"Upload Images",{name:"gettext",hash:{},data:i}))+'"><span>'+a(t.gettext.call(e,"Attach",{name:"gettext",hash:{},data:i}))+'</span></a>\n<input type="file" data-role="media-upload" tabindex="-1" accept="image/*">\n'},useData:!0})}),define("core/views/media/UploadButtonView",["jquery","underscore","backbone","core/templates/postMediaUploadButton","core/utils"],function(e,t,n,i,a){var s=a.stopEventHandler,o="input[type=file][data-role=media-upload]",r=n.View.extend({events:function(){var e={"click [data-action=attach]":"_attachMedia"};return e["change "+o]="_selectorChange",e}(),initialize:function(e){this.template=e&&e.template||i},render:function(){return this.$el.html(this.template()),this},_attachMedia:s(function(){this.$(o).click()}),_selectorChange:function(t){var n=t.target,i=n.files;i.length&&(this.trigger("uploader:attachMedia",i),e(n).replaceWith(n.cloneNode()))}});return r}),define("core/templates/postMediaUploadProgress",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return'<li>\n<div class="media-progress-box">\n<div class="media-progress">\n<div class="bar" style="right: '+n(t(null!=e?e.remainingPerc:e,e))+'%"></div>\n</div>\n</div>\n</li>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t.each.call(e,null!=e?e.collection:e,{name:"each",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},useData:!0})}),define("core/views/media/UploadsProgressSubView",["backbone","core/templates/postMediaUploadProgress"],function(e,t){var n=e.View.extend({initialize:function(){this.collection=new e.Collection,this.listenTo(this.collection,"add remove change",this.render)},hasVisible:function(){return!!this.collection.length},render:function(){return this.$el.html(t({collection:this.collection.toJSON()})),this}});return n}),define("core/collections/MediaUploadCollection",["backbone","core/models/MediaUpload"],function(e,t){var n=e.Collection.extend({model:t});return n}),define("core/utils/media/MediaStore",["underscore","core/utils/storage"],function(e,t){var n=function(e){if(!e)throw Error("Cannot instantiate MediaStore without a valid storageKey!");this._storageKey=e};return e.extend(n.prototype,{getItems:function(){return t.get(this._storageKey)||{}},clear:function(){t.remove(this._storageKey)},getItem:function(e){return this.getItems()[e]},setItem:function(e,n){var i=this.getItems();return i[e]=n,t.set(this._storageKey,i),n},removeItem:function(e){var n=this.getItems();return e in n?(delete n[e],t.set(this._storageKey,n),!0):!1}}),n}),define("core/templates/postMediaUploadLegacy",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.lambda,s=this.escapeExpression;return'<li class="publisher-border-color" data-media-id="'+s(a(null!=e?e.original_url:e,e))+'">\n<div class="media-box">\n<div class="media-ct">\n<div class="media-surface">\n<img src="'+s(a(null!=e?e.original_url:e,e))+'?w=128&h=128" alt="'+s(t.gettext.call(e,"Media attachment",{name:"gettext",hash:{},data:i}))+'">\n<a href="#" class="media-delete" data-action="detach">&#10005;</a>\n</div>\n</div>\n</div>\n</li>\n'},useData:!0})}),define("core/views/media/UploadsLegacySubView",["jquery","underscore","backbone","core/collections/MediaUploadCollection","core/utils","core/utils/media/MediaStore","core/templates/postMediaUploadLegacy"],function(e,t,n,i,a,s,o){var r=a.stopEventHandler,l=n.View.extend({events:{"click [data-action=detach]":"onDetach"},initialize:function(e){this.collection=new i;var n=e.mediaStorageKey;this.mediaStore=n&&new s(n),this.mediaStore&&this.collection.reset(t.values(this.mediaStore.getItems()),{validate:!0}),this.listenTo(this.collection,{add:this.onAdd,remove:this.onRemove,reset:this.onReset})},setElement:function(){var e=n.View.prototype.setElement.apply(this,arguments);return this.collection&&this.collection.each(this._addElement,this),e},hasVisible:function(){return!!this.collection.length},onDetach:r(function(t){var n=e(t.target).closest("li"),i=n.attr("data-media-id"),a=this.collection.where({original_url:i});this.collection.remove(a,{$el:n})}),_addElement:function(t){var n=e(o(t.toJSON()));n.attr("data-media-id",t.get("original_url")),this.$el.append(n)},onAdd:function(e){this.mediaStore&&this.mediaStore.setItem(e.get("original_url"),e),this._addElement(e)},onRemove:function(e,t,n){n.$el&&n.$el.remove();var i=this.mediaStore&&this.mediaStore.getItem(e.get("original_url"));i&&this.mediaStore.removeItem(e.get("original_url"))},onReset:function(){this.$el.empty(),this.mediaStore&&this.mediaStore.clear()}});return l}),define("core/templates/postMediaUploadRich",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e){var t,n=this.lambda,i=this.escapeExpression;return i(n(null!=(t=null!=e?e.media:e)?t.title:t,e))},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Media attachment",{name:"gettext",hash:{},data:i}))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<li class="publisher-border-color">\n<div class="media-box">\n<div class="media-ct">\n<div class="media-surface">\n<a href="'+o(s(null!=(a=null!=e?e.media:e)?a.url:a,e))+'" target="_blank">\n<img src="'+o(s(null!=(a=null!=e?e.media:e)?a.thumbnailUrl:a,e))+'" alt="';return a=t["if"].call(e,null!=(a=null!=e?e.media:e)?a.title:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+'">\n</a>\n</div>\n</div>\n</div>\n</li>\n'},useData:!0})}),define("core/views/media/UploadsRichSubView",["jquery","underscore","backbone","core/models/Media","core/UniqueModel","core/utils","core/templates/postMediaUploadRich"],function(e,t,n,i,a,s,o){var r=n.View.extend({initialize:function(){this._hasVisible=!1,this.collection=new n.Collection([],{model:i,comparator:"index"}),this.listenTo(this.collection,"add remove reset sort change:thumbnailUrl change:mediaType change:editsFinished",this.render),this.listenTo(this.collection,"change:index",t.bind(this.collection.sort,this.collection))},render:function(){return this.$el.empty(),this._hasVisible=!1,this.collection.each(function(e){e.get("thumbnailUrl")&&(t.contains(i.WEBPAGE_TYPES,e.get("mediaType"))||e.get("editsFinished")&&(this.$el.append(o({media:e.toJSON()})),this._hasVisible=!0))},this),this},hasVisible:function(){return this._hasVisible},addMedia:function(e){var t=a.get(i,e.url);if(t)t.set(e);else{if(!e.editsFinished)return;t=new a(i,e),t.fetch()}return this.collection.add(t),t},updateFromText:function(e,n,i){if(!e)return void this.collection.reset();var a=s.bleachFindUrls(e);a=t.uniq(a,!1,function(e){return e.url});var o={};t.each(a,function(a){o[a.url]=!0;var s=t.pick(a,"index","url"),r=n>a.index&&a.endIndex>=n||"."===e[a.endIndex];(!r||i.isPasteEvent)&&(s.editsFinished=!0),this.addMedia(s)},this);var r=this.collection.pluck("url");o=t.keys(o);var l=t.difference(r,o);this.collection.remove(this.collection.filter(function(e){return t.contains(l,e.get("url"))}))}});return r}),define("core/templates/postMediaUploads",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<ul data-role="media-legacy-list"></ul>\n<ul data-role="media-progress-list"></ul>\n<ul data-role="media-rich-list"></ul>\n<div class="media-expanded empty" data-role="media-preview-expanded">\n<img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="\ndata-role="media-preview-expanded-image" alt="'+a(t.gettext.call(e,"Media preview placeholder",{name:"gettext",hash:{},data:i}))+'">\n</div>\n'},useData:!0})}),define("core/views/media/UploadsView",["backbone","core/views/media/UploadsProgressSubView","core/views/media/UploadsLegacySubView","core/views/media/UploadsRichSubView","core/templates/postMediaUploads"],function(e,t,n,i,a){var s=e.View.extend({initialize:function(e){this.legacyView=new n({mediaStorageKey:e.mediaStorageKey}),this.legacy=this.legacyView.collection,this.richView=new i,this.rich=this.richView.collection,this.uploadProgressView=new t,this.uploadProgress=this.uploadProgressView.collection,this.listenTo(this.legacy,"all",this._updateEmpty),this.listenTo(this.rich,"all",this._updateEmpty),this.listenTo(this.uploadProgress,"all",this._updateEmpty)},render:function(){return this.legacyView.$el.detach(),this.richView.$el.detach(),this.uploadProgressView.$el.detach(),this.$el.html(a()),this._updateEmpty(),this.legacyView.setElement(this.$("[data-role=media-legacy-list]")[0]),this.richView.setElement(this.$("[data-role=media-rich-list]")[0]),this.uploadProgressView.setElement(this.$("[data-role=media-progress-list]")[0]),this},clear:function(){this.legacy.reset(),this.rich.reset(),this.uploadProgress.reset()},_updateEmpty:function(){this.legacyView.hasVisible()||this.richView.hasVisible()||this.uploadProgressView.hasVisible()?this.$el.removeClass("empty"):this.$el.addClass("empty")}});return s}),define("core/mixins/withUploadForm",["jquery","underscore","backbone","core/strings","core/utils","core/utils/media/upload","core/utils/storage","core/views/media/DragDropUploadView","core/views/media/UploadButtonView","core/views/media/UploadsView"],function(e,t,n,i,a,s,o,r,l,c){var d=i.get,u=function(){t.defaults(this,u.bothProto,u.uploadsProto,u.previewsProto)};return u.previewsProto={initMediaPreviews:function(e,n,i){this.mediaUploadsView=new c({el:e[0],mediaStorageKey:n}),this.mediaUploadsView.render(),this.updateLiveMediaDebounced=t.partial(t.debounce(this.updateLiveMedia,500),i,!1),this.listenTo(i,{keychange:this.updateLiveMediaDebounced,paste:function(e,n){n&&n.fake||t.defer(t.bind(this.updateLiveMedia,this,i,!0))}}),this.updateLiveMedia(i,!0)},clearMediaPreviews:function(){this.mediaUploadsView&&this.mediaUploadsView.clear()},updateLiveMedia:function(e,t){if(this.mediaUploadsView){var n=e.get(),i=e.offset();this.mediaUploadsView.richView.updateFromText(n,i,{isPasteEvent:t})}}},u.uploadsProto={initMediaUploads:function(e,t,n){this.mediaDragDropView=new r({el:t[0]}),this.listenTo(this.mediaDragDropView,{"uploader:attachMedia":function(){o.set("usedDragDrop",1),this.handleAttachMedia.apply(this,arguments)},"uploader:dragEnter":function(){this.$el.addClass("expanded")},"uploader:showPlaceholder":function(){e.show()},"uploader:hidePlaceholder":function(){e.hide()},"uploader:dropError":function(){var e=d("Sorry we didn't catch that. Try again?");this.alert(e,{type:"error",isUploadError:!0})}}),this.mediaUploadButtonView=new l({el:n[0]}),this.listenTo(this.mediaUploadButtonView,{"uploader:attachMedia":this.handleUploadViaButton}),this.mediaUploadButtonView.render()},handleUploadViaButton:function(e){if(e&&o.isPersistent&&!o.get("usedDragDrop")&&!a.isMobileUserAgent()){var t=this.alert(d("Did you know you can drag and drop images too? Try it now!"));this.listenToOnce(t,"dismiss",function(){o.set("usedDragDrop",1)})}this.handleAttachMedia.apply(this,arguments)},handleAttachMedia:function(e,i){var a=this,o=new n.Model({remainingPerc:100});a.mediaUploadsView.uploadProgress.add(o),i=t.extend(i||{},{onProgress:function(e){o.set("remainingPerc",100-e)}});var r;r=t.result(a,"areUploadUrlsEnabled")?s.uploadMediaUrl(e,i).then(function(e){e.fetch(),a.textarea.insertAtCursor(e.get("url")),a.updateLiveMedia(a.textarea,!0),a.dismissUploadError()}).otherwise(function(){var e=d("Unfortunately your image upload failed. Please verify that your image is in a supported format (JPEG, PNG, or GIF). If you continue seeing this error, please try again later.");a.alert(e,{type:"error",isUploadError:!0})}):s.uploadMedia(e,i).then(function(e){a.mediaUploadsView.legacy.add(e),a.dismissUploadError()}).otherwise(function(){var e=d("Unfortunately your image upload failed. Please verify that your image is under 2MB. If you continue seeing this error, please try again later.");a.alert(e,{type:"error",isUploadError:!0})}),r.always(function(){a.mediaUploadsView.uploadProgress.remove(o)})},dismissUploadError:function(){this.dismissAlert(function(e){return e.options&&e.options.isUploadError})},uploadSupported:s.uploadSupported,isUploadInProgress:function(){return this.mediaUploadsView&&this.mediaUploadsView.uploadProgress.length},getMediaUploadTokens:function(){return this.mediaUploadsView?this.mediaUploadsView.legacy.pluck("token"):[]}},u.bothProto={initMediaViews:function(e){e.allowMedia&&this.initMediaPreviews(this.$("[data-role=media-preview]"),e.storageKey,e.textarea),e.allowUploads&&this.initMediaUploads(this.$("[data-role=drag-drop-placeholder]"),this.$("[data-role=textarea]"),this.$("[data-role=media-uploader]"))}},u}),define("core/editable",[],function(){function e(e){return e.replace(s," ")}function t(n,i,a){var s,o,l,c,d="",u=[];for("string"!=typeof a&&(a="\n\n"),c=0;n.length>c;++c)o=n[c],s=o.nodeName.toLowerCase(),1===o.nodeType?(l=i&&i(o),l?d+=l:r.hasOwnProperty(s)?(d&&u.push(d),d=t(o.childNodes,i,a)):d+="br"===s?"\n":t(o.childNodes,i,a)):3===o.nodeType&&(d+=e(o.nodeValue));return u.push(d),u.join(a)}function n(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{if(!e.attachEvent)throw Error("No event support.");e.attachEvent("on"+t,n)}}var i=window.document,a="character",s=RegExp(String.fromCharCode(160),"gi"),o="h1 h2 h3 h4 h5 h6 p pre blockquote address ul ol dir menu li dl div form".split(" "),r={},l=0;for(l=0;o.length>l;l++)r[o[l]]=!0;var c=function(e,t,i){var a=this;if(!e||!e.contentEditable)throw Error("First argument must be contentEditable");this.elem=e,this.emulateTextarea=e.getAttribute("plaintext-only")||t,this.emulateTextarea&&(this.pasteHandler=function(){var e=a.plainTextReformat,t=function(){e.timeout=null,e.call(a)};e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(t,0)},n(e,"paste",this.pasteHandler));for(var s in i)i.hasOwnProperty(s)&&(this[s]=i[s])};return c.prototype={insertHTML:function(e){if(i.all){var t=i.selection.createRange();return t.pasteHTML(e),t.collapse(!1),t.select()}return i.execCommand("insertHTML",!1,e)},insertNode:function(e){var t,n,a;window.getSelection?(t=window.getSelection(),t.getRangeAt&&t.rangeCount&&(n=t.getRangeAt(0),n.deleteContents(),n.insertNode(e),n.collapse(!1),t.removeAllRanges(),t.addRange(n))):i.selection&&i.selection.createRange&&(n=i.selection.createRange(),a=3===e.nodeType?e.data:e.outerHTML,n.pasteHTML(a),n.collapse(!1))},getTextNodes:function(e){var t=this.elem;e&&e.nodeType?e=[e]:e||(e=t.childNodes);for(var n,i=[],a=0;e.length>a;++a)if(n=e[a])switch(n.nodeType){case 1:i=i.concat(this.getTextNodes(n.childNodes));break;case 3:/^\n\s+/.test(n.nodeValue)||i.push(n)}return i},text:function(e){var n,i,a,s=this.elem;try{i=Array.prototype.slice.call(s.childNodes)}catch(o){for(i=[],a=0;s.childNodes.length>a;++a)i.push(s.childNodes[a])}return n=t(i,e,this.emulateTextarea&&"\n"),n.replace(/^\s+|\s+$/g,"")},setText:function(e){e=e||"";var t,n,a,s=i.createDocumentFragment(),o=this.emulateTextarea?[e.replace(/(?:\r\n|\r|\n){2,}/g,"\n\n")]:e.split(/(?:\r\n|\r|\n){2,}/),r=o&&o.length;for(t=0;r>t;t++)n=o[t],a=this.createParagraph(n),s.appendChild(a);s.lastChild.appendChild(i.createElement("br")),this.elem.innerHTML="",this.elem.appendChild(s);var l=window.getSelection&&window.getSelection();l&&l.anchorNode===this.elem&&l.modify&&l.modify("move","forward","line")},createParagraph:function(e){var t,n,a,s,o,r,l,c=i.createElement("p");for(a=e.split(/\r\n|\r|\n/),n=0,o=a.length;o>n;n++){for(s=a[n],l=this.getHtmlElements(s),t=0,r=l.length;r>t;t++)c.appendChild(l[t]);c.appendChild(i.createElement("br"))}return c.lastChild&&c.removeChild(c.lastChild),c},getHtmlElements:function(e){return[i.createTextNode(e)]},plainTextReformat:function(){if(!(this.elem.getElementsByTagName("p").length<=1)){this.emulateTextarea=!1;var e=this.text();this.emulateTextarea=!0,this.setText(e)}},removeNode:function(e){var t,n,a;window.getSelection?(t=e.previousSibling,e.parentNode.removeChild(e),n=window.getSelection(),a=i.createRange(),t&&(a.setStart(t,t.length),a.setEnd(t,t.length)),n.addRange(a)):e.parentNode.removeChild(e)},selectedTextNode:function(){var t,n,s=this.elem;if(window.getSelection)return t=window.getSelection(),t.anchorNode;if(i.selection.createRange){for(n=i.selection.createRange().duplicate();-1e3===n.moveStart(a,-1e3);)continue;var o,r,l,c,d,u,h,m=n.text;for(u=0;s.childNodes.length>u;++u)for(o=s.childNodes[u],l=this.getTextNodes(o),h=0;l.length>h;++h)if(r=l[h],d=e(r.nodeValue),m.indexOf(d)>-1)c=r,m=m.replace(d,"");else if(d.indexOf(m)>-1)return r;return c}},selectedTextNodeOffset:function(t){var n,s;if(window.getSelection){var o=window.getSelection();o&&o.anchorOffset&&(s=o.anchorOffset)}else if(t&&i.selection.createRange){n=i.selection.createRange();for(var r=e(t.nodeValue),l=n.duplicate(),c=l.parentElement(),d=0;0!==n.moveStart(a,-1)&&++d&&0!==r.indexOf(e(n.text))&&c===n.parentElement();)l=n.duplicate(),c=l.parentElement();s=d}return isNaN(s)?0:s},offset:function(){function t(i,a){function s(e){l+=e[0];for(var t=1;e.length>t;++t)o.push(l),l=e[t]}"string"!=typeof a&&(a="\n\n");for(var o=[],l="",c=0;i.length>c;++c){var d=i[c],u=d.nodeName.toLowerCase();1===d.nodeType?r.hasOwnProperty(u)?(l&&(l+=a),s(t(d.childNodes,a))):"br"===u?l+="\n":s(t(d.childNodes,a)):3===d.nodeType&&(d===n.anchorNode?(l+=e(d.nodeValue.slice(0,n.anchorOffset)),o.push(l),l=e(d.nodeValue.slice(n.anchorOffset))):l+=e(d.nodeValue))}return o.push(l),o}if(!window.getSelection)return 0;var n=window.getSelection();if(!n||!n.anchorNode||3!==n.anchorNode.nodeType)return 0;var i,a=this.elem;try{i=Array.prototype.slice.call(a.childNodes)}catch(s){i=[];for(var o=0;a.childNodes.length>o;++o)i.push(a.childNodes[o])}var l=t(i,this.emulateTextarea&&"\n");if(1===l.length)return 0;var c=l[0].length,d=l.join(""),u=d.match(/\s+$/);if(u){var h=u[0].length;c=Math.min(c,d.length-h)}var m=d.match(/^\s+/);if(m){var p=m[0].length;c-=p}return c},selectNodeText:function(t,n,s){var o,r,l=this.elem;if(window.getSelection)return o=window.getSelection(),o.removeAllRanges(),r=i.createRange(),r.setStart(t,n),r.setEnd(t,s),o.addRange(r),o;if(i.selection.createRange){r=i.selection.createRange();var c=e(t.nodeValue);if("body"===r.parentElement().nodeName.toLowerCase()){for(l.focus(),r=i.selection.createRange();-1e3===r.moveStart(a,-1e3);)continue;for(;1e3===r.moveEnd(a,1e3);)continue;var d=e(r.text),u=d.indexOf(c);u>0&&r.moveStart(a,u+2),r.collapse()}for(;-1===r.moveStart(a,-1)&&0!==c.indexOf(e(r.text));)continue;for(;1===r.moveEnd(a,1)&&c!==e(r.text);)continue;return r.moveStart(a,n),r.moveEnd(a,-1*(s-n-r.text.length)),r.select(),r}}},c.normalizeSpace=e,c}),define("core/CappedStorage",["core/utils/storage"],function(e){var t=function(e,t){this.max=e||10,this.queueKey=t||"__queue",this.getQueue()||this.setQueue([])};return t.prototype.set=function(t,n){var i=this.getQueue()||this.setQueue([]);i.length===this.max&&e.remove(i.shift()),e.set(t,n),i.push(t),this.setQueue(i)},t.prototype.get=function(t){return e.get(t)},t.prototype.remove=function(t){e.remove(t);for(var n=this.getQueue()||[],i=0;n.length>i;i++)if(n[i]===t){n.splice(i,1);break}this.setQueue(n)},t.prototype.clear=function(){e.clear(),this.setQueue([])},t.prototype.getQueue=function(){return e.get(this.queueKey)},t.prototype.setQueue=function(t){return e.set(this.queueKey,t),t},t}),define("core/extensions/jquery.autoresize",["jquery","underscore"],function(e,t){return e.fn.autoresize=function(n){var i=t.extend({extraSpace:0,maxHeight:1e3},n);return this.each(function(){var n=e(this).css({resize:"none",overflow:"hidden"}),a=n[0].contentEditable+""=="true"?"html":"val",s="html"===a?"<br>":"\n",o=n.height(),r=function(){var i={};t.each(i,function(e,t){i[t]=n.css(t)});var a=e(n[0].cloneNode(!0));return a.removeAttr("id").removeAttr("name").css({visibility:"hidden",position:"absolute",top:"-9999px",left:"-9999px",contentEditable:!1}).css(i).attr("tabIndex","-1"),a.insertAfter(n[0]),a}(),l=null,c=function(){r[0].style.height=0,r[a](n[a]()+s),r.scrollTop(r[0].scrollHeight);var e=Math.max(r[0].scrollHeight,o)+parseInt(i.extraSpace,10);i.maxHeight&&(e>=i.maxHeight?(n.css("overflow",""),e=i.maxHeight):n.css("overflow","hidden")),l!==e&&(l=e,n.height(e),n.trigger&&n.trigger("resize"))},d=t.throttle(c,500),u=function(e){13===e.keyCode?c():d()};n.bind("keyup",u).bind("paste",c).css("overflow","hidden"),c()})},e}),define("core/views/TextareaView",["underscore","jquery","backbone","core/utils","core/CappedStorage","core/extensions/jquery.autoresize"],function(e,t,n,i,a){var s=n.View.extend({events:{"keydown  [data-role=editable]":"handleKeyDown","keyup    [data-role=editable]":"handleKeyUp","paste    [data-role=editable]":"handlePaste","focusin  [data-role=editable]":"handleFocusIn","blur     [data-role=editable]":"handleBlur"},initialize:function(t){t=t||{},this.storageKey=t.storageKey,this.value=t.value||this.getDraft()[0],this.placeholder=t.placeholder,this.listenTo(this,"keychange",e.debounce(this.saveDraft,this.constructor.SAVE_DRAFT_INTERVAL))},render:function(){return this.$input=this.createInput(),this.set(this.value),this.$el.append(this.$input),this.$input.autoresize({maxHeight:this.constructor.MAX_TEXTAREA_HEIGHT}),this},createInput:function(){return t("<textarea>").attr({"class":"textarea",placeholder:this.placeholder,"data-role":"editable"})},resize:function(){this.$input.trigger("paste",{fake:!0})},get:function(){return this.$input.val()},getSelected:function(){var e=this.$input[0];if("number"==typeof e.selectionStart){var t=this.$input.val();return t.substring(e.selectionStart,e.selectionEnd)}return""},offset:function(){var e=this.$input[0];return"number"==typeof e.selectionStart?e.selectionStart:0},insertAtCursor:function(e){this.focus();var t=this.get(),n=this.offset(),a=i.insertWithWhitespace(t,n,e),s=this.$input[0];if(this.set(a),s.setSelectionRange){var o=a.indexOf(e,n)+e.length+1;s.setSelectionRange(o,o)}},insertAroundSelection:function(e,t){this.focus();var n,i,a=this.$input[0];"number"==typeof a.selectionStart?(n=a.selectionStart,i=a.selectionEnd):n=i=0;var s=this.get(),o=s.substring(0,n)+e+s.substring(n,i)+t+s.substring(i);this.set(o),a.setSelectionRange&&a.setSelectionRange(n+e.length,i+e.length)},set:function(e){this.$input.val(e)},clear:function(){this.set("")},focus:function(){this.$input[0].focus()},handleKeyDown:function(e){this.trigger("keydown",e)},handleKeyUp:function(e){this.trigger("keychange",e)},handlePaste:function(e,t){t=t||{},this.trigger(t.fake?"paste":"paste keychange"),this.$input.trigger("resize")},handleFocusIn:function(){this.trigger("focus")},handleBlur:function(){this.trigger("blur")},saveDraft:function(){return this.storageKey?t.trim(this.get())?void this.constructor.storage.set(this.storageKey,this.toJSON()):void this.removeDraft():void 0},toJSON:function(){return[this.get(),t.now()]},getDraft:function(){var e=[""];if(!this.storageKey)return e;var n=this.constructor.storage.get(this.storageKey);if(!n)return e;if(e=n,!e.length)return[""];var i=t.now()-e[1]>=this.constructor.DRAFT_MAX_AGE;return i?(this.removeDraft(),[""]):e},removeDraft:function(){this.storageKey&&this.constructor.storage.remove(this.storageKey)}},{MAX_TEXTAREA_HEIGHT:350,SAVE_DRAFT_INTERVAL:500,DRAFT_MAX_AGE:864e5,storage:new a(5,"drafts.queue")});return s}),define("core/views/ContentEditableView",["jquery","underscore","core/editable","core/views/TextareaView"],function(e,t,n,i){var a=i,s=a.prototype,o=a.extend({events:function(){return t.extend({},s.events,{"focusout [data-role=editable]":"handleFocusOut","click .placeholder":"handlePlaceholderClick"})},initialize:function(){s.initialize.apply(this,arguments),this.hasFocus=!1,this._selectionRange=null},saveSelection:function(){if(window.getSelection){var e=window.getSelection(),t=e&&e.rangeCount&&e.getRangeAt(0);this._selectionRange=t}},restoreSelection:function(){if(this._selectionRange){var e=window.getSelection();e.removeAllRanges(),e.addRange(this._selectionRange),this._selectionRange=null}},render:function(){return this.$input=this.createInput(),this.$el.append(this.$input),this.set(this.value),this.renderPlaceholder(),this},createInput:function(){var t=e("<div>").attr({"class":"textarea",tabIndex:0,role:"textbox","aria-multiline":"true",contenteditable:"true","data-role":"editable"}).css({overflow:"auto","max-height":this.constructor.MAX_TEXTAREA_HEIGHT+"px"});return this.content=new n(t[0],!0),t},renderPlaceholder:function(){var t=this.placeholder;t&&(this.$input.attr("aria-label",t),this.$placeholder=e('<span class="placeholder">'+t+"</span>"),this.updatePlaceholderDisplay())},updatePlaceholderDisplay:function(){this.$placeholder&&(this.hasFocus||this.content.text()?this.$placeholder.remove():this.$el.prepend(this.$placeholder))},handlePlaceholderClick:function(){this.$input.focus()},handleFocusIn:function(){s.handleFocusIn.call(this),this.restoreSelection(),this.hasFocus=!0,this.updatePlaceholderDisplay()},handleFocusOut:function(){this.saveSelection(),this.hasFocus=!1,this.updatePlaceholderDisplay()},get:function(){return this.content.text()},getSelected:function(){return this.hasFocus&&window.getSelection?""+window.getSelection():this._selectionRange?""+this._selectionRange:""},offset:function(){return this.content.offset()},set:function(e){this.content.setText(e),this.resize(),this.updatePlaceholderDisplay()},insertAtCursor:function(e){this.focus();var t=" "+e+" ";document.queryCommandSupported&&document.queryCommandSupported("insertText")&&document.execCommand("insertText",!1,t)||this.content.insertNode(document.createTextNode(t))},clear:function(){s.clear.call(this),t.defer(function(e){e.$input.blur()},this)},insertAroundSelection:function(e,t){if(window.getSelection){this.focus();var n=window.getSelection();if(n.rangeCount){var i=n.getRangeAt(0),a=i.cloneRange();a.collapse(!1);var s=document.createTextNode(t);a.insertNode(s);var o=i.cloneRange();o.collapse(!0);var r=document.createTextNode(e);o.insertNode(r),i.setStart(r,e.length),i.setEnd(s,0),n.removeAllRanges(),n.addRange(i)}}}});return o}),define("home/templates/postReply",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s='<div class="avatar">\n';return a=t["if"].call(e,null!=(a=null!=e?e.user:e)?a.isRegistered:a,{name:"if",hash:{},fn:this.program(2,i),inverse:this.program(4,i),data:i}),null!=a&&(s+=a),s+"</div>\n"},2:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.userAvatar,"","userAvatar",null!=e?e.user:e,void 0,t,n,i),null!=a&&(s+=a),s},4:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<span class="user">\n<img data-role="user-avatar" src="'+i(n(null!=(t=null!=(t=null!=e?e.user:e)?t.avatar:t)?t.cache:t,e))+'"/>\n</span>\n'},6:function(){return'style="margin-left: 0"'},8:function(){return'<div class="media-preview empty" data-role="media-preview"></div>\n'},10:function(e,t,n,i){var a,s='<div class="post-actions">\n<ul class="wysiwyg">\n';return a=t["if"].call(e,null!=e?e.displayMediaUploadButton:e,{name:"if",hash:{},fn:this.program(11,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+="</ul>\n",a=t["if"].call(e,null!=(a=null!=e?e.user:e)?a.isRegistered:a,{name:"if",hash:{},fn:this.program(13,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+"</div>\n"},11:function(){return'<li data-role="media-uploader"></li>\n'},13:function(e,t,n,i){var a=this.escapeExpression;return'<div class="logged-in">\n<section>\n<div class="temp-post" style="text-align: right">\n<button class="btn">\n'+a(t.gettext.call(e,"Post as %(username)s",{name:"gettext",hash:{username:t.getPartial.call(e,"userSpan",null!=e?e.user:e,{name:"getPartial",hash:{},data:i})},data:i}))+"\n</button>\n</div>\n</section>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="alert error" style="display:none" role="alert">\n<a class="close" data-action="dismiss-alert" title="'+s(t.gettext.call(e,"Dismiss",{name:"gettext",hash:{},data:i}))+'">×</a>\n<span></span>\n</div>\n\n<div class="postbox">\n';return a=t["if"].call(e,null!=e?e.showAvatar:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='\n<div class="textarea-wrapper" ',a=t.unless.call(e,null!=e?e.showAvatar:e,{name:"unless",hash:{},fn:this.program(6,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='\ndata-role="textarea" dir="auto">\n<div data-role="drag-drop-placeholder" class="media-drag-hover" style="display: none">\n<div class="drag-text">\n&#11015; '+s(t.gettext.call(e,"Drag and drop your images here to upload them.",{name:"gettext",hash:{},data:i}))+"\n</div>\n</div>\n",a=t["if"].call(e,null!=e?e.displayMediaPreviews:e,{name:"if",hash:{},fn:this.program(8,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='<div class="edit-alert" role="postbox-alert"></div>\n',a=t["if"].call(e,null!=e?e.showSubmitButton:e,{name:"if",hash:{},fn:this.program(10,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+"</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/templates/blacklistErrorMessage",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"We are unable to post your comment because you have been blocked by %(forumName)s",{name:"gettext",hash:{forumName:null!=e?e.forumName:e},data:i}))+'\n<a target="_blank" href="https://help.disqus.com/customer/portal/articles/466223-who-deleted-or-removed-my-comment-">'+a(t.gettext.call(e,'"Find out more."',{name:"gettext",hash:{},data:i}))+"</a>\n"
},useData:!0})}),define("home/templates/mustVerifyEmail",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'Disqus.com requires you to\n<a href="#" data-action="verify-email">verify your email address</a> before posting\n'},useData:!0})}),define("home/views/PostReplyView",["jquery","underscore","backbone","core/bus","core/mixins/withAlert","core/mixins/withUploadForm","core/strings","core/switches","core/utils/releaseUtils","core/views/ContentEditableView","core/views/TextareaView","home/models/Session","home/templates/postReply","home/templates/blacklistErrorMessage","home/templates/mustVerifyEmail"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p){var f=o.get,g=n.View.extend({tagName:"form",className:"reply-form",events:{"click [data-action=cancel]":"hide",submit:"submitForm"},postboxAlertSelector:"[role=postbox-alert]",initialize:function(e){this.session=e.session,this.thread=e.thread,this.showSubmitButton=e.showSubmitButton!==!1,this.showAvatar=e.showAvatar!==!1,this.placeholderText=e.placeholder,this.canUseContentEditable=e.canUseContentEditable,this.showMediaPreviews=e.showMediaPreviews,this.canUploadLegacyMedia=e.canUploadLegacyMedia,this.showMustVerifyAlert=e.showMustVerifyAlert!==!1,this.enableUploadUrls=e.enableUploadUrls,this.setAlertSelector(this.postboxAlertSelector),this._isHidden=!1,this.listenTo(this.model,{error:this.onerror}),this.listenTo(this.model,"change:id",function(){this.model.id&&this.textarea.removeDraft()})},redraw:function(){var t=this.$el.hasClass("expanded"),n=this.el,i=this.$el.find("textarea").val();this.render(),this.$el.find("textarea").val(i),t&&this.$el.addClass("expanded"),0!==e(n).parent().length&&n.parentNode.replaceChild(this.el,n)},getPlaceholderText:function(){return this.placeholderText||"Discuss…"},render:function(){var e=this.$el,t=this.showMediaPreviews&&this.thread.forum.get("settings").allowMedia,n=t&&this.uploadSupported&&(this.canUploadLegacyMedia||this.areUploadUrlsEnabled());return e.html(h({showAvatar:this.showAvatar,showSubmitButton:this.showSubmitButton,user:this.session.toJSON(),displayMediaPreviews:t,displayMediaUploadButton:n})),this.model.get("parent")?e.addClass("expanded"):e.removeClass("expanded"),e.addClass("authenticated"),this.initTextarea(),this.initMediaViews({allowMedia:t,allowUploads:n,storageKey:this.model.storageKey("media"),textarea:this.textarea}),this.showMustVerifyAlert&&this.constructor.mustVerifyEmailToPost(this.session.user)&&this._alertMustVerify(),this._isHidden&&e.addClass("hidden"),this},areUploadUrlsEnabled:function(){var e=u.get().user;return this.enableUploadUrls||r.isFeatureActive("home_upload_urls",{isAdmin:l.isDisqusAdmin(e)})},initTextarea:function(){var e=this.canUseContentEditable?c:d,n=this.textarea=new e({placeholder:this.getPlaceholderText(),userSuggestions:this.userSuggestions,value:this.model.get("raw_message"),storageKey:this.model.storageKey()});this.$("[data-role=textarea]").prepend(n.render().el),this.listenTo(n,{focus:function(){this.$el.addClass("expanded"),t.delay(t.bind(this.resize,this),200)},blur:function(){this.trigger("blur")}})},resize:function(){this.textarea.resize()},focus:function(){this.textarea.focus()},clear:function(){var e=this;e.textarea.clear(),e.clearMediaPreviews(),e.$el.removeClass("expanded"),e.model.get("parent")&&e.hide()},restore:function(e){var n=this;n.textarea.set(e.get("raw_message")),n.textarea.handleFocusIn(),t.delay(function(){n.resize()},200),n.model.get("parent")&&n.show()},_alertMustVerify:function(e){var t=p();this.alert(t,{safe:!0,type:e?"error":"warn",target:e?this.postboxAlertSelector:null})},submitForm:function(e){return e.preventDefault(),this.dismissAlert(),this.createPost()},onerror:function(e,n){var i=this,a=this.model;if(12===n.code&&/not have permission to post on this thread/.test(n.response)){var s=m({forumName:i.thread.forum.get("name")});i.alert(s,{type:"error",target:i.postboxAlertSelector,safe:!0})}else 12===n.code&&/verify/.test(n.response)?i._alertMustVerify(!0):t.isString(n.response)?i.alert(n.response,{type:"error",target:i.postboxAlertSelector}):i.alert(f("Oops! We're having trouble posting your comment. Check your internet connection and try again."),{type:"error",target:i.postboxAlertSelector});i.restore(a)},createPost:function(){var e=this.model;if(this.dismissAlert(),this.isUploadInProgress())return void this.alert(f("Please wait until your images finish uploading."),{type:"error",target:this.postboxAlertSelector});var t=e.save({raw_message:this.textarea.get()},{uploadTokens:this.getMediaUploadTokens()});return t?(t.done(function(){i.trigger("uiCallback:postCreated",e)}),this.clear(),e):void this.alert(e.validationError,{type:"error",target:this.postboxAlertSelector})},toggle:function(){this.isOpen()?this.hide():this.show()},show:function(){var e=this;e._isHidden=!1,e.$el.removeClass("hidden"),e.trigger("show")},hide:function(){var e=this;e._isHidden=!0,e.dismissAlert(),e.$el.addClass("hidden"),e.trigger("hide")},isOpen:function(){return!this._isHidden}},{mustVerifyEmailToPost:function(e){return!e.get("isVerified")}});return a.call(g.prototype),s.call(g.prototype),g}),define("home/ReplyViewManager",["underscore","jquery","backbone","home/utils/features","home/models/Post","home/models/Session","home/views/PostReplyView"],function(e,t,n,i,a,s,o){function r(e){this.view=e,this.model=this.view.model,this.listenTo(this.view,"close",function(){this.stopListening()})}var l={toggleReplyView:function(e){var n=t(e);this.replyView?this.replyView.toggle():(this.replyView=this.createReplyView().render(),n.parent().after(this.replyView.el)),this.replyView._isHidden||this.replyView.focus()},vivifyReply:function(e){var t=new this.view.constructor({model:e,session:s.get()});this.replyView.$el.after(t.render().el),t.trigger("show"),this.replyView.remove(),this.replyView=null},createReplyView:function(){var e=new a({thread:this.model.thread.id,parent:this.model.id,depth:this.model.get("depth")+1,author:s.get().user.id});return this.listenTo(e,"change:id",this.vivifyReply),new o({model:e,thread:e.thread,session:s.get(),canUseContentEditable:i.canUseContentEditable(),showMediaPreviews:!0,canUploadLegacyMedia:!0})}};return e.extend(r.prototype,l,n.Events),r}),define("core/views/UpvotersCard",["underscore","core/views/common/HoverCard","core/views/UsersCard","core/bus","core/utils"],function(e,t,n,i,a){var s=a.preventDefaultHandler,o=n.extend({guestTextPartialName:"cardGuestUpvoterText",initialize:function(t){var i=t.model,a=i.getUpvotersUserCollection();e.extend(t,{collection:a,numUsers:i.get("likes")}),n.prototype.initialize.call(this,t),this.model=i,this.session=t.session,this.likes=i.get("likes"),this.hadLikes=!!this.likes,this._fetched=!1,this._rendered=!1,this.listenTo(this.model,"change:userScore",this.updateUserSet),this.listenTo(this.model,"change:likes",this.updateGuests)},updateGuests:function(){this.numUsers=this.model.get("likes")||0,n.prototype.updateGuests.call(this)},updateUserSet:function(){var e=this.session.user,t=this.likes,n=!1;this.likes=this.model.get("likes"),this.model.get("userScore")>0?(this.session.isLoggedIn()&&this.collection.add(e),this.likes&&!t?(this._rendered=!1,this.show()):n=this.session.isLoggedOut()?!0:!!(this.likes-1-this.collection.length)):(this.collection.remove(e),this.likes||this.hide()),this.updateGuests(),this.moveTo(this.$target,n)},show:function(){if(this.likes&&!this.isVisible()){if(this.hadLikes||(this._fetched=!0),!this._fetched)return void this.collection.fetch().done(e.bind(function(){this._fetched=!0,this.show()},this));var t=this.session.user;this.model.get("userScore")>0&&this.session.isLoggedIn()&&!this.collection.contains(t)&&this.collection.add(t),n.prototype.show.call(this),i.trigger("uiAction:upvotersCardShow")}},handleShowProfile:s(function(e){n.prototype.handleShowProfile.call(this,e),i.trigger("uiAction:showProfileFromUpvotes")})},{create:function(e){var n=e.model;if(n.has("id"))return t.create(n.get("id"),e,"UpvotersCard",o)}});return o}),define("core/views/ClickTooltip",["underscore","core/views/common/HoverCard"],function(e,t){var n=t.extend({className:"tooltip-outer",initialize:function(e){t.prototype.initialize.call(this,e),this.template=e.template},render:function(){this.$el.html(this.template()),t.prototype.render.call(this)},moveTo:function(e){if(e){var n=t.POSITION_OFFSET,i=e.offset(),a=this.getContainerPosition();this.$el.css({bottom:a.containerOffset.height-i.top+n,top:"inherit",left:i.left})}},target:function(t){t.on("click",e.bind(this.targetClicked,this,t)),t.on("mouseleave",e.bind(this.leave,this))},targetClicked:function(e){e&&(this.$target=e),"in"!==this._hoverState&&(this._hoverState="in",this.show(),t.open[this.uid]=this)}},{create:function(e){return t.create(e.id,e,"ClickTooltip",n)}});return n}),define("home/templates/anonUpvoteCard",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="tooltip">\n'+a(t.gettext.call(e,"You must sign in to up-vote this post.",{name:"gettext",hash:{},data:i}))+"\n</div>\n"},useData:!0})}),define("home/templates/anonDownvoteCard",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="tooltip">\n'+a(t.gettext.call(e,"You must sign in to down-vote this post.",{name:"gettext",hash:{},data:i}))+"\n</div>\n"},useData:!0})}),define("home/views/PostActionsView",["jquery","backbone-marionette","home/templates/postActions","home/utils/mixpanelUtils","home/ReplyViewManager","home/models/Session","core/views/UpvotersCard","core/views/ClickTooltip","home/templates/anonUpvoteCard","home/templates/anonDownvoteCard","core/bus","core/utils"],function(e,t,n,i,a,s,o,r,l,c,d,u){var h=t.ItemView.extend({template:n,templateHelpers:function(){return{discussionRoute:this.model.thread.getDiscussionRoute(),sessionUserHasUpvoted:this.model.get("userScore")>0,sessionUserHasDownvoted:this.model.get("userScore")<0,wasAuthoredBySessionUser:this.model.author.isSessionUser(),isLoggedIn:s.get().isLoggedIn()}},events:{"click [data-action=vote]":"vote","click [data-action=reply]":"toggleReplyView"},initialize:function(e){this.session=s.get(),this.initializeReplyViewManager(e)},initializeReplyViewManager:function(e){this.replyViewManager=new a(e.parentPostView)},onRender:function(){this.initUpvotersCard(),this.initAnonVoteCards()},initAnonVoteCards:function(){if(this.session.isKnownToBeLoggedOut()&&!this.model.thread.forum.get("settings").allowAnonVotes){this.anonUpvoteCard&&this.anonUpvoteCard.remove();var e=this.$("[data-action=vote][data-vote=1]");e.length&&(this.anonUpvoteCard=r.create({targetElement:e,template:l,id:"anonUpvote"}),this.listenTo(this.anonUpvoteCard,"show",this.closeUpvotersCard),this.anonDownvoteCard&&this.anonDownvoteCard.remove(),e=this.$("[data-action=vote][data-vote=-1]"),e.length&&(this.anonDownvoteCard=r.create({targetElement:e,template:c,id:"anonDownvote"})))}},closeUpvotersCard:function(){this.hoverCard&&this.hoverCard.hide()},initUpvotersCard:function(){if(!u.isMobileUserAgent()){this.hoverCard&&this.hoverCard.remove();var e=this.$("[data-action=vote][data-vote=1]");e.length&&(this.hoverCard=o.create({targetElement:e,model:this.model,session:this.session}))}},vote:function(t){if(t&&(this.model.thread.forum.get("settings").allowAnonVotes||!this.session.isKnownToBeLoggedOut())){t.preventDefault(),t.stopPropagation(),i.track("like post",t);var n=e(t.currentTarget),a=parseInt(n.data("vote"),10),s=this.model.get("userScore")===a;s?d.trigger("uiAction:postUnvote",this.model,t):1===a?d.trigger("uiAction:postUpvote",this.model,t):-1===a&&d.trigger("uiAction:postDownvote",this.model,t),this.model.vote(s?0:a),this.$("[data-vote=1]").toggleClass("active",1===this.model.get("userScore")),this.$("[data-vote=-1]").toggleClass("active",-1===this.model.get("userScore")),this.$("[data-role=upvotes]").text(this.model.get("likes")||"")}},toggleReplyView:function(e){e&&(e.preventDefault(),e.stopPropagation(),this.replyViewManager.toggleReplyView(e.currentTarget))}});return h}),define("core/collections/MediaCollection",["backbone","core/models/Media"],function(e,t){var n=e.Collection.extend({model:t});return n}),define("core/mediaConfig",["underscore","backbone"],function(e,t){function n(){var t=document.body.offsetWidth,n=i,a=n.length;return e.find(n,function(e,i){return i+1===a||Math.abs(n[i+1]-t)>Math.abs(n[i]-t)})}var i=[320,480,600,800],a=new t.Model({collapsed:!1,defaultIframeHeight:300,mediaPersistedWidths:i,loadedThumbnailWidth:n()});return a.findClosestThumbnailSize=n,a}),define("core/models/RichMediaViewModel",["backbone"],function(e){return e.Model.extend({defaults:{deferred:!0,showButtons:!0,activated:!1,kind:"image",deferredHeight:0,providerExpandMessage:"",providerCollapseMessage:"",providerIcon:"icon-proceed",respectSettings:!0}})}),define("core/templates/postMediaInlineLink",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.hasUserText:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},2:function(e){var t=this.lambda,n=this.escapeExpression;return'<a href="'+n(t(null!=e?e.href:e,e))+'" rel="nofollow">'+n(t(null!=e?e.text:e,e))+"</a>\n"},4:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="'+o(s(null!=e?e.href:e,e))+'" class="post-media-link" data-action="expand-collapse-media" rel="nofollow">';return a=t["if"].call(e,null!=(a=null!=e?e.model:e)?a.providerIcon:a,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+=o(s(null!=e?e.mediaLinkText:e,e)),a=t["if"].call(e,null!=e?e.domain:e,{name:"if",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+"</a>\n"},5:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<i class="'+i(n(null!=(t=null!=e?e.model:e)?t.providerIcon:t,e))+'"></i>'},7:function(e){var t=this.lambda,n=this.escapeExpression;return'<span class="post-media-link-domain"> &mdash; '+n(t(null!=e?e.domain:e,e))+"</span>"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=(a=null!=e?e.model:e)?a.deferred:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(4,i),data:i}),null!=a&&(s+=a),s},useData:!0})}),define("core/views/RichMediaLinkView",["backbone","handlebars","core/utils","core/templates/postMediaInlineLink"],function(e,t,n,i){return e.View.extend({tagName:"span",events:{"click [data-action=expand-collapse-media]":"handleToggle"},initialize:function(e){this.media=e.media;var t=e.$link;this.linkText=t.text(),this.linkHref=t.attr("href"),this.linkDomain=n.getDomain(this.linkHref),this.linkHasUserText=this.isUserText(t),this.hasGenericMessage=!1,this.linkHasUserText?this.mediaLinkText=this.linkText:this.media.get("title")?this.mediaLinkText=n.niceTruncate(this.media.get("title"),60):(this.hasGenericMessage=!0,this.mediaLinkText=this.model.get("providerExpandMessage")),this.listenTo(this.model,"change:deferred",this.render),this.listenTo(this.model,"change:activated",this.onChangeActivated)},isUserText:function(e){if("A"!==e[0].nodeName)return!1;var t=(e.text()||"").toLowerCase();if(!t)return!1;if(0===t.indexOf("http")||0===t.indexOf("www"))return!1;t=t.replace(/\.\.\.$/,"");var n=(e.attr("href")||"").toLowerCase();return-1===n.indexOf(t)},render:function(){var e=this.mediaLinkText;return this.hasGenericMessage&&this.model.get("activated")&&(e=this.model.get("providerCollapseMessage")),this.$el.html(i({model:this.model.toJSON(),text:this.linkText,href:this.linkHref,mediaLinkText:e,domain:this.linkDomain,hasUserText:this.linkHasUserText})),this},onChangeActivated:function(){this.hasGenericMessage&&this.render()},handleToggle:function(e){this.model.get("deferred")||(this.model.set("activated",!this.model.get("activated")),e&&e.preventDefault&&e.preventDefault())}})}),define("core/templates/postMedia",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r="";return a=t["if"].call(e,null!=(a=null!=e?e.media:e)?a.providerName:a,{name:"if",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+o(s(null!=(a=null!=e?e.media:e)?a.title:a,e))},2:function(e){var t,n=this.lambda,i=this.escapeExpression;return i(n(null!=(t=null!=e?e.media:e)?t.providerName:t,e))+" &ndash; "},4:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<i class="'+i(n(null!=(t=null!=e?e.model:e)?t.providerIcon:t,e))+' publisher-background-color"></i>'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='\n<a class="media-button media-button-expand publisher-color publisher-border-color" href="'+o(s(null!=(a=null!=e?e.media:e)?a.url:a,e))+'" rel="nofollow" target="_blank" data-action="expand"\ntitle="';return a=t["if"].call(e,null!=(a=null!=e?e.media:e)?a.title:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n',a=t["if"].call(e,null!=(a=null!=e?e.model:e)?a.providerIcon:a,{name:"if",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+"\n"+o(s(null!=(a=null!=e?e.model:e)?a.providerExpandMessage:a,e))+'\n</a>\n<a class="media-button media-button-contract publisher-color publisher-border-color" href="#" target="_blank" data-action="contract">\n<i class="icon-cancel publisher-background-color"></i> '+o(s(null!=(a=null!=e?e.model:e)?a.providerCollapseMessage:a,e))+'\n</a>\n<div class="media-content-loader" data-role="content-loader"></div>\n<div data-role="content-placeholder" class="media-content-placeholder"></div>\n'},useData:!0})}),define("core/templates/postMediaPlaceholder",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<a href="#" class="media-force-load" data-action="force-load"><i class="'+i(n(null!=(t=null!=e?e.model:e)?t.providerIcon:t,e))+'"></i></a>\n'},useData:!0})}),define("core/views/RichMediaView",["underscore","jquery","backbone","core/utils","core/mediaConfig","core/views/RichMediaLinkView","core/templates/postMedia","core/templates/postMediaPlaceholder"],function(e,t,n,i,a,s,o,r){var l=i.preventDefaultHandler,c=function(e,t,n,i){e[t.get(n)?"addClass":"removeClass"](i)};return n.View.extend({className:"media-container",events:{"click [data-action=expand]":"handleExpand","click [data-action=contract]":"handleContract","click [data-action=force-load]":"handleForceLoad"},template:o,initialize:function(e){this.options=e,this.media=e.media,this.template=e.template||this.template,this.$linkEl=null,this.setupMode(),this.listenTo(this.model,"change:activated",this.applyState),this.listenTo(this.model,"change:deferredHeight",this.onChangeDeferredHeight),this.listenTo(this.model,"change:showButtons",this.updateElementClass),this.listenTo(this.model,"change:deferred",this.render),this.listenTo(a,"change:collapsed",this.setupMode)},getMediaDimensions:function(){return{width:null,height:null}},getAvailableWidth:function(){return this.$el.parent().width()||a.get("loadedThumbnailWidth")},updateDeferredHeight:function(){this.model.set("deferredHeight",this.calculateDeferredHeight())},calculateDeferredHeight:function(){var e=this.getMediaDimensions(),t=e.width,n=e.height;if(!t||!n)return n;var i=this.getAvailableWidth(),a=i*n/t;return a},convertToButton:function(e){this.model.set("showButtons",!1),this.linkSubview&&this.linkSubview.remove(),this.linkSubview=new s({model:this.model,media:this.media,$link:e}),e.replaceWith(this.linkSubview.$el),this.linkSubview.render()},applyContentNodeHeight:function(e){this.contentNode.height(e||"auto")},shouldAutoplay:function(){return!this.model.get("deferred")},generateContentHtml:function(){return this.media.get("html")},createContentNode:function(e){return t(e)},insertContentNode:function(e){this.contentNode.html(e)},prepareElementEvents:function(){},displayContent:function(){this.updateDeferredHeight();var e=this.generateContentHtml(),t=this.createContentNode(e);this.prepareElementEvents(t),this.insertContentNode(t),this.applyContentNodeHeight(null)},configureDeferred:function(){this.enterViewport()},configureContentFromActivated:function(){this.model.get("activated")?this.displayContent():this.displayPlaceholder()},displayPlaceholder:function(){this.contentNode.html(r({model:this.model.toJSON()}))},updateElementClass:function(){var e=this.$el,t=this.model;c(e,t,"deferred","media-mode-deferred"),c(e,t,"activated","media-activated"),c(e,t,"showButtons","media-show-buttons")},applyState:function(){this.configureDeferred(),this.configureContentFromActivated(),this.updateElementClass()},render:function(){return this.$el.html(this.template({model:this.model.toJSON(),media:this.media.toJSON()})),this.contentNode=this.$el.find("[data-role=content-placeholder]"),this.applyState(),this},remove:function(){this.linkSubview&&this.linkSubview.remove(),n.View.prototype.remove.apply(this,arguments)},enterViewport:function(){this.model.get("deferred")&&this.activate()},activate:function(){this.model.set("activated",!0)},setupMode:function(){if(this.model.get("respectSettings")){this.model.set("activated",!1);var e=a.get("collapsed");e?this.model.set("deferred",!1):this.model.set("deferred",!0)}},onChangeDeferredHeight:function(){this.model.get("deferred")&&!this.model.get("activated")&&this.applyContentNodeHeight(this.model.get("deferredHeight"))},handleExpand:l(function(){this.model.set("activated",!0)}),handleContract:l(function(){this.model.set("activated",!1)}),handleForceLoad:l(function(){this.model.get("deferred")&&this.model.set("activated",!0)})})}),define("core/templates/postMediaImage",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e){var t,n=this.lambda,i=this.escapeExpression;return' height="'+i(n(null!=(t=null!=e?e.model:e)?t.deferredHeight:t,e))+'" '},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="'+o(s(null!=e?e.imageUrl:e,e))+'" target="_blank" rel="nofollow">\n<img src="'+o(s(null!=e?e.thumbnailUrl:e,e))+'" alt="'+o(t.gettext.call(e,"Thumbnail",{name:"gettext",hash:{},data:i}))+'" ';return a=t["if"].call(e,null!=(a=null!=e?e.model:e)?a.deferredHeight:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+">\n</a>\n"},useData:!0})}),define("core/views/ImageRichMediaView",["core/views/RichMediaView","core/utils","core/config","core/mediaConfig","core/templates/postMediaImage"],function(e,t,n,i,a){var s=RegExp("(^|\\.)"+t.getDomain(n.urls.media).split(".").slice(-2).join("\\.")+"$");return e.extend({getMediaDimensions:function(){return{width:this.media.get("thumbnailWidth"),height:this.media.get("thumbnailHeight")}},getImageUrl:function(){return this.media.get("resolvedUrl")||this.media.get("url")||this.media.get("thumbnailUrl")},getImageThumbnailUrl:function(){var e=this.media.get("thumbnailUrl");return this.constructor.isOnDisqusCDN(e)&&(e=t.serialize(e,{w:i.get("loadedThumbnailWidth"),h:this.model.get("deferredHeight")})),e},generateContentHtml:function(){return a({model:this.model.toJSON(),media:this.media.toJSON(),thumbnailUrl:this.getImageThumbnailUrl(),imageUrl:this.getImageUrl()})},prepareElementEvents:function(e){var t=this,n=e.find("img");n.on("load.richMediaView error.richMediaView",function(e){t.trigger(e.type),n.off(".richMediaView")})},calculateDeferredHeight:function(){var t=Math.floor(e.prototype.calculateDeferredHeight.apply(this,arguments)),n=this.getMediaDimensions().height;return Math.min(n,t)||null}},{isOnDisqusCDN:function(e){var n=t.getDomain(e);return s.test(n)}})}),define("core/views/IframeRichMediaView",["underscore","core/mediaConfig","core/views/RichMediaView"],function(e,t,n){return n.extend({getMediaDimensions:function(){return{width:this.media.get("htmlWidth"),height:this.media.get("htmlHeight")}},_findIframe:function(e){return e.is("iframe")?e:e.find("iframe")},configureContentFromActivated:function(){n.prototype.configureContentFromActivated.apply(this,arguments),this.model.get("activated")||this.$el.removeClass("media-loading")},createContentNode:function(){var e=n.prototype.createContentNode.apply(this,arguments);return e.attr({width:"100%",height:this.model.get("deferredHeight")}),e},insertContentNode:function(e){this.loaderNode=this.$el.find("[data-role=content-loader]"),this.loaderHeight=this.model.get("deferredHeight")||t.get("defaultIframeHeight"),this.loaderNode.height(this.loaderHeight),this.$el.addClass("media-loading"),n.prototype.insertContentNode.call(this,e)},prepareElementEvents:function(t){var n=this._findIframe(t);n.one("load",e.bind(this.finishLoad,this,n))},finishLoad:function(e){this.$el.removeClass("media-loading"),e.height(this.loaderHeight),this.trigger("load")}})}),define("core/views/FacebookPhotoRichMediaView",["core/views/ImageRichMediaView"],function(e){return e.extend({getImageThumbnailUrl:function(){return this.media.get("metadata").imageUrl||e.prototype.getImageThumbnailUrl.call(this)}})}),define("core/views/AutoplayRichMediaView",["underscore","jquery","core/utils","core/views/IframeRichMediaView"],function(e,t,n,i){return i.extend({createContentNode:function(){var e=i.prototype.createContentNode.apply(this,arguments),t=e.attr("src");return this.shouldAutoplay()&&t&&!this.model.get("playerjs")&&(t=n.serialize(t,{auto_play:!0,autoplay:1}),e.attr("src",t)),e},insertContentNode:function(n){if(this.model.get("playerjs")){var a=this._findIframe(n),s=a.attr("src");"//"===s.substr(0,2)&&(s=window.location.protocol+s);var o=s.split("/");o=o[0]+"//"+o[2],this.playerjs={ready:!1,queue:[],origin:o,$iframe:a},this.model.get("mute")&&this.send("mute"),this.shouldAutoplay()&&this.send("play");var r=e.once(e.bind(function(){this.playerjs.ready=!0;var t=this.playerjs.queue;this.playerjs.queue=[],e.each(t,this.send,this)},this));t(window).on("message",function(e){if(e=e.originalEvent,e.origin===o){var t;try{t=JSON.parse(e.data)}catch(n){return}"ready"===t.event&&t.value&&t.value.src===s&&r()}})}return i.prototype.insertContentNode.apply(this,arguments)},send:function(e){if(this.playerjs){if(!this.playerjs.ready)return void this.playerjs.queue.push(e);var t={context:"player.js",version:"0.0.10",method:e};this.playerjs.$iframe[0].contentWindow.postMessage(JSON.stringify(t),this.playerjs.origin)}}})}),define("core/views/DynamicHeightRichMediaView",["underscore","core/views/RichMediaView"],function(e,t){return t.extend({insertContentNode:function(){t.prototype.insertContentNode.apply(this,arguments),this.finishLoad()},finishLoad:function(){var t=this,n=0,i=150,a=20,s=function(){++n,a>n?e.delay(s,i):t.trigger("load")};s()}})}),define("core/templates/postMediaTwitterContent",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e){var t=this.lambda,n=this.escapeExpression;return'<meta name="twitter:widgets:csp" content="on">\n<blockquote class="twitter-tweet" data-theme="'+n(t(null!=e?e.theme:e,e))+'" data-link-color="'+n(t(null!=e?e.linkColor:e,e))+'" lang="'+n(t(null!=e?e.language:e,e))+'">\n<a href="'+n(t(null!=e?e.url:e,e))+'"></a>\n</blockquote>\n<script src="//platform.twitter.com/widgets.js"></script>\n'},useData:!0})}),define("core/views/TwitterRichMediaView",["underscore","core/views/DynamicHeightRichMediaView","core/templates/postMediaTwitterContent","core/utils"],function(e,t,n,i){var a=t.extend({generateContentHtml:function(){var t=document.documentElement.lang;t=t&&t.substring(0,2);var s=this.media.get("url");return-1!==this.media.get("resolvedUrl").indexOf("/status")&&(s=this.media.get("resolvedUrl")),n({url:s,theme:e.result(a,"theme"),linkColor:i.escapeColor(e.result(a,"linkColor")),language:t})}},{theme:"light",linkColor:"rgb(46, 159, 255)"});return a}),define("core/views/SoundCloudRichMediaView",["core/views/AutoplayRichMediaView"],function(e){return e.extend({getMediaDimensions:function(){return{width:null,height:this.media.get("htmlHeight")}}})}),define("core/views/VineRichMediaView",["core/views/AutoplayRichMediaView","core/utils"],function(e,t){return e.extend({createContentNode:function(){var n=e.prototype.createContentNode.apply(this,arguments),i=n.attr("src");return this.shouldAutoplay()&&i&&(i=t.serialize(i,{audio:1}),n.attr("src",i)),n}})}),define("core/media",["underscore","core/strings","core/mediaConfig","core/models/Media","core/models/RichMediaViewModel","core/views/RichMediaView","core/views/ImageRichMediaView","core/views/IframeRichMediaView","core/views/FacebookPhotoRichMediaView","core/views/AutoplayRichMediaView","core/views/TwitterRichMediaView","core/views/SoundCloudRichMediaView","core/views/VineRichMediaView"],function(e,t,n,i,a,s,o,r,l,c,d,u,h){var m=t.get,p={PLAY_HIDE:{kind:"html",providerExpandMessage:m("Play"),providerCollapseMessage:m("Hide")},VIEW_HIDE:{kind:"html",providerExpandMessage:m("View"),providerCollapseMessage:m("Hide")},VIEW_IMAGE:{kind:"image",providerIcon:"icon-images",providerExpandMessage:m("View"),providerCollapseMessage:m("Hide")}},f=function(t){var n=function(t,n){return e.defaults({providerIcon:n},p[t])},s=null,m=null,f=i.MEDIA_TYPES;switch(t.get("mediaType")){case f.IMAGE:case f.IMAGE_UPLOAD:s=p.VIEW_IMAGE;break;case f.FACEBOOK_PHOTO:m=l,s=p.VIEW_IMAGE;break;case f.VIMEO_VIDEO:case f.YOUTUBE_VIDEO:m=c,s=n("PLAY_HIDE","icon-video");break;case f.TWITTER_STATUS:m=d,s=n("VIEW_HIDE","icon-twitter");break;case f.VINE_VIDEO:m=h,s=n("PLAY_HIDE","icon-video");break;case f.FACEBOOK_VIDEO:s=n("VIEW_HIDE","icon-video");break;case f.SOUNDCLOUD_SOUND:m=u,s=n("PLAY_HIDE","icon-music");break;case f.GOOGLE_MAP:s=n("VIEW_HIDE","icon-map");break;default:return null}if(null===m)switch(s.kind){case"webpage":return null;case"html":m=r;break;case"image":m=o}var g=new a(s);return{Cls:m,mediaViewModel:g}},g=function(e){var t=f(e);return t?new t.Cls({model:t.mediaViewModel,media:e}):null},v=function(e){return new o({model:new a(p.VIEW_IMAGE),media:e})};return{instantiateRichMediaView:g,instantiateRichMediaThumbnail:v,getRichMediaViewConfig:f}}),define("core/mixins/withRichMedia",["underscore","jquery","core/collections/MediaCollection","core/media"],function(e,t,n,i){function a(e){var n={};return e.length?(e.find("a").each(function(e,i){var a=i.href;n[a]||(n[a]=t(i))}),n):n}function s(){e.extend(this,o)}var o={renderRichMedia:function(e,s,o){return o=o||{},e=e instanceof n?e:new n(e),e.chain().map(function(e){return i.instantiateRichMediaView(e)}).without(null).map(function(e){var n=e.media.get("url");o.normalize&&(n=o.normalize.call(this,n));var i=a(this.$("[data-role=message]")),r=i[n];return o.beforeRender&&o.beforeRender.call(this,e),e.render(),r?o.convertLinkToButton?(r.after(e.$el),e.convertToButton(r)):r.replaceWith(e.$el):(s=s||this.$("[data-role=post-media-list]"),s.append(t("<li>").append(e.$el))),e},this).value()}};return s}),define("home/templates/postContent",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return"comment-message-hidden"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="comment-message expanded ';return a=t["if"].call(e,null!=e?e.isHidden:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='"\ndata-role="message" dir="auto">\n',a=s(null!=e?e.message:e,e),null!=a&&(r+=a),r+'\n<div><ul class="post-media" data-role="post-media-list"></ul></div>\n</div>\n<a  href="#" class="curtain-truncate hidden" title="'+o(t.gettext.call(e,"see more",{name:"gettext",hash:{},data:i}))+'"\ndata-action="expand"\ndata-target=".comment-message">'+o(t.gettext.call(e,"see more",{name:"gettext",hash:{},data:i}))+"</a>\n"
},useData:!0})}),define("home/views/PostContentView",["jquery","underscore","backbone","backbone-marionette","core/bus","core/mixins/withRichMedia","home/utils/datetimeUtils","home/templates/postContent"],function(e,t,n,i,a,s,o,r){var l=i.ItemView.extend({template:r,templateHelpers:function(){return{isHidden:"visible"!==this.model.get("state")}},events:{"click a":"trackClickLink"},trackClickLink:function(e){a.trigger("uiAction:clickLink",e,{adjective:"message"})},onRender:function(){this.renderRichMedia(this.model.get("media"))}});return s.call(l.prototype),l}),define("home/mixins/withCollapsing",["underscore","jquery","home/utils/mixpanelUtils"],function(e,t,n){var i=function(e){return e.collapsibleSelector?this.$(e.collapsibleSelector):this.$el},a={events:{"click [data-action=expand]":"expand","click [data-action=collapse]":"forceCollapse"},collapse:function(n){var a=i.call(this,n),s=a.find("img").map(function(e,n){var i=t.Deferred(),a=t(n);return a.complete?i.resolve():a.one("load",i.resolve),i.promise()});t.when(s).then(e.bind(this.forceCollapse,this,null,n))},expand:function(e,t){e&&e.preventDefault();var a=i.call(this,t),s=a.find("[data-action=expand][data-target]"),o=a.find("[data-action=collapse]"),r=s.data("target"),l=a.find(r),c=this;s.addClass("hidden"),l.addClass("expanded").one("transitionend oTransitionEnd webkitTransitionEnd",function(){c.trigger("expandedComplete")}),o.removeClass("hidden"),n.track("expand comment",e)},forceCollapse:function(e,n){e&&e.preventDefault();var a=i.call(this,n),s=a.find("[data-action=expand]"),o=a.find("[data-action=collapse]"),r=e?t(e.currentTarget).data("target"):".expanded",l=a.find(r);s.length&&(l.height()>n.maxHeight&&(l.removeClass("expanded"),s.removeClass("hidden")),o.addClass("hidden"))}},s=function(t){var n=this.initialize;this.initialize=function(){n.apply(this,arguments),this.listenTo(this,"show",this.collapse)},this.collapse=function(){a.collapse.call(this,t)},this.expand=function(e){a.expand.call(this,e,t)},this.forceCollapse=function(e){a.forceCollapse.call(this,e,t)},this.events=e.defaults({},this.events,a.events)};return s}),define("home/views/CollapsingPostContentView",["home/views/PostContentView","home/mixins/withCollapsing"],function(e,t){var n=e.extend({});return t.call(n.prototype,{maxHeight:115}),n}),define("home/templates/post",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return'<span class="label label-danger">'+n(t(null!=e?e.hiddenExplanation:e,e))+"</span>\n"},3:function(){return"hidden"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r="";return a=this.invokePartial(n.userAvatar,"","userAvatar",null!=e?e.author:e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="comment-body">\n<header class="comment-header">\n',a=this.invokePartial(n.userName,"","userName",null!=e?e.author:e,void 0,t,n,i),null!=a&&(r+=a),r+='<a class="link-gray time"\nhref="'+o(s(null!=e?e.discussionRoute:e,e))+"#comment-"+o(s(null!=e?e.id:e,e))+'"\ndata-link-name="timestamp"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n\n'+o(s(null!=e?e.relativeTime:e,e))+"\n</a>\n",a=t["if"].call(e,null!=e?e.isHidden:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</header>\n<div data-role="post-content"></div>\n<footer class="comment-actions ',a=t["if"].call(e,null!=e?e.isHidden:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'" data-role="post-actions">\n</footer>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/PostView",["backbone-marionette","core/strings","home/mixins/withSubviews","home/views/PostActionsView","home/views/PostContentView","home/views/CollapsingPostContentView","home/utils/datetimeUtils","home/templates/post","home/utils/cardUtils"],function(e,t,n,i,a,s,o,r){var l=t.get,c=e.ItemView,d=c.extend({className:"card-comment",template:r,templateHelpers:function(){var e=this.model.get("state");return{isHidden:"visible"!==e,hiddenExplanation:{flagged:l("Pending"),pending:l("Pending"),spam:l("Detected as spam"),deleted:l("Removed")}[e],discussionRoute:this.model.thread.getDiscussionRoute(),relativeTime:o.getRelativeDatetime(this.model.get("createdAt"))}},initialize:function(e){e=e||{},this.hideActions=e.hideActions,this.shouldCollapse=e.shouldCollapse},regions:{postContentRegion:"[data-role=post-content]",postActionsRegion:"[data-role=post-actions]"},onRender:function(){this.activateRegion(this.postContentRegion,this.createPostContentView),this.hideActions||this.activateRegion(this.postActionsRegion,this.createPostActionsView)},createPostActionsView:function(){return new i({el:this.postActionsRegion.el,model:this.model,parentPostView:this})},createPostContentView:function(){var e=this.shouldCollapse?s:a;return new e({el:this.postContentRegion.el,model:this.model})}}),u=d.prototype;return n.call(u),d}),define("home/views/PostCollectionView",["home/views/common/FetchableCollectionView","home/views/PostView"],function(e,t){return e.extend({itemView:t})}),define("home/templates/genericCardCreate",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" no-image"},3:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<a href="'+i(n(null!=(t=null!=e?e.thread:e)?t.link:t,e))+'"\nclass="discussion-image"\ndata-link-name="image"\ndata-link-out="'+i(n(null!=(t=null!=e?e.thread:e)?t.signedLink:t,e))+'"\ndata-thread-id="'+i(n(null!=(t=null!=e?e.thread:e)?t.id:t,e))+'">\n\n<img src="'+i(n(null!=(t=null!=e?e.image:e)?t.src:t,e))+'" alt="'+i(n(null!=(t=null!=e?e.image:e)?t.title:t,e))+'">\n</a>\n'},5:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a class="card-avatar" href="/by/'+o(s(null!=e?e.username:e,e))+'/" data-link-name="user_avatar">\n<img\nsrc="'+o(s(null!=(a=null!=e?e.avatar:e)?a.cache:a,e))+'"\nalt="';return a=this.invokePartial(n.userNameNoLink,"","userNameNoLink",e,void 0,t,n,i),null!=a&&(r+=a),r+'" />\n</a>\n'},7:function(e,t,n,i){var a=this.escapeExpression;return'<div class="card-discussion-comments-title">'+a(t.gettext.call(e,"Recent Comments",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="card-discussion-comments" data-role="posts"></div>\n'},9:function(e){var t,n=this.lambda,i='<div class="card-summary">\n<div class="card-summary-content truncate" data-truncate-lines="3" dir="auto">\n';return t=n(null!=e?e.threadDescription:e,e),null!=t&&(i+=t),i+"\n</div>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="card-discussion';return a=t.unless.call(e,null!=e?e.image:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='">\n<div class="card-aside">\n',a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='</div>\n<div class="card-body">\n',a=t["with"].call(e,null!=e?e.firstActor:e,{name:"with",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='<div class="card-reason">\n'+s(t.gettext.call(e,"%(group)s authored",{name:"gettext",hash:{group:t.getPartial.call(e,"userGroupNames",{name:"getPartial",hash:{},data:i})},data:i}))+"\n</div>\n",a=this.invokePartial(n.threadTitle,"","threadTitle",e,void 0,t,n,i),null!=a&&(o+=a),a=t["if"].call(e,null!=e?e.recentPostCount:e,{name:"if",hash:{},fn:this.program(7,i),inverse:this.program(9,i),data:i}),null!=a&&(o+=a),o+'<footer class="card-footer" data-role="footer"></div>\n</div>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/GenericCardCreateView",["backbone-marionette","home/mixins/asGenericCard","home/mixins/withReason","home/mixins/withSubviews","home/views/PostCollectionView","home/templates/genericCardCreate"],function(e,t,n,i,a,s){var o=e.ItemView,r=o.extend({template:s,templateHelpers:function(){return{recentPostCount:this.model.thread.recentPosts.length}},regions:{postsRegion:"[data-role=posts]"},onRender:function(){this.activateRegion(this.postsRegion,this.createPostsView)},createPostsView:function(){return new a({el:this.postsRegion.el,collection:this.model.thread.recentPosts})}}),l=r.prototype;return t.call(l),n.call(l),i.call(l),r}),define("home/templates/genericCardFavorite",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" no-image"},3:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<a href="'+i(n(null!=(t=null!=e?e.thread:e)?t.link:t,e))+'"\nclass="discussion-image"\ndata-link-name="image"\ndata-link-out="'+i(n(null!=(t=null!=e?e.thread:e)?t.signedLink:t,e))+'"\ndata-thread-id="'+i(n(null!=(t=null!=e?e.thread:e)?t.id:t,e))+'">\n\n<img src="'+i(n(null!=(t=null!=e?e.image:e)?t.src:t,e))+'" alt="'+i(n(null!=(t=null!=e?e.image:e)?t.title:t,e))+'">\n</a>\n'},5:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a class="card-avatar" href="/by/'+o(s(null!=e?e.username:e,e))+'/" data-link-name="user_avatar">\n<img\nsrc="'+o(s(null!=(a=null!=e?e.avatar:e)?a.cache:a,e))+'"\nalt="';return a=this.invokePartial(n.userNameNoLink,"","userNameNoLink",e,void 0,t,n,i),null!=a&&(r+=a),r+'" />\n</a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="card-discussion';return a=t.unless.call(e,null!=e?e.image:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="card-aside">\n',a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</div>\n<div class="card-body">\n',a=t["with"].call(e,null!=e?e.firstActor:e,{name:"with",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<div class="card-reason">\n'+s(t.gettext.call(e,"%(group)s recommended",{name:"gettext",hash:{group:t.getPartial.call(e,"userGroupNames",{name:"getPartial",hash:{},data:i})},data:i}))+'\non\n<a class="name-community"\nhref="/home/forum/'+s(o(null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.id:a,e))+'/"\ndata-link-name="forum_name"\ndata-forum-pk="'+s(o(null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.pk:a,e))+'">\n\n',a=this.invokePartial(n.forumName,"","forumName",null!=(a=null!=e?e.thread:e)?a.forum:a,void 0,t,n,i),null!=a&&(r+=a),r+="</a>\n</div>\n",a=this.invokePartial(n.threadTitle,"","threadTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="card-summary">\n<div class="card-summary-content truncate" data-truncate-lines="3" dir="auto">\n',a=o(null!=e?e.threadDescription:e,e),null!=a&&(r+=a),r+'\n</div>\n</div>\n<footer class="card-footer" data-role="footer"></div>\n</div>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/GenericCardFavoriteView",["backbone-marionette","home/mixins/asGenericCard","home/mixins/withReason","home/templates/genericCardFavorite"],function(e,t,n,i){var a=e.ItemView.extend({template:i});return t.call(a.prototype),n.call(a.prototype),a}),define("home/templates/genericCardTrending",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" no-image"},3:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<a href="'+i(n(null!=(t=null!=e?e.thread:e)?t.link:t,e))+'"\nclass="discussion-image"\ndata-link-name="image"\ndata-link-out="'+i(n(null!=(t=null!=e?e.thread:e)?t.signedLink:t,e))+'"\ndata-thread-id="'+i(n(null!=(t=null!=e?e.thread:e)?t.id:t,e))+'">\n\n<img src="'+i(n(null!=(t=null!=e?e.image:e)?t.src:t,e))+'" alt="'+i(n(null!=(t=null!=e?e.image:e)?t.title:t,e))+'">\n</a>\n'},5:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a class="card-avatar"\nhref="/home/forum/'+o(s(null!=e?e.id:e,e))+'/"\ndata-link-name="forum_name"\ndata-forum-pk="'+o(s(null!=e?e.pk:e,e))+'">\n\n<img src="'+o(s(null!=e?e.faviconImage:e,e))+'" alt="';return a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+'" />\n</a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="card-discussion';return a=t.unless.call(e,null!=e?e.image:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="card-aside">\n',a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</div>\n<div class="card-body">\n',a=t["with"].call(e,null!=(a=null!=e?e.thread:e)?a.forum:a,{name:"with",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<div class="card-reason">\n'+s(t.gettext.call(e,"%(forum)s recently published",{name:"gettext",hash:{forum:t.getPartial.call(e,"forumLink",null!=(a=null!=e?e.thread:e)?a.forum:a,{name:"getPartial",hash:{},data:i})},data:i}))+"\n</div>\n",a=this.invokePartial(n.threadTitle,"","threadTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="card-summary">\n<div class="card-summary-content truncate" data-truncate-lines="3" dir="auto">\n',a=o(null!=e?e.threadDescription:e,e),null!=a&&(r+=a),r+'\n</div>\n</div>\n<footer class="card-footer" data-role="footer"></div>\n</div>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/GenericCardTrendingView",["backbone-marionette","home/mixins/asGenericCard","home/templates/genericCardTrending"],function(e,t,n){var i=e.ItemView.extend({template:n});return t.call(i.prototype),i}),define("home/views/GenericCardCollectionView",["jquery","underscore","backbone","home/utils/layoutUtils","home/views/common/FetchableCollectionView","home/views/GenericCardCreateView","home/views/GenericCardFavoriteView","home/views/GenericCardTrendingView"],function(e,t,n,i,a,s,o,r){var l=a.extend({itemView:function(e){switch(e.model.get("verb")){case"favorite":return new o(e);case"create":return new s(e);case"trending":return new r(e);case"share":return e.model.thread.author?(e.model.actors.length||(e.model.actors=[e.model.thread.author],e.model.set({totalActors:1})),new s(e)):new r(e);default:return new n.View}},itemViewOptions:function(){var e=a.prototype.itemViewOptions;t.isFunction(e)&&(e=e.apply(this,arguments));var n=t.defaults({channel:this.channel,hideImage:this.hideImage},e);return n},initialize:function(e){this.channel=e&&e.channel,this.hideImage=e&&e.hideImage,a.prototype.initialize.apply(this,arguments)}});return l}),define("home/views/common/ActivityCardView",["underscore","backbone-marionette"],function(e,t){var n=t.ItemView,i=n.prototype;return n.extend({constructor:function(e){i.constructor.call(this,e),this.listenTo(this.model,"change:isFromUnreadQueue",this.updateUnreadClass)},updateUnreadClass:function(){this.$el.toggleClass("unread",!!this.model.get("isFromUnreadQueue"))}})}),define("home/templates/channelCardPostActions",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" active"},3:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.likes:e,e))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="#" class="vote__item vote--up';return a=t["if"].call(e,null!=e?e.sessionUserHasUpvoted:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='"\ndata-action="vote" data-vote="1">\n<span class="vote__count text-gray" data-role="upvotes">\n',a=t["if"].call(e,null!=e?e.likes:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='\n</span>\n<span class="icon-arrow-up icon-tiny"></span>\n</a>\n\n<a href="#" class="vote__item vote--down',a=t["if"].call(e,null!=e?e.sessionUserHasDownvoted:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='"\ndata-action="vote" data-vote="-1">\n<span class="icon-arrow-down  icon-tiny"></span>\n</a>\n\n',a=this.invokePartial(n.replyOrEditLink,"","replyOrEditLink",e,void 0,t,n,i),null!=a&&(r+=a),r+'\n<span class="bullet"></span>\n<a href="'+o(s(null!=e?e.discussionRoute:e,e))+"#comment-"+o(s(null!=e?e.id:e,e))+'"\nclass="link-gray"\ndata-link-name="view_comment"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n\n<span class="visible-md">'+o(t.gettext.call(e,"View",{name:"gettext",hash:{},data:i}))+'</span>\n<span class="hidden-md">'+o(t.gettext.call(e,"View in Discussion",{name:"gettext",hash:{},data:i}))+"</span>\n</a>\n"},usePartial:!0,useData:!0})}),define("home/views/ChannelCardPostActionsView",["jquery","home/views/PostActionsView","home/templates/channelCardPostActions"],function(e,t,n){var i=t.extend({template:n,initializeReplyViewManager:e.noop,toggleReplyView:e.noop});return i}),define("home/templates/channelCardPost",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return'<span class="label label-danger">'+n(t(null!=e?e.hiddenExplanation:e,e))+"</span>\n"},3:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.excerpt:e,e))+"\n"},5:function(e){var t,n=this.lambda,i="";return t=n(null!=e?e.message:e,e),null!=t&&(i+=t),i+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="post-comments">\n<div class="post-comments__origin link-gray">\n';return a=this.invokePartial(n.forumLink,"","forumLink",null!=(a=null!=e?e.thread:e)?a.forum:a,void 0,t,n,i),null!=a&&(r+=a),r+='</div>\n<div class="post-comments__reason">\n',a=this.invokePartial(n.userAvatar,"","userAvatar",null!=e?e.author:e,void 0,t,n,i),null!=a&&(r+=a),a=this.invokePartial(n.userName,"","userName",null!=e?e.author:e,void 0,t,n,i),null!=a&&(r+=a),r+='<span class="bullet"></span>\n<a class="link-gray post-comments__time"\nhref="'+o(s(null!=e?e.discussionRoute:e,e))+"#comment-"+o(s(null!=e?e.id:e,e))+'"\ndata-link-name="timestamp"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n\n'+o(s(null!=e?e.relativeTime:e,e))+"\n</a>\n",a=t["if"].call(e,null!=e?e.isHidden:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</div>\n<div class="post-comment__content">\n<a href="'+o(s(null!=e?e.discussionRoute:e,e))+"#comment-"+o(s(null!=e?e.id:e,e))+'"\nclass="truncate link-gray-dark post-comments__lnk"\ndata-link-name="message"\ndir="auto"\ndata-truncate-lines="'+o(s(null!=e?e.numLines:e,e))+'"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">',a=t["if"].call(e,null!=e?e.excerpt:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.program(5,i),data:i}),null!=a&&(r+=a),r+"</a>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/ChannelCardPostView",["jquery","underscore","backbone-marionette","core/strings","core/utils/html","home/views/ChannelCardPostActionsView","home/mixins/withTruncate","home/mixins/withSubviews","home/utils/datetimeUtils","home/templates/channelCardPost"],function(e,t,n,i,a,s,o,r,l,c){var d=i.get,u=n.ItemView,h=t.template('<span class="text-smaller icon-<%= type %>"></span>'),m=u.extend({className:"post-comments__wrapper",template:c,regions:{postActionsRegion:"[data-role=post-actions]"},templateHelpers:function(){var t=this.model.get("state");return{isHidden:"visible"!==t,hiddenExplanation:{flagged:d("Pending"),pending:d("Pending"),spam:d("Detected as spam"),deleted:d("Removed")}[t],message:this.replaceLinks(this.model.get("message")),discussionRoute:this.model.thread.getDiscussionRoute(),relativeTime:l.getRelativeDatetime(this.model.get("createdAt")),numLines:e(window).width()<=875?4:2}},replaceLinks:function(e){var n=t.pluck(this.model.get("media"),"url"),i=function(e){return h({type:t.contains(n,e.href)?"images":"link"})};return a.replaceAnchors(e,i)},onRender:function(){this.activateRegion(this.postActionsRegion,this.createPostActionsView)},createPostActionsView:function(){return new s({model:this.model})}});return o.call(m.prototype),r.call(m.prototype),m}),define("home/templates/channelCardFooter",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.escapeExpression,o='<li class="button__wrapper--recommend -count';return a=t["if"].call(e,t.gt.call(e,null!=e?e.likes:e,9,{name:"gt",hash:{},data:i}),{name:"if",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(o+=a),a=t["if"].call(e,null!=e?e.favorited:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='" data-action="favorite">\n<a class="button--recommend -small" href="#">\n<span class="button__heart icon-heart"></span>\n<span class="button__text hidden-md">'+s(t.gettext.call(e,"Recommend",{name:"gettext",hash:{},data:i}))+"</span>\n",a=t["if"].call(e,null!=e?e.likes:e,{name:"if",hash:{},fn:this.program(6,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+"</a>\n</li>\n"},2:function(){return" -wide"},4:function(){return" is-recommended"},6:function(e){var t=this.lambda,n=this.escapeExpression;return'<span class="button__count">'+n(t(null!=e?e.likes:e,e))+"</span>\n"},8:function(){return'<span class="icon icon-lock spacing-right-small"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<ul class="list--layout">\n';return a=t["if"].call(e,null!=e?e.authenticated:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<li>\n<a class="button button-lnk spacing-right-small"\nhref="'+o(s(null!=e?e.discussionRoute:e,e))+'"\ndata-link-name="view_discussion"\ndata-thread-id="'+o(s(null!=e?e.id:e,e))+'">\n',a=t["if"].call(e,null!=e?e.isClosed:e,{name:"if",hash:{},fn:this.program(8,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+o(t.gettext.call(e,"Comments %(count)s",{name:"gettext",hash:{count:t.tag.call(e,"span",{name:"tag",hash:{text:null!=e?e.posts:e,"class":"label--count"},data:i})},data:i}))+'\n</a>\n</li>\n<li class="dropdown" data-dropdown="enabled">\n<a class="button button-link dropdown-toggle" data-toggle="dropdown" href="#">\n'+o(t.gettext.call(e,"Share",{name:"gettext",hash:{},data:i}))+'\n</a>\n<ul class="dropdown-menu dropdown--share-menu">\n<li>\n<a class="link" data-action="share" data-network="twitter" href="#">\n<span class="icon icon-twitter text-smaller icon__position -inline"></span>\n<strong>'+o(t.gettext.call(e,"Tweet this",{name:"gettext",hash:{},data:i}))+'</strong>\n</a>\n</li>\n<li>\n<a class="link" data-action="share" data-network="facebook" href="#">\n<span class="icon icon-facebook text-smaller icon__position -inline"></span>\n<strong>'+o(t.gettext.call(e,"Post to Facebook",{name:"gettext",hash:{},data:i}))+"</strong>\n</a>\n</li>\n</ul>\n</li>\n</ul>\n"},useData:!0})}),define("home/views/ChannelCardFooterView",["home/views/ThreadCardDefaultFooterView","home/templates/channelCardFooter"],function(e,t){var n=e,i=n.prototype,a=n.extend({template:t,toggleThreadFavorited:function(e){i.toggleThreadFavorited.call(this,e),this.$("[data-action=favorite]").addClass("animate-recommend")}});return a}),define("home/views/TopicTagView",["backbone-marionette","handlebars"],function(e,t){var n=e.ItemView.extend({template:t.partials.topicTag,className:function(){return"tag__item"+(this.model.get("hidden")?" hidden-topic":"")},events:{"click [data-action=remove-tag]":"removeTag"},initialize:function(e){this.topicRoute=e&&e.baseTopicRoute?e.baseTopicRoute+this.model.id+"/":null},templateHelpers:function(){return{topicRoute:this.topicRoute}},removeTag:function(e){e&&e.preventDefault(),this.trigger("removeTag")}});return n}),define("home/views/TopicTagCollectionView",["backbone-marionette","home/views/TopicTagView"],function(e,t){var n=e.CollectionView.extend({className:"topic-group__wrapper",itemView:t,itemViewOptions:function(){return{baseTopicRoute:this.baseTopicRoute}},initialize:function(e){e=e||{},this.baseTopicRoute=e.baseTopicRoute,!this.baseTopicRoute&&e.channel&&(this.baseTopicRoute="/home/channel/"+e.channel.id+"/topics/")}});return n}),define("home/mixins/asChannelCard",["jquery","underscore","backbone-marionette","handlebars","core/utils/releaseUtils","home/utils/datetimeUtils","home/models/Session","home/views/ChannelCardPostView","home/views/ChannelCardFooterView","home/views/TopicTagCollectionView","home/mixins/withTruncate","home/mixins/withSubviews"],function(e,t,n,i,a,s,o,r,l,c,d,u){var h={regions:{postsRegion:"[data-role=posts]",footerRegion:"[data-role=footer]",topicsRegion:"[data-role=topics]"},events:{"click [data-action=menuitem-click]":"handleMenuItemClick"},className:function(e){return t.contains(this.options.filterVerbs,this.model.get("verb"))?"hidden":(t.isFunction(e)&&(e=e.apply(this,t.rest(arguments))),e=e||"",["card-wrap card--channel",e].join(" "))},initialize:function(e,t){t=t||{},e.call(this,t),this.session=o.get(),this.channel=t.channel,this.hideImage=t.hideImage,this.listenTo(this.model.thread,"change:content",this.render),this.numTitleLines=t.numTitleLines||3,this.showTopics=this.model.thread.topics.length&&this.channel,this.isChannelFeed=t.isChannelFeed,this.listenTo(this.model.thread,"change:userSubscription",this.renderMenu),this.listenTo(this.model.thread,"change:isDeleted",this.renderMenu)},serializeData:function(e){var n=e.call(this),i=this.model.thread,s=this.model.getPostsPreviewCollection(),o=i.getFriendlySourceUrl()||i.forum.getFriendlyUrl(),r=this.channel||i.forum.channel,l=r&&a.isDisqusAdmin(this.session.user),c=i.forum.channel&&i.canEdit(this.session),d=c&&(l||t.contains(this.session.moderatedForums,i.forum.id));return t.defaults(n,{recentPostCount:s.length,discussionRoute:i.getDiscussionRoute(this.channel),threadDescription:i.getPlainDescription(),image:i.getImage(),numTitleLines:this.numTitleLines,threadOverrides:this.model.getThreadOverrides(),forumFriendlyUrl:o,canEdit:c,canCurate:l,curationRoute:l?"/home/curate/channel/"+r.id+"/":"",canDelete:d,channel:r,threadCreated:i.getRelativeCreatedAt(),isChannelFeed:this.isChannelFeed})},render:function(e){return e.call(this),this.$(this.postsRegion.selector).length&&this.activateRegion(this.postsRegion,h.createPostsView),this.showTopics&&this.activateRegion(this.topicsRegion,h.createTopicsView),this.activateRegion(this.footerRegion,h.createFooter),this},renderMenu:function(){var e=this.serializeData();e=this.mixinTemplateHelpers(e),e.menuOpen=this.$(".dropdown").hasClass("open"),this.$("[data-role=menu]").replaceWith(i.partials.channelCardMenu(e))},createPostsView:function(){var e=this.model.getPostsPreviewCollection();return new n.CollectionView({itemView:r,collection:e})},createTopicsView:function(){var e=this.model.thread.topics;return new c({collection:e,channel:this.channel})},_createFooter:function(e){return new l({el:e,model:this.model.thread,channel:this.channel})},createFooter:function(){return h._createFooter.call(this,this.footerRegion.el)},handleMenuItemClick:function(t){if(t){t.preventDefault(),t.stopPropagation();var n=e(t.currentTarget).attr("data-menu-item");switch(n){case"toggle-subscription":this.toggleSubscription();break;case"toggle-follow-targetchannel":this.toggleFollowTargetChannel();break;case"delete-thread":this.model.thread.confirmDelete(!0);break;case"restore-thread":this.model.thread.restore()}}},toggleSubscription:function(){this.model.thread.toggleSubscription()},toggleFollowTargetChannel:function(){var e=this.model.activities[0].targetChannel;e&&e.toggleFollowed()},getRelativeCreatedAt:function(){return s.getRelativeDatetime(this.model.thread.get("createdAt"))}};return function(){d.apply(this,arguments),u.call(this),this.regions=t.extend({},h.regions,this.regions),this.events=t.extend({},h.events,this.events),this.className=t.wrap(this.className,h.className),this.initialize=t.wrap(this.initialize,h.initialize),this.serializeData=t.wrap(this.serializeData,h.serializeData),this.render=t.wrap(this.render,h.render),t.extend(this,t.pick(h,"handleMenuItemClick","toggleSubscription","toggleFollowTargetChannel","renderMenu"))}}),define("home/mixins/withChannelAvatar",["underscore"],function(e){function t(e){return{templateHelpers:function(){var t=e.call(this),n=t&&t.get("bannerColor"),i=t&&t.get("name")&&t.get("name").charAt(0);return{channel:t&&t.toJSON(),channelAvatar:t&&(t.get("avatar")||t.get("options").favicon),bannerColorClass:n?"-"+n:"",channelInitial:i}}}}function n(n){var i=n||function(){return this.model},a=t(i);this.templateHelpers=e.wrap(this.templateHelpers,function(t){var n=e.isFunction(t)?t.call(this):t;return e.extend(a.templateHelpers.call(this),n)})}return n}),define("home/views/ChannelCardView",["home/views/common/ActivityCardView","home/mixins/asChannelCard","home/mixins/withChannelAvatar","home/mixins/withReason"],function(e,t,n,i){var a=e.extend({getChannel:function(){return this.channel||this.model.thread.forum.channel}});return t.call(a.prototype),i.call(a.prototype),n.call(a.prototype,a.prototype.getChannel),a}),define("home/templates/channelCardFavorite",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="card__header -feed is-recommended">\n<div class="card__reason link-gray-dark">\n<span class="icon-heart icon__position -inline text-smaller text-gray-light"></span>\n'+s(t.gettext.call(e,"%(group)s recommended",{name:"gettext",hash:{group:t.getPartial.call(e,"userGroupNames",{name:"getPartial",hash:{},data:i})},data:i}))+'\n\n<time class="bullet text-gray">'+s(o(null!=e?e.relativeTime:e,e))+"</time>\n</div>\n";return a=this.invokePartial(n.cardReasonForum,"","cardReasonForum",e,void 0,t,n,i),null!=a&&(r+=a),a=this.invokePartial(n.channelCardMenu,"","channelCardMenu",e,void 0,t,n,i),null!=a&&(r+=a),r+="</div>\n",a=this.invokePartial(n.channelCardContent,"","channelCardContent",e,void 0,t,n,i),null!=a&&(r+=a),r},usePartial:!0,useData:!0})}),define("home/views/ChannelCardFavoriteView",["underscore","home/views/ChannelCardView","home/templates/channelCardFavorite"],function(e,t,n){var i=t.extend({template:n,templateHelpers:function(){var n=t.prototype.templateHelpers.apply(this,arguments);return e.extend(n,{forumHref:"/home/forum/"+this.model.thread.forum.id+"/"})}});return i}),define("home/templates/channelCardCreate",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a class="spacing-right align__item" href="/by/'+o(s(null!=e?e.username:e,e))+'/" data-link-name="user_avatar">\n<img\nclass="img-round-sm img-block"\nsrc="'+o(s(null!=(a=null!=e?e.avatar:e)?a.cache:a,e))+'"\nalt="';return a=this.invokePartial(n.userNameNoLink,"","userNameNoLink",e,void 0,t,n,i),null!=a&&(r+=a),r+'" />\n</a>\n'},3:function(e){var t=this.lambda,n=this.escapeExpression;return'<time class="bullet text-gray">'+n(t(null!=e?e.relativeTime:e,e))+"</time>\n"},5:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.cardReasonForum,"","cardReasonForum",e,void 0,t,n,i),null!=a&&(s+=a),s},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="card__header -feed">\n<div class="card__reason align align--middle">\n';return a=t["with"].call(e,null!=e?e.firstActor:e,{name:"with",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='<div class="align__item">\n'+s(t.gettext.call(e,"%(user)s started a discussion",{name:"gettext",hash:{user:t.getPartial.call(e,"userGroupNames",{name:"getPartial",hash:{},data:i})},data:i}))+"\n",a=t["if"].call(e,null!=e?e.isChannelFeed:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+="</div>\n</div>\n",a=t.unless.call(e,null!=e?e.isChannelFeed:e,{name:"unless",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+="\n",a=this.invokePartial(n.channelCardMenu,"","channelCardMenu",e,void 0,t,n,i),null!=a&&(o+=a),o+="</div>\n",a=this.invokePartial(n.channelCardContent,"","channelCardContent",e,void 0,t,n,i),null!=a&&(o+=a),o
},usePartial:!0,useData:!0})}),define("home/views/ChannelCardCreateView",["home/views/ChannelCardView","home/templates/channelCardCreate"],function(e,t){var n=e.extend({template:t});return n}),define("home/templates/channelCardTrending",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" is-recommended"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="card__header -feed';return a=t["if"].call(e,null!=e?e.isBestOfDisqus:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+='">\n',a=this.invokePartial(n.cardReasonDisqusPicks,"","cardReasonDisqusPicks",e,void 0,t,n,i),null!=a&&(s+=a),a=this.invokePartial(n.cardReasonForum,"","cardReasonForum",e,void 0,t,n,i),null!=a&&(s+=a),a=this.invokePartial(n.channelCardMenu,"","channelCardMenu",e,void 0,t,n,i),null!=a&&(s+=a),s+="</div>\n",a=this.invokePartial(n.channelCardContent,"","channelCardContent",e,void 0,t,n,i),null!=a&&(s+=a),s},usePartial:!0,useData:!0})}),define("home/views/ChannelCardTrendingView",["home/views/ChannelCardView","home/templates/channelCardTrending"],function(e,t){var n=e.extend({template:t});return n}),define("home/templates/channelCardShare",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" is-recommended"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="card__header -feed';return a=t["if"].call(e,null!=e?e.isBestOfDisqus:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+='">\n',a=this.invokePartial(n.cardReasonDisqusPicks,"","cardReasonDisqusPicks",e,void 0,t,n,i),null!=a&&(s+=a),a=this.invokePartial(n.cardReasonForum,"","cardReasonForum",e,void 0,t,n,i),null!=a&&(s+=a),a=this.invokePartial(n.channelCardMenu,"","channelCardMenu",e,void 0,t,n,i),null!=a&&(s+=a),s+="</div>\n",a=this.invokePartial(n.channelCardContent,"","channelCardContent",e,void 0,t,n,i),null!=a&&(s+=a),s},usePartial:!0,useData:!0})}),define("home/views/ChannelCardShareView",["underscore","core/config","home/views/ChannelCardView","home/templates/channelCardShare"],function(e,t,n,i){var a=n.extend({template:i,templateHelpers:function(){var i=n.prototype.templateHelpers.apply(this,arguments);return e.extend(i,{guestAvatar:t.urls.avatar.generic})}});return a}),define("home/templates/channelFeedEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda;return'<div class="empty-message card-wrap">\n<img class="empty-message__img" src="'+s(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/empty-states/discussions.png"/>\n<div class="empty-message__content">\n<h2 class="text-larger">'+s(t.gettext.call(e,"This channel doesn't have any discussions yet.",{name:"gettext",hash:{},data:i}))+'</h2>\n<p class="text-gray text-medium">'+s(t.gettext.call(e,"Discussions started by people in this channel will appear here.",{name:"gettext",hash:{},data:i}))+'</p>\n<a href="/home/discuss/'+s(o(null!=(a=null!=e?e.primaryForum:e)?a.id:a,e))+'/" class="button button-outline button-semi-wide text-large">\n'+s(t.gettext.call(e,"Start the first discussion",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n</div>\n"},useData:!0})}),define("home/templates/channelOwnerFeedEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda;return'<div class="card-wrap">\n<div class="card__header">\n<div class="card__reason -large">\n<h1 class="text-gray-darker">\n<span class="icon-checkmark icon__position spacing-right-small text-success"></span>\n'+s(t.gettext.call(e,"Your channel's been created!  Let's kick it off.",{name:"gettext",hash:{},data:i}))+'\n</h1>\n</div>\n</div>\n<div class="card__content -empty">\n<div class="card-content__body">\n<ol class="list--numbered spacing-narrow text-gray-darker">\n<li>\n<h2 class="text-large spacing-bottom-small">\n'+s(t.gettext.call(e,"Check out the %(exampleChannel)s and read the %(modPlaybook)s.",{name:"gettext",hash:{modPlaybook:t.tag.call(e,"a",{name:"tag",hash:{text:"Mod Playbook",href:"https://media.disquscdn.com/channel-docs/Mod_Playbook.pdf"},data:i}),exampleChannel:t.tag.call(e,"a",{name:"tag",hash:{text:"example channel",href:"https://disqus.com/home/channel/testchannel/"},data:i})},data:i}))+'\n</h2>\n<p class="text-gray">\n'+s(t.gettext.call(e,"These will explain how to set up your channel for success.",{name:"gettext",hash:{},data:i}))+'</p>\n</li>\n<li>\n<h2 class="text-large spacing-bottom-small">\n'+s(t.gettext.call(e,"Start your first, introductory discussion. Here's an %(exampleDiscussion)s.",{name:"gettext",hash:{exampleDiscussion:t.tag.call(e,"a",{name:"tag",hash:{text:"example discussion",href:"https://disqus.com/home/channel/selectstart/discussion/channel-selectstart/welcome/"},data:i})},data:i}))+'\n</h2>\n<p class="text-gray spacing-bottom-narrow">\n'+s(t.gettext.call(e,"Introduce your future audience to what your channel is about. This notice will disappear once you do.",{name:"gettext",hash:{},data:i}))+'</p>\n<p>\n<a class="button button-outline" href="/home/discuss/'+s(o(null!=(a=null!=e?e.primaryForum:e)?a.id:a,e))+'/">\n'+s(t.gettext.call(e,"Start a discussion",{name:"gettext",hash:{},data:i}))+'\n</a>\n</p>\n</li>\n<li>\n<h2 class="text-large spacing-bottom-small">\n'+s(t.gettext.call(e,"Need help? Visit %(channelChat)s for tips on getting started.",{name:"gettext",hash:{channelChat:t.tag.call(e,"a",{name:"tag",hash:{text:"Channel Chat",href:"https://disqus.com/home/channel/channelchat/"},data:i})},data:i}))+'\n</h2>\n<p class="text-gray">\n'+s(t.gettext.call(e,"We want your channel to thrive just as much as you do.",{name:"gettext",hash:{},data:i}))+"\n</p>\n</li>\n</ol>\n</div>\n</div>\n</div>\n"},useData:!0})}),define("home/views/ChannelFeedEmptyView",["backbone-marionette","home/models/Session","home/templates/channelFeedEmpty","home/templates/channelOwnerFeedEmpty"],function(e,t,n,i){var a=e.ItemView.extend({getTemplate:function(){return this.model.get("owner_id")===this.session.user.get("id")?i:n},initialize:function(){this.session=t.get()}});return a}),define("home/mixins/withViewFeedTracking",["underscore","core/bus"],function(e,t){var n=function(){var n=this.initialize;this.initialize=function(){n.apply(this,arguments),this.listenTo(this,"renderInitialContent",this.trackView)},this.trackView=function(){t.trigger("viewFeed",this),e.defer(e.bind(function(){this.listenTo(this.collection,"sync",this.trackViewMore)},this))},this.trackViewMore=function(){t.trigger("viewMoreFeed",this.getNumPages())},this.getNumPages=function(){return this.model&&this.model.get("numPages")}};return n}),define("home/views/ChannelCardCollectionView",["underscore","backbone","core/bus","home/views/GenericCardCollectionView","home/views/ChannelCardFavoriteView","home/views/ChannelCardCreateView","home/views/ChannelCardTrendingView","home/views/ChannelCardShareView","home/views/ChannelFeedEmptyView","home/mixins/withViewFeedTracking"],function(e,t,n,i,a,s,o,r,l,c){var d=i.extend({itemView:function(e){switch(e.model.get("verb")){case"favorite":return new a(e);case"create":return new s(e);case"trending":return new o(e);case"share":return new r(e);default:return new t.View}},itemViewOptions:function(e,t){var n=i.prototype.itemViewOptions.call(this,e,t);return n.enableBestOfDisqusCallout=this.enableBestOfDisqusCallout,n.filterVerbs=this.filterVerbs,n.isChannelFeed=this.isChannelFeed,n},emptyView:l,emptyViewOptions:function(){return{model:this.channel}},initialize:function(e){i.prototype.initialize.call(this,e),e=e||{},this.enableBestOfDisqusCallout=e.enableBestOfDisqusCallout,this.filterVerbs=e.filterVerbs,this.isChannelFeed=e.isChannelFeed,this.listenToOnce(this,"showFirstItem",function(){n.trigger("showFirstCard","channel")})}});return c.call(d.prototype),d}),define("core/templates/channelPromotionDiscussion",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return'data-mix-location="recent discussion"'},3:function(){return'target="_blank"'},5:function(e){var t=this.lambda,n=this.escapeExpression;return'<div class="channel-item__description">\n<p class="truncate" data-truncate-lines="2">'+n(t(null!=e?e.threadDescription:e,e))+"</p>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="'+o(s(null!=e?e.discussionRoute:e,e))+'" class="channel-item__link"\n';return a=t["if"].call(e,null!=e?e.inHome:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+='>\n<div class="channel-item__heading">\n<h2 class="truncate" data-truncate-lines="2">'+o(s(null!=(a=null!=e?e.thread:e)?a.clean_title:a,e))+"</h2>\n</div>\n",a=t["if"].call(e,null!=e?e.inHome:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'<div class="channel-item__footer">\n<span class="channel-item__count">'+o(s(null!=(a=null!=e?e.thread:e)?a.posts:a,e))+'</span>\n<span class="channel-item__comment">'+o(t.gettext.call(e,"Comments",{name:"gettext",hash:{},data:i}))+"</span>\n</div>\n</a>\n"},useData:!0})}),define("core/views/common/mixins/asChannelPromotionDiscussionView",["underscore","core/templates/channelPromotionDiscussion"],function(e,t){var n={template:t,templateHelpers:function(){var e=this.model.thread||this.model;return{discussionRoute:e.getDiscussionRoute()}}};return function(){this.template||(this.template=n.template),this.templateHelpers=e.wrap(this.templateHelpers,function(t){return e.isFunction(t)&&(t=t.call(this)),e.extend(n.templateHelpers.call(this),t)})}}),define("home/views/DiscoverChannelDiscussionView",["backbone-marionette","core/views/common/mixins/asChannelPromotionDiscussionView","home/mixins/withTruncate"],function(e,t,n){var i=e.ItemView.extend({templateHelpers:function(){return{threadDescription:this.model.thread.getPlainDescription(),inHome:!0}}});return t.call(i.prototype),n.call(i.prototype),i}),define("core/mixins/withChannelFollowing",["underscore"],function(e){function t(e){return{events:{"click [data-action=toggle-follow]":"toggleFollow"},initialize:function(){this.bindToPrimaryForum()},templateHelpers:function(){return{isFollowing:this.getIsFollowing()}},bindToPrimaryForum:function(){var t=e.call(this);return t.primaryForum?void this.listenTo(t.primaryForum,"change:isFollowing",this.updateFollowedState):void this.listenToOnce(t,"changeRelated:primaryForum",this.bindToPrimaryForum)},updateFollowedState:function(){this.$("[data-action=toggle-follow]").toggleClass("active",this.getIsFollowing())},getIsFollowing:function(){var t=e.call(this);return t.primaryForum&&t.primaryForum.get("isFollowing")},toggleFollow:function(t){t&&t.preventDefault();var n=e.call(this);n.primaryForum&&(n.primaryForum.toggleFollowed(),this.trigger("toggled:follow",t))}}}function n(n){var i=n||function(){return this.model},a=t(i);this.initialize=e.wrap(this.initialize,function(e,t){e.call(this,t),a.initialize.call(this,t)}),this.templateHelpers=e.wrap(this.templateHelpers,function(t){var n=e.isFunction(t)?t.call(this):t;return e.extend(a.templateHelpers.call(this),n)}),this.events=e.extend({},a.events,this.events),e.extend(this,e.pick(a,"bindToPrimaryForum","updateFollowedState","getIsFollowing","toggleFollow"))}return n}),define("core/templates/channelPromotion",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return'data-mix-location="tile"'},3:function(){return'target="_blank"'},5:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<img src="'+i(n(null!=(t=null!=(t=null!=e?e.channel:e)?t.options:t)?t.tile:t,e))+'" class="tile__media" />\n'},7:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<div class="tile__overlay">\n<h1 class="tile__name">'+i(n(null!=(t=null!=e?e.channel:e)?t.name:t,e))+'</h1>\n</div>\n<img src="https://media.disquscdn.com/home/blank_tile.png"\nclass="tile__media" />\n'},9:function(){return'data-mix-location="follow button"'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="channels-module__inner" data-mix-location="channel promotion item">\n<a href="/home/channel/'+o(s(null!=(a=null!=e?e.channel:e)?a.slug:a,e))+'/" class="tile__wrapper"\n';return a=t["if"].call(e,null!=e?e.inHome:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+=">\n",a=t["if"].call(e,null!=(a=null!=(a=null!=e?e.channel:e)?a.options:a)?a.tile:a,{name:"if",hash:{},fn:this.program(5,i),inverse:this.program(7,i),data:i}),null!=a&&(r+=a),r+='</a>\n<div class="channels-subheading">\n<div class="channels-subheading__description">\n<p>'+o(s(null!=(a=null!=(a=null!=e?e.channel:e)?a.options:a)?a.description:a,e))+'</p>\n</div>\n<div class="channels-subheading__action"\n',a=t["if"].call(e,null!=e?e.inHome:e,{name:"if",hash:{},fn:this.program(9,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='>\n<div class="channels-subheading__button">',a=this.invokePartial(n.genericFollowButton,"","genericFollowButton",e,void 0,t,n,i),null!=a&&(r+=a),r+'</div>\n</div>\n</div>\n<div class="channels-module__body">\n<h4 class="text-subheading">'+o(t.gettext.call(e,"Recommended Discussions",{name:"gettext",hash:{},data:i}))+'</h4>\n<section data-role="discussions" class="channels-module__discussions"></section>\n</div>\n</div>\n'},usePartial:!0,useData:!0})}),define("core/views/common/mixins/asChannelPromotionView",["underscore","core/mixins/withChannelFollowing","core/templates/channelPromotion"],function(e,t,n){var i={className:"channels-module__block",template:n,regions:{discussionsRegion:"[data-role=discussions]"}};return function(n,a){t=a||t,t.call(this,n),this.className=[i.className,this.className].join(" "),this.template||(this.template=i.template),this.regions=e.extend({},i.regions,this.regions)}}),define("home/mixins/withChannelFollowing",["underscore","core/mixins/withChannelFollowing","home/utils/mixpanelUtils"],function(e,t,n){function i(e){return{initialize:function(){this.listenTo(this,"toggled:follow",this.onToggleFollow)},onToggleFollow:function(t){var i=e.call(this);n.track("follow channel",t,{properties:{follow:!this.getIsFollowing(),channel:i.id}})}}}function a(n){t.call(this,n);var a=n||function(){return this.model},s=i(a);this.initialize=e.wrap(this.initialize,function(e,t){e.call(this,t),s.initialize.call(this,t)}),e.extend(this,e.pick(s,"onToggleFollow"))}return a}),define("home/mixins/asChannelPromotionView",["core/views/common/mixins/asChannelPromotionView","home/mixins/withChannelFollowing"],function(e,t){return function(n){e.call(this,n,t)}}),define("home/views/DiscoverChannelView",["backbone-marionette","home/views/DiscoverChannelDiscussionView","home/views/FetchingView","home/mixins/withSubviews","home/mixins/asChannelPromotionView"],function(e,t,n,i,a){var s=e.ItemView.extend({templateHelpers:function(){return{inHome:!0}},onRender:function(){this.activateRegion(this.discussionsRegion,this.createDiscussionsRegion)},createDiscussionsRegion:function(){return new e.CollectionView({itemView:t,itemViewOptions:function(e,t){return{className:t>1?"hidden":"channels-module__article"}},collection:this.model.topActivities.items,emptyView:function(){return new n({className:"spinner-small"})}})}}),o=s.prototype;return a.call(o,function(){return this.model.channel}),i.call(o),s}),define("home/views/PromotedChannelsCardView",["backbone-marionette","home/views/DiscoverChannelView","home/utils/mixpanelUtils"],function(e,t,n){var i=e.CollectionView.extend({className:"card--interstitial",itemView:t,attributes:{"data-mix-location":"interstitial channel card"},events:{"click a,button":"trackChannelsLink"},trackChannelsLink:function(e){n.track("click channels module",e)}});return i}),define("home/mixins/withInterstitialChannelCards",["jquery","underscore","backbone","core/UniqueModel","home/models/ChannelProfileFeed","home/models/Session","home/views/PromotedChannelsCardView"],function(e,t,n,i,a,s,o){var r=10,l=2,c={initialize:function(n,i){n.call(this,i),this.lastIntersitialCardIndex=-1;var a=t.bind(this.initializeChannelProfiles,this),o=s.get();o.loadPromise().always(function(){var t=o.getUserProfile(),n=t&&t.forumsFollowing.ensureFetched();e.when(n).then(a)})},initializeChannelProfiles:function(){var e=new i(a,{listName:a.LIST_NAMES.promoted});e.ensureFetched().then(t.bind(function(){this.interstitialChannelProfiles=e.items.chain().reject(function(e){return e.channel.primaryForum.get("isFollowing")}).shuffle().value()},this))},getAdjustedIndex:function(e){var n=0,i=0;return t.each(this.children._views,function(t){i>e||(t instanceof o?n+=1:i+=1)}),e+n},addItemView:function(e,t,n,i){var a=this.getAdjustedIndex(i),s=e.call(this,t,n,a);return a+=1,this.interstitialChannelProfiles&&a-this.lastIntersitialCardIndex>r&&(this.insertChannelCard(a),this.lastIntersitialCardIndex=a),s},insertChannelCard:function(e){var t=new n.Collection(this.interstitialChannelProfiles.splice(0,l));if(!(l>t.length)){t.invoke("ensureFetchedTopActivities");var i=new o({collection:t});this.children.add(i),this.renderItemView(i,e)}}};return function(){this.initialize=t.wrap(this.initialize,c.initialize),this.addItemView=t.wrap(this.addItemView,c.addItemView),t.extend(this,t.pick(c,["insertChannelCard","initializeChannelProfiles","getAdjustedIndex"]))}}),define("home/views/ChannelCardCollectionViewWithChannelPromotion",["core/switches","home/views/ChannelCardCollectionView","home/mixins/withInterstitialChannelCards"],function(e,t,n){var i=t.extend({});return n.call(i.prototype),i}),define("home/templates/spinner",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div class="spinner"></div>\n'},useData:!0})}),define("home/templates/moreButton",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<button class="button button-fill -small button-wide -shorter" data-action="more-feed">\n'+a(t.gettext.call(e,"More",{name:"gettext",hash:{},data:i}))+"\n</button>\n"},useData:!0})}),define("home/templates/endOfItems",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="feed-end" data-role="end-message">\n'+a(t.gettext.call(e,"That's the end. ",{name:"gettext",hash:{},data:i}))+' <a href="/home/channels/explore/">'+a(t.gettext.call(e,"Find more interesting discussions »",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n"},useData:!0})}),define("home/templates/loadError",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="empty-message">\n<img src="'+a(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/Pam_Error.png" class="img-responsive" />\n<h2>'+a(t.gettext.call(e,"Darn it!",{name:"gettext",hash:{},data:i}))+'</h2>\n<div class="text-small">\n'+a(t.gettext.call(e,"Something went wrong while trying to load this feed. Try again in a little while.",{name:"gettext",hash:{},data:i}))+'\n</div>\n<div class="text-small">\n'+a(t.gettext.call(e,"Please visit %(discussDisqus)s to learn more.",{name:"gettext",hash:{discussDisqus:t.tag.call(e,"a",{name:"tag",hash:{text:"Discuss Disqus",href:"//disqus.com/home/discussion/channel-discussdisqus/issues_loading_your_feed_send_us_more_details/"},data:i})},data:i}))+"\n</div>\n</div>\n"},useData:!0})}),define("home/views/common/FetchableCollectionFooterView",["underscore","backbone-marionette","home/templates/spinner","home/templates/moreButton","home/templates/endOfItems","home/templates/loadError"],function(e,t,n,i,a,s){var o=t.ItemView.extend({endOfItemsTemplate:a,errorTemplate:s,template:function(e){return e.error?this.errorTemplate(e):this.collection.length?e.fetching?n(e):e.hasNext?i(e):this.endOfItemsTemplate(e):""},className:"more-wrapper",events:{"click [data-action=more-feed]":"moreClicked"},modelEvents:{"change:fetching":"render"},initialize:function(){this.template=e.bind(this.template,this)},moreClicked:function(e){e.preventDefault(),this.model.fetchItems()}});return o}),define("home/templates/channelFeedEndOfItems",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="feed-end" data-role="end-message">\n<a href="#content-area">'+a(t.gettext.call(e,"Back to Top",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n"},useData:!0})}),define("home/views/ChannelFeedFooterView",["home/views/common/FetchableCollectionFooterView","home/templates/channelFeedEndOfItems"],function(e,t){var n=e.extend({endOfItemsTemplate:t});return n}),define("home/mixins/asCollapsibleCard",["underscore"],function(e){var t=function(){this.events=e.extend({"click [data-action=toggle-collapsed]":"toggleCollapsed"},this.events),this.toggleCollapsed=function(e){e&&e.preventDefault(),this.$(".card-collapsed, .card-expanded").addBack(".card-collapsed, .card-expanded").toggleClass("card-collapsed card-expanded")}};return t}),define("home/mixins/withReasonOld",["underscore","home/views/ActivityActorsHoverCard","core/utils"],function(e,t,n){var i=function(){if(!n.isMobileUserAgent()){var e=this.$("[data-role=actors]");e.length&&(this.hoverCard&&this.hoverCard.remove(),this.hoverCard=t.create({targetElement:e,activityFeedItem:this.model,activityId:this.model.id,numShownActors:a.call(this).length}))}},a=function(){return this.model.actors?this.model.get("totalActors")<4?this.model.toJSON().actors:this.model.toJSON().actors.slice(0,2):[]},s=function(){if(!this.model.actors||1!==this.model.actors.length)return 0;var e=this.model.get("totalActivities");return e>1?e:0},o=function(){this.initialize=e.wrap(this.initialize,function(t){t.apply(this,e.rest(arguments)),this.listenTo(this,"render",i)});var t=this.templateHelpers;this.templateHelpers=function(){var n=a.call(this);return e.extend({relativeTime:this.model.getRelativeTimestamp(),shownActors:n,numRemainingActors:this.model.get("totalActors")-n.length,numOccurences:s.call(this)},t?t.apply(this,arguments):{})}};return o}),define("home/views/common/ActivityFooterView",["backbone-marionette","home/utils/mixpanelUtils","home/models/Session"],function(e,t,n){var i=e.ItemView.extend({templateHelpers:function(){var e=n.get();return{favorited:this.model.thread.get("userScore")>0,discussionRoute:this.model.thread.getDiscussionRoute(),authenticated:!e.isAnonymous()}},events:{"click [data-action=favorite]":"toggleThreadFavorited"},initialize:function(){this.listenTo(this.model.thread,"change:userScore",this.render)},toggleThreadFavorited:function(e){e&&e.preventDefault(),this.model.thread.get("userScore")<1&&t.track("like thread",e),this.model.thread.toggleFavorited()}});return i}),define("home/templates/activityFooterFavorite",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<ul class="actions">\n';return a=this.invokePartial(n.activityFooterDefaultActions,"","activityFooterDefaultActions",e,void 0,t,n,i),null!=a&&(s+=a),s+"</ul>\n"},usePartial:!0,useData:!0})}),define("home/views/ActivityFooterFavoriteView",["home/views/common/ActivityFooterView","home/templates/activityFooterFavorite"],function(e,t){var n=e.extend({template:t});return n}),define("home/templates/activityCardFavorite",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"%(group)s recommended %(numOccurance)s times",{name:"gettext",hash:{numOccurance:null!=e?e.numOccurance:e,group:t.getPartial.call(e,"userGroup",{name:"getPartial",hash:{},data:i})},data:i}))+"\n"},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"%(group)s recommended",{name:"gettext",hash:{group:t.getPartial.call(e,"userGroup",{name:"getPartial",hash:{},data:i})},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="card-reason">\n';return a=t["if"].call(e,null!=e?e.numOccurances:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+='<span class="time">'+o(s(null!=e?e.relativeTime:e,e))+"</span>\n</div>\n",a=this.invokePartial(n.cardTitle,"","cardTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="card-summary">\n<div class="card-summary-content" dir="auto">\n',a=s(null!=e?e.threadDescription:e,e),null!=a&&(r+=a),r+'\n</div>\n</div>\n<footer class="card-footer" data-role="footer"></div>\n'},usePartial:!0,useData:!0})}),define("home/views/ActivityCardFavoriteView",["backbone-marionette","home/mixins/withReasonOld","home/mixins/withSubviews","home/views/ActivityFooterFavoriteView","home/templates/activityCardFavorite"],function(e,t,n,i,a){var s=e.ItemView,o=s.extend({template:a,templateHelpers:function(){return{discussionRoute:this.model.thread.getDiscussionRoute(),threadDescription:this.model.thread.getDefaultDescription()}},initialize:function(){this.listenTo(this.model.thread,"change:content",this.render)},regions:{footerRegion:"[data-role=footer]"},onRender:function(){this.activateRegion(this.footerRegion,this.createFooterView)},createFooterView:function(){return new i({el:this.footerRegion.el,model:this.model})}}),r=o.prototype;return t.call(r),n.call(r),o}),define("home/templates/truncatedPost",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return'<span class="label label-danger">'+n(t(null!=e?e.hiddenExplanation:e,e))+"</span>\n"},3:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.plaintext:e,e))+"\n"},5:function(){return'<span class="icon-images"></span>\n'},7:function(){return"hidden"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r="";return a=this.invokePartial(n.userAvatar,"","userAvatar",null!=e?e.author:e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="comment-body">\n<header class="comment-header">\n',a=this.invokePartial(n.userName,"","userName",null!=e?e.author:e,void 0,t,n,i),null!=a&&(r+=a),r+='<a class="link-gray time"\nhref="'+o(s(null!=e?e.discussionRoute:e,e))+"#comment-"+o(s(null!=e?e.id:e,e))+'"\ndata-link-name="timestamp"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n\n'+o(s(null!=e?e.relativeTime:e,e))+"\n</a>\n",a=t["if"].call(e,null!=e?e.isHidden:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</header>\n<a href="'+o(s(null!=e?e.discussionRoute:e,e))+"#comment-"+o(s(null!=e?e.id:e,e))+'"\nclass="card-comment-truncated truncate-line"\ndata-link-name="message"\ndir="auto"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n\n',a=t["if"].call(e,null!=e?e.plaintext:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.program(5,i),data:i}),null!=a&&(r+=a),r+='</a>\n\n<footer class="comment-actions ',a=t["if"].call(e,null!=e?e.isHidden:e,{name:"if",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'" data-role="post-actions">\n</footer>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/TruncatedPostView",["underscore","home/views/PostView","home/templates/truncatedPost"],function(e,t,n){var i=t.extend({template:n});return i}),define("home/templates/replyActivity",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div data-role="parent-post" class="parent"></div>\n<div data-role="child-post" class="child"></div>\n'},useData:!0})}),define("home/views/ReplyActivityView",["backbone-marionette","home/mixins/withSubviews","home/views/PostView","home/views/TruncatedPostView","home/templates/replyActivity"],function(e,t,n,i,a){var s=e.ItemView,o=s.extend({className:"card-reply",template:a,regions:{inReplyToRegion:"[data-role=parent-post]",replyRegion:"[data-role=child-post]"},initialize:function(e){this.shouldCollapse=e&&e.shouldCollapse},onRender:function(){this.activateRegion(this.inReplyToRegion,this.createParentPostView),this.activateRegion(this.replyRegion,this.createChildPostView)},createParentPostView:function(){return new i({model:this.model.target})},createChildPostView:function(){return new n({model:this.model.object,shouldCollapse:this.shouldCollapse})}});return t.call(o.prototype),o}),define("home/views/PostActivityCollectionView",["underscore","backbone-marionette","home/views/PostView","home/views/ReplyActivityView"],function(e,t,n,i){var a=t.CollectionView.extend({initialize:function(e){this.collapsePosts=!e||e.collapsePosts!==!1},getItemView:function(e){return"reply"===e.get("verb")?i:n},itemViewOptions:function(t,n){var i=t;"post"===t.get("verb")&&(i=t.object);var a=this.getItemView(t).prototype.className;a=e.isFunction(a)?a.call({model:t}):a||"";var s=a;return n>0&&(s+=" collapsible"),{model:i,className:s,shouldCollapse:this.collapsePosts}}});return a}),define("home/views/common/ActivityCardPostBaseView",["backbone","backbone-marionette","home/mixins/withSubviews","home/views/PostActivityCollectionView"],function(e,t,n,i){var a=t.ItemView.extend({regions:{postsRegion:"[data-role=posts]",footerRegion:"[data-role=footer]"},buildPostsView:function(){return new i({el:this.postsRegion.el,collection:new e.Collection(this.model.activities)})},createFooterView:void 0,onRender:function(){this.activateRegion(this.postsRegion,this.buildPostsView),this.activateRegion(this.footerRegion,this.createFooterView)}});return n.call(a.prototype),a}),define("home/templates/activityFooterPost",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<ul class="actions">\n';return a=this.invokePartial(n.activityFooterDefaultActions,"","activityFooterDefaultActions",e,void 0,t,n,i),null!=a&&(s+=a),s+"</ul>\n"},usePartial:!0,useData:!0})}),define("home/views/ActivityFooterPostView",["underscore","home/views/common/ActivityFooterView","home/templates/activityFooterPost"],function(e,t,n){var i=t.extend({template:n,templateHelpers:function(){return e.defaults({hasMultiplePosts:this.model.activities.length>1},t.prototype.templateHelpers.apply(this,arguments))}});return i}),define("home/templates/activityCardPost",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"%(group)s commented %(numOccurance)s times",{name:"gettext",hash:{numOccurance:null!=e?e.numOccurance:e,group:t.getPartial.call(e,"userGroup",{name:"getPartial",hash:{},data:i})},data:i}))+"\n"},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"%(group)s commented",{name:"gettext",hash:{group:t.getPartial.call(e,"userGroup",{name:"getPartial",hash:{},data:i})},data:i}))+"\n"},5:function(e,t,n,i){var a=this.escapeExpression;return'<div class="expandable">\n<div class="card-grouped-actions">\n<a href="#" data-action="toggle-collapsed" class="expandable card-expand">\n<div class="icon-more-vert"></div>\n'+a(t.gettext.call(e,"See More",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n</div>\n"
},7:function(e,t,n,i){var a=this.lambda,s=this.escapeExpression;return'<div class="collapsible">\n<div class="card-grouped-actions">\n<a class="collapsible button button-outline -small" href="'+s(a(null!=e?e.discussionRoute:e,e))+'" data-link-name="view_comment">\n'+s(t.gettext.call(e,"See All Comments",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="card-reason">\n';return a=t["if"].call(e,null!=e?e.numOccurances:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+='<span class="time">'+o(s(null!=e?e.relativeTime:e,e))+"</span>\n</div>\n",a=this.invokePartial(n.cardTitle,"","cardTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div data-role="posts"></div>\n',a=t["if"].call(e,null!=e?e.shouldCollapse:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t["if"].call(e,null!=e?e.hasOverflowPosts:e,{name:"if",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'<footer class="card-footer" data-role="footer"></div>\n'},usePartial:!0,useData:!0})}),define("home/views/ActivityCardPostView",["underscore","home/mixins/withReasonOld","home/views/common/ActivityCardPostBaseView","home/views/ActivityFooterPostView","home/templates/activityCardPost"],function(e,t,n,i,a){var s=n,o=s.extend({template:a,templateHelpers:function(){return{hasOverflowPosts:this.model.get("totalActivities")>this.model.activities.length,shouldCollapse:this.shouldCollapse(),discussionRoute:this.model.thread.getDiscussionRoute()}},createFooterView:function(){return new i({el:this.footerRegion.el,model:this.model})},shouldCollapse:function(){return this.model.activities.length>1}}),r=o.prototype;return t.call(r),o}),define("home/templates/activityFooterReply",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<ul class="actions">\n';return a=this.invokePartial(n.activityFooterDefaultActions,"","activityFooterDefaultActions",e,void 0,t,n,i),null!=a&&(s+=a),s+"</ul>\n"},usePartial:!0,useData:!0})}),define("home/views/ActivityFooterReplyView",["home/views/common/ActivityFooterView","home/templates/activityFooterReply"],function(e,t){var n=e.extend({template:t});return n}),define("home/templates/activityCardReply",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="card-reason">\n';return a=this.invokePartial(n.userGroup,"","userGroup",e,void 0,t,n,i),null!=a&&(r+=a),r+='<span class="icon-forward"></span>',a=this.invokePartial(n.userPreview,"","userPreview",null!=(a=null!=e?e.target:e)?a.author:a,void 0,t,n,i),null!=a&&(r+=a),r+=' <span class="time">'+o(s(null!=e?e.relativeTime:e,e))+"</span>\n</div>\n",a=this.invokePartial(n.cardTitle,"","cardTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+'<div class="card-reply" data-role="posts"></div>\n<footer class="card-footer" data-role="footer"></div>\n'},usePartial:!0,useData:!0})}),define("home/views/ActivityCardReplyView",["underscore","home/mixins/withReasonOld","home/views/common/ActivityCardPostBaseView","home/views/ActivityFooterReplyView","home/templates/activityCardReply"],function(e,t,n,i,a){var s=n,o=s.extend({template:a,templateHelpers:function(){return{target:this.model.activities[0].target.toJSON()}},createFooterView:function(){return new i({el:this.footerRegion.el,model:this.model})}}),r=o.prototype;return t.call(r),o}),define("home/templates/activityFooterTrending",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<ul class="actions">\n';return a=this.invokePartial(n.activityFooterDefaultActions,"","activityFooterDefaultActions",e,void 0,t,n,i),null!=a&&(s+=a),s+"</ul>\n"},usePartial:!0,useData:!0})}),define("home/views/ActivityFooterTrendingView",["home/views/common/ActivityFooterView","home/templates/activityFooterTrending"],function(e,t){var n=e.extend({template:t});return n}),define("home/templates/activityCardTrending",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="/home/forum/'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.id:a,e))+'/" class="community link-gray-darker" data-link-name="forum_name">';return a=this.invokePartial(n.forumName,"","forumName",null!=(a=null!=e?e.target:e)?a.forum:a,void 0,t,n,i),null!=a&&(r+=a),r+"</a>\n"},3:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r="";return a=this.invokePartial(n.forumAvatarLink,"","forumAvatarLink",null!=(a=null!=e?e.target:e)?a.forum:a,void 0,t,n,i),null!=a&&(r+=a),r+=' <a href="/home/forum/'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.id:a,e))+'/" class="community link-gray-darker" data-link-name="forum_name">',a=this.invokePartial(n.forumName,"","forumName",null!=(a=null!=e?e.target:e)?a.forum:a,void 0,t,n,i),null!=a&&(r+=a),r+"</a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="card-reason">\n';return a=t["if"].call(e,null!=e?e.hideForumFavicon:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+='<span class="time">'+s(t.gettext.call(e,"Recent activity",{name:"gettext",hash:{},data:i}))+" "+s(o(null!=e?e.relativeTime:e,e))+"</span>\n</div>\n",a=this.invokePartial(n.cardTitle,"","cardTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="card-summary">\n<div class="card-summary-content" dir="auto">\n',a=o(null!=e?e.threadDescription:e,e),null!=a&&(r+=a),r+'\n</div>\n</div>\n<footer class="card-footer" data-role="footer"></div>\n'},usePartial:!0,useData:!0})}),define("home/views/ActivityCardTrendingView",["underscore","backbone-marionette","home/mixins/withReasonOld","home/mixins/withSubviews","home/views/ActivityFooterTrendingView","home/templates/activityCardTrending"],function(e,t,n,i,a,s){var o=t.ItemView,r=o.extend({template:s,templateHelpers:function(){var t=this.model.thread.forum.get("favicon")&&this.model.thread.forum.get("favicon").cache,n={};return e.extend(n,{commenter:this.model.thread.getMostRecentCommenter(),target:this.model.activities[0].target.toJSON(),discussionRoute:this.model.thread.getDiscussionRoute(),threadDescription:this.model.thread.getDefaultDescription(),hideForumFavicon:!t||/favicon-default/.test(t)})},initialize:function(){this.listenTo(this.model.thread,"change:content",this.render)},regions:{footerRegion:"[data-role=footer]"},onRender:function(){this.activateRegion(this.footerRegion,this.createFooterView)},createFooterView:function(){return new a({el:this.footerRegion.el,model:this.model})}}),l=r.prototype;return n.call(l),i.call(l),r}),define("home/templates/activityFooterCreate",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<ul class="actions">\n';return a=this.invokePartial(n.activityFooterDefaultActions,"","activityFooterDefaultActions",e,void 0,t,n,i),null!=a&&(s+=a),s+"</ul>\n"},usePartial:!0,useData:!0})}),define("home/views/ActivityFooterCreateView",["home/views/common/ActivityFooterView","home/templates/activityFooterCreate"],function(e,t){var n=e.extend({template:t});return n}),define("home/templates/activityCardCreate",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="card-discussion-comments-title">'+s(t.gettext.call(e,"Recent Comments",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="card-discussion-comments" data-role="posts"></div>\n';return a=t["if"].call(e,null!=e?e.shouldCollapse:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o},2:function(e,t,n,i){var a=this.escapeExpression;return'<div class="expandable">\n<div class="card-grouped-actions">\n<a href="#" data-action="toggle-collapsed" class="expandable card-expand">\n<div class="icon-more-vert"></div>\n'+a(t.gettext.call(e,"See More",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n</div>\n"},4:function(e){var t,n=this.lambda,i='<div class="card-summary">\n<div class="card-summary-content" dir="auto">\n';return t=n(null!=e?e.threadDescription:e,e),null!=t&&(i+=t),i+"\n</div>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="card-reason">\n'+s(t.gettext.call(e,"%(group)s authored",{name:"gettext",hash:{group:t.getPartial.call(e,"userGroup",{name:"getPartial",hash:{},data:i})},data:i}))+'\n<span class="time">'+s(o(null!=e?e.relativeTime:e,e))+"</span>\n</div>\n";return a=this.invokePartial(n.cardTitle,"","cardTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+="\n",a=t["if"].call(e,null!=e?e.recentPostCount:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(4,i),data:i}),null!=a&&(r+=a),r+'\n<footer class="card-footer" data-role="footer"></div>\n'},usePartial:!0,useData:!0})}),define("home/views/ActivityCardCreateView",["underscore","backbone-marionette","home/mixins/withReasonOld","home/mixins/withSubviews","home/views/ActivityFooterCreateView","home/views/PostCollectionView","home/templates/activityCardCreate"],function(e,t,n,i,a,s,o){var r=t.ItemView,l=r.extend({template:o,templateHelpers:function(){var e=this.model.thread.forum.get("favicon")&&this.model.thread.forum.get("favicon").cache;return{target:this.model.activities[0].target.toJSON(),discussionRoute:this.model.thread.getDiscussionRoute(),threadDescription:this.model.thread.getDefaultDescription(),recentPostCount:this.model.thread.recentPosts.length,shouldCollapse:this.shouldCollapse(),hideForumFavicon:!e||/favicon-default/.test(e)}},initialize:function(){this.listenTo(this.model.thread,"change:content",this.render)},regions:{postsRegion:"[data-role=posts]",footerRegion:"[data-role=footer]"},onRender:function(){this.activateRegion(this.postsRegion,this.createPostsView),this.activateRegion(this.footerRegion,this.createFooterView)},createPostsView:function(){return new s({el:this.postsRegion.el,collection:this.model.thread.recentPosts,itemViewOptions:function(t,n){var i=this.getItemView(t).prototype.className;i=e.isFunction(i)?i.call({model:t}):i||"";var a=i;return n>0&&(a+=" collapsible"),{className:a}}})},createFooterView:function(){var e=new a({el:this.footerRegion.el,model:this.model});return this.listenTo(e,"toggle:collapsed",function(){this.trigger("toggle:collapsed")}),e},shouldCollapse:function(){return this.model.thread.recentPosts.length>1}}),c=l.prototype;return n.call(c),i.call(c),l}),define("home/templates/activityCard",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.threadImage,"","threadImage",e,void 0,t,n,i),null!=a&&(s+=a),s},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="card-discussion">\n<div class="card-aside" data-role="thread-image">\n';return a=t["if"].call(e,null!=e?e.canShowThreadImage:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+'</div>\n<div class="card-body">\n<div data-role="card-content"></div>\n</div>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/ActivityCardWrapperView",["underscore","jquery","backbone-marionette","handlebars","home/utils/mixpanelUtils","home/utils/layoutUtils","home/views/common/ActivityCardView","home/mixins/asCollapsibleCard","home/mixins/withSubviews","home/views/ActivityCardFavoriteView","home/views/ActivityCardPostView","home/views/ActivityCardReplyView","home/views/ActivityCardTrendingView","home/views/ActivityCardCreateView","home/templates/activityCard"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p){var f=o,g=f.extend({className:function(){return"card card-"+this.model.get("verb")},template:p,templateHelpers:function(){return{canShowThreadImage:this.canShowThreadImage(),discussionRoute:this.model.thread.getDiscussionRoute(),image:this.model.thread.getImage()}},events:{"click [data-role=thread-link]":"trackOpenedThread"},initialize:function(){this.canShowThreadImage()&&this.listenTo(this.model.thread,"change:content",this.renderThreadImage),this.contentRegion=this.addRegion("[data-role=card-content]")},getContentView:function(){var e;switch(this.model.get("verb")){case"favorite":e=c;break;case"post":e=d;break;case"reply":e=u;break;case"trending":e=h;break;case"create":e=m}return new e({el:this.contentRegion.el,model:this.model})},canShowThreadImage:function(){return s.getScreenWidth()>480},renderThreadImage:function(){if(this.canShowThreadImage()){var e=this.serializeData();e=this.mixinTemplateHelpers(e),this.$("[data-role=thread-image]").html(i.partials.threadImage(e))}},onRender:function(){var e=this.contentRegion;this.activateRegion(e,this.getContentView);var t=e.currentView;t.shouldCollapse&&t.shouldCollapse()&&this.$el.addClass("card-collapsed")},trackOpenedThread:function(e){a.track("click external article",e)}}),v=g.prototype;return r.call(v),l.call(v),g}),define("home/templates/feedEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Woops, nothing is happening here.",{name:"gettext",hash:{},data:i}))+"\n"},useData:!0})}),define("home/views/FeedEmptyView",["backbone-marionette","home/templates/feedEmpty"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/views/ActivityCardCollectionView",["underscore","home/utils/layoutUtils","home/views/ActivityCardWrapperView","home/views/common/FetchableCollectionView","home/views/FeedEmptyView","home/mixins/withViewFeedTracking","home/mixins/withClickLinkTracking"],function(e,t,n,i,a,s,o){var r=i.extend({className:"cards",emptyView:a,itemView:n,events:e.defaults({"click a[data-link-name]":function(e){this.isShowingNonItemView()||this.trackClickLink(e)}},i.prototype.events)});return s.call(r.prototype),o.call(r.prototype),r}),define("home/collections/RecommendedForumCollection",["backbone","core/UniqueModel","home/models/Forum","core/api"],function(e,t,n,i){return e.Collection.extend({url:i.getURL("users/recommendedForumsToFollow"),model:t.boundModel(n),addSpecial:function(e){return e.unshift({id:"channel-plotthreads",name:"Plot Threads",favicon:{cache:"//media.disquscdn.com/home/plotthreads_favicon.png"}},{id:"channel-talkshop",name:"Talk Shop",favicon:{cache:"//media.disquscdn.com/home/talkshop_favicon.png"}}),e},parse:function(e){return this.addSpecial(e.response)}})}),define("home/templates/suggestions",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div class="carousel" data-role="carousel">\n<div data-role="cards-container">\n</div>\n</div>\n'},useData:!0})}),function(e){"function"==typeof define&&define.amd?define("slick",["jquery"],e):"undefined"!=typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){var t=window.Slick||{};t=function(){function t(t,i){var a,s,o=this;if(o.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:e(t),appendDots:e(t),arrows:!0,asNavFor:null,prevArrow:'<button type="button" data-role="none" class="slick-prev">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(e,t){return'<button type="button" data-role="none">'+(t+1)+"</button>"},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",onBeforeChange:null,onAfterChange:null,onInit:null,onReInit:null,onSetPosition:null,pauseOnHover:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rtl:!1,slide:"div",slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,variableWidth:!1,vertical:!1,waitForAnimate:!0},o.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:!1},e.extend(o,o.initials),o.activeBreakpoint=null,o.animType=null,o.animProp=null,o.breakpoints=[],o.breakpointSettings=[],o.cssTransitions=!1,o.paused=!1,o.positionProp=null,o.respondTo=null,o.shouldClick=!0,o.$slider=e(t),o.$slidesCache=null,o.transformType=null,o.transitionType=null,o.windowWidth=0,o.windowTimer=null,o.options=e.extend({},o.defaults,i),o.currentSlide=o.options.initialSlide,o.originalSettings=o.options,a=o.options.responsive||null,a&&a.length>-1){o.respondTo=o.options.respondTo||"window";for(s in a)a.hasOwnProperty(s)&&(o.breakpoints.push(a[s].breakpoint),o.breakpointSettings[a[s].breakpoint]=a[s].settings);o.breakpoints.sort(function(e,t){return t-e})}o.autoPlay=e.proxy(o.autoPlay,o),o.autoPlayClear=e.proxy(o.autoPlayClear,o),o.changeSlide=e.proxy(o.changeSlide,o),o.clickHandler=e.proxy(o.clickHandler,o),o.selectHandler=e.proxy(o.selectHandler,o),o.setPosition=e.proxy(o.setPosition,o),o.swipeHandler=e.proxy(o.swipeHandler,o),o.dragHandler=e.proxy(o.dragHandler,o),o.keyHandler=e.proxy(o.keyHandler,o),o.autoPlayIterator=e.proxy(o.autoPlayIterator,o),o.instanceUid=n++,o.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,o.init(),o.checkResponsive()}var n=0;return t}(),t.prototype.addSlide=function(t,n,i){var a=this;if("boolean"==typeof n)i=n,n=null;else if(0>n||n>=a.slideCount)return!1;a.unload(),"number"==typeof n?0===n&&0===a.$slides.length?e(t).appendTo(a.$slideTrack):i?e(t).insertBefore(a.$slides.eq(n)):e(t).insertAfter(a.$slides.eq(n)):i===!0?e(t).prependTo(a.$slideTrack):e(t).appendTo(a.$slideTrack),a.$slides=a.$slideTrack.children(this.options.slide),a.$slideTrack.children(this.options.slide).detach(),a.$slideTrack.append(a.$slides),a.$slides.each(function(t,n){e(n).attr("index",t)}),a.$slidesCache=a.$slides,a.reinit()},t.prototype.animateSlide=function(t,n){var i={},a=this;if(1===a.options.slidesToShow&&a.options.adaptiveHeight===!0&&a.options.vertical===!1){var s=a.$slides.eq(a.currentSlide).outerHeight(!0);a.$list.animate({height:s},a.options.speed)}a.options.rtl===!0&&a.options.vertical===!1&&(t=-t),a.transformsEnabled===!1?a.options.vertical===!1?a.$slideTrack.animate({left:t},a.options.speed,a.options.easing,n):a.$slideTrack.animate({top:t},a.options.speed,a.options.easing,n):a.cssTransitions===!1?e({animStart:a.currentLeft}).animate({animStart:t},{duration:a.options.speed,easing:a.options.easing,step:function(e){a.options.vertical===!1?(i[a.animType]="translate("+e+"px, 0px)",a.$slideTrack.css(i)):(i[a.animType]="translate(0px,"+e+"px)",a.$slideTrack.css(i))},complete:function(){n&&n.call()}}):(a.applyTransition(),i[a.animType]=a.options.vertical===!1?"translate3d("+t+"px, 0px, 0px)":"translate3d(0px,"+t+"px, 0px)",a.$slideTrack.css(i),n&&setTimeout(function(){a.disableTransition(),n.call()},a.options.speed))},t.prototype.asNavFor=function(t){var n=this,i=null!=n.options.asNavFor?e(n.options.asNavFor).getSlick():null;null!=i&&i.slideHandler(t,!0)},t.prototype.applyTransition=function(e){var t=this,n={};n[t.transitionType]=t.options.fade===!1?t.transformType+" "+t.options.speed+"ms "+t.options.cssEase:"opacity "+t.options.speed+"ms "+t.options.cssEase,t.options.fade===!1?t.$slideTrack.css(n):t.$slides.eq(e).css(n)},t.prototype.autoPlay=function(){var e=this;e.autoPlayTimer&&clearInterval(e.autoPlayTimer),e.slideCount>e.options.slidesToShow&&e.paused!==!0&&(e.autoPlayTimer=setInterval(e.autoPlayIterator,e.options.autoplaySpeed))},t.prototype.autoPlayClear=function(){var e=this;e.autoPlayTimer&&clearInterval(e.autoPlayTimer)},t.prototype.autoPlayIterator=function(){var e=this;e.options.infinite===!1?1===e.direction?(e.currentSlide+1===e.slideCount-1&&(e.direction=0),e.slideHandler(e.currentSlide+e.options.slidesToScroll)):(e.currentSlide-1===0&&(e.direction=1),e.slideHandler(e.currentSlide-e.options.slidesToScroll)):e.slideHandler(e.currentSlide+e.options.slidesToScroll)},t.prototype.buildArrows=function(){var t=this;t.options.arrows===!0&&t.slideCount>t.options.slidesToShow&&(t.$prevArrow=e(t.options.prevArrow),t.$nextArrow=e(t.options.nextArrow),t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.appendTo(t.options.appendArrows),t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.appendTo(t.options.appendArrows),t.options.infinite!==!0&&t.$prevArrow.addClass("slick-disabled"))},t.prototype.buildDots=function(){var t,n,i=this;if(i.options.dots===!0&&i.slideCount>i.options.slidesToShow){for(n='<ul class="'+i.options.dotsClass+'">',t=0;t<=i.getDotCount();t+=1)n+="<li>"+i.options.customPaging.call(this,i,t)+"</li>";n+="</ul>",i.$dots=e(n).appendTo(i.options.appendDots),i.$dots.find("li").first().addClass("slick-active")}},t.prototype.buildOut=function(){var t=this;t.$slides=t.$slider.children(t.options.slide+":not(.slick-cloned)").addClass("slick-slide"),t.slideCount=t.$slides.length,t.$slides.each(function(t,n){e(n).attr("index",t)}),t.$slidesCache=t.$slides,t.$slider.addClass("slick-slider"),t.$slideTrack=0===t.slideCount?e('<div class="slick-track"/>').appendTo(t.$slider):t.$slides.wrapAll('<div class="slick-track"/>').parent(),t.$list=t.$slideTrack.wrap('<div class="slick-list"/>').parent(),t.$slideTrack.css("opacity",0),t.options.centerMode===!0&&(t.options.slidesToScroll=1),e("img[data-lazy]",t.$slider).not("[src]").addClass("slick-loading"),t.setupInfinite(),t.buildArrows(),t.buildDots(),t.updateDots(),t.options.accessibility===!0&&t.$list.prop("tabIndex",0),t.setSlideClasses("number"==typeof this.currentSlide?this.currentSlide:0),t.options.draggable===!0&&t.$list.addClass("draggable")},t.prototype.checkResponsive=function(){var t,n,i,a=this,s=a.$slider.width(),o=window.innerWidth||e(window).width();if("window"===a.respondTo?i=o:"slider"===a.respondTo?i=s:"min"===a.respondTo&&(i=Math.min(o,s)),a.originalSettings.responsive&&a.originalSettings.responsive.length>-1&&null!==a.originalSettings.responsive){n=null;for(t in a.breakpoints)a.breakpoints.hasOwnProperty(t)&&a.breakpoints[t]>i&&(n=a.breakpoints[t]);null!==n?null!==a.activeBreakpoint?n!==a.activeBreakpoint&&(a.activeBreakpoint=n,a.options=e.extend({},a.originalSettings,a.breakpointSettings[n]),a.refresh()):(a.activeBreakpoint=n,a.options=e.extend({},a.originalSettings,a.breakpointSettings[n]),a.refresh()):null!==a.activeBreakpoint&&(a.activeBreakpoint=null,a.options=a.originalSettings,a.refresh())}},t.prototype.changeSlide=function(t,n){var i,a,s,o,r,l=this,c=e(t.target);switch(c.is("a")&&t.preventDefault(),s=l.slideCount%l.options.slidesToScroll!==0,i=s?0:(l.slideCount-l.currentSlide)%l.options.slidesToScroll,t.data.message){case"previous":a=0===i?l.options.slidesToScroll:l.options.slidesToShow-i,l.slideCount>l.options.slidesToShow&&l.slideHandler(l.currentSlide-a,!1,n);break;case"next":a=0===i?l.options.slidesToScroll:i,l.slideCount>l.options.slidesToShow&&l.slideHandler(l.currentSlide+a,!1,n);break;case"index":var d=0===t.data.index?0:t.data.index||e(t.target).parent().index()*l.options.slidesToScroll;if(o=l.getNavigableIndexes(),r=0,o[d]&&o[d]===d)if(d>o[o.length-1])d=o[o.length-1];else for(var u in o){if(o[u]>d){d=r;break}r=o[u]}l.slideHandler(d,!1,n);default:return}},t.prototype.clickHandler=function(e){var t=this;t.shouldClick===!1&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault())},t.prototype.destroy=function(){var t=this;t.autoPlayClear(),t.touchObject={},e(".slick-cloned",t.$slider).remove(),t.$dots&&t.$dots.remove(),t.$prevArrow&&"object"!=typeof t.options.prevArrow&&t.$prevArrow.remove(),t.$nextArrow&&"object"!=typeof t.options.nextArrow&&t.$nextArrow.remove(),t.$slides.parent().hasClass("slick-track")&&t.$slides.unwrap().unwrap(),t.$slides.removeClass("slick-slide slick-active slick-center slick-visible").removeAttr("index").css({position:"",left:"",top:"",zIndex:"",opacity:"",width:""}),t.$slider.removeClass("slick-slider"),t.$slider.removeClass("slick-initialized"),t.$list.off(".slick"),e(window).off(".slick-"+t.instanceUid),e(document).off(".slick-"+t.instanceUid)},t.prototype.disableTransition=function(e){var t=this,n={};n[t.transitionType]="",t.options.fade===!1?t.$slideTrack.css(n):t.$slides.eq(e).css(n)},t.prototype.fadeSlide=function(e,t,n){var i=this;i.cssTransitions===!1?(i.$slides.eq(t).css({zIndex:1e3}),i.$slides.eq(t).animate({opacity:1},i.options.speed,i.options.easing,n),i.$slides.eq(e).animate({opacity:0},i.options.speed,i.options.easing)):(i.applyTransition(t),i.applyTransition(e),i.$slides.eq(t).css({opacity:1,zIndex:1e3}),i.$slides.eq(e).css({opacity:0}),n&&setTimeout(function(){i.disableTransition(t),i.disableTransition(e),n.call()},i.options.speed))},t.prototype.filterSlides=function(e){var t=this;null!==e&&(t.unload(),t.$slideTrack.children(this.options.slide).detach(),t.$slidesCache.filter(e).appendTo(t.$slideTrack),t.reinit())},t.prototype.getCurrent=function(){var e=this;return e.currentSlide},t.prototype.getDotCount=function(){var e=this,t=0,n=0,i=0;if(e.options.infinite===!0)i=Math.ceil(e.slideCount/e.options.slidesToScroll);else for(;e.slideCount>t;)++i,t=n+e.options.slidesToShow,n+=e.options.slidesToShow>=e.options.slidesToScroll?e.options.slidesToScroll:e.options.slidesToShow;return i-1},t.prototype.getLeft=function(e){var t,n,i,a=this,s=0;return a.slideOffset=0,n=a.$slides.first().outerHeight(),a.options.infinite===!0?(a.slideCount>a.options.slidesToShow&&(a.slideOffset=a.slideWidth*a.options.slidesToShow*-1,s=n*a.options.slidesToShow*-1),a.slideCount%a.options.slidesToScroll!==0&&e+a.options.slidesToScroll>a.slideCount&&a.slideCount>a.options.slidesToShow&&(e>a.slideCount?(a.slideOffset=(a.options.slidesToShow-(e-a.slideCount))*a.slideWidth*-1,s=(a.options.slidesToShow-(e-a.slideCount))*n*-1):(a.slideOffset=a.slideCount%a.options.slidesToScroll*a.slideWidth*-1,s=a.slideCount%a.options.slidesToScroll*n*-1))):e+a.options.slidesToShow>a.slideCount&&(a.slideOffset=(e+a.options.slidesToShow-a.slideCount)*a.slideWidth,s=(e+a.options.slidesToShow-a.slideCount)*n),a.options.slidesToShow>=a.slideCount&&(a.slideOffset=0,s=0),a.options.centerMode===!0&&a.options.infinite===!0?a.slideOffset+=a.slideWidth*Math.floor(a.options.slidesToShow/2)-a.slideWidth:a.options.centerMode===!0&&(a.slideOffset=0,a.slideOffset+=a.slideWidth*Math.floor(a.options.slidesToShow/2)),t=a.options.vertical===!1?e*a.slideWidth*-1+a.slideOffset:e*n*-1+s,a.options.variableWidth===!0&&(i=a.$slideTrack.children(".slick-slide").eq(a.options.slidesToShow>=a.slideCount||a.options.infinite===!1?e:e+a.options.slidesToShow),t=i[0]?-1*i[0].offsetLeft:0,a.options.centerMode===!0&&(i=a.$slideTrack.children(".slick-slide").eq(a.options.infinite===!1?e:e+a.options.slidesToShow+1),t=i[0]?-1*i[0].offsetLeft:0,t+=(a.$list.width()-i.outerWidth())/2)),t},t.prototype.getNavigableIndexes=function(){for(var e=this,t=0,n=0,i=[];e.slideCount>t;)i.push(t),t=n+e.options.slidesToScroll,n+=e.options.slidesToShow>=e.options.slidesToScroll?e.options.slidesToScroll:e.options.slidesToShow;return i},t.prototype.getSlideCount=function(){var t,n=this;if(n.options.swipeToSlide===!0){var i=null;return n.$slideTrack.find(".slick-slide").each(function(t,a){return a.offsetLeft+e(a).outerWidth()/2>-1*n.swipeLeft?(i=a,!1):void 0}),t=Math.abs(e(i).attr("index")-n.currentSlide)}return n.options.slidesToScroll},t.prototype.init=function(){var t=this;e(t.$slider).hasClass("slick-initialized")||(e(t.$slider).addClass("slick-initialized"),t.buildOut(),t.setProps(),t.startLoad(),t.loadSlider(),t.initializeEvents(),t.updateArrows(),t.updateDots()),null!==t.options.onInit&&t.options.onInit.call(this,t)},t.prototype.initArrowEvents=function(){var e=this;e.options.arrows===!0&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.on("click.slick",{message:"previous"},e.changeSlide),e.$nextArrow.on("click.slick",{message:"next"},e.changeSlide))},t.prototype.initDotEvents=function(){var t=this;t.options.dots===!0&&t.slideCount>t.options.slidesToShow&&e("li",t.$dots).on("click.slick",{message:"index"},t.changeSlide),t.options.dots===!0&&t.options.pauseOnDotsHover===!0&&t.options.autoplay===!0&&e("li",t.$dots).on("mouseenter.slick",function(){t.paused=!0,t.autoPlayClear()}).on("mouseleave.slick",function(){t.paused=!1,t.autoPlay()})},t.prototype.initializeEvents=function(){var t=this;t.initArrowEvents(),t.initDotEvents(),t.$list.on("touchstart.slick mousedown.slick",{action:"start"},t.swipeHandler),t.$list.on("touchmove.slick mousemove.slick",{action:"move"},t.swipeHandler),t.$list.on("touchend.slick mouseup.slick",{action:"end"},t.swipeHandler),t.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},t.swipeHandler),t.$list.on("click.slick",t.clickHandler),t.options.pauseOnHover===!0&&t.options.autoplay===!0&&(t.$list.on("mouseenter.slick",function(){t.paused=!0,t.autoPlayClear()}),t.$list.on("mouseleave.slick",function(){t.paused=!1,t.autoPlay()})),t.options.accessibility===!0&&t.$list.on("keydown.slick",t.keyHandler),t.options.focusOnSelect===!0&&e(t.options.slide,t.$slideTrack).on("click.slick",t.selectHandler),e(window).on("orientationchange.slick.slick-"+t.instanceUid,function(){t.checkResponsive(),t.setPosition()}),e(window).on("resize.slick.slick-"+t.instanceUid,function(){e(window).width()!==t.windowWidth&&(clearTimeout(t.windowDelay),t.windowDelay=window.setTimeout(function(){t.windowWidth=e(window).width(),t.checkResponsive(),t.setPosition()},50))}),e("*[draggable!=true]",t.$slideTrack).on("dragstart",function(e){e.preventDefault()}),e(window).on("load.slick.slick-"+t.instanceUid,t.setPosition),e(document).on("ready.slick.slick-"+t.instanceUid,t.setPosition)},t.prototype.initUI=function(){var e=this;e.options.arrows===!0&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.show(),e.$nextArrow.show()),e.options.dots===!0&&e.slideCount>e.options.slidesToShow&&e.$dots.show(),e.options.autoplay===!0&&e.autoPlay()},t.prototype.keyHandler=function(e){var t=this;37===e.keyCode&&t.options.accessibility===!0?t.changeSlide({data:{message:"previous"}}):39===e.keyCode&&t.options.accessibility===!0&&t.changeSlide({data:{message:"next"}})},t.prototype.lazyLoad=function(){function t(t){e("img[data-lazy]",t).each(function(){var t=e(this),n=e(this).attr("data-lazy");t.load(function(){t.animate({opacity:1},200)}).css({opacity:0}).attr("src",n).removeAttr("data-lazy").removeClass("slick-loading")})}var n,i,a,s,o=this;o.options.centerMode===!0?o.options.infinite===!0?(a=o.currentSlide+(o.options.slidesToShow/2+1),s=a+o.options.slidesToShow+2):(a=Math.max(0,o.currentSlide-(o.options.slidesToShow/2+1)),s=2+(o.options.slidesToShow/2+1)+o.currentSlide):(a=o.options.infinite?o.options.slidesToShow+o.currentSlide:o.currentSlide,s=a+o.options.slidesToShow,o.options.fade===!0&&(a>0&&a--,o.slideCount>=s&&s++)),n=o.$slider.find(".slick-slide").slice(a,s),t(n),o.options.slidesToShow>=o.slideCount?(i=o.$slider.find(".slick-slide"),t(i)):o.currentSlide>=o.slideCount-o.options.slidesToShow?(i=o.$slider.find(".slick-cloned").slice(0,o.options.slidesToShow),t(i)):0===o.currentSlide&&(i=o.$slider.find(".slick-cloned").slice(-1*o.options.slidesToShow),t(i))},t.prototype.loadSlider=function(){var e=this;e.setPosition(),e.$slideTrack.css({opacity:1}),e.$slider.removeClass("slick-loading"),e.initUI(),"progressive"===e.options.lazyLoad&&e.progressiveLazyLoad()},t.prototype.postSlide=function(e){var t=this;
null!==t.options.onAfterChange&&t.options.onAfterChange.call(this,t,e),t.animating=!1,t.setPosition(),t.swipeLeft=null,t.options.autoplay===!0&&t.paused===!1&&t.autoPlay()},t.prototype.progressiveLazyLoad=function(){var t,n,i=this;t=e("img[data-lazy]",i.$slider).length,t>0&&(n=e("img[data-lazy]",i.$slider).first(),n.attr("src",n.attr("data-lazy")).removeClass("slick-loading").load(function(){n.removeAttr("data-lazy"),i.progressiveLazyLoad()}).error(function(){n.removeAttr("data-lazy"),i.progressiveLazyLoad()}))},t.prototype.refresh=function(){var t=this,n=t.currentSlide;t.destroy(),e.extend(t,t.initials),t.init(),t.changeSlide({data:{message:"index",index:n}},!0)},t.prototype.reinit=function(){var t=this;t.$slides=t.$slideTrack.children(t.options.slide).addClass("slick-slide"),t.slideCount=t.$slides.length,t.currentSlide>=t.slideCount&&0!==t.currentSlide&&(t.currentSlide=t.currentSlide-t.options.slidesToScroll),t.options.slidesToShow>=t.slideCount&&(t.currentSlide=0),t.setProps(),t.setupInfinite(),t.buildArrows(),t.updateArrows(),t.initArrowEvents(),t.buildDots(),t.updateDots(),t.initDotEvents(),t.options.focusOnSelect===!0&&e(t.options.slide,t.$slideTrack).on("click.slick",t.selectHandler),t.setSlideClasses(0),t.setPosition(),null!==t.options.onReInit&&t.options.onReInit.call(this,t)},t.prototype.removeSlide=function(e,t,n){var i=this;return"boolean"==typeof e?(t=e,e=t===!0?0:i.slideCount-1):e=t===!0?--e:e,1>i.slideCount||0>e||e>i.slideCount-1?!1:(i.unload(),n===!0?i.$slideTrack.children().remove():i.$slideTrack.children(this.options.slide).eq(e).remove(),i.$slides=i.$slideTrack.children(this.options.slide),i.$slideTrack.children(this.options.slide).detach(),i.$slideTrack.append(i.$slides),i.$slidesCache=i.$slides,void i.reinit())},t.prototype.setCSS=function(e){var t,n,i=this,a={};i.options.rtl===!0&&(e=-e),t="left"==i.positionProp?e+"px":"0px",n="top"==i.positionProp?e+"px":"0px",a[i.positionProp]=e,i.transformsEnabled===!1?i.$slideTrack.css(a):(a={},i.cssTransitions===!1?(a[i.animType]="translate("+t+", "+n+")",i.$slideTrack.css(a)):(a[i.animType]="translate3d("+t+", "+n+", 0px)",i.$slideTrack.css(a)))},t.prototype.setDimensions=function(){var t=this;if(t.options.vertical===!1?t.options.centerMode===!0&&t.$list.css({padding:"0px "+t.options.centerPadding}):(t.$list.height(t.$slides.first().outerHeight(!0)*t.options.slidesToShow),t.options.centerMode===!0&&t.$list.css({padding:t.options.centerPadding+" 0px"})),t.listWidth=t.$list.width(),t.listHeight=t.$list.height(),t.options.vertical===!1&&t.options.variableWidth===!1)t.slideWidth=Math.ceil(t.listWidth/t.options.slidesToShow),t.$slideTrack.width(Math.ceil(t.slideWidth*t.$slideTrack.children(".slick-slide").length));else if(t.options.variableWidth===!0){var n=0;t.slideWidth=Math.ceil(t.listWidth/t.options.slidesToShow),t.$slideTrack.children(".slick-slide").each(function(){n+=Math.ceil(e(this).outerWidth(!0))}),t.$slideTrack.width(Math.ceil(n)+1)}else t.slideWidth=Math.ceil(t.listWidth),t.$slideTrack.height(Math.ceil(t.$slides.first().outerHeight(!0)*t.$slideTrack.children(".slick-slide").length));var i=t.$slides.first().outerWidth(!0)-t.$slides.first().width();t.options.variableWidth===!1&&t.$slideTrack.children(".slick-slide").width(t.slideWidth-i)},t.prototype.setFade=function(){var t,n=this;n.$slides.each(function(i,a){t=n.slideWidth*i*-1,e(a).css(n.options.rtl===!0?{position:"relative",right:t,top:0,zIndex:800,opacity:0}:{position:"relative",left:t,top:0,zIndex:800,opacity:0})}),n.$slides.eq(n.currentSlide).css({zIndex:900,opacity:1})},t.prototype.setHeight=function(){var e=this;if(1===e.options.slidesToShow&&e.options.adaptiveHeight===!0&&e.options.vertical===!1){var t=e.$slides.eq(e.currentSlide).outerHeight(!0);e.$list.css("height",t)}},t.prototype.setPosition=function(){var e=this;e.setDimensions(),e.setHeight(),e.options.fade===!1?e.setCSS(e.getLeft(e.currentSlide)):e.setFade(),null!==e.options.onSetPosition&&e.options.onSetPosition.call(this,e)},t.prototype.setProps=function(){var e=this,t=document.body.style;e.positionProp=e.options.vertical===!0?"top":"left","top"===e.positionProp?e.$slider.addClass("slick-vertical"):e.$slider.removeClass("slick-vertical"),(void 0!==t.WebkitTransition||void 0!==t.MozTransition||void 0!==t.msTransition)&&e.options.useCSS===!0&&(e.cssTransitions=!0),void 0!==t.OTransform&&(e.animType="OTransform",e.transformType="-o-transform",e.transitionType="OTransition",void 0===t.perspectiveProperty&&void 0===t.webkitPerspective&&(e.animType=!1)),void 0!==t.MozTransform&&(e.animType="MozTransform",e.transformType="-moz-transform",e.transitionType="MozTransition",void 0===t.perspectiveProperty&&void 0===t.MozPerspective&&(e.animType=!1)),void 0!==t.webkitTransform&&(e.animType="webkitTransform",e.transformType="-webkit-transform",e.transitionType="webkitTransition",void 0===t.perspectiveProperty&&void 0===t.webkitPerspective&&(e.animType=!1)),void 0!==t.msTransform&&(e.animType="msTransform",e.transformType="-ms-transform",e.transitionType="msTransition",void 0===t.msTransform&&(e.animType=!1)),void 0!==t.transform&&e.animType!==!1&&(e.animType="transform",e.transformType="transform",e.transitionType="transition"),e.transformsEnabled=null!==e.animType&&e.animType!==!1},t.prototype.setSlideClasses=function(e){var t,n,i,a,s=this;s.$slider.find(".slick-slide").removeClass("slick-active").removeClass("slick-center"),n=s.$slider.find(".slick-slide"),s.options.centerMode===!0?(t=Math.floor(s.options.slidesToShow/2),s.options.infinite===!0&&(e>=t&&s.slideCount-1-t>=e?s.$slides.slice(e-t,e+t+1).addClass("slick-active"):(i=s.options.slidesToShow+e,n.slice(i-t+1,i+t+2).addClass("slick-active")),0===e?n.eq(n.length-1-s.options.slidesToShow).addClass("slick-center"):e===s.slideCount-1&&n.eq(s.options.slidesToShow).addClass("slick-center")),s.$slides.eq(e).addClass("slick-center")):e>=0&&s.slideCount-s.options.slidesToShow>=e?s.$slides.slice(e,e+s.options.slidesToShow).addClass("slick-active"):s.options.slidesToShow>=n.length?n.addClass("slick-active"):(a=s.slideCount%s.options.slidesToShow,i=s.options.infinite===!0?s.options.slidesToShow+e:e,s.options.slidesToShow==s.options.slidesToScroll&&s.options.slidesToShow>s.slideCount-e?n.slice(i-(s.options.slidesToShow-a),i+a).addClass("slick-active"):n.slice(i,i+s.options.slidesToShow).addClass("slick-active")),"ondemand"===s.options.lazyLoad&&s.lazyLoad()},t.prototype.setupInfinite=function(){var t,n,i,a=this;if(a.options.fade===!0&&(a.options.centerMode=!1),a.options.infinite===!0&&a.options.fade===!1&&(n=null,a.slideCount>a.options.slidesToShow)){for(i=a.options.centerMode===!0?a.options.slidesToShow+1:a.options.slidesToShow,t=a.slideCount;t>a.slideCount-i;t-=1)n=t-1,e(a.$slides[n]).clone(!0).attr("id","").attr("index",n-a.slideCount).prependTo(a.$slideTrack).addClass("slick-cloned");for(t=0;i>t;t+=1)n=t,e(a.$slides[n]).clone(!0).attr("id","").attr("index",n+a.slideCount).appendTo(a.$slideTrack).addClass("slick-cloned");a.$slideTrack.find(".slick-cloned").find("[id]").each(function(){e(this).attr("id","")})}},t.prototype.selectHandler=function(t){var n=this,i=parseInt(e(t.target).parents(".slick-slide").attr("index"));return i||(i=0),n.options.slidesToShow>=n.slideCount?(n.$slider.find(".slick-slide").removeClass("slick-active"),n.$slides.eq(i).addClass("slick-active"),n.options.centerMode===!0&&(n.$slider.find(".slick-slide").removeClass("slick-center"),n.$slides.eq(i).addClass("slick-center")),void n.asNavFor(i)):void n.slideHandler(i)},t.prototype.slideHandler=function(e,t,n){var i,a,s,o,r=null,l=this;return t=t||!1,l.animating===!0&&l.options.waitForAnimate===!0||l.options.fade===!0&&l.currentSlide===e||l.options.slidesToShow>=l.slideCount?void 0:(t===!1&&l.asNavFor(e),i=e,r=l.getLeft(i),o=l.getLeft(l.currentSlide),l.currentLeft=null===l.swipeLeft?o:l.swipeLeft,l.options.infinite===!1&&l.options.centerMode===!1&&(0>e||e>l.getDotCount()*l.options.slidesToScroll)?void(l.options.fade===!1&&(i=l.currentSlide,n!==!0?l.animateSlide(o,function(){l.postSlide(i)}):l.postSlide(i))):l.options.infinite===!1&&l.options.centerMode===!0&&(0>e||e>l.slideCount-l.options.slidesToScroll)?void(l.options.fade===!1&&(i=l.currentSlide,n!==!0?l.animateSlide(o,function(){l.postSlide(i)}):l.postSlide(i))):(l.options.autoplay===!0&&clearInterval(l.autoPlayTimer),a=0>i?l.slideCount%l.options.slidesToScroll!==0?l.slideCount-l.slideCount%l.options.slidesToScroll:l.slideCount+i:i>=l.slideCount?l.slideCount%l.options.slidesToScroll!==0?0:i-l.slideCount:i,l.animating=!0,null!==l.options.onBeforeChange&&e!==l.currentSlide&&l.options.onBeforeChange.call(this,l,l.currentSlide,a),s=l.currentSlide,l.currentSlide=a,l.setSlideClasses(l.currentSlide),l.updateDots(),l.updateArrows(),l.options.fade===!0?void(n!==!0?l.fadeSlide(s,a,function(){l.postSlide(a)}):l.postSlide(a)):void(n!==!0?l.animateSlide(r,function(){l.postSlide(a)}):l.postSlide(a))))},t.prototype.startLoad=function(){var e=this;e.options.arrows===!0&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.hide(),e.$nextArrow.hide()),e.options.dots===!0&&e.slideCount>e.options.slidesToShow&&e.$dots.hide(),e.$slider.addClass("slick-loading")},t.prototype.swipeDirection=function(){var e,t,n,i,a=this;return e=a.touchObject.startX-a.touchObject.curX,t=a.touchObject.startY-a.touchObject.curY,n=Math.atan2(t,e),i=Math.round(180*n/Math.PI),0>i&&(i=360-Math.abs(i)),45>=i&&i>=0?a.options.rtl===!1?"left":"right":360>=i&&i>=315?a.options.rtl===!1?"left":"right":i>=135&&225>=i?a.options.rtl===!1?"right":"left":"vertical"},t.prototype.swipeEnd=function(){var e=this;if(e.dragging=!1,e.shouldClick=e.touchObject.swipeLength>10?!1:!0,void 0===e.touchObject.curX)return!1;if(e.touchObject.swipeLength>=e.touchObject.minSwipe)switch(e.swipeDirection()){case"left":e.slideHandler(e.currentSlide+e.getSlideCount()),e.currentDirection=0,e.touchObject={};break;case"right":e.slideHandler(e.currentSlide-e.getSlideCount()),e.currentDirection=1,e.touchObject={}}else e.touchObject.startX!==e.touchObject.curX&&(e.slideHandler(e.currentSlide),e.touchObject={})},t.prototype.swipeHandler=function(e){var t=this;if(!(t.options.swipe===!1||"ontouchend"in document&&t.options.swipe===!1||t.options.draggable===!1&&-1!==e.type.indexOf("mouse")))switch(t.touchObject.fingerCount=e.originalEvent&&void 0!==e.originalEvent.touches?e.originalEvent.touches.length:1,t.touchObject.minSwipe=t.listWidth/t.options.touchThreshold,e.data.action){case"start":t.swipeStart(e);break;case"move":t.swipeMove(e);break;case"end":t.swipeEnd(e)}},t.prototype.swipeMove=function(e){var t,n,i,a,s=this;return a=void 0!==e.originalEvent?e.originalEvent.touches:null,!s.dragging||a&&1!==a.length?!1:(t=s.getLeft(s.currentSlide),s.touchObject.curX=void 0!==a?a[0].pageX:e.clientX,s.touchObject.curY=void 0!==a?a[0].pageY:e.clientY,s.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(s.touchObject.curX-s.touchObject.startX,2))),n=s.swipeDirection(),"vertical"!==n?(void 0!==e.originalEvent&&s.touchObject.swipeLength>4&&e.preventDefault(),i=(s.options.rtl===!1?1:-1)*(s.touchObject.curX>s.touchObject.startX?1:-1),s.swipeLeft=s.options.vertical===!1?t+s.touchObject.swipeLength*i:t+s.touchObject.swipeLength*(s.$list.height()/s.listWidth)*i,s.options.fade===!0||s.options.touchMove===!1?!1:s.animating===!0?(s.swipeLeft=null,!1):void s.setCSS(s.swipeLeft)):void 0)},t.prototype.swipeStart=function(e){var t,n=this;return 1!==n.touchObject.fingerCount||n.options.slidesToShow>=n.slideCount?(n.touchObject={},!1):(void 0!==e.originalEvent&&void 0!==e.originalEvent.touches&&(t=e.originalEvent.touches[0]),n.touchObject.startX=n.touchObject.curX=void 0!==t?t.pageX:e.clientX,n.touchObject.startY=n.touchObject.curY=void 0!==t?t.pageY:e.clientY,void(n.dragging=!0))},t.prototype.unfilterSlides=function(){var e=this;null!==e.$slidesCache&&(e.unload(),e.$slideTrack.children(this.options.slide).detach(),e.$slidesCache.appendTo(e.$slideTrack),e.reinit())},t.prototype.unload=function(){var t=this;e(".slick-cloned",t.$slider).remove(),t.$dots&&t.$dots.remove(),t.$prevArrow&&"object"!=typeof t.options.prevArrow&&t.$prevArrow.remove(),t.$nextArrow&&"object"!=typeof t.options.nextArrow&&t.$nextArrow.remove(),t.$slides.removeClass("slick-slide slick-active slick-visible").css("width","")},t.prototype.updateArrows=function(){var e,t=this;e=Math.floor(t.options.slidesToShow/2),t.options.arrows===!0&&t.options.infinite!==!0&&t.slideCount>t.options.slidesToShow&&(t.$prevArrow.removeClass("slick-disabled"),t.$nextArrow.removeClass("slick-disabled"),0===t.currentSlide?(t.$prevArrow.addClass("slick-disabled"),t.$nextArrow.removeClass("slick-disabled")):t.currentSlide>=t.slideCount-t.options.slidesToShow&&t.options.centerMode===!1?(t.$nextArrow.addClass("slick-disabled"),t.$prevArrow.removeClass("slick-disabled")):t.currentSlide>t.slideCount-t.options.slidesToShow+e&&t.options.centerMode===!0&&(t.$nextArrow.addClass("slick-disabled"),t.$prevArrow.removeClass("slick-disabled")))},t.prototype.updateDots=function(){var e=this;null!==e.$dots&&(e.$dots.find("li").removeClass("slick-active"),e.$dots.find("li").eq(Math.floor(e.currentSlide/e.options.slidesToScroll)).addClass("slick-active"))},e.fn.slick=function(e){var n=this;return n.each(function(n,i){i.slick=new t(i,e)})},e.fn.slickAdd=function(e,t,n){var i=this;return i.each(function(i,a){a.slick.addSlide(e,t,n)})},e.fn.slickCurrentSlide=function(){var e=this;return e.get(0).slick.getCurrent()},e.fn.slickFilter=function(e){var t=this;return t.each(function(t,n){n.slick.filterSlides(e)})},e.fn.slickGoTo=function(e,t){var n=this;return n.each(function(n,i){i.slick.changeSlide({data:{message:"index",index:parseInt(e)}},t)})},e.fn.slickNext=function(){var e=this;return e.each(function(e,t){t.slick.changeSlide({data:{message:"next"}})})},e.fn.slickPause=function(){var e=this;return e.each(function(e,t){t.slick.autoPlayClear(),t.slick.paused=!0})},e.fn.slickPlay=function(){var e=this;return e.each(function(e,t){t.slick.paused=!1,t.slick.autoPlay()})},e.fn.slickPrev=function(){var e=this;return e.each(function(e,t){t.slick.changeSlide({data:{message:"previous"}})})},e.fn.slickRemove=function(e,t){var n=this;return n.each(function(n,i){i.slick.removeSlide(e,t)})},e.fn.slickRemoveAll=function(){var e=this;return e.each(function(e,t){t.slick.removeSlide(null,null,!0)})},e.fn.slickGetOption=function(e){var t=this;return t.get(0).slick.options[e]},e.fn.slickSetOption=function(e,t,n){var i=this;return i.each(function(i,a){a.slick.options[e]=t,n===!0&&(a.slick.unload(),a.slick.reinit())})},e.fn.slickUnfilter=function(){var e=this;return e.each(function(e,t){t.slick.unfilterSlides()})},e.fn.unslick=function(){var e=this;return e.each(function(e,t){t.slick&&t.slick.destroy()})},e.fn.getSlick=function(){var e=null,t=this;return t.each(function(t,n){e=n.slick}),e}}),define("home/views/CarouselView",["jquery","underscore","backbone-marionette","home/templates/suggestions","slick"],function(e,t,n,i){var a=n.CompositeView.extend({template:i,itemViewContainer:"[data-role=cards-container]",ui:{carousel:"[data-role=carousel]",left:"[data-action=scroll-left]",right:"[data-action=scroll-right]"},onCompositeCollectionRendered:function(){this.children.length&&t.defer(t.bind(this.slickify,this))},slickify:function(){var e=Math.min(3,this.children.length);this.$(this.itemViewContainer).slick({infinite:!1,appendArrows:this.ui.carousel,prevArrow:'<div class="carousel-nav left" data-action="scroll-left"></div>',nextArrow:'<div class="carousel-nav right" data-action="scroll-right"></div>',slidesToShow:e,slidesToScroll:e,responsive:[{breakpoint:1024,settings:{slidesToShow:e,slidesToScroll:e}},{breakpoint:768,settings:{slidesToShow:Math.max(e-1,1),slidesToScroll:Math.max(e-1,1)}},{breakpoint:480,settings:{slidesToShow:Math.max(e-2,1),slidesToScroll:Math.max(e-2,1)}}]})}});return a}),define("home/views/BaseSuggestionCardView",["underscore","backbone-marionette","handlebars","home/views/CarouselView","home/mixins/withClickLinkTracking","home/mixins/withSubviews"],function(e,t,n,i,a,s){var o=t.ItemView,r=o.extend({className:"card suggestions",events:{"click a[data-link-name]":"trackClickLink"},hideIfEmpty:function(){this.collection.length||this.$el.hide()},fetchSuggestions:function(){return this.collection.fetch({reset:!0,success:e.bind(this.hideIfEmpty,this)})},regions:{suggestionsRegion:"[data-role=suggestions]"},onRender:function(){this.activateRegion(this.suggestionsRegion,this.createSuggestionsView)},createSuggestionsView:function(){return new i({el:this.suggestionsRegion.el,collection:this.collection,itemView:this.CollectionItemViewClass,itemViewOptions:{className:"carousel-card"}})}}),l=r.prototype;return a.call(l,"carousel_card"),s.call(l),r}),define("home/templates/forumSuggestionCard",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<header class="suggestions-header">\n'+a(t.gettext.call(e,"Recommended Communities",{name:"gettext",hash:{},data:i}))+'\n</header>\n<div class="carousel-wrapper" data-role="suggestions"></div>\n'},useData:!0})}),define("home/views/ForumSuggestionCardView",["underscore","home/collections/RecommendedForumCollection","home/views/BaseSuggestionCardView","home/views/ForumSuggestionView","home/templates/forumSuggestionCard"],function(e,t,n,i,a){var s=n.extend({attributes:{"data-mix-location":"forum suggestion card"},template:a,initialize:function(e){e=e||{},this.collection=new t,this.CollectionItemViewClass=i,n.prototype.initialize.call(this,e)}});return s}),define("home/templates/userSuggestionCard",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"%(channelName)s Creators",{name:"gettext",hash:{channelName:null!=e?e.name:e},data:i}))},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Recommended People",{name:"gettext",hash:{},data:i}))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<header class="suggestions-header">';return a=t["if"].call(e,null!=e?e.name:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s+'</header>\n<div class="carousel-wrapper" data-role="suggestions"></div>\n'},useData:!0})}),define("home/views/UserSuggestionCardView",["underscore","home/collections/RecommendedUserCollection","home/views/BaseSuggestionCardView","home/views/UserSuggestionView","home/templates/userSuggestionCard"],function(e,t,n,i,a){return n.extend({attributes:{"data-mix-location":"user suggestion card"},template:a,initialize:function(e){e=e||{},this.collection=e.collection||new t,this.CollectionItemViewClass=i,n.prototype.initialize.call(this,e)}})}),define("home/templates/homeFeedEmptyCover",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<h3 class="headline">'+a(t.gettext.call(e,"You fed your feed %(happyFace)s",{name:"gettext",hash:{happyFace:t.tag.call(e,"span",{name:"tag",hash:{text:":)","class":"face face-happy"},data:i})},data:i}))+' </h3>\n<p class="description">'+a(t.gettext.call(e,"Refresh to see your newly filled feed.",{name:"gettext",hash:{},data:i}))+"</p>\n"},3:function(e,t,n,i){var a=this.escapeExpression;return'<h3 class="headline">'+a(t.gettext.call(e,"Your feed's empty! %(sadFace)s",{name:"gettext",hash:{sadFace:t.tag.call(e,"span",{name:"tag",hash:{text:":(","class":"face face-sad"},data:i})},data:i}))+' </h3>\n<p class="description">'+a(t.gettext.call(e,"To get the best experience, follow some communities. We recommend these:",{name:"gettext",hash:{},data:i}))+"</p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="cover">\n<div class="cover-message">\n';return a=t["if"].call(e,null!=e?e.numTotalFollowing:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s+"</div>\n</div>\n"},useData:!0})}),define("home/views/HomeFeedEmptyCoverView",["backbone-marionette","home/models/Session","home/templates/homeFeedEmptyCover"],function(e,t,n){var i=e.ItemView.extend({template:n,templateHelpers:function(){var e=!this.model.isAnonymous()&&this.model.user;return{numTotalFollowing:e?e.get("numFollowing")+e.get("numForumsFollowing"):0}},modelEvents:{"change:numFollowing":"render","change:numForumsFollowing":"render","change:id":"render"}});return i}),define("home/templates/homeFeedEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div data-role="cover-area"></div>\n<header class="nav-tabs-container">\n<ul class="nav-tabs">\n<li class="active" data-action="switch-tab" data-tab="forums">\n<a href="#"><span class="text-wide">'+a(t.gettext.call(e,"Communities",{name:"gettext",hash:{},data:i}))+'</span></a>\n</li>\n<li data-action="switch-tab" data-tab="people">\n<a href="#">'+a(t.gettext.call(e,"People",{name:"gettext",hash:{},data:i}))+'</a>\n</li>\n</ul>\n</header>\n<div data-role="content-area"></div>\n'},useData:!0})}),define("home/views/HomeFeedEmptyView",["jquery","underscore","home/views/common/TabbedView","home/views/HomeFeedEmptyCoverView","home/views/ForumSuggestionCardView","home/views/UserSuggestionCardView","home/models/Session","home/templates/homeFeedEmpty"],function(e,t,n,i,a,s,o,r){var l=n.extend({className:"home-empty",defaultTab:"forums",template:r,regions:t.defaults({coverRegion:"[data-role=cover-area]"},n.prototype.regions),onDomRefresh:function(){this.$(this.coverRegion.el).length&&this.coverRegion.show(new i({model:o.get()})),n.prototype.onDomRefresh.apply(this,arguments),this.trigger("toggleHeight","content")},getTabView:function(e){var t;switch(e){case"forums":t=new a;break;case"people":t=new s;break;default:return}return t.fetchSuggestions(),t}});return l}),define("home/views/HomeCardCollectionView",["jquery","underscore","home/utils/layoutUtils","home/utils/mixpanelUtils","home/views/ActivityCardCollectionView","home/views/ForumSuggestionCardView","home/views/UserSuggestionCardView","home/views/HomeFeedEmptyView"],function(e,t,n,i,a,s,o,r){var l=a.extend({emptyView:r,attributes:{"data-mix-location":"home"},initialize:function(){a.prototype.initialize.apply(this,arguments),this.listenTo(this,"after:item:added",this.onShowCard)},onClose:function(){this.handleOnScroll&&t.each(this.handleOnScroll,function(t){e(window).off("scroll",t)})},onShowCard:function(){var e=this.insertionPoint=this.insertionPoint||Math.floor(.75*this.collection.length);this.forumSuggestionCardView||this.children.length!==e||(this.forumSuggestionCardView=this.insertSuggestionCard(s)),this.userSuggestionCardView||this.children.length!==2*e||(this.userSuggestionCardView=this.insertSuggestionCard(o))},insertSuggestionCard:function(n){var i=this.addItemView(this.model,n);i.fetchSuggestions(),this.handleOnScroll||(this.handleOnScroll={});var a=t.debounce(t.bind(this.trackViewSuggestionCard,this,i),200);return this.handleOnScroll[i.cid]=a,e(window).scroll(a),i},trackViewSuggestionCard:function(t){if(n.isElementInViewport(t.$el)){i.track("view infeed suggestion",{target:t.$el});var a=this.handleOnScroll[t.cid];e(window).off("scroll",a)}}});return l}),define("home/templates/unreadCount",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Show One New Item",{name:"gettext",hash:{},data:i}))+"\n"},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Show %(x)s New Items",{name:"gettext",hash:{x:null!=e?e.numUnread:e},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<button class="button button-wide button-inverted button-inverted-fill text-medium">\n';return a=t["if"].call(e,t.eq.call(e,null!=e?e.numUnread:e,1,{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),s+"</button>\n"},useData:!0})}),define("home/views/UnreadCountView",["backbone-marionette","home/templates/unreadCount"],function(e,t){var n=e.ItemView,i=n.prototype;return n.extend({className:"feed-new",events:{click:"handleAddUnread"},handleAddUnread:function(){this.collection.addUnread(),this.close()},template:t,serializeData:function(){return{numUnread:this.collection.unreadQueue.length}},render:function(){return this.serializeData().numUnread<=0?this:i.render.call(this)}})}),define("home/templates/fetchableCollectionLayout",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div data-role="header-area"></div>\n<div data-role="content-area"></div>\n<div data-role="footer-area"></div>\n'},useData:!0})}),define("home/views/common/FetchableCollectionLayout",["underscore","backbone-marionette","home/views/common/FetchableCollectionView","home/views/common/FetchableCollectionFooterView","home/views/FetchingView","home/views/UnreadCountView","home/templates/fetchableCollectionLayout"],function(e,t,n,i,a,s,o){var r=t.Layout.extend({itemViewEventPrefix:"collectionview",template:o,regions:{headerRegion:"[data-role=header-area]",contentRegion:"[data-role=content-area]",footerRegion:"[data-role=footer-area]"},fetchableCollectionFooterView:i,initialize:function(e){if(e.fetchableCollectionView&&(this.fetchableCollectionView=e.fetchableCollectionView),!this.fetchableCollectionView||!(this.fetchableCollectionView===n||this.fetchableCollectionView.prototype instanceof n))throw Error("A FetchableCollectionLayout must define a fetchableCollectionView");if(e.fetchableCollectionFooterView&&(this.fetchableCollectionFooterView=e.fetchableCollectionFooterView),!this.contentRegion||!this.footerRegion)throw Error("A template for a FetchableCollectionLayout must define a content region and a footer region");this.listenTo(this.collection,"unreadItemsReady",this.updateHeader),this.options=e},updateHeader:function(){var e=new s({collection:this.collection});this.headerRegion.show(e)},onDomRefresh:function(){this.contentRegion.currentView&&this.stopListening(this.contentRegion.currentView);var n=new this.fetchableCollectionView(e.clone(this.options)),i=n.collection;i.updateUnreadCount&&i.updateUnreadCount(),n.listenable.ensureFetched&&n.listenable.ensureFetched(),t.CollectionView.prototype.addChildViewEventForwarding.call(this,n),this.contentRegion.show(new a),e.defer(e.bind(function(){this.isClosed||(this.contentRegion.show(n),this.trigger("showCollection",n),this.footerRegion.show(new this.fetchableCollectionFooterView({model:this.model,collection:this.collection})))},this))},getItemEvents:t.CollectionView.prototype.getItemEvents});return r}),define("home/templates/commentCardPostActions",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" active"},3:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.likes:e,e))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="#" class="vote-up';return a=t["if"].call(e,null!=e?e.sessionUserHasUpvoted:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='" data-action="vote" data-vote="1">\n<span class="vote__count text-gray text-small" data-role="upvotes">\n',a=t["if"].call(e,null!=e?e.likes:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='\n</span>\n<span class="icon-arrow-up icon-tiny"></span>\n</a>\n\n<a href="#" class="vote-down',a=t["if"].call(e,null!=e?e.sessionUserHasDownvoted:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='" data-action="vote" data-vote="-1">\n<span class="icon-arrow-down icon-tiny"></span>\n</a>\n\n',a=this.invokePartial(n.replyOrEditLink,"","replyOrEditLink",e,void 0,t,n,i),null!=a&&(r+=a),r+'\n<a href="'+o(s(null!=e?e.discussionRoute:e,e))+"#comment-"+o(s(null!=e?e.id:e,e))+'"\nclass="view-comment link-gray"\ndata-link-name="view_comment"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n\n<span class="visible-md">'+o(t.gettext.call(e,"View",{name:"gettext",hash:{},data:i}))+'</span>\n<span class="hidden-md">'+o(t.gettext.call(e,"View in discussion",{name:"gettext",hash:{},data:i}))+"</span>\n</a>\n"},usePartial:!0,useData:!0})}),define("home/views/CommentCardPostActionsView",["jquery","home/views/PostActionsView","home/templates/commentCardPostActions"],function(e,t,n){var i=t.extend({template:n,initializeReplyViewManager:e.noop,toggleReplyView:e.noop});return i}),define("home/templates/commentCard",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="card-comment comment-card__wrap">\n<div\nclass="card-link__wrapper ';return a=t.unless.call(e,null!=e?e.image:e,{name:"unless",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+=' align"\ndata-role="thread-link"\ndata-link-name="thread_preview"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n\n',a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<div class="card-link__body">\n<div>\n<div class="truncate" data-truncate-lines="2" dir="auto">\n<h3 class="text-large">'+o(s(null!=(a=null!=e?e.thread:e)?a.clean_title:a,e))+"</h3>\n</div>\n</div>\n",a=t["if"].call(e,null!=e?e.threadDescription:e,{name:"if",hash:{},fn:this.program(6,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'</div>\n</div>\n<div data-role="posts" class="card-link__comments"></div>\n<button class="comment-card__more text-small pull-right">\n<span class="text-mobile">'+o(t.gettext.call(e,"Less",{name:"gettext",hash:{},data:i}))+'</span>\n<span class="text-desktop">'+o(t.gettext.call(e,"Less Information",{name:"gettext",hash:{},data:i}))+"</span>\n</button>\n</div>\n"},2:function(){return" no-image"},4:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<img class="card-link__img" src="'+i(n(null!=(t=null!=e?e.image:e)?t.src:t,e))+'" alt="'+i(n(null!=(t=null!=e?e.image:e)?t.title:t,e))+'">\n'},6:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div>\n<div class="card-link__description truncate" data-truncate-lines="2" dir="auto">\n'+o(s(null!=e?e.threadDescription:e,e))+"\n</div>\n</div>\n";return a=t["if"].call(e,null!=e?e.forumFriendlyUrl:e,{name:"if",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r},7:function(e){var t=this.lambda,n=this.escapeExpression;return'<div class="card-link-forum-url">('+n(t(null!=e?e.forumFriendlyUrl:e,e))+")</div>\n"},9:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="card-comment comment-card__wrap">\n<div class="comment-body">\n<div class="comment-header comment-card__header text-small text-gray">\n';return a=t["with"].call(e,null!=e?e.postActivity:e,{name:"with",hash:{},fn:this.program(10,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<time class="time">'+o(s(null!=e?e.relativeTime:e,e))+'</time>\n</div>\n<div class="comment-card__title link-gray text-small">\n<strong class="link-gray-dark">\n',a=this.invokePartial(n.channelAwareForumLink,"","channelAwareForumLink",null!=e?e.thread:e,void 0,t,n,i),null!=a&&(r+=a),r+='</strong>\n<span class="bullet"></span>\n<span class="truncate" data-truncate-lines="2" dir="auto">\n',a=this.invokePartial(n.threadLink,"","threadLink",e,void 0,t,n,i),null!=a&&(r+=a),r+='</span>\n</div>\n<div class="card-content__summary">\n<div class="truncate" data-truncate-lines="30" data-role="message">\n',a=s(null!=(a=null!=(a=null!=e?e.postActivity:e)?a.object:a)?a.message:a,e),null!=a&&(r+=a),r+'\n</div>\n</div>\n<div class="card-comment-action comment-card__action" data-role="actions"></div>\n</div>\n<button class="comment-card__more text-gray-light text-small pull-right">\n<span class="text-mobile">'+o(t.gettext.call(e,"More",{name:"gettext",hash:{},data:i}))+'</span>\n<span class="text-desktop">'+o(t.gettext.call(e,"More Information",{name:"gettext",hash:{},data:i}))+"</span>\n</button>\n\n</div>\n"
},10:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.userPreview,"","userPreview",null!=e?e.actor:e,void 0,t,n,i),null!=a&&(s+=a),a=t["if"].call(e,t.eq.call(e,null!=e?e.verb:e,"reply",{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(11,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},11:function(e,t,n,i){var a,s='<span class="icon-forward"></span>\n<span class="link-gray">';return a=this.invokePartial(n.userName,"","userName",null!=(a=null!=e?e.target:e)?a.author:a,void 0,t,n,i),null!=a&&(s+=a),s+"</span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.expanded:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(9,i),data:i}),null!=a&&(s+=a),s},usePartial:!0,useData:!0})}),define("home/views/CommentCardView",["jquery","underscore","backbone","core/mixins/withRichMedia","home/utils/navigationUtils","home/mixins/withSubviews","home/mixins/withTruncate","home/views/common/ActivityCardView","home/views/CommentCardPostActionsView","home/views/PostActivityCollectionView","home/templates/commentCard"],function(e,t,n,i,a,s,o,r,l,c,d){var u=r.extend({className:"card-wrap is-expandable",template:d,templateHelpers:function(){var e=this.getPostActivity();return{expanded:this.expanded,discussionRoute:this.model.thread.getDiscussionRoute(),postActivity:e.toJSON(),relativeTime:e.getRelativeCreatedAt(),forumFriendlyUrl:this.model.thread.forum.getFriendlyUrl(),threadDescription:this.model.thread.getPlainDescription(),image:this.model.thread.getImage()}},regions:{actionsRegion:"[data-role=actions]",postsRegion:"[data-role=posts]"},events:{click:"handleClick",mouseover:"beginHover",mouseout:"endHover","mouseover a":"endHover","mouseout a":"beginHover","mouseover [data-role=thread-link]":"endHover","mouseout [data-role=thread-link]":"beginHover"},initialize:function(){this.boundRenderPostMedia=t.bind(this.renderPostMedia,this)},onRender:function(){this.activateRegion(this.actionsRegion,this.createDefaultActionsView),this.expanded?this.activateRegion(this.postsRegion,this.createPostCollectionView):this._isShown?this.boundRenderPostMedia():this.listenToOnce(this,"truncate:complete",this.boundRenderPostMedia)},renderPostMedia:function(){var e=this.getPostActivity().object;this.renderRichMedia(e.get("media"))},getPostActivity:function(){return this.model.activities[0]},createDefaultActionsView:function(){return new l({model:this.getPostActivity().object})},createPostCollectionView:function(){return new c({el:this.postsRegion.el,collection:new n.Collection(this.model.activities),collapsePosts:!1})},handleClick:function(t){return e(t.target).closest("[data-role=thread-link]").length?(a.navigate(this.model.thread.getDiscussionRoute(),{trigger:!0}),!1):void this.toggleExpanded(t)},toggleExpanded:function(n){e(n.target).closest("a, form",this.$el).length||(this.expanded=!this.expanded,this.render(),t.delay(t.bind(this.checkHovered,this)))},checkHovered:function(){var e=this.$el.is(":hover")&&!this.$el.find("a:hover").length&&!this.$el.find("[data-role=thread-link]:hover").length;this.$el.toggleClass("is-hovered",e)},beginHover:function(t){var n=e(t.target);n.closest("a",this.$el).length||n.closest("[data-role=thread-link]",this.$el).length||this.$el.addClass("is-hovered")},endHover:function(){this.$el.removeClass("is-hovered")}});return o.call(u.prototype),s.call(u.prototype),i.call(u.prototype),u}),define("home/views/CommentCardCollectionView",["home/views/ActivityCardCollectionView","home/views/CommentCardView"],function(e,t){var n=e.extend({itemView:t});return n}),define("home/mixins/withExpiration",["underscore","modernizr"],function(e,t){var n=t.localstorage,i={templateHelpers:function(t){return e.isFunction(t)&&(t=t.call(this)),e.extend({viewExpired:!n||this.getRemainingViews()<=0},t)},events:{"click [data-action=force-expiration]":"forceExpire"},onShow:function(t){e.isFunction(t)&&t.call(this),this.decrementRemainingViews()},forceExpire:function(e){e&&e.preventDefault(),this.setRemainingViews(-1),this.remove()},decrementRemainingViews:e.once(function(){var e=this.getRemainingViews();e>0&&this.setRemainingViews(e-1)}),getRemainingViews:function(){if(n){var e=parseInt(localStorage.getItem(this.getExpirationKey()),10);if(!isNaN(e))return e}return this.getNumberOfViews()},getNumberOfViews:function(){return this.defaultViews||5},setRemainingViews:function(e){n&&localStorage.setItem(this.getExpirationKey(),e)},getExpirationKey:function(){return e.result(this,"expirationKey")}};return function(){this.templateHelpers=e.wrap(this.templateHelpers,i.templateHelpers),this.onShow=e.wrap(this.onShow,i.onShow),this.events=e.defaults({},this.events,i.events),e.extend(this,e.pick(i,"forceExpire","decrementRemainingViews","getRemainingViews","getNumberOfViews","setRemainingViews","getExpirationKey"))}}),define("home/templates/homepageWelcomeMessage",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="aside__wrap aside-inverted">\n<div class="aside-inverted__content text-center">\n';return a=t.unless.call(e,null!=e?e.isLoggedOut:e,{name:"unless",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='<img src="'+s(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/welcome-banner-graphic.png" width="170" height="93" />\n',a=t["if"].call(e,null!=e?e.isLoggedOut:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.program(6,i),data:i}),null!=a&&(o+=a),o+'<p>\n<button class="button button-inverted text-small button-semi-wide" data-action="show-tour">\n<strong>'+s(t.gettext.call(e,"Take a Tour",{name:"gettext",hash:{},data:i}))+"</strong>\n</button>\n</p>\n</div>\n</div>\n"},2:function(e,t,n,i){var a=this.escapeExpression;return'<button class="text-smaller aside-inverted__close"\naria-hidden="true"\ntitle="'+a(t.gettext.call(e,"Don't show this message again",{name:"gettext",hash:{},data:i}))+'"\ndata-action="force-expiration">\n<span class="icon-cancel"></span>\n</button>\n'},4:function(e,t,n,i){var a=this.escapeExpression;return'<h2 class="text-large">'+a(t.gettext.call(e,"Welcome!",{name:"gettext",hash:{},data:i}))+"</h2>\n<p>"+a(t.gettext.call(e,"Discover great discussions or create your own.",{name:"gettext",hash:{},data:i}))+"</p>\n"},6:function(e,t,n,i){var a=this.escapeExpression;return'<h2 class="text-large">'+a(t.gettext.call(e,"New Stuff!",{name:"gettext",hash:{},data:i}))+"</h2>\n<p>"+a(t.gettext.call(e,"We've made big changes we think you'll like.",{name:"gettext",hash:{},data:i}))+"</p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t.unless.call(e,null!=e?e.viewExpired:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},useData:!0})}),define("home/views/HomepageWelcomeMessageView",["jquery","underscore","backbone-marionette","home/mixins/withExpiration","home/models/Session","home/templates/homepageWelcomeMessage"],function(e,t,n,i,a,s){var o=n.ItemView.extend({expirationKey:"homepageWelcomeTourRemaining",template:s,templateHelpers:function(){var e=this.session.isKnownToBeLoggedOut(),t={isLoggedOut:e};return e&&(t.viewExpired=!1),t},initialize:function(){this.session=a.get(),this.session.isKnownToBeLoggedOut()&&(this.decrementRemainingViews=e.noop)}});return i.call(o.prototype),o}),define("home/templates/homepageUserModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.userAvatar,"","userAvatar",e,void 0,t,n,i),null!=a&&(s+=a),s},3:function(e,t,n,i){var a=this.escapeExpression;return'<a href="/home/settings/profile/" class="avatar avatar__add button-outline text-semibold">\n<span class="icon-plus"></span>'+a(t.gettext.call(e,"Avatar",{name:"gettext",hash:{},data:i}))+"\n</a>\n"},5:function(e,t,n,i){var a=this.escapeExpression;return'<a href="/home/settings/profile/" class="button -small -wide button-outline spacing-left spacing-right">\n'+a(t.gettext.call(e,"Complete your profile",{name:"gettext",hash:{},data:i}))+"\n</a>\n"},7:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="align__item">\n<a href="/by/'+o(s(null!=e?e.username:e,e))+'/" class="link-gray-darker" data-link-name="comment_count">\n';return a=t.unless.call(e,t.eq.call(e,null!=e?e.numPosts:e,1,{name:"eq",hash:{},data:i}),{name:"unless",hash:{},fn:this.program(8,i),inverse:this.program(10,i),data:i}),null!=a&&(r+=a),r+='</a>\n</div>\n<div class="align__item">\n<a href="/by/'+o(s(null!=e?e.username:e,e))+'/following/" class="link-gray-darker" data-link-name="following_count">\n'+o(t.gettext.call(e,"%(num)s Following",{name:"gettext",hash:{num:t.tag.call(e,"h3",{name:"tag",hash:{text:null!=e?e.numTotalFollowing:e,"class":"text-medium"},data:i})},data:i}))+'\n</a>\n</div>\n<div class="align__item">\n<a href="/by/'+o(s(null!=e?e.username:e,e))+'/followers/" class="link-gray-darker" data-link-name="followers_count">\n',a=t.unless.call(e,t.eq.call(e,null!=e?e.numFollowers:e,1,{name:"eq",hash:{},data:i}),{name:"unless",hash:{},fn:this.program(12,i),inverse:this.program(14,i),data:i}),null!=a&&(r+=a),r+"</a>\n</div>\n"},8:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"%(num)s Comments",{name:"gettext",hash:{num:t.tag.call(e,"h3",{name:"tag",hash:{text:null!=e?e.numPosts:e,"class":"text-medium"},data:i})},data:i}))+"\n"},10:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"%(num)s Comment",{name:"gettext",hash:{num:t.tag.call(e,"h3",{name:"tag",hash:{text:"1","class":"text-medium"},data:i})},data:i}))+"\n"},12:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"%(num)s Followers",{name:"gettext",hash:{num:t.tag.call(e,"h3",{name:"tag",hash:{text:null!=e?e.numFollowers:e,"class":"text-medium"},data:i})},data:i}))+"\n"},14:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"%(num)s Follower",{name:"gettext",hash:{num:t.tag.call(e,"h3",{name:"tag",hash:{text:"1","class":"text-medium"},data:i})},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="aside-user__header">\n<div class="avatar-circle-bg__wrapper">\n<div class="avatar-circle-bg">\n<div class="avatar-circle-bg">\n<div class="avatar-circle-bg">\n<div class="avatar-circle-bg">\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class="aside-user__avatar align align--column">\n';return a=t["if"].call(e,null!=(a=null!=e?e.avatar:e)?a.isCustom:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(s+=a),a=this.invokePartial(n.userName,"","userName",e,void 0,t,n,i),null!=a&&(s+=a),s+='</div>\n<div class="aside-user__body align">\n',a=t["if"].call(e,null!=e?e.promptForProfileCompletion:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.program(7,i),data:i}),null!=a&&(s+=a),s+"</div>\n"},usePartial:!0,useData:!0})}),define("home/views/HomepageUserModuleView",["underscore","backbone-marionette","home/templates/homepageUserModule"],function(e,t,n){var i=t.ItemView.extend({template:n,className:"aside__wrap",templateHelpers:function(){return{numTotalFollowing:this.model.getNumTotalFollowing(),promptForProfileCompletion:this.shouldPromptForProfileCompletion()}},shouldPromptForProfileCompletion:function(){var t=this.model.get("avatar").isCustom&&e.chain(this.model.attributes).pick(["name","about","url","location"]).every().value();return this.model.registeredToday()&&!t},modelEvents:{"change:numChannelsFollowing":"render"}});return i}),define("home/templates/homepageCommentsModuleEmptyView",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="post-comments__wrapper">\n<div class="empty-message post-comments">\n<span class="icon-empty-comment text-gray-light icon-huge"></span>\n<p>'+a(t.gettext.call(e,"Follow other %(disqus)s users to see their latest comments appear here.",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+'</p>\n<p><a href="/home/channels/explore/">'+a(t.gettext.call(e,"Find interesting users to follow",{name:"gettext",hash:{},data:i}))+"</a></p>\n</div>\n</div>\n"},useData:!0})}),define("home/views/HomepageCommentsModuleEmptyView",["backbone-marionette","home/templates/homepageCommentsModuleEmptyView"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/templates/homepageCommentsModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<header class="module-header text-center">\n<div class="module-header__icon">\n<span class="icon icon-latest-comments text-brand"></span>\n</div>\n<div class="module-header__title">\n<h2 class="module-header__heading">'+a(t.gettext.call(e,"Latest Comments",{name:"gettext",hash:{},data:i}))+'</h2>\n<p class="module-header__subheading">'+a(t.gettext.call(e,"Comments by people you follow and replies to you.",{name:"gettext",hash:{},data:i}))+'</p>\n</div>\n</header>\n\n<div data-role="posts" class="module-body"></div>\n\n<footer data-action="switch-tab" data-tab="comments" class="module-footer">\n<a href="/home/comments/" class="nav-lnk -color-muted -flushed">\n<div class="nav-lnk__blk">'+a(t.gettext.call(e,"See All Comments",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</footer>\n'},useData:!0})}),define("home/views/HomepageCommentsModuleView",["backbone-marionette","home/views/ChannelCardPostView","home/views/FetchingView","home/views/HomepageCommentsModuleEmptyView","home/templates/homepageCommentsModule"],function(e,t,n,i,a){var s=e.CompositeView.extend({template:a,className:"aside__wrap -padded",emptyView:function(){return new n({className:"spinner-small"})},itemView:t,itemViewContainer:"[data-role=posts]",initialize:function(e){e=e||{},this.commentsPromise=e.commentsPromise},itemViewOptions:function(e,t){return t>2?{className:"hidden"}:void 0},onDomRefresh:function(){if(this.commentsPromise){var e=this;this.commentsPromise.then(function(){0===e.collection.length&&e.createEmptyView()})}},createEmptyView:function(){this._emptyViewCreated||(this.emptyView=i,this.render(),this._emptyViewCreated=!0)}});return s}),define("home/templates/channelsModuleItem",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<img src="'+i(n(null!=(t=null!=e?e.options:e)?t.tile:t,e))+'" class="tile__media" />\n'},3:function(e){var t=this.lambda,n=this.escapeExpression;return'<div class="tile__overlay">\n<h1 class="tile__name">'+n(t(null!=e?e.name:e,e))+'</h1>\n</div>\n<img src="https://media.disquscdn.com/home/blank_tile.png"\nclass="tile__media" />\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="spacing-bottom-large">\n<a href="/home/channel/'+o(s(null!=e?e.slug:e,e))+'/" class="tile__wrapper -plain link-gray-dark" data-mix-location="tile">\n';return a=t["if"].call(e,null!=(a=null!=e?e.options:e)?a.tile:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+'</a>\n<div class="channels-subheading">\n<div class="channels-subheading__description text-gray-dark text-medium">\n<p>'+o(s(null!=(a=null!=e?e.options:e)?a.description:a,e))+'</p>\n</div>\n<div class="channels-subheading__action -visit">\n<div class="channels-subheading__button">\n<a class="button button-outline text-medium" data-mix-location="visit button"\nhref="/home/channel/'+o(s(null!=e?e.slug:e,e))+'/">\n'+o(t.gettext.call(e,"Visit",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n</div>\n</div>\n</div>\n"},useData:!0})}),define("home/views/ChannelsModuleItemView",["backbone-marionette","home/templates/channelsModuleItem"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/templates/channelsModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="module--plain" data-mix-location="channel module">\n<header class="module-header -no-border">\n';return a=this.invokePartial(n.channelsModuleHeader,"","channelsModuleHeader",e,void 0,t,n,i),null!=a&&(s+=a),s+'</header>\n<div data-role="channels" class="module-body"></div>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/ChannelsModuleView",["underscore","backbone-marionette","home/views/FetchingView","home/views/ChannelsModuleItemView","home/templates/channelsModule"],function(e,t,n,i,a){var s=t.CompositeView.extend({template:a,itemView:i,itemViewContainer:"[data-role=channels]",itemViewOptions:function(e){return{model:e.channel||e}},addItemView:function(e,n,i){return i>this.constructor.CHANNELS_MAX-1?void 0:t.CompositeView.prototype.addItemView.call(this,e,n,i)},emptyView:function(){return new n({className:"spinner-small"})}},{CHANNELS_MAX:3});return s}),define("home/templates/channelSuggestion",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.channelAvatarWithDefault,"","channelAvatarWithDefault",e,void 0,t,n,i),null!=a&&(s+=a),s},3:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<img class="forum-favicon" src="'+o(s(null!=e?e.favicon:e,e))+'" alt="';return a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+'">\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="recommended__item">\n<a href="/home/channel/'+o(s(null!=e?e.slug:e,e))+'/"\nclass="avatar"\ndata-link-name="channel_avatar"\ndata-channel-slug="'+o(s(null!=e?e.slug:e,e))+'">\n';return a=t["if"].call(e,null!=e?e.channel:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+='</a>\n<h3 class="recommended__name truncate-line">\n<a href="/home/channel/'+o(s(null!=e?e.slug:e,e))+'/"\ndata-link-name="channel_name"\ndata-channel-slug="'+o(s(null!=e?e.slug:e,e))+'">\n\n',a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+="</a>\n</h3>\n",a=this.invokePartial(n.genericFollowButton,"","genericFollowButton",null!=e?e.primaryForum:e,void 0,t,n,i),null!=a&&(r+=a),r+'</div>\n<div class="recommended__reason"><em>'+o(s(null!=(a=null!=e?e.options:e)?a.description:a,e))+"</em></div>\n"},usePartial:!0,useData:!0})}),define("home/views/ChannelSuggestionView",["backbone-marionette","home/mixins/withChannelAvatar","home/mixins/withChannelFollowing","home/templates/channelSuggestion"],function(e,t,n,i){var a=e.ItemView.extend({template:i,className:"recommended__item",templateHelpers:function(){return{favicon:this.model.get("options").favicon||this.model.primaryForum.get("favicon").cache}}});return n.call(a.prototype,function(){return this.model}),t.call(a.prototype),a}),define("home/templates/homepageChannelsModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div data-mix-location="channel module">\n<header class="module-header">\n';return a=this.invokePartial(n.channelsModuleHeader,"","channelsModuleHeader",e,void 0,t,n,i),null!=a&&(s+=a),s+='</header>\n<div data-role="channels" class="module-body"></div>\n',a=this.invokePartial(n.channelsModuleMoreFooter,"","channelsModuleMoreFooter",e,void 0,t,n,i),null!=a&&(s+=a),s+"</div>\n"},usePartial:!0,useData:!0})}),define("home/views/HomepageChannelsModuleView",["underscore","core/strings","home/views/ChannelsModuleView","home/views/ChannelSuggestionView","home/templates/homepageChannelsModule"],function(e,t,n,i,a){var s=t.get,o=n.extend({className:"aside__wrap -padded",template:a,templateHelpers:{moduleTitle:s("Lively Channels")},itemView:i,itemViewOptions:function(t,i){var a=n.prototype.itemViewOptions;return e.isFunction(a)&&(a=a.call(this,t,i)),e.defaults({className:"recommended-wrap"},a)}});return o}),define("home/templates/homepageOnboardingModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="alert -brand -padded">\n<p class="spacing-bottom text-bold">'+a(t.gettext.call(e,"Discussions from channels and people you follow will appear here on your homepage.",{name:"gettext",hash:{},data:i}))+'</p>\n<button data-role="hide-onboarding" class="button button-inverted text-medium spacing-right-small">'+a(t.gettext.call(e,"Got it!",{name:"gettext",hash:{},data:i}))+'</button>\n<a data-role="complete-onboarding" href="/home/explore/" class="button button-inverted text-medium link-inverted"><span class="hidden-md">'+a(t.gettext.call(e,"Explore more channels and discussions",{name:"gettext",hash:{},data:i}))+'</span><span class="visible-md">'+a(t.gettext.call(e,"Explore more discussions",{name:"gettext",hash:{},data:i}))+"</span></a>\n</div>\n"},useData:!0})}),define("home/views/HomepageOnboardingModuleView",["backbone-marionette","home/models/Session","home/templates/homepageOnboardingModule"],function(e,t,n){var i=e.ItemView.extend({template:n,events:{"click [data-role=complete-onboarding]":"markOnboardingComplete","click [data-role=hide-onboarding]":"hideOnboarding"},markOnboardingComplete:function(){var e=t.get(),n=e.user;n.updateFlags({homeFeedOnboardingComplete:!0})},hideOnboarding:function(){this.markOnboardingComplete(),this.trigger("hideOnboarding")}});return i}),define("home/templates/moderatedForumsModuleItem",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="recommended-wrap">\n<div data-role="recommended-object">\n<div class="recommended__item">\n';return a=this.invokePartial(n.forumAvatarLink,"","forumAvatarLink",e,void 0,t,n,i),null!=a&&(r+=a),r+'<h3 class="recommended__name truncate-line spacing-top-narrow">\n<a href="/home/forums/'+o(s(null!=e?e.id:e,e))+'">'+o(s(null!=e?e.name:e,e))+'</a>\n</h3>\n<a href="https://'+o(s(null!=e?e.id:e,e))+'.disqus.com/admin/" class="button button-outline pull-right">'+o(t.gettext.call(e,"Manage",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/ModeratedForumsModuleItemView",["backbone-marionette","home/templates/moderatedForumsModuleItem"],function(e,t){var n=e.ItemView.extend({template:t,initialize:function(){this.model.shouldFetch()&&this.model.fetch(),this.listenTo(this.model,"sync",this.render)}});return n}),define("home/templates/moderatedForumsModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<footer class="module-footer">\n<a href="/admin/" class="nav-lnk -color-muted -flushed">\n<div class="nav-lnk__blk">'+a(t.gettext.call(e,"Manage All",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</footer>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="module--aside">\n<div class="aside__wrap -padded">\n<header class="module-header -has-button">\n<div class="module-header__title">\n<h2 class="module-header__heading pull-left spacing-top-narrow">\n'+s(t.gettext.call(e,"Your Sites",{name:"gettext",hash:{},data:i}))+'\n<span class="text-gray">('+s(o(null!=e?e.moderatedForumsCount:e,e))+')</span>\n</h2>\n<a href="/admin/" class="button button-outline pull-right module-header__button">'+s(t.gettext.call(e,"View Admin",{name:"gettext",hash:{},data:i}))+'</a>\n</div>\n</header>\n<div data-role="moderated-forums" class="module-body"></div>\n';return a=t.unless.call(e,t.eq.call(e,null!=e?e.moderatedForumsCount:e,1,{name:"eq",hash:{},data:i}),{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+"</div>\n</div>\n"},useData:!0})}),define("home/views/ModeratedForumsModuleView",["underscore","backbone-marionette","home/models/Forum","home/views/FetchingView","home/views/ModeratedForumsModuleItemView","home/templates/moderatedForumsModule"],function(e,t,n,i,a,s){var o=t.CompositeView.extend({template:s,itemView:a,itemViewContainer:"[data-role=moderated-forums]",templateHelpers:function(){return{moderatedForumsCount:this.collection.length}},addItemView:function(e,n,i){return i>this.constructor.FORUMS_MAX-1?void 0:t.CompositeView.prototype.addItemView.call(this,e,n,i)},emptyView:function(){return new i({className:"spinner-small"})}},{FORUMS_MAX:3});return o}),define("home/templates/followingCard",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.channelAvatarWithDefault,"","channelAvatarWithDefault",e,void 0,t,n,i),null!=a&&(s+=a),s},3:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.forumAvatar,"","forumAvatar",e,void 0,t,n,i),null!=a&&(s+=a),s},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a class="aside-list__blk align link-gray-blue"\nhref="/home/forum/'+o(s(null!=e?e.id:e,e))+'/"\ndata-link-name="forum_name"\ndata-forum-pk="'+o(s(null!=e?e.pk:e,e))+'">\n\n<div class="align__item avatar">\n';return a=t["if"].call(e,null!=e?e.channel:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+='</div>\n<div class="align__item aside-list__name">\n<strong>',a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+"</strong>\n</div>\n</a>\n"},usePartial:!0,useData:!0})}),define("home/views/FollowingCardView",["backbone-marionette","home/utils/mixpanelUtils","home/mixins/withChannelAvatar","home/templates/followingCard"],function(e,t,n,i){var a=e.ItemView.extend({template:i,className:"aside-list__item"});return n.call(a.prototype,function(){return this.model.channel}),a}),define("home/templates/homepageFollowingModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression,s=this.lambda;return'<div class="aside__subheadings">\n<h2 class="text-subheading">'+a(t.gettext.call(e,"Following",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<div class="aside__wrap">\n<div data-role="forums"></div>\n<a href="/by/'+a(s(null!=e?e.sessionUsername:e,e))+'/following/sites/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">'+a(t.gettext.call(e,"See All Following",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</div>\n'},useData:!0})}),define("home/views/HomepageFollowingModuleView",["backbone-marionette","home/models/Session","home/views/FollowingCardView","home/templates/homepageFollowingModule"],function(e,t,n,i){var a=e.CompositeView.extend({template:i,templateHelpers:function(){return{sessionUsername:this.session._fromCookie().username}},itemViewContainer:"[data-role=forums]",itemView:n,addItemView:function(t,n,i){return i>4?void 0:e.CompositeView.prototype.addItemView.call(this,t,n,i)},initialize:function(){this.session=t.get()}});return a}),define("home/templates/homepageFeedEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.lambda,s=this.escapeExpression;return'<div class="card--empty text-center">\n<h2>'+s(a(null!=e?e.feedMessage:e,e))+'</h2>\n<p class="text-gray spacing-top-small">'+s(t.gettext.call(e,"Until you do that, here are the latest %(number)s trending discussions on %(disqus)s.",{name:"gettext",hash:{disqus:"Disqus",number:null!=e?e.numItemsShown:e},data:i}))+"\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o="";return a=t["if"].call(e,null!=e?e.isLoggedIn:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+'<div data-role="items"></div>\n<div class="spacing-bottom spacing-top">\n<a href="/home/explore/" class="button button-inverted-fill button-wide text-medium">\n'+s(t.gettext.call(e,"Explore channels to follow",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n"},useData:!0})}),define("home/views/HomepageFeedEmptyView",["backbone-marionette","home/mixins/withSubviews","home/models/Session","home/views/ChannelCardCollectionView","home/templates/homepageFeedEmpty","home/templates/spinner"],function(e,t,n,i,a,s){var o=e.ItemView.extend({initialize:function(e){this.session=n.get(),this.maxItemsText=e.maxItemsText,this.model.ensureFetched().then(this.render)},getTemplate:function(){return this.model.get("fetched")?a:s},templateHelpers:function(){return{numItemsShown:this.maxItemsText,feedMessage:this.feedMessage,isLoggedIn:this.session.isLoggedIn()}},regions:{feedRegion:"[data-role=items]"},onRender:function(){this.activateRegion(this.feedRegion,this.createFeedView)},createFeedView:function(){return new i({model:this.model,collection:this.collection,emptyView:null})}});return t.call(o.prototype),o}),define("home/views/HomepageRecommendedFeedEmptyView",["core/strings","home/views/HomepageFeedEmptyView"],function(e,t){var n=e.get,i=t.extend({feedMessage:n("Follow channels and people to see their recommended discussions here.")});return i}),define("home/views/HomepageCommentsFeedEmptyView",["core/strings","home/views/HomepageFeedEmptyView"],function(e,t){var n=e.get,i=t.extend({feedMessage:n("Follow people to see their latest comments here.")});return i}),define("home/views/HomepageDiscussionsFeedEmptyView",["core/strings","home/views/HomepageFeedEmptyView"],function(e,t){var n=e.get,i=t.extend({feedMessage:n("Follow channels and people to see their latest discussions here.")});return i}),define("core/mixins/withEmailVerifyLink",["jquery","underscore","core/config","core/utils"],function(e,t,n,i){var a=i.preventDefaultHandler,s={events:{"click [data-action=verify-email]":"showVerifyEmailPopup"},showVerifyEmailPopup:a(function(t){var a=e(t.target).attr("data-forum"),s=n.urls.verifyEmail;return a&&(s=s+"?f="+a),i.openWindow(s,"_blank",{width:460,height:355})})};return function(){this.events=t.defaults({},this.events,s.events),t.extend(this,t.pick(s,"showVerifyEmailPopup"))}}),define("home/templates/emailVerificationAlert",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.escapeExpression;return'<div class="alert -warning text-medium">\n'+s(t.gettext.call(e,"The email address for your account %(email)s still needs to be verified.",{name:"gettext",hash:{email:t.tag.call(e,"strong",{name:"tag",hash:{text:null!=(a=null!=e?e.user:e)?a.email:a},data:i})},data:i}))+'\n<a href="/verify" data-action="verify-email">'+s(t.gettext.call(e,"Resend confirmation email »",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.shouldShowEmailVerificationAlert:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},useData:!0})}),define("home/views/EmailVerificationAlertView",["underscore","backbone-marionette","core/mixins/withEmailVerifyLink","home/models/Session","home/templates/emailVerificationAlert"],function(e,t,n,i,a){var s=t.ItemView.extend({template:a,templateHelpers:function(){return{user:this.session.user.toJSON(),shouldShowEmailVerificationAlert:this.shouldShowEmailVerificationAlert()}
},initialize:function(){this.session=i.get(),this.session.loadPromise().then(e.bind(this.render,this))},shouldShowEmailVerificationAlert:function(){return this.session.isLoggedIn()&&!this.session.user.get("isVerified")&&!this.session.user.registeredToday()}});return n.call(s.prototype),s}),define("home/mixins/withEmailVerificationAlert",["underscore","core/advice","home/views/EmailVerificationAlertView"],function(e,t,n){return function(){t.withAdvice.call(this),this.before("onDomRefresh",function(){this.emailVerificationAlertRegion.show(new n)}),this.regions=e.defaults({emailVerificationAlertRegion:"[data-role=email-verification-alert]"},this.regions)}}),define("home/models/common/BaseSettings",["underscore","backbone","core/config","core/utils/cookies","home/models/Session"],function(e,t,n,i,a){var s=t.Model.extend({shouldFetch:function(){return!this.fetched&&!this.fetching},ensureFetched:function(){if(this.shouldFetch()){var e=this;e.fetching=!0,e.fetch({success:function(){e.fetched=!0,e.fetching=!1},error:function(){e.fetched=!1,e.fetching=!1}})}},toFormData:function(t){return t=t||this.toJSON(),e.reduce(t,function(t,n,i){return t.append(i,e.isString(n)?n.trim():n),t},new FormData)},useMultiPartForm:!1,save:function(e,n){return e=e||this.toJSON(),n=n||{},this.useMultiPartForm&&(n.data=this.toFormData(e),n.contentType=!1),n.beforeSend=this.setCSRFHeader,t.Model.prototype.save.call(this,e,n)},setCSRFHeader:function(e,t){var n=a.get().getCsrfToken();/^(GET|HEAD|OPTIONS|TRACE)$/.test(t.type)||e.setRequestHeader("X-CSRFToken",n)},destroy:function(e){return e=e||{},e.beforeSend=this.setCSRFHeader,t.Model.prototype.destroy.call(this,e)}});return s}),define("home/models/SettingsSocialAccount",["underscore","backbone","core/config","home/models/common/BaseSettings"],function(e,t,n,i){var a=i.extend({url:function(){return n.urls.oauthStatus(this.id)},destroyUrl:function(){return n.urls.oauthDestroy(this.id)},destroy:function(e){return e=e||{},e.method="POST",e.url=this.destroyUrl(),i.prototype.destroy.call(this,e)},toJSON:function(){return{display_name:this.get("display_name"),url:this.get("url")}}});return a}),define("home/collections/SettingsSocialAccountCollection",["backbone","underscore","home/models/SettingsSocialAccount"],function(e,t,n){var i=e.Collection.extend({model:n,toJSON:function(){return t.reduce(this.models,function(e,t){return e[t.id]=t.toJSON(),e},{})}});return i}),define("home/models/SettingsAccount",["underscore","backbone","core/config","home/collections/SettingsSocialAccountCollection","home/models/common/BaseSettings","core/UniqueModel"],function(e,t,n,i,a,s){var o=a.extend({url:n.urls.apiSettings+"account/",initialize:function(){this.socialAccounts=new i},parse:function(t){var n=e.map(t.social_accounts,function(e,t){return e.id=t,e});return this.socialAccounts.reset(n),delete t.social_accounts,a.prototype.parse.call(this,t)},toJSON:function(){return{username:this.get("username"),email:this.get("email"),password:this.get("password"),old_password:this.get("old_password"),email_verified:this.get("email_verified")}}});return s.addType("SettingsAccount",o),o}),define("home/mixins/asModal",["jquery","underscore","home/templates/confirmModal","home/utils/confirmModal"],function(e,t,n,i){var a={initialize:function(e,n){e.apply(this,t.rest(arguments)),this.modal=this.getModal(n)},onRender:function(e){e&&e.apply(this,t.rest(arguments)),this.modal.find("[data-role=content]").append(this.$el)},showModal:function(e){e&&this.modal.modal(e),this.modal.modal("show")},closeModal:function(){this.remove(),this.modal.modal("hide")}},s=function(e){this.initialize=t.wrap(this.initialize,a.initialize),this.onRender=t.wrap(this.onRender,a.onRender),this.getModal=i.getModal,this.showModal=t.partial(a.showModal,e),this.closeModal=a.closeModal};return s}),define("home/templates/emailConfirmedModalContent",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return"is-error"},3:function(e,t,n,i){var a,s="";return a=t.each.call(e,null!=(a=null!=e?e.errors:e)?a.username:a,{name:"each",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},4:function(e){var t=this.lambda,n=this.escapeExpression;return'<p class="fieldset__description fieldset__description--error text-small">'+n(t(e,e))+"</p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<form>\n<div class="form__header">\n<h1 class="form-heading">\n<span class="icon-checkmark text-success icon__position spacing-right-small"></span>\n'+s(t.gettext.call(e,"Email Verified",{name:"gettext",hash:{},data:i}))+'\n</h1>\n<p class="form-description text-gray text-medium">'+s(t.gettext.call(e,"Now choose a unique username before someone else grabs it!",{name:"gettext",hash:{},data:i}))+'</p>\n</div>\n<div class="form__content">\n<div class="fieldset" role="group">\n<label for="settings-username" class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Username",{name:"gettext",hash:{},data:i}))+'</label>\n<div class="fieldset__block align__item ';return a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.username:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="fieldset__block--text">\n<input type="text" id="settings-username" class="input--textbox" name="username" value="'+s(o(null!=e?e.username:e,e))+'">\n</div>\n',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.username:a,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'<p class="fieldset__description text-gray text-small">\nhttp://disqus.com/by/<strong data-role="username-placeholder">'+s(o(null!=e?e.username:e,e))+"</strong>\n<br/>\n"+s(t.gettext.call(e,"This will be used as your profile address and for logging in.",{name:"gettext",hash:{},data:i}))+'\n</p>\n</div>\n</div>\n</div>\n<div class="form__footer">\n<div class="fieldset" role="group">\n<div class="fieldset__label" data-role="save-status"><div class="spinner-small"></div><div class="icon-checkmark"></div></div>\n<div class="fieldset__block"><button class="button button-inverted button-inverted-fill button-semi-wide text-medium" data-role="save-btn">'+s(t.gettext.call(e,"Save",{name:"gettext",hash:{},data:i}))+"</button></div>\n</div>\n</div>\n</form>\n"},useData:!0})}),define("home/templates/settingsAccountForm",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return"is-error"},3:function(e,t,n,i){var a,s="";return a=t.each.call(e,null!=(a=null!=e?e.errors:e)?a.username:a,{name:"each",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},4:function(e){var t=this.lambda,n=this.escapeExpression;return'<p class="fieldset__description fieldset__description--error text-small">'+n(t(e,e))+"</p>\n"},6:function(e,t,n,i){var a,s="";return a=t.each.call(e,null!=(a=null!=e?e.errors:e)?a.email:a,{name:"each",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},8:function(e,t,n,i){var a=this.escapeExpression;return'<p class="fieldset__description fieldset__description--pending text-small">\n'+a(t.gettext.call(e,"Your email address hasn't been verified yet. Please request a new verification email, if you haven't yet received one.",{name:"gettext",hash:{},data:i}))+'\n<a href="/verify" data-action="verify-email">'+a(t.gettext.call(e,"Request »",{name:"gettext",hash:{},data:i}))+"</a>\n</p>\n"},10:function(e,t,n,i){var a=this.escapeExpression;return'<p class="fieldset__description text-gray text-small">\n'+a(t.gettext.call(e,"Changing your email requires you to verify it. Just click on the big button in the email we send to the new email address.",{name:"gettext",hash:{},data:i}))+"\n</p>\n"},12:function(e,t,n,i){var a,s="";return a=t.each.call(e,null!=(a=null!=e?e.errors:e)?a.__all__:a,{name:"each",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<form class="form">\n<div class="form__header--mobile visible-md">\n<a href="/home/settings/" class="form__header--mobile-back"><span class="icon-left-bracket"></span></a>\n<h2>'+s(t.gettext.call(e,"Account",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<div class="form__header">\n<h1 class="form-heading hidden-md">'+s(t.gettext.call(e,"Account",{name:"gettext",hash:{},data:i}))+'</h1>\n<p class="form-description text-gray text-medium">'+s(t.gettext.call(e,"Change your basic account information.",{name:"gettext",hash:{},data:i}))+'</p>\n</div>\n<div class="form__content">\n<div class="fieldset" role="group">\n<label for="settings-username" class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Username",{name:"gettext",hash:{},data:i}))+'</label>\n<div class="fieldset__block align__item ';return a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.username:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="fieldset__block--text">\n<input type="text" id="settings-username" class="input--textbox" name="username" value="'+s(o(null!=e?e.username:e,e))+'">\n</div>\n',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.username:a,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<p class="fieldset__description text-gray text-small">\nhttp://disqus.com/by/<strong data-role="username-placeholder">'+s(o(null!=e?e.username:e,e))+"</strong>\n<br/>\n"+s(t.gettext.call(e,"This will be used as your profile address and for logging in.",{name:"gettext",hash:{},data:i}))+'\n</p>\n</div>\n</div>\n<div class="fieldset" role="group">\n<label for="settings-email" class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Email",{name:"gettext",hash:{},data:i}))+'</label>\n<div class="fieldset__block align__item ',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.email:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="fieldset__block--text">\n<input type="text" id="settings-email" class="input--textbox" name="email" value="'+s(o(null!=e?e.email:e,e))+'">\n</div>\n',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.email:a,{name:"if",hash:{},fn:this.program(6,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t.unless.call(e,null!=e?e.email_verified:e,{name:"unless",hash:{},fn:this.program(8,i),inverse:this.program(10,i),data:i}),null!=a&&(r+=a),r+='</div>\n</div>\n<div class="fieldset" role="group">\n<div class="fieldset__label align__item text-gray"><label for="settings-password">'+s(t.gettext.call(e,"Password",{name:"gettext",hash:{},data:i}))+'</label></div>\n<div class="fieldset__block align__item">\n<div class="fieldset__block--text">\n<input type="password" placeholder="'+s(t.gettext.call(e,"Current password",{name:"gettext",hash:{},data:i}))+'" id="settings-password" name="old_password" class="input--textbox">\n</div>\n<p class="fieldset__description text-gray text-small">\n'+s(t.gettext.call(e,"Forgot your password?",{name:"gettext",hash:{},data:i}))+' <a href="/forgot" target="_blank">'+s(t.gettext.call(e,"Request a password recovery email.",{name:"gettext",hash:{},data:i}))+'</a>\n</p>\n<div class="fieldset__block--text">\n<input type="password" placeholder="'+s(t.gettext.call(e,"New password",{name:"gettext",hash:{},data:i}))+'" name="password" class="input--textbox">\n</div>\n',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.__all__:a,{name:"if",hash:{},fn:this.program(12,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'</div>\n</div>\n</div>\n<div class="form__footer">\n<div class="fieldset" role="group">\n<div class="fieldset__label" data-role="save-status"><div class="spinner-small"></div><div class="icon-checkmark"></div></div>\n<div class="fieldset__block"><button class="button button-inverted button-inverted-fill button-semi-wide text-medium" data-role="save-btn" disabled>'+s(t.gettext.call(e,"Save",{name:"gettext",hash:{},data:i}))+"</button></div>\n</div>\n</div>\n</form>\n"},useData:!0})}),define("home/mixins/withFetchingView",["underscore","home/views/FetchingView"],function(e,t){var n=function(){this.render=e.wrap(this.render,function(n){if(this.isDoneFetching())return n.apply(this,e.rest(arguments));var i=new t;return this.$el.html(i.render().el),this})};return n}),define("home/views/common/BaseSettingsView",["jquery","underscore","backbone-marionette","home/mixins/withFetchingView"],function(e,t,n,i){var a=n.ItemView.extend({events:{"submit form":"submitHandler","change input[type=checkbox], input[type=radio], select":"changeHandler","keyup input[type=text], input[type=password]":"changeHandler"},initialize:function(){this.model.ensureFetched(),this.listenTo(this.model,"invalid sync",this.render),this.listenTo(this.model,"error",this.handleValidationError)},onRender:function(){this.$form=this.$("form"),this.$saveStatus=this.$("[data-role=save-status]"),this.saveBtn=this.$("[data-role=save-btn]")[0],this.model.set(this.getFormData())},handleValidationError:function(e,t){e.validationError=t.responseJSON,this.render()},isDoneFetching:function(){return this.model.fetched},serializeData:function(){var e=n.ItemView.prototype.serializeData.call(this,arguments);return e.errors=this.model.validationError||{},e},changeHandler:t.debounce(function(){this.updateButtonState(this.model.changedAttributes(this.getFormData()))},100),updateButtonState:function(e){this.saveBtn.disabled=!e},submitHandler:function(e){e.preventDefault(),this.$saveStatus.addClass("is-saving"),this.clearErrors(),this.updateStatus("is-saving"),this.model.set(this.getFormData()),this.model.save().done(t.bind(this.updateStatus,this,"is-saved"))},updateStatus:function(e){this.$saveStatus.removeClass("is-saving is-saved").addClass(e)},getFormData:function(){return t.reduce(this.$form.serializeArray(),function(e,t){return e[t.name]=t.value,e},{})},clearErrors:function(){this.$el.find(".is-error").removeClass("is-error"),this.$el.find(".fieldset__description--error").hide(),this.model.validationError=null}});return i.call(a.prototype),a}),define("home/views/SettingsAccountFormView",["jquery","backbone-marionette","underscore","core/mixins/withEmailVerifyLink","home/templates/settingsAccountForm","home/views/common/BaseSettingsView"],function(e,t,n,i,a,s){var o=s.extend({template:a,events:n.defaults({"keyup input[name=username]":"handleKeyup"},s.prototype.events),onRender:function(){this.$usernamePlaceholder=this.$("[data-role=username-placeholder]"),s.prototype.onRender.apply(this,arguments)},handleKeyup:n.debounce(function(e){this.$usernamePlaceholder.text(e.currentTarget.value||this.model.get("username"))},300)});return i.call(o.prototype),o}),define("home/views/EmailConfirmedModalContentView",["underscore","core/utils","home/mixins/asModal","home/templates/emailConfirmedModalContent","home/views/SettingsAccountFormView"],function(e,t,n,i,a){var s=a.extend({template:i,updateStatus:function(n){if(a.prototype.updateStatus.apply(this,arguments),"is-saved"===n){var i=t.animationEndEvent,s=e.bind(this.closeModal,this);i?this.$saveStatus.one(i,".icon-checkmark",s):e.delay(s,1500)}},getFormData:function(){var t=a.prototype.getFormData.call(this);return e.defaults(t,{password:"",old_password:""})}});return n.call(s.prototype),s}),define("home/mixins/withEmailConfirmedModal",["underscore","core/advice","core/UniqueModel","core/utils","home/models/Session","home/models/SettingsAccount","home/views/EmailConfirmedModalContentView"],function(e,t,n,i,a,s,o){var r={showEmailVerifiedModal:function(){if(this.shouldShowEmailVerifiedModal()){var t=a.get();t.loadPromise().then(e.bind(function(){if(!t.isLoggedOut()){var e=new n(s,{id:t.user.id}),i=new o({model:e});i.showModal()}},this))}},shouldShowEmailVerifiedModal:function(){return!!i.getQueryParams().email_verified}};return function(){t.withAdvice.call(this),this.showEmailVerifiedModal=r.showEmailVerifiedModal,this.shouldShowEmailVerifiedModal=r.shouldShowEmailVerifiedModal,this.after("initialize",function(){this.showEmailVerifiedModal()})}}),define("home/templates/createChannelModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="aside__wrap aside-inverted">\n<div class="aside-inverted__content text-center">\n<h1 class="text-large spacing-top">'+a(t.gettext.call(e,"Have an idea for a channel?",{name:"gettext",hash:{},data:i}))+'</h1>\n<div class="spacing-narrow">'+a(t.gettext.call(e,"Now you can make your own.",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="spacing-narrow spacing-top">\n<a href="/home/channels/new/" class="button button-inverted text-small button-semi-wide">\n<strong>'+a(t.gettext.call(e,"Create a Channel",{name:"gettext",hash:{},data:i}))+"</strong>\n</a>\n</div>\n</div>\n</div>\n"},useData:!0})}),define("home/templates/homepage",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div data-role="marketing-module">\n</div>\n<div class="section-contained">\n<div class="layout">\n<div class="layout__main">\n<nav class="layout__nav">\n<div data-role="welcome-message"></div>\n<div data-role="user-card" class="hidden-lg" data-jester-area="profile_module"></div>\n<div data-role="homepage-nav"></div>\n<div data-role="following-module" class="hidden-lg module__wrapper" data-jester-area="following_module"></div>\n<div data-role="topics-module" class="hidden-lg module__wrapper">\n<div class="aside__subheadings">\n<h2 class="text-subheading">\n<span class="icon-topics icon-tiny icon__position -inline"></span>'+s(t.gettext.call(e,"Topics",{name:"gettext",hash:{},data:i}))+'\n</h2>\n</div>\n<div class="aside__wrap">\n<section class="padding-default" data-role="topics"></section>\n</div>\n</div>\n</nav>\n<section class="layout__content homepage-feed">\n<div data-role="onboarding-module" class="homepage-onboard__note"></div>\n<div data-role="email-verification-alert"></div>\n<div data-role="content-area" data-jester-area="feed"></div>\n</section>\n</div>\n<aside data-role="right-rail" class="layout__aside hidden-md module__wrapper">\n<div data-role="create-channel-module" data-jester-area="create-channel-module"></div>\n<div data-role="moderated-forums-module" data-jester-area="moderated-forums-module"></div>\n<div data-role="comments-module" data-jester-area="comments-module" class="module--aside"></div>\n<div data-role="recommend-module" data-recommend-type="channel" data-jester-area="recommended-channels"\nclass="module--aside"></div>\n<div data-role="recommend-module" data-recommend-type="user" data-jester-area="recommended-users"\nclass="module--aside"></div>\n<div data-role="recommend-module" data-recommend-type="forum" data-jester-area="recommended-forums"\nclass="module--aside"></div>\n<div class="text-smaller text-gray">\n';return a=this.invokePartial(n.homeFooter,"","homeFooter",e,void 0,t,n,i),null!=a&&(o+=a),o+"</div>\n</aside>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/templates/homepageMarketing",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="homepage-marketing">\n<div class="section-contained homepage-marketing__inner">\n<div class="layout">\n<div class="homepage-marketing__consumers">\n<h1 class="homepage-marketing__headline">'+a(t.gettext.call(e,"Great discussions are happening here.",{name:"gettext",hash:{},data:i}))+'</h1>\n<p class="homepage-marketing__description">'+a(t.gettext.call(e,"Whether it's the biggest story of the day or the kind of thing super fans are talking about, there's lots to discuss on %(disqus)s.",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+'</p>\n<div class="homepage-marketing__cta">\n<a href="/profile/signup" class="button button-green-fill -large text-large">'+a(t.gettext.call(e,"Sign Up",{name:"gettext",hash:{},data:i}))+'</a>\n<a href="/home/explore" class="button button-inverted -thick -large text-large">'+a(t.gettext.call(e,"Explore",{name:"gettext",hash:{},data:i}))+'</a>\n</div>\n</div>\n<div class="homepage-marketing__publishers">\n<h1 class="homepage-marketing__headline">'+a(t.gettext.call(e,"Have a website? This one's for you.",{name:"gettext",hash:{},data:i}))+'</h1>\n<p class="homepage-marketing__description">'+a(t.gettext.call(e,"%(disqus)s offers publishers the best tools in the universe to power discussions, increase engagement, & earn new revenue.",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+'</p>\n<div class="homepage-marketing__cta">\n<a href="http://publishers.disq.us/?utm_source=Home-Banner" class="button button-inverted -thick -large text-large">'+a(t.gettext.call(e,"Learn More",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n</div>\n</div>\n</div>\n</div>\n"},useData:!0})}),define("home/templates/homepageTabs",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="aside__subheadings hidden-lg">\n<h2 class="text-subheading">'+a(t.gettext.call(e,"Your Feed",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<ul class="nav--aside">\n<li data-action="switch-tab" data-tab="popular" class="nav__item">\n<a href="/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n<span class="nav-lnk__icon icon icon-popular"></span>\n<span class="button__text">'+a(t.gettext.call(e,"Recommended",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n<li data-action="switch-tab" data-tab="comments" class="nav__item">\n<a href="/home/comments/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n<span class="nav-lnk__icon icon icon-comments"></span>\n<span class="button__text">'+a(t.gettext.call(e,"Latest Comments",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n<li data-action="switch-tab" data-tab="discussions" class="nav__item">\n<a href="/home/discussions/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n<span class="nav-lnk__icon icon icon-discussions"></span>\n<span class="button__text">'+a(t.gettext.call(e,"Latest Discussions",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n<li class="nav__item visible-md">\n<a href="/about/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n<span class="nav-lnk__icon icon icon-brand-square"></span>\n<span class="button__text">'+a(t.gettext.call(e,"About %(disqus)s",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+"</span>\n</div>\n</a>\n</li>\n</ul>\n"},useData:!0})}),define("home/templates/homepageTour",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<div class="carousel-card">\n<p><img src="'+a(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/Pam_SignUp.png" class="tour__img" /></p>\n<p>\n<h3 class="text-large">\n'+a(t.gettext.call(e,"Sign Up or Log In to Continue",{name:"gettext",hash:{},data:i}))+"\n</h3>\n</p>\n<p>\n"+a(t.gettext.call(e,"To use these features, you’ll need to sign up or log into your existing %(disqus)s account. Go now!",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+'\n</p>\n<div class="tour__btn-group">\n<a href="//disqus.com/profile/signup/?next=https%3A%2F%2Fdisqus.com%2F"\nclass="button button-outline text-small button-semi-wide">\n'+a(t.gettext.call(e,"Sign Up",{name:"gettext",hash:{},data:i}))+'\n</a>\n<a href="//disqus.com/profile/login/?next=https%3A%2F%2Fdisqus.com%2F"\nclass="button button-inverted text-small button-semi-wide">\n'+a(t.gettext.call(e,"Log In",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="tour text-center" data-role="carousel">\n<div data-role="page-container">\n<div class="carousel-card">\n<p>\n<img src="'+s(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/Pam_Disqus_Picks.png" class="tour__img" />\n</p>\n<p>\n<h3 class="text-large">'+s(t.gettext.call(e,"%(disqus)s Recommendations",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+"</h3>\n</p>\n<p>\n"+s(t.gettext.call(e,"We find the best discussions from the %(disqus)s network and share them here. We’ll introduce you to trending topics and new sites, but you can always unfollow us, if you want.",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+'\n</p>\n</div>\n<div class="carousel-card">\n<p><img src="'+s(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/Pam_Feed.png" class="tour__img" /></p>\n<p>\n<h3 class="text-large">'+s(t.gettext.call(e,"I %(heartIcon)s Recommendations",{name:"gettext",hash:{heartIcon:"♥"},data:i}))+"</h3>\n</p>\n<p>\n"+s(t.gettext.call(e,"When you %(heartIcon)s a discussion, it shows up in feeds of people following you.",{name:"gettext",hash:{heartIcon:"♥"},data:i}))+'\n</p>\n</div>\n<div class="carousel-card">\n<p><img src="'+s(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/Pam_Following.png" class="tour__img" /></p>\n<p>\n<h3 class="text-large">\n'+s(t.gettext.call(e,"Follow Interesting People and Communities",{name:"gettext",hash:{},data:i}))+"\n</h3>\n</p>\n<p>\n"+s(t.gettext.call(e,"When you follow sites and blogs you’ll see their discussions appear in your feed. Following people adds their comments and recommendations to your feed.",{name:"gettext",hash:{},data:i}))+'\n</p>\n</div>\n<div class="carousel-card">\n<p><img src="'+s(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/Pam_Recommendations.png" class="tour__img" /></p>\n<p>\n<h3 class="text-large">\n'+s(t.gettext.call(e,"Your Feed",{name:"gettext",hash:{},data:i}))+"\n</h3>\n</p>\n<p>\n"+s(t.gettext.call(e,"Your feed is where you’ll find discussions from communities and people you follow. Switch between the Recommended, Comment and Discussion feeds to see different kinds of content.",{name:"gettext",hash:{},data:i}))+"\n</p>\n</div>\n";return a=t["if"].call(e,null!=e?e.isLoggedOut:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+"</div>\n</div>\n"},useData:!0})}),define("home/views/HomepageView",["jquery","underscore","backbone","backbone-marionette","core/strings","core/switches","home/models/Session","home/collections/ForumCollection","home/collections/RecommendedUserCollection","home/views/common/TabbedView","home/views/RecommendationsModuleView","home/views/ChannelCardCollectionViewWithChannelPromotion","home/views/ChannelFeedFooterView","home/views/HomeCardCollectionView","home/views/common/FetchableCollectionLayout","home/views/CommentCardCollectionView","home/views/HomepageWelcomeMessageView","home/views/HomepageUserModuleView","home/views/HomepageCommentsModuleView","home/views/TopicTagCollectionView","home/views/HomepageChannelsModuleView","home/views/HomepageOnboardingModuleView","home/views/ModeratedForumsModuleView","home/utils/confirmModal","home/views/HomepageFollowingModuleView","home/views/HomepageRecommendedFeedEmptyView","home/views/HomepageCommentsFeedEmptyView","home/views/HomepageDiscussionsFeedEmptyView","home/mixins/withClickLinkTracking","home/mixins/withEmailVerificationAlert","home/mixins/withEmailConfirmedModal","home/templates/createChannelModule","home/templates/homepage","home/templates/homepageMarketing","home/templates/homepageTabs","home/templates/homepageTour"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f,g,v,w,b,x,y,_,k,C,T,S,E,F,P,D,M,V,A,R,N){var O=a.get,I=s.isFeatureActive("homeOnboarding"),U=c.extend({defaultTab:"popular",template:V,events:t.defaults({"click [data-action=show-tour]":"showTour","click a[data-link-name]":"trackClickLink"},c.prototype.events),regions:t.defaults({welcomeRegion:"[data-role=welcome-message]",userCardRegion:"[data-role=user-card]",commentsModuleRegion:"[data-role=comments-module]",createChannelModuleRegion:"[data-role=create-channel-module]",followingModuleRegion:"[data-role=following-module]",recommendedChannelsModuleRegion:"[data-role=recommend-module][data-recommend-type=channel]",recommendedUsersModuleRegion:"[data-role=recommend-module][data-recommend-type=user]",recommendedForumsModuleRegion:"[data-role=recommend-module][data-recommend-type=forum]",topicsRegion:"[data-role=topics]",topicsModuleRegion:"[data-role=topics-module]",rightRailRegion:"[data-role=right-rail]",onboardingModuleRegion:"[data-role=onboarding-module]",marketingRegion:"[data-role=marketing-module]",homepageTabsRegion:"[data-role=homepage-nav]",moderatedForumsRegion:"[data-role=moderated-forums-module]"},c.prototype.regions),initialize:function(e){c.prototype.initialize.call(this,e),this.session=o.get(),this.showOnboarding=!1,this.session.loadPromise().then(t.bind(function(){this.showOnboarding=this.session.isLoggedIn()&&!this.session.user.get("homeFeedOnboardingComplete"),this.showOnboarding&&this.toggleOnboardingModules()},this)),this.listenTo(this,"change:activeTab",this.updateTabSpecificModules)},onDomRefresh:function(){c.prototype.onDomRefresh.call(this),I||this.welcomeRegion.show(new g);var n=this.model.topicChannelProfile,a=n.trendingTopics.items;this.topicsRegion.show(new b({collection:a,channel:n.channel}));var s,o=this.model.interestingChannels.ensureFetched(),r=t.bind(this.showChannelsModule,this);this.session.isKnownToBeLoggedOut()?(this.marketingRegion.show(new i.ItemView({template:A})),o.done(r)):(this.showCreateChannelModule(),this.listenTo(this.session.user,"unfollowed:curationchannel",this.refreshRecommendedFeed),this.session.loadPromise().then(t.bind(this.showLoggedInModules,this)),s=this.session.userProfile.forumsFollowing.ensureFetched(),s.done(t.bind(this.showFollowingModule,this)),e.when(s,o).done(r)),this.toggleOnboardingModules()},showFollowingModule:function(){var e=this.session.userProfile.forumsFollowing;e.items.length&&this.followingModuleRegion.show(new C({collection:e.items}))},showCreateChannelModule:function(){this.createChannelModuleRegion.show(new i.ItemView({template:M}))},showLoggedInModules:function(){this.recommendedUsersModuleRegion.show(d.createUserRecommendedModuleView({model:this.model.interestingUsers})),this.userCardRegion.show(new v({model:this.session.user})),this.homepageTabsRegion.show(new i.ItemView({template:R})),this.updateTabClasses(),this.showModeratedForums()},showModeratedForums:function(){this.session.loadModeratedForums().then(t.bind(function(){var e=t.chain(this.session.moderatedForums).reject(function(e){return 0===e.indexOf("channel-")}).sortBy().map(function(e){return{id:e}}).value();t.isEmpty(e)||this.moderatedForumsRegion.show(new _({collection:new r(e)}))},this))},showChannelsModule:function(){var e=this.model.interestingChannels.items.chain().reject(function(e){return e.channel.primaryForum.get("isFollowing")}).pluck("channel").shuffle().value();e.length?this.recommendedChannelsModuleRegion.show(new x({collection:new n.Collection(e)})):(this.model.initializeAndFetchInterestingForums(),this.recommendedForumsModuleRegion.show(d.createForumRecommendedModuleView({model:this.model.interestingForums})))},refreshRecommendedFeed:function(){this.model.popular.fetchItems({reset:!0})},showTour:function(){var t=this.session.isKnownToBeLoggedOut(),n=t?5:4;k.confirmationPromise(k.TYPES.CLOSE_ICON,N({isLoggedOut:t,numSlides:n})),e(".modal [data-role=page-container]").slick({infinite:!1,appendArrows:e(".modal [data-role=carousel]"),prevArrow:null,nextArrow:'<button class="text-small tour__btn">'+O("Next")+"</button>",slidesToShow:1,slidesToScroll:1,dots:!0,onAfterChange:function(n,i){i===n.slideCount-1&&t?e(".tour__btn").css("opacity","0"):(e(".tour__btn").css("opacity","1"),i===n.slideCount-1?(e(".tour__btn").text(O("Got It!")),e(".tour__btn").attr("data-dismiss","modal")):(e(".tour__btn").text(O("Next")),e(".tour__btn").removeAttr("data-dismiss")))
}})},updateTabSpecificModules:function(e){"comments"===e?this.hideRegion(this.commentsModuleRegion):this.session.isKnownToBeLoggedOut()||(this.commentsModuleRegion.currentView||this.commentsModuleRegion.show(this.createHomepageCommentsModuleView()),this.showRegion(this.commentsModuleRegion))},toggleOnboardingModules:function(){if(I)if(t.each(["followingModuleRegion","topicsModuleRegion","rightRailRegion"],function(e){this[e].ensureEl(),this[e].$el.toggleClass("is-disabled",this.showOnboarding)},this),this.showOnboarding){var e=new y;this.listenTo(e,"hideOnboarding",function(){this.showOnboarding=!1,this.toggleOnboardingModules()}),this.onboardingModuleRegion.show(e),this.hideRegion(this.createChannelModuleRegion),this.hideRegion(this.emailVerificationAlertRegion)}else this.onboardingModuleRegion.$el&&this.hideRegion(this.onboardingModuleRegion)},createHomepageCommentsModuleView:function(){var e=new n.Collection([]),t=this;return this.model.commentsPromise.then(function(){e.reset(t.model.comments.items.map(function(e){return e.activities[0].object}))}),new w({collection:e,commentsPromise:this.model.commentsPromise})},hideRegion:function(e){e.$el&&e.$el.addClass("is-hidden")},showRegion:function(e){e.$el&&e.$el.removeClass("is-hidden")},getTrackingSection:function(e){return e},getTabView:function(e){var t,n={model:this.model.spotlightProfile.topActivities,collection:this.model.spotlightProfile.topActivities.items,maxItemsText:this.model.constructor.MAX_SPOTLIGHT_ITEMS.TEXT};switch(e){case"popular":return t=new p({model:this.model.popular,collection:this.model.popular.items,fetchableCollectionView:u,fetchableCollectionFooterView:h,infiniteScroll:!0,enableBestOfDisqusCallout:!0,emptyView:T,emptyViewOptions:n}),t.$el.attr({"data-mix-location":"popular"}),t;case"comments":return t=new p({model:this.model.comments,collection:this.model.comments.items,fetchableCollectionView:f,infiniteScroll:!0,emptyView:S,emptyViewOptions:n}),t.$el.attr({"data-mix-location":"comments"}),t;case"discussions":return t=new p({model:this.model.discussions,collection:this.model.discussions.items,fetchableCollectionView:u,infiniteScroll:!0,emptyView:E,emptyViewOptions:n}),t.$el.attr({"data-mix-location":"discussions"}),t}},getMetaAttrs:function(){switch(this.activeTab){case"popular":return O("Recommended Discussions");case"comments":return O("Latest Comments");case"discussions":return O("Latest Discussions")}}});return F.call(U.prototype),P.call(U.prototype),D.call(U.prototype),U}),define("home/templates/activityFeed",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div class="section-contained">\n<div class="cover" data-role="cover-area"></div>\n</div>\n<div class="section-contained" data-role="header-area"></div>\n<div class="section-contained" id="container-content" data-role="content-area"></div>\n<div class="section-contained" data-role="footer-area"></div>\n'},useData:!0})}),define("home/views/ActivityFeedView",["jquery","underscore","home/views/ActivityCardCollectionView","home/views/common/FetchableCollectionLayout","home/templates/activityFeed"],function(e,t,n,i,a){var s=i.extend({template:a,attributes:{"data-mix-location":"feed"},regions:t.defaults({coverRegion:"[data-role=cover-area]"},i.prototype.regions),fetchableCollectionView:n,initialize:function(e){i.prototype.initialize.apply(this,arguments),e.coverView&&(this.coverView=e.coverView)},onDomRefresh:function(){if(i.prototype.onDomRefresh.apply(this,arguments),this.coverView){var e=this.coverView.getModel?this.coverView.getModel(this.model):this.model;this.coverRegion.show(new this.coverView({model:e}))}},getMetaAttrs:function(){var e=this.coverRegion.currentView;return e&&e.getMetaAttrs&&e.getMetaAttrs()||""}});return s}),define("home/mixins/asNotificationCard",["underscore"],function(e){var t=function(){var t=this.className;this.className=function(){var n=e.isFunction(t)?t.apply(this,arguments):t||"";return"card-wrap card--notification "+n};var n=this.initialize;this.initialize=function(){n.apply(this,arguments),this.listenTo(this.model,"change:isUnread",this.updateUnreadClass),this.updateUnreadClass()},this.updateUnreadClass=function(){this.$el.toggleClass("unread",!!this.model.get("isUnread"))};var i=this.serializeData;this.serializeData=function(){var t=i.apply(this,arguments);return e.defaults(t,{discussionRoute:this.model.thread&&this.model.thread.getDiscussionRoute()})}};return t}),define("home/templates/notificationCardChannelPost",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression,s=this.lambda;return'<div class="card__reason">\n<div class="notification__icon -reply">\n<span class="icon-notification-response text-brand icon__position text-smaller"></span>\n</div>'+a(t.gettext.call(e,"%(userName)s responded to your discussion %(thread)s",{name:"gettext",hash:{thread:t.getPartial.call(e,"threadLink",{name:"getPartial",hash:{},data:i}),userName:t.getPartial.call(e,"userName",null!=e?e.firstActor:e,{name:"getPartial",hash:{},data:i})},data:i}))+'\n\n<span class="time text-gray">'+a(s(null!=e?e.relativeTime:e,e))+'</span>\n</div>\n<div class="card__content -notification">\n<div class="card-comment" data-role="post"></div>\n</div>\n'},useData:!0})}),define("home/views/NotificationCardChannelPostView",["home/views/common/ActivityCardView","home/mixins/withReason","home/mixins/asNotificationCard","home/mixins/withSubviews","home/views/TruncatedPostView","home/templates/notificationCardChannelPost"],function(e,t,n,i,a,s){var o=e,r=o.extend({className:"card-notif-channel-post",template:s,regions:{postsRegion:"[data-role=post]"},onRender:function(){this.activateRegion(this.postsRegion,this.createPostView)},createPostView:function(){return new a({model:this.model.activities[0].target})}}),l=r.prototype;return t.call(l),n.call(l),i.call(l),r}),define("home/templates/notificationCardUpvote",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression,s=this.lambda;return'<div class="card__reason">\n<div class="notification__icon -upvote text-brand">\n<span class="icon-arrow-up text-smaller"></span>\n</div>'+a(t.gettext.call(e,"%(userNames)s upvoted you on %(thread)s",{name:"gettext",hash:{thread:t.getPartial.call(e,"threadLink",{name:"getPartial",hash:{},data:i}),userNames:t.getPartial.call(e,"userGroupNames",{name:"getPartial",hash:{},data:i})},data:i}))+'\n\n<span class="time text-gray">'+a(s(null!=e?e.relativeTime:e,e))+'</span>\n</div>\n<div class="card__content -notification">\n<div data-role="post"></div>\n</div>\n'},useData:!0})}),define("home/views/NotificationCardUpvoteView",["underscore","home/views/common/ActivityCardView","home/mixins/withReason","home/mixins/asNotificationCard","home/mixins/withSubviews","home/views/TruncatedPostView","home/templates/notificationCardUpvote"],function(e,t,n,i,a,s,o){var r=t,l=r.extend({className:"card-notif-upvote",template:o,regions:{postRegion:"[data-role=post]"},onRender:function(){this.activateRegion(this.postRegion,this.createPostView)},createPostView:function(){return new s({model:this.model.activities[0].target})}}),c=l.prototype;return n.call(c),i.call(c),a.call(c),l}),define("home/templates/notificationCardChannelRecommend",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression,s=this.lambda;return'<div class="card__reason  -recommendation">\n<div class="notification__icon">\n<span class="icon-heart text-error text-smaller icon__position"></span>\n</div>'+a(t.gettext.call(e,"%(userNames)s recommended your discussion %(thread)s",{name:"gettext",hash:{thread:t.getPartial.call(e,"threadLink",{name:"getPartial",hash:{},data:i}),userNames:t.getPartial.call(e,"userGroupNames",{name:"getPartial",hash:{},data:i})},data:i}))+'\n\n<span class="time text-gray">'+a(s(null!=e?e.relativeTime:e,e))+"</span>\n</div>\n"},useData:!0})}),define("home/views/NotificationCardChannelRecommendView",["home/views/common/ActivityCardView","home/mixins/withReason","home/mixins/asNotificationCard","home/templates/notificationCardChannelRecommend"],function(e,t,n,i){var a=e,s=a.extend({className:"card-notif-recommend",template:i}),o=s.prototype;return t.call(o),n.call(o),s}),define("home/templates/notificationCardReply",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression,s=this.lambda;return'<div class="card__reason">\n<div class="notification__icon -reply">\n<span class="icon-notification-reply text-success icon-small"></span>\n</div>'+a(t.gettext.call(e,"%(userName)s replied to you on %(thread)s",{name:"gettext",hash:{thread:t.getPartial.call(e,"threadLink",{name:"getPartial",hash:{},data:i}),userName:t.getPartial.call(e,"userName",null!=e?e.firstActor:e,{name:"getPartial",hash:{},data:i})},data:i}))+'\n\n<span class="time text-gray">'+a(s(null!=e?e.relativeTime:e,e))+'</span>\n</div>\n<div class="card__content -notification">\n<div class="card-comment" data-role="post"></div>\n</div>\n'},useData:!0})}),define("home/views/NotificationCardReplyView",["underscore","backbone","home/views/common/ActivityCardView","home/mixins/withReason","home/mixins/asNotificationCard","home/mixins/withSubviews","home/views/PostActivityCollectionView","core/utils/html","home/templates/notificationCardReply"],function(e,t,n,i,a,s,o,r,l){var c=n,d=c.prototype,u=c.extend({className:"card-notif-reply",template:l,serializeData:function(){var t=d.serializeData.apply(this,arguments),n=t.activities[0].target;return e.extend(t,{plaintextParent:r.stripTags(n.message)})},regions:{postsRegion:"[data-role=post]"},onRender:function(){this.activateRegion(this.postsRegion,this.createPostCollectionView)},createPostCollectionView:function(){return new o({collection:new t.Collection(this.model.activities)})}}),h=u.prototype;return i.call(h),a.call(h),s.call(h),u}),define("home/templates/userCard",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="card--user">\n<div class="user-card__block">\n';return a=this.invokePartial(n.userCardBody,"","userCardBody",e,void 0,t,n,i),null!=a&&(s+=a),s+='</div>\n<div class="user-card__button">\n',a=this.invokePartial(n.userFollowButton,"","userFollowButton",e,void 0,t,n,i),null!=a&&(s+=a),s+"</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/UserCardView",["backbone-marionette","home/utils/mixpanelUtils","home/templates/userCard","core/bus"],function(e,t,n,i){var a=e.ItemView.extend({template:n,templateHelpers:function(){return{isSessionUser:this.model.isSessionUser()}},className:"card",events:{"click [data-action=toggle-follow]":"toggleFollow"},modelEvents:{"change:isFollowing":"handleFollowedClass"},handleFollowedClass:function(){this.$("[data-action=toggle-follow]").toggleClass("active",this.model.get("isFollowing"))},toggleFollow:function(e){e&&e.preventDefault(),t.track("follow user",e,{properties:{follow:!this.model.get("isFollowing")}}),this.model.get("isFollowing")?i.trigger("uiAction:unfollowUser",this.model,e):i.trigger("uiAction:followUser",this.model,e),this.model.toggleFollowed()}});return a}),define("home/templates/followerCard",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression,s=this.lambda;return'<button class="button button-outline -error spacing-right-small"\ntitle="'+a(t.gettext.call(e,"Remove Follower",{name:"gettext",hash:{},data:i}))+'"\ndata-action="remove-follower"\ndata-user="'+a(s(null!=e?e.id:e,e))+'">\n<span class="icon-cancel icon__position"></span>\n</button>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="card--user">\n<div class="user-card__block">\n';return a=this.invokePartial(n.userCardBody,"","userCardBody",e,void 0,t,n,i),null!=a&&(s+=a),s+='</div>\n<div class="user-card__button">\n',a=t["if"].call(e,null!=e?e.showRemoveButton:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),a=this.invokePartial(n.userFollowButton,"","userFollowButton",e,void 0,t,n,i),null!=a&&(s+=a),s+"</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/FollowerCardView",["home/views/UserCardView","home/templates/followerCard"],function(e,t){return e.extend({initialize:function(t){e.prototype.initialize.call(this,t),this.showRemoveButton=t.showRemoveButton},template:t,templateHelpers:function(){var t=e.prototype.templateHelpers.call(this);return t.showRemoveButton=this.showRemoveButton,t}})}),define("home/views/FollowerCollectionView",["underscore","jquery","core/strings","core/bus","home/views/FollowerCardView","home/views/common/FetchableCollectionView"],function(e,t,n,i,a,s){var o=n.get;return s.extend({initialize:function(e){s.prototype.initialize.call(this,e),this.user=e.user},events:e.defaults({"click [data-action=remove-follower]":"removeFollower"},s.prototype.events),itemView:a,itemViewOptions:function(){return{showRemoveButton:this.user.isSessionUser()}},removeFollower:function(e){if(this.user.isSessionUser()){e.preventDefault();var a=t(e.currentTarget),s=a.attr("data-user"),r=this.collection.findWhere({id:s}),l=window.confirm(n.interpolate(o("Remove %(follower)s as a follower?"),{follower:r.getDisplayName()}));if(l)return this.collection.remove(r),i.trigger("removeFollower",r),this.user.removeFollower(r)}}})}),define("home/templates/notificationCardFollow",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<div class="expandable">\n<div class="followers__expand">\n<a href="#" data-action="toggle-collapsed" class="expandable card-expand">\n<div class="icon-more-vert"></div>\n'+a(t.gettext.call(e,"See More",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n</div>\n"},3:function(e,t,n,i){var a=this.lambda,s=this.escapeExpression;return'<div class="collapsible">\n<div class="followers__collapse">\n<a class="button button-outline" href="/by/'+s(a(null!=e?e.sessionUsername:e,e))+'/followers/">\n'+s(t.gettext.call(e,"See All Followers",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="card__reason">\n<div class="notification__icon">\n<span class="icon-notification-follow icon__position text-small"></span>\n</div>'+s(t.gettext.call(e,"%(userNames)s followed you",{name:"gettext",hash:{userNames:t.getPartial.call(e,"userGroupNames",{name:"getPartial",hash:{},data:i})},data:i}))+'\n<span class="time text-gray">'+s(o(null!=e?e.relativeTime:e,e))+'</span>\n</div>\n<div data-role="users"></div>\n\n';return a=t["if"].call(e,null!=e?e.shouldCollapse:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t["if"].call(e,null!=e?e.hasOverflowActors:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r},useData:!0})}),define("home/views/NotificationCardFollowView",["underscore","backbone","backbone-marionette","home/views/common/ActivityCardView","home/mixins/withReason","home/mixins/asNotificationCard","home/mixins/asCollapsibleCard","home/mixins/withSubviews","home/models/Session","home/views/FollowerCollectionView","home/templates/notificationCardFollow"],function(e,t,n,i,a,s,o,r,l,c,d){var u=i,h=u.extend({className:function(){return"card-notif-follow"+(this.shouldCollapse()?" card-collapsed":"")},initialize:function(){this.session=l.get(),this.initializeShownActors()},initializeShownActors:function(){this.shownActors||(this.shownActors=e.pluck(this.model.activities,"actor"))},shouldCollapse:function(){return this.initializeShownActors(),this.shownActors.length>3},template:d,templateHelpers:function(){return{hasOverflowActors:this.model.get("totalActors")>this.model.actors.length,sessionUsername:this.session.user.get("username"),shouldCollapse:this.shouldCollapse()}},regions:{usersRegion:"[data-role=users]"},onRender:function(){this.activateRegion(this.usersRegion,this.createUsersView)},createUsersView:function(){return new c({user:this.session.user,el:this.usersRegion.el,itemViewOptions:function(e,t){return{className:"followers__wrap"+(t>2?" collapsible":""),showRemoveButton:!0}},collection:new t.Collection(this.shownActors)})}}),m=h.prototype;return a.call(m),s.call(m),o.call(m),r.call(m),h}),define("home/views/NotificationCardNoteView",["jquery","underscore","home/views/common/ActivityCardView","home/mixins/withReason","home/mixins/asNotificationCard","home/utils/navigationUtils","core/analytics/jester","core/bus"],function(e,t,n,i,a,s,o){var r=n,l=/\#.*/,c=function(n){var i=e("head");t.each(n,function(e,t){i.find("#"+t).length||i.append('<style type="text/css" id="'+t+'">'+e+"</style>")})},d=r.extend({initialize:function(){this.activity=this.model.activities[0],this.object=this.activity.object},events:{"click a":"trackClick"},className:"card-notif-note",getTemplate:function(){return"<div>"+t.reduce(d.TEMPLATE_INTERPOLATION_TABLE,function(e,t,n){return e.replace(RegExp(n,"g"),t.call(this))},this.object.get("body"),this)+"</div>"},getAnalyticsPayload:function(e){var t={verb:e,object_type:"note",object_id:this.activity.get("backendId")},n=this.object.get("template");return n&&(t.note_template_id=n.id,t.note_template_name=n.name),t},trackClick:function(n){var i=e(n.currentTarget);if(this.shouldTrackClick(n,i)){var a=o.client.emit(this.getAnalyticsPayload("click"));if(a&&this.shouldDelayNavigation(n,i)){n.preventDefault(),n.stopPropagation();var s=t.once(function(){window.top.location=i[0].href});t.delay(s,1e3),a.always(s)}}},shouldTrackClick:function(e,t){if(e.isDefaultPrevented())return!1;var n=(t.attr("href")||"").replace(l,"");return n?!0:!1},shouldDelayNavigation:function(e,t){return s.isInbound(e.target)?!1:!("_blank"===t.attr("target")||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey)},onRender:function(){c(this.object.get("styles")),this.activity.get("isUnread")&&o.client.emit(this.getAnalyticsPayload("view"))}},{TEMPLATE_INTERPOLATION_TABLE:{ACTIVITY_ID:function(){return this.activity.get("backendId")},RELATIVE_TIME:function(){return this.model.getRelativeTimestamp()}}});return i.call(d.prototype),a.call(d.prototype),d}),define("home/templates/notificationCardInvite",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" has-image"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="card__reason">\n<div class="notification__icon -invite">\n<span class="icon-notification-invite text-brand icon-small"></span>\n</div>'+s(t.gettext.call(e,"%(userName)s invited you to a new discussion on %(parent)s",{name:"gettext",hash:{parent:t.getPartial.call(e,"channelAwareForumLink",null!=e?e.thread:e,{name:"getPartial",hash:{},data:i}),userName:t.getPartial.call(e,"userName",null!=e?e.firstActor:e,{name:"getPartial",hash:{},data:i})},data:i}))+'\n<span class="time text-gray">'+s(o(null!=e?e.relativeTime:e,e))+'</span>\n</div>\n<div class="card__content -notification';return a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n',a=this.invokePartial(n.cardContentImage,"","cardContentImage",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="card-content__body">\n',a=this.invokePartial(n.threadTitle,"","threadTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+'<div class="card-content__summary text-medium">\n<div class="truncate" data-truncate-lines="3" dir="auto">\n'+s(o(null!=e?e.threadDescription:e,e))+'\n</div>\n</div>\n<p class="spacing-narrow spacing-top ">\n<a href="'+s(o(null!=e?e.discussionRoute:e,e))+'"\nclass="button button-outline text-medium"\ndata-thread-id="'+s(o(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\nJoin Discussion\n</a>\n</p>\n</div>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/NotificationCardInviteView",["home/views/common/ActivityCardView","home/mixins/withReason","home/mixins/asNotificationCard","home/utils/layoutUtils","home/mixins/withTruncate","home/templates/notificationCardInvite"],function(e,t,n,i,a,s){var o=e,r=o.extend({className:"card-notif-invite card-notif-note",template:s,templateHelpers:function(){return{threadDescription:this.model.thread.getPlainDescription(),image:this.model.thread.getImage(),numTitleLines:3}},initialize:function(){this.listenTo(this.model.thread,"change:content",this.render)}});return t.call(r.prototype),n.call(r.prototype),a.call(r.prototype),r}),define("home/templates/notificationCardCreate",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" has-image"},3:function(e,t,n,i){var a,s=this.escapeExpression,o="";return a=t["if"].call(e,null!=e?e.canCurate:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='<button\nclass="button button-outline -error text-medium spacing-right-small"\ndata-action="delete">\n<span class="icon-tiny icon-cancel spacing-right-small"></span>\n'+s(t.gettext.call(e,"Delete",{name:"gettext",hash:{},data:i}))+"\n</button>\n\n",a=t["if"].call(e,null!=e?e.canCurate:e,{name:"if",hash:{},fn:this.program(9,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o},4:function(e,t,n,i){var a,s="";return a=t.unless.call(e,null!=e?e.isApproved:e,{name:"unless",hash:{},fn:this.program(5,i),inverse:this.program(7,i),data:i}),null!=a&&(s+=a),s},5:function(e,t,n,i){var a=this.escapeExpression;return'<button\nclass="button button-outline -success text-medium spacing-right-small"\ndata-action="toggle-approve">\n<span class="icon-tiny spacing-right-small icon-checkmark"></span>\n'+a(t.gettext.call(e,"Approve",{name:"gettext",hash:{},data:i}))+"\n</button>\n"},7:function(e,t,n,i){var a=this.escapeExpression;return'<button\nclass="button button-outline -success text-medium spacing-right-small"\ndata-action="toggle-approve">\n<span class="icon-tiny spacing-right-small icon-checkmark"></span>\n'+a(t.gettext.call(e,"Approved",{name:"gettext",hash:{},data:i}))+"\n</button>\n"},9:function(e,t,n,i){var a=this.lambda,s=this.escapeExpression;return'<a href="'+s(a(null!=e?e.curationRoute:e,e))+'"\nclass="button button-outline -muted text-medium">\n'+s(t.gettext.call(e,"Curation Tool",{name:"gettext",hash:{},data:i}))+"\n</a>\n"},11:function(e,t,n,i){var a=this.escapeExpression;return'<span class="text-small text-gray">\n'+a(t.gettext.call(e,"This discussion was deleted.",{name:"gettext",hash:{},data:i}))+'\n<a href="#" data-action="restore">'+a(t.gettext.call(e,"Undo",{name:"gettext",hash:{},data:i}))+"</a>\n</span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="card__reason">\n<div class="notification__icon -new-discussion">\n<span class="icon-create-discussion text-smaller"></span>\n</div>'+s(t.gettext.call(e,"%(userName)s started a discussion on %(parent)s",{name:"gettext",hash:{parent:t.getPartial.call(e,"channelAwareForumLink",null!=e?e.thread:e,{name:"getPartial",hash:{},data:i}),userName:t.getPartial.call(e,"userName",null!=e?e.firstActor:e,{name:"getPartial",hash:{},data:i})},data:i}))+'\n\n<span class="time text-gray">'+s(o(null!=e?e.relativeTime:e,e))+'</span>\n</div>\n\n<div class="card__content -notification';return a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n',a=this.invokePartial(n.cardContentImage,"","cardContentImage",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="card-content__body">\n',a=this.invokePartial(n.threadTitle,"","threadTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="card-content__summary text-medium">\n<div class="truncate" data-truncate-lines="3" dir="auto">\n'+s(o(null!=e?e.threadDescription:e,e))+'\n</div>\n</div>\n<div class="spacing-top spacing-narrow align">\n',a=t.unless.call(e,null!=(a=null!=e?e.thread:e)?a.isDeleted:a,{name:"unless",hash:{},fn:this.program(3,i),inverse:this.program(11,i),data:i}),null!=a&&(r+=a),r+"</div>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/NotificationCardCreateView",["underscore","core/utils/releaseUtils","home/models/Session","home/views/common/ActivityCardView","home/mixins/withReason","home/mixins/asNotificationCard","home/mixins/withTruncate","home/utils/layoutUtils","home/templates/notificationCardCreate"],function(e,t,n,i,a,s,o,r,l){var c=i,d=c.extend({className:"card-notif-create card-notif-invite card-notif-note",template:l,templateHelpers:function(){var e=this.model.thread.forum.channel;return{threadDescription:this.model.thread.getPlainDescription(),image:this.model.thread.getImage(),numTitleLines:3,isApproved:this.isApproved,canCurate:t.isDisqusAdmin(this.session.user),curationRoute:e&&"/home/curate/channel/"+e.id+"/"}},events:{"click [data-action=toggle-approve]":"toggleApproveThread","click [data-action=delete]":"deleteThread","click [data-action=restore]":"restoreThread"},initialize:function(){this.session=n.get(),this.listenTo(this.model.thread,"change:content",this.render),this.listenTo(this.model.thread,"change:isDeleted",this.render)},toggleApproveThread:function(){var t=this.model.thread.forum.channel.id;this.isApproved?this.model.hideThreadFromChannel(t).then(e.bind(this._handleToggleApproveThread,this)):this.model.shareThreadToChannel(t).then(e.bind(this._handleToggleApproveThread,this))},_handleToggleApproveThread:function(){this.isApproved=!this.isApproved,this.render()},deleteThread:function(){this.model.thread.confirmDelete(!0)},restoreThread:function(){this.model.thread.restore()}}),u=d.prototype;return a.call(u),s.call(u),o.call(u),d}),define("home/templates/notificationFeedEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="empty-message">\n\n<svg class="art-empty-notifications" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 164.8 50" enable-background="new 0 0 164.8 50" xml:space="preserve"><path d="M0 11h13.7v3.6H0V11z" class="arm"/><path d="M15.4 11h4.2l18.1 37h-4.2L15.4 11z" class="arm"/><path d="M39 44.2h24.2V48H39V44.2z" class="arm"/><path d="M101.6 44.2h24.2V48h-24.2V44.2z" class="arm"/><path d="M145 11h4.2l-18.1 37h-4.2L145 11z" class="arm"/><path d="M151.1 11h13.7v3.6h-13.7V11z" class="arm"/><path d="M57.9 25c0-13.8 11.2-25 25-25s25 11.2 25 25s-11.2 25-25 25 S57.9 38.8 57.9 25z" class="body"/><path d="M71.1 20.7C71.8 26.5 76.8 31 82.9 31s11-4.5 11.8-10.3c-2.3 2.2-6.7 3-11.8 3S73.4 22.9 71.1 20.7z" class="mouth"/><path d="M63.3 16c0-2.1 1.8-3.9 4-3.9c2.2 0 4 1.7 4 3.9s-1.8 3.9-4 3.9 C65.1 19.9 63.3 18.1 63.3 16z" class="eye"/><path d="M94.4 15.6c0-2.1 1.8-3.8 4-3.8c2.2 0 4 1.7 4 3.8 c0 2.1-1.8 3.8-4 3.8C96.2 19.5 94.4 17.8 94.4 15.6z" class="eye"/></svg>\n\n<div class="notifications-empty-headline">'+a(t.gettext.call(e,"No Notifications",{name:"gettext",hash:{},data:i}))+"</div>\n"+a(t.gettext.call(e,"You must be new. Or quiet.",{name:"gettext",hash:{},data:i}))+"\n</div>\n"},useData:!0})}),define("home/views/NotificationFeedEmptyView",["backbone-marionette","home/templates/notificationFeedEmpty"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/views/NotificationCardCollectionView",["jquery","underscore","core/bus","home/views/ActivityCardCollectionView","home/views/NotificationCardChannelPostView","home/views/NotificationCardUpvoteView","home/views/NotificationCardChannelRecommendView","home/views/NotificationCardReplyView","home/views/NotificationCardFollowView","home/views/NotificationCardNoteView","home/views/NotificationCardInviteView","home/views/NotificationCardCreateView","home/views/NotificationFeedEmptyView"],function(e,t,n,i,a,s,o,r,l,c,d,u,h){var m=i.extend({itemView:function(e){var t=m.ITEM_VIEWS[e.model.get("verb")];return t?new t({model:e.model}):void 0},emptyView:h,initialize:function(){i.prototype.initialize.apply(this,arguments),this.listenTo(this,"after:item:added",this.onShowNotification);var e=t.debounce(t.bind(n.trigger,n,"after:render"),100);this.listenTo(this,"after:item:added",e),this.listenToOnce(this,"showFirstItem",function(){n.trigger("showFirstCard","notifications")})},onShowNotification:function(e){e.model&&e.model===this.collection.at(0)&&this.model.trigger("clearUnreadCount")}},{ITEM_VIEWS:{favorite:s,reply:r,follow:l,send:c,invite:d,create:u,recommend:o,"channel-post":a}});return m}),define("home/templates/notifications",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<div class="nav-notifs-settings dropdown" data-action="toggle-dropdown" data-dropdown="notif-settings">\n<a href="/home/settings/web/" title="'+a(t.gettext.call(e,"Control what notifications you see from %(Disqus)s.",{name:"gettext",hash:{Disqus:"Disqus"},data:i}))+'">\n<span class="icon-cog"></span>\n</a>\n<div class="dropdown-menu dropdown-notifs-settings">\n<header class="dropdown-notifs-settings-header">\n<h6>'+a(t.gettext.call(e,"Control Your Inbox",{name:"gettext",hash:{},data:i}))+"</h6>\n<p>"+a(t.gettext.call(e,"Use these settings to control what notifications you see from %(disqus)s. To change email notifications click %(here)s.",{name:"gettext",hash:{here:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"here",{name:"gettext",hash:{},data:i}),"data-action":"notification-settings",href:"#"},data:i}),disqus:"Disqus"},data:i}))+'</a></p>\n</header>\n<ul class="dropdown-notifs-settings-options">\n<li class="dropdown-notifs-settings-option">\n<label><input data-action="filter-toggle" data-filter="likepost" type="checkbox" name="upvotes" value="upvotes">'+a(t.gettext.call(e,"Hide upvotes",{name:"gettext",hash:{},data:i}))+'</label>\n</li>\n<li class="dropdown-notifs-settings-option">\n<label><input data-action="filter-toggle" data-filter="invite" type="checkbox" name="invite" value="invite">'+a(t.gettext.call(e,"Hide invitations",{name:"gettext",hash:{},data:i}))+"</label>\n</li>\n</ul>\n</div>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="section-contained">\n<div class="layout layout--no-aside">\n<div class="layout__main">\n<div class="layout__nav">\n<ul class="nav--no-aside">\n<li data-action="switch-tab" data-tab="all" class="nav__item active">\n<a href="/home/inbox/" class="nav-lnk -color-muted truncate-line">\n<div class="nav-lnk__blk">\n<span class="nav-lnk__icon icon icon-recent"></span>\n<span class="button__text">'+s(t.gettext.call(e,"Most Recent",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n<li data-action="switch-tab" data-tab="replies" class="nav__item">\n<a href="/home/inbox/replies/" class="nav-lnk -color-muted truncate-line">\n<div class="nav-lnk__blk">\n<span class="nav-lnk__icon icon icon-replies"></span>\n<span class="button__text">'+s(t.gettext.call(e,"Replies",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n<li class="nav__spacing hidden-md"></li>\n<li class="nav__item">\n<a href="/home/settings/web/" class="nav-lnk -color-muted truncate-line">\n<div class="nav-lnk__blk">\n<span class="nav-lnk__icon icon icon-settings"></span>\n<span class="button__text">'+s(t.gettext.call(e,"Settings",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n</ul>\n</div>\n<div class="layout__content">\n<div data-role="email-verification-alert"></div>\n<div class="nav-notifs sidebar-fixed notifs-fixed visible-sidebar">\n<div class="nav-notifs-body">\n<h2 class="nav-notifs-title">'+s(t.gettext.call(e,"Notifications",{name:"gettext",hash:{},data:i}))+"</h2>\n";
return a=t.unless.call(e,null!=e?e.isLoggedOut:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='<div class="nav-notifs-refresh">\n<a class="nav-refresh" data-action="refresh-drawer" href="#">\n<svg class="icon-refresh" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="338.2 -95.3 790.6 790.6" enable-background="new 338.2 -95.3 790.6 790.6" xml:space="preserve"><path d="M976.8 454.2l152-172.8h-98.9c-4.7-74.4-35.9-143.6-88.7-195.9C885.7 30.3 812.4 0 734.8 0 C571.7 0 439.1 134.5 439.1 300s132.6 300 295.7 300c66.2 0 131-22.5 182.5-63.4l9.3-7.4l-63.9-69.6l-8 6.1 c-34.7 26.3-76.1 40.2-119.8 40.2c-111.8 0-202.6-92.4-202.6-206S623 94.2 734.8 94.2c52.5 0 102.3 20.6 140.3 57.8 c35.3 34.7 56.6 80.3 60.6 129.4H823.5L976.8 454.2z"/></svg>\n</a>\n</div>\n</div>\n<ul class="nav-tabs">\n<li class="active" data-action="switch-tab" data-tab="all">\n<a class="truncate-line" href="/home/inbox/">\n'+s(t.gettext.call(e,"Most Recent",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li data-action="switch-tab" data-tab="replies">\n<a class="truncate-line" href="/home/inbox/replies/"><span class="icon-forward"></span>\n'+s(t.gettext.call(e,"Replies",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n</ul>\n</div>\n<div class="sidebar-scrollable notifs-scrollable scrollable-measure-selector"\ndata-role="content-area" data-mix-location="notifications"></div>\n</div>\n</div>\n<aside class="layout__aside hidden-lg">\n<div data-role="recommend-module" data-recommend-type="user" data-jester-area="recommended-users" class="module--aside"></div>\n<div data-role="recommend-module" data-recommend-type="forum" data-jester-area="recommended-forums" class="module--aside"></div>\n<div class="text-smaller text-gray">\n',a=this.invokePartial(n.homeFooter,"","homeFooter",e,void 0,t,n,i),null!=a&&(o+=a),o+"</div>\n</aside>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/NotificationsView",["underscore","jquery","home/utils/sidebarUtils","home/views/common/TabbedView","home/views/common/FetchableCollectionLayout","home/views/NotificationCardCollectionView","home/views/RecommendationsModuleView","home/views/HomepageRecommendedFeedEmptyView","home/templates/notifications","home/mixins/withClickLinkTracking","home/mixins/withEmailVerificationAlert"],function(e,t,n,i,a,s,o,r,l,c,d){var u=i.extend({defaultTab:"all",template:l,events:e.defaults({"click a[data-link-name]":"trackClickLink"},i.prototype.events),regions:e.defaults({recommendedUsersModuleRegion:"[data-role=recommend-module][data-recommend-type=user]",recommendedForumsModuleRegion:"[data-role=recommend-module][data-recommend-type=forum]"},i.prototype.regions),onDomRefresh:function(){i.prototype.onDomRefresh.call(this),this.recommendedUsersModuleRegion.show(o.createUserRecommendedModuleView({model:this.model.interestingUsers})),this.recommendedForumsModuleRegion.show(o.createForumRecommendedModuleView({model:this.model.interestingForums}))},getTrackingSection:function(e){return"replies"===e&&e},getMetaAttrs:function(){return"Notifications"},getTabView:function(e){var t=this.model[e];if(t){var n=new a({model:t,collection:t.get("items"),fetchableCollectionView:s,infiniteScroll:!0});return n.$el.attr({"data-mix-location":e}),n}}});return c.call(u.prototype),n.isSidebar()||d.call(u.prototype),u}),define("home/templates/notificationCardLogin",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="card-wrap card--notification">\n<div class="card__reason">\n<div class="notification__icon">\n<span class="icon icon-megaphone icon__position"></span>\n</div>\n'+a(t.gettext.call(e,"%(disqus)s Announcement",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+'\n</div>\n\n<div class="card__content -notification has-image">\n<a href="#" class="card-content__media" data-action="login">\n<div style="background-image: url('+a(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/notifications_logged_out.jpg)" class="img-cards"></div>\n</a>\n\n<div class="card-content__body">\n<h2 class="discussion-title" dir="auto">\n<a href="#" data-action="login" class="link-gray-darker truncate">\n'+a(t.gettext.call(e,"Get more with a %(disqus)s account!",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+'\n</a>\n</h2>\n<div class="card-content__summary">\n'+a(t.gettext.call(e,"Signing up means that you'll now be able to find old comments, discover new discussions, and get notified when someone replies to you.",{name:"gettext",hash:{},data:i}))+'\n</div>\n<div class="spacing-top spacing-bottom">\n<button data-action="login" class="button button-inverted button-inverted-fill text-medium">\n'+a(t.gettext.call(e,"Log In or Sign Up",{name:"gettext",hash:{},data:i}))+"\n</button>\n</div>\n</div>\n</div>\n</div>\n"},useData:!0})}),define("home/views/NotificationCardLoginView",["backbone-marionette","home/templates/notificationCardLogin","home/utils/navigationUtils"],function(e,t,n){var i=e.ItemView.extend({className:"card-notif-invite card-notif-note",events:{"click [data-action=login]":"navigateToLogin"},template:t,navigateToLogin:function(e){e&&e.preventDefault(),n.navigateToLogin()}});return i}),define("home/views/NotificationsLoggedOutView",["underscore","home/views/NotificationsView","home/views/NotificationCardLoginView"],function(e,t,n){var i=t.extend({templateHelpers:function(){var n=t.prototype.templateHelpers;return e.defaults({isLoggedOut:!0},e.isFunction(n)?n.call(this):n)},getTabView:function(){return new n}});return i}),define("home/templates/forumView",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="section-expanded sidebar-fixed">\n<div class="cover cover-forum" data-role="cover-area"></div>\n</div>\n<div class="section-contained">\n<div class="layout">\n<div class="layout__main">\n<div class="layout__nav hidden-sidebar">\n<ul class="nav--aside">\n<li data-action="switch-tab" data-tab="recent" class="nav__item">\n<a title="'+s(t.gettext.call(e,"Latest Discussions",{name:"gettext",hash:{},data:i}))+'" class="truncate-line nav-lnk -color-muted"\nhref="/home/forum/'+s(o(null!=e?e.id:e,e))+'/">\n<div class="nav-lnk__blk">\n<span class="button__text">'+s(t.gettext.call(e,"Latest Discussions",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n\n</a>\n</li>\n<li data-action="switch-tab" data-tab="commenters" class="nav__item">\n<a title="'+s(t.gettext.call(e,"Top Commenters",{name:"gettext",hash:{},data:i}))+'" class="truncate-line nav-lnk -color-muted"\nhref="/home/forum/'+s(o(null!=e?e.id:e,e))+'/commenters/">\n<div class="nav-lnk__blk">\n<span class="button__text">'+s(t.gettext.call(e,"Top Commenters",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n</ul>\n</div>\n<div class="layout__content">\n<div class="sidebar-scrollable forum-scrollable scrollable-measure-selector"\ndata-role="content-area" data-mix-location="feed"></div>\n</div>\n</div>\n<aside class="layout__aside hidden-md">\n<div data-role="recommend-module" data-recommend-type="forum" data-jester-area="recommended-forums" class="module--aside"></div>\n<div data-role="recommend-module" data-recommend-type="user" data-jester-area="recommended-users" class="module--aside"></div>\n<div class="text-smaller text-gray">\n';return a=this.invokePartial(n.homeFooter,"","homeFooter",e,void 0,t,n,i),null!=a&&(r+=a),r+"</div>\n</aside>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/mixins/asForumProfileCard",["jquery","underscore","home/utils/layoutUtils","home/mixins/withTruncate","home/mixins/withThreadCardDefaultFooter"],function(e,t,n,i,a){var s=function(){i.apply(this,arguments),a.apply(this,arguments),this.initialize=t.wrap(this.initialize,function(e){e.apply(this,t.rest(arguments));var n=this.model.thread||this.model;this.listenTo(n,"change:content",this.render),this.numTitleLines=3}),this.serializeData=t.wrap(this.serializeData,function(e){var i=e.apply(this,t.rest(arguments)),a=this.model.thread||this.model;return t.defaults(i,{image:a.getImage(),canShowThreadImage:n.shouldShowImages(),thread:a.toJSON(),numTitleLines:this.numTitleLines})})};return s}),define("home/templates/forumProfileCardRecent",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" no-image"},3:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},4:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<a href="'+i(n(null!=(t=null!=e?e.thread:e)?t.link:t,e))+'"\nclass="discussion-image"\ndata-link-name="image"\ndata-link-out="'+i(n(null!=(t=null!=e?e.thread:e)?t.signedLink:t,e))+'"\ndata-thread-id="'+i(n(null!=(t=null!=e?e.thread:e)?t.id:t,e))+'">\n\n<img src="'+i(n(null!=(t=null!=e?e.image:e)?t.src:t,e))+'" alt="'+i(n(null!=(t=null!=e?e.image:e)?t.title:t,e))+'">\n</a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="card-discussion';return a=t.unless.call(e,null!=e?e.image:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="card-aside">\n',a=t["if"].call(e,null!=e?e.canShowThreadImage:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</div>\n<div class="card-body">\n<div class="card-reason">\n'+s(t.gettext.call(e,"Recent activity",{name:"gettext",hash:{},data:i}))+" "+s(o(null!=e?e.relativeTime:e,e))+"\n</div>\n",a=this.invokePartial(n.threadTitle,"","threadTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="card-summary">\n<div class="card-summary-content truncate" data-truncate-lines="2" dir="auto">\n',a=o(null!=e?e.threadDescription:e,e),null!=a&&(r+=a),r+'\n</div>\n</div>\n<footer class="card-footer" data-role="footer"></div>\n</div>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/ForumProfileCardRecentView",["underscore","home/views/common/ActivityCardView","home/mixins/asForumProfileCard","home/templates/forumProfileCardRecent"],function(e,t,n,i){var a=t,s=a.prototype,o=a.extend({className:"card card-profile card-profile-forum",template:i,serializeData:function(){var t=s.serializeData.apply(this,arguments),n=this.model.thread;return e.defaults(t,{relativeTime:this.model.getRelativeTimestamp(),target:this.model.activities[0].target.toJSON(),threadDescription:n.getDefaultDescription()})}});return n.call(o.prototype),o}),define("home/views/ForumProfileCardCollectionView",["jquery","backbone","home/views/common/FetchableCollectionView","home/views/ForumProfileCardRecentView","home/mixins/withViewFeedTracking"],function(e,t,n,i,a){var s=n.extend({className:"cards",itemView:i});return a.call(s.prototype),s}),define("home/templates/forumCover",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return'<p class="cover-description">\n'+n(t(null!=e?e.plainDescription:e,e))+"\n</p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="section-contained">\n<div class="cover-body">\n<div class="cover-body-left">\n<div class="cover-profile-content" dir="auto">\n<div class="cover-profile-name-wrapper">\n<a href="'+o(s(null!=e?e.url:e,e))+'" data-link-out="'+o(s(null!=e?e.signedUrl:e,e))+'"><img class="cover-favicon" src="'+o(s(null!=e?e.faviconImage:e,e))+'" alt="';return a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+='"></a>\n<a href="'+o(s(null!=e?e.url:e,e))+'" data-link-out="'+o(s(null!=e?e.signedUrl:e,e))+'"><h1 class="cover-profile-name truncate-line">',a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+='</h1></a>\n<div class="cover-profile-action">\n',a=this.invokePartial(n.genericFollowButton,"","genericFollowButton",e,void 0,t,n,i),null!=a&&(r+=a),r+="</div>\n</div>\n",a=t["if"].call(e,null!=e?e.plainDescription:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<ul class="cover-attributes">\n<li class="cover-attribute">\n<a href="'+o(s(null!=e?e.url:e,e))+'" data-link-out="'+o(s(null!=e?e.signedUrl:e,e))+'">'+o(s(null!=e?e.friendlyUrl:e,e))+'</a>\n</li>\n</ul>\n<div class="cover-profile-action-mobile">\n',a=this.invokePartial(n.genericFollowButton,"","genericFollowButton",e,void 0,t,n,i),null!=a&&(r+=a),r+'</div>\n</div>\n</div>\n</div>\n</div>\n<div class="cover-nav-wrapper visible-sidebar">\n<div class="section-contained">\n<nav class="cover-nav cover-nav-profile-user">\n<ul class="cover-nav-options">\n<li class="cover-nav-option active" data-action="switch-tab" data-tab="recent">\n<a title="'+o(t.gettext.call(e,"Latest Discussions",{name:"gettext",hash:{},data:i}))+'" class="truncate-line" href="/home/forum/'+o(s(null!=e?e.id:e,e))+'/">\n<span class="hidden-md">'+o(t.gettext.call(e,"Latest Discussions",{name:"gettext",hash:{},data:i}))+'</span>\n<span class="visible-md">'+o(t.gettext.call(e,"Latest",{name:"gettext",hash:{},data:i}))+'</span>\n</a>\n</li>\n<li class="cover-nav-option" data-action="switch-tab" data-tab="commenters">\n<a title="'+o(t.gettext.call(e,"Top Commenters",{name:"gettext",hash:{},data:i}))+'" class="truncate-line" href="/home/forum/'+o(s(null!=e?e.id:e,e))+'/commenters/">\n<span class="hidden-md">'+o(t.gettext.call(e,"Top Commenters",{name:"gettext",hash:{},data:i}))+'</span>\n<span class="visible-md">'+o(t.gettext.call(e,"Commenters",{name:"gettext",hash:{},data:i}))+"</span>\n</a>\n</li>\n</ul>\n</nav>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/ForumCoverView",["underscore","backbone-marionette","home/utils/mixpanelUtils","home/utils/backboneUtils","home/models/Session","home/templates/forumCover"],function(e,t,n,i,a,s){var o=t.ItemView.extend({attributes:{"data-mix-location":"cover"},template:s,templateHelpers:function(){return{friendlyUrl:this.model.getFriendlyUrl(),plainDescription:this.model.getPlainDescription()}},events:{"click [data-action=toggle-follow]":"toggleFollow"},modelEvents:{"change:name":"render","change:isFollowing":"handleFollowedClass"},initialize:function(){this.session=a.get(),this.listenTo(this.session,"setModeratedForums",this.render)},handleFollowedClass:function(){this.$("[data-action=toggle-follow]").toggleClass("active",this.model.get("isFollowing"))},toggleFollow:function(e){e&&e.preventDefault(),n.track("follow forum",e,{properties:{follow:!this.model.get("isFollowing")}}),this.model.toggleFollowed()}},{getModel:function(e){return e.forum||e}});return o}),define("home/templates/forumProfileRecentEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="empty-message">\n\n<svg class="art-empty-community" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 94 128" enable-background="new 0 0 94 128" xml:space="preserve"><path class="house" d="M61 118.4l-9.8-10c-0.5-0.5-1.3-0.5-1.8 0l-9.8 10c-0.5 0.5-0.3 1 0.4 1h2v7.7c0 0.6 0 1 1 1h4.8v-7.7h5 v7.7h5c0.8 0 0.8-0.4 0.8-1v-7.7h2C61.3 119.3 61.5 118.9 61 118.4z" /><path class="bubble-top" d="M75.2 21C75.2 9.4 66.2 0 55 0C43.8 0 34.8 9.4 34.8 21c0 3.1 0.7 6.1 1.8 8.7l-3.4 8.5l8.7-1.2 c3.5 3.1 8.1 5 13.1 5C66.2 42 75.2 32.6 75.2 21z M56.4 26.6h-1.9V22h-5.1v4.5h-1.9V15.8h1.9v4.5h5.1v-4.5h1.9V26.6z M60.9 26.6 h-1.9v-8.1h1.9V26.6z M61 17.2h-2v-1.8h2V17.2z"/><path class="bubble-left" d="M79.3 47c-8 0-14.5 6.7-14.5 15c0 2.2 0.5 4.3 1.3 6.2l-2.4 6.1l6.2-0.9c2.5 2.2 5.8 3.6 9.3 3.6 c8 0 14.5-6.7 14.5-15S87.3 47 79.3 47z M80.5 66.6H79v-3.7h-4.2v3.7h-1.6v-8.9h1.6v3.7H79v-3.7h1.6V66.6z M84.3 66.6h-1.5v-6.7h1.5 V66.6z M84.3 58.9h-1.6v-1.5h1.6V58.9z" /><path class="bubble-right" d="M48.4 72c0-13.8-10.8-25-24.1-25C11 47 0.2 58.2 0.2 72S11 97 24.3 97c5.9 0 11.4-2.2 15.6-5.9l10.3 1.5 l-4-10.2C47.7 79.2 48.4 75.7 48.4 72z M26.4 78.6h-2.2v-5.3h-6v5.3H16V66h2.2v5.3h6V66h2.2V78.6z M31.7 78.6h-2.2v-9.5h2.2V78.6z M31.8 67.6h-2.3v-2.1h2.3V67.6z"/></svg>\n\n'+a(t.gettext.call(e,"This community hasn't been busy recently.",{name:"gettext",hash:{},data:i}))+'</br><a href="/">'+a(t.gettext.call(e,"Head back home to find interesting discussions »",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n"},useData:!0})}),define("home/views/ForumProfileRecentEmptyView",["backbone-marionette","home/templates/forumProfileRecentEmpty"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/templates/forumProfileTopCommentersEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="empty-message">\n\n<svg class="art-empty-community" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 94 128" enable-background="new 0 0 94 128" xml:space="preserve"><path class="house" d="M61 118.4l-9.8-10c-0.5-0.5-1.3-0.5-1.8 0l-9.8 10c-0.5 0.5-0.3 1 0.4 1h2v7.7c0 0.6 0 1 1 1h4.8v-7.7h5 v7.7h5c0.8 0 0.8-0.4 0.8-1v-7.7h2C61.3 119.3 61.5 118.9 61 118.4z" /><path class="bubble-top" d="M75.2 21C75.2 9.4 66.2 0 55 0C43.8 0 34.8 9.4 34.8 21c0 3.1 0.7 6.1 1.8 8.7l-3.4 8.5l8.7-1.2 c3.5 3.1 8.1 5 13.1 5C66.2 42 75.2 32.6 75.2 21z M56.4 26.6h-1.9V22h-5.1v4.5h-1.9V15.8h1.9v4.5h5.1v-4.5h1.9V26.6z M60.9 26.6 h-1.9v-8.1h1.9V26.6z M61 17.2h-2v-1.8h2V17.2z"/><path class="bubble-left" d="M79.3 47c-8 0-14.5 6.7-14.5 15c0 2.2 0.5 4.3 1.3 6.2l-2.4 6.1l6.2-0.9c2.5 2.2 5.8 3.6 9.3 3.6 c8 0 14.5-6.7 14.5-15S87.3 47 79.3 47z M80.5 66.6H79v-3.7h-4.2v3.7h-1.6v-8.9h1.6v3.7H79v-3.7h1.6V66.6z M84.3 66.6h-1.5v-6.7h1.5 V66.6z M84.3 58.9h-1.6v-1.5h1.6V58.9z" /><path class="bubble-right" d="M48.4 72c0-13.8-10.8-25-24.1-25C11 47 0.2 58.2 0.2 72S11 97 24.3 97c5.9 0 11.4-2.2 15.6-5.9l10.3 1.5 l-4-10.2C47.7 79.2 48.4 75.7 48.4 72z M26.4 78.6h-2.2v-5.3h-6v5.3H16V66h2.2v5.3h6V66h2.2V78.6z M31.7 78.6h-2.2v-9.5h2.2V78.6z M31.8 67.6h-2.3v-2.1h2.3V67.6z"/></svg>\n\n'+a(t.gettext.call(e,"Darn. No one comments in this community.",{name:"gettext",hash:{},data:i}))+'</br><a href="/">'+a(t.gettext.call(e,"Head back home to find interesting discussions »",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n"},useData:!0})}),define("home/views/ForumProfileTopCommentersEmptyView",["backbone-marionette","home/templates/forumProfileTopCommentersEmpty"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/mixins/withItemRemovalSkipped",[],function(){var e=function(){var e=this.addItemView;this.addItemView=function(t){return this.children.findByModel(t)?void 0:e.apply(this,arguments)};var t=this.removeItemView;this.removeItemView=function(){return this.isShowingNonItemView&&this.isShowingNonItemView()?t.apply(this,arguments):void 0}};return e}),define("home/views/UserCollectionView",["underscore","home/mixins/withItemRemovalSkipped","home/views/UserCardView","home/views/common/FetchableCollectionView","home/mixins/withViewFeedTracking"],function(e,t,n,i,a){var s=i.extend({itemView:n,emptyViewOptions:function(){return{model:this.options.user}}});return t.call(s.prototype),a.call(s.prototype),s}),define("home/views/ForumProfileView",["underscore","core/strings","home/templates/forumView","home/views/common/FetchableCollectionLayout","home/views/common/TabbedView","home/models/Session","home/utils/backboneUtils","home/views/RecommendationsModuleView","home/views/ForumProfileCardCollectionView","home/views/ForumCoverView","home/views/ForumProfileRecentEmptyView","home/views/ForumProfileTopCommentersEmptyView","home/views/UserCollectionView","home/mixins/withClickLinkTracking"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m){var p=t.get,f=a.extend({defaultTab:"recent",template:n,regions:e.defaults({coverRegion:"[data-role=cover-area]",recommendedUsersModuleRegion:"[data-role=recommend-module][data-recommend-type=user]",recommendedForumsModuleRegion:"[data-role=recommend-module][data-recommend-type=forum]"},a.prototype.regions),events:e.defaults({"click a[data-link-name]":"trackClickLink"},a.prototype.events),initialize:function(){a.prototype.initialize.apply(this,arguments);var e=s.get();e.loadPromise().then(function(){e.userProfile.forumsFollowing.ensureFetched()})},getTabView:function(e){var t;switch(e){case"recent":return t=new i({model:this.model.recent,collection:this.model.recent.get("items"),fetchableCollectionView:l,emptyView:d,infiniteScroll:!0});case"commenters":return t=new i({user:this.model.user,model:this.model.mostLikedUsers,collection:this.model.mostLikedUsers.get("items"),fetchableCollectionView:h,emptyView:u,infiniteScroll:!0}),t.$el.attr({"class":"card-wrap"}),t}},getTrackingSection:function(e){switch(e){case"recent":return"recent_threads";case"commenters":return"top_commenters"}},renderCover:function(){var t=new c({model:this.model.forum});t.listenTo(t,"dom:refresh",e.bind(this.updateTabClasses,this)),this.coverRegion.show(t)},onDomRefresh:function(){return this.$(this.coverRegion.el).length&&this.renderCover(),this.recommendedUsersModuleRegion.show(r.createUserRecommendedModuleView({model:this.model.interestingUsers})),this.recommendedForumsModuleRegion.show(r.createForumRecommendedModuleView({model:this.model.interestingForums})),a.prototype.onDomRefresh.apply(this,arguments)},getPageTitle:function(){var e=this.model.forum;return o.getPromiseFor(e,"name").then(function(e){return t.interpolate(p("%(forum)s · Conversations"),{forum:e})})},getMetaAttrs:function(){var e=this.model.forum;return this.getPageTitle().then(function(t){return{title:t,description:e.get("description"),image:e.has("favicon")&&e.get("favicon").cache,type:"article"}})},getPageTrackingParams:function(){var e=this.model.forum;return this.getPageTitle().then(function(t){return{forum:e.id,title:t}})},refreshRecommendedFeed:function(){this.model.popular.fetchItems({reset:!0})}});return m.call(f.prototype),f}),define("home/templates/topicCover",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.lambda,s=this.escapeExpression;return'<div class="cover-body-left">\n<h1 class="cover-title text-capitalized">'+s(a(null!=e?e.id:e,e))+'</h1>\n<p class="cover-description">'+s(t.gettext.call(e,"Trending discussions",{name:"gettext",hash:{},data:i}))+"</p>\n</div>\n"},useData:!0})}),define("home/views/TopicCoverView",["backbone-marionette","home/utils/backboneUtils","home/templates/topicCover"],function(e,t,n){var i=e.ItemView.extend({className:"cover-body",template:n,getMetaAttrs:function(){return t.getPromiseFor(this.model,"name").then(function(e){return e.charAt(0).toUpperCase()+e.slice(1)})}},{getModel:function(e){return e.topic||e}});return i}),define("home/templates/profileCover",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return'<div class="hidden-sidebar cover-profile-reputation">\n<span class="label--default button--info text-small">'+n(t(null!=e?e.userReputationLabel:e,e))+"</span>\n</div>\n"},3:function(e,t,n,i){var a=this.lambda,s=this.escapeExpression;return'<div class="cover-profile-flag">\n<a href="https://help.disqus.com/customer/portal/articles/1752367-report-a-user?flagged='+s(a(null!=e?e.username:e,e))+"&reporter="+s(a(null!=e?e.sessionUserName:e,e))+'" class="tooltipped"\ndata-toggle="tooltip" data-placement="bottom" title="'+s(t.gettext.call(e,"Report User",{name:"gettext",hash:{},data:i}))+'">\n<span class="icon-flag"></span>\n</a>\n</div>\n'},5:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<img src="'+i(n(null!=(t=null!=e?e.avatar:e)?t.cache:t,e))+'" alt="'+i(n(null!=e?e.username:e,e))+'" />\n'},7:function(e){var t=this.lambda,n=this.escapeExpression;return'<img src="'+n(t(null!=e?e.CDN_ROOT:e,e))+'/img/avatar-default.png" />\n'},9:function(e,t,n,i){var a=this.escapeExpression;return'<a href="/home/settings/profile/" class="button button-fill -small cover-profile-action-edit">\n'+a(t.gettext.call(e,"Edit Profile",{name:"gettext",hash:{},data:i}))+"\n</a>\n"},11:function(e){var t=this.lambda,n=this.escapeExpression;return'<span class="cover-nav-option-count">'+n(t(null!=e?e.numPosts:e,e))+"</span>\n"},13:function(e){var t=this.lambda,n=this.escapeExpression;return'<span class="cover-nav-option-count hidden-md" data-role="num-followers">'+n(t(null!=e?e.numFollowers:e,e))+"</span>\n"},15:function(e){var t=this.lambda,n=this.escapeExpression;return'<span class="cover-nav-option-count hidden-md" data-role="num-following">'+n(t(null!=e?e.numTotalFollowing:e,e))+"</span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="section-contained">\n<div class="cover-body">\n';return a=t["if"].call(e,null!=e?e.isDisqusNetMod:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t.unless.call(e,null!=e?e.isSessionUser:e,{name:"unless",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<div class="cover-body-left">\n<div class="cover-profile-avatar-wrapper">\n<a href="/by/'+o(s(null!=e?e.username:e,e))+'/" class="cover-profile-avatar">\n',a=t["if"].call(e,null!=(a=null!=e?e.avatar:e)?a.cache:a,{name:"if",hash:{},fn:this.program(5,i),inverse:this.program(7,i),data:i}),null!=a&&(r+=a),r+='</a>\n</div>\n<div class="cover-profile-content" dir="auto">\n<div class="cover-profile-name-wrapper">\n<h1 class="cover-profile-name text-largest truncate-line">'+o(s(null!=e?e.name:e,e))+'</h1>\n<div class="cover-profile-action">\n',a=this.invokePartial(n.userFollowButton,"","userFollowButton",e,void 0,t,n,i),null!=a&&(r+=a),a=t["if"].call(e,null!=e?e.isSessionUser:e,{name:"if",hash:{},fn:this.program(9,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</div>\n</div>\n<div class="cover-attribute-details">\n',a=this.invokePartial(n.profileCoverAttributes,"","profileCoverAttributes",e,void 0,t,n,i),null!=a&&(r+=a),r+='</div>\n\n<div class="cover-profile-action-mobile">',a=this.invokePartial(n.userFollowButton,"","userFollowButton",e,void 0,t,n,i),null!=a&&(r+=a),r+='</div>\n</div>\n</div>\n</div>\n</div>\n<div class="cover-nav-wrapper">\n<div class="section-contained">\n<nav class="cover-nav cover-nav-profile-user">\n<ul class="cover-nav-options">\n<li class="cover-nav-option" data-action="switch-tab" data-tab="comments">\n<a title="'+o(t.gettext.call(e,"Comments",{name:"gettext",hash:{},data:i}))+'" class="truncate-line" href="/by/'+o(s(null!=e?e.username:e,e))+'/comments/">\n'+o(t.gettext.call(e,"Comments",{name:"gettext",hash:{},data:i}))+"\n",a=t["if"].call(e,null!=e?e.showNumPosts:e,{name:"if",hash:{},fn:this.program(11,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</a>\n</li>\n<li class="cover-nav-option hidden-md hidden-sidebar" data-action="switch-tab" data-tab="discussions">\n<a title="'+o(t.gettext.call(e,"Discussions",{name:"gettext",hash:{},data:i}))+'" class="truncate-line" href="/by/'+o(s(null!=e?e.username:e,e))+'/discussions/">\n'+o(t.gettext.call(e,"Discussions",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li class="cover-nav-option hidden-md" data-action="switch-tab" data-tab="favorites">\n<a title="'+o(t.gettext.call(e,"Recommends",{name:"gettext",hash:{},data:i}))+'" class="truncate-line" href="/by/'+o(s(null!=e?e.username:e,e))+'/favorites/">\n'+o(t.gettext.call(e,"Recommends",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li class="cover-nav-option" data-action="switch-tab" data-tab="followers">\n<a title="'+o(t.gettext.call(e,"Followers",{name:"gettext",hash:{},data:i}))+'" class="truncate-line" href="/by/'+o(s(null!=e?e.username:e,e))+'/followers/">\n'+o(t.gettext.call(e,"Followers",{name:"gettext",hash:{},data:i}))+"\n",a=t["if"].call(e,null!=e?e.showNumFollowers:e,{name:"if",hash:{},fn:this.program(13,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</a>\n</li>\n<li class="cover-nav-option" data-action="switch-tab" data-tab="following">\n<a title="'+o(t.gettext.call(e,"Following",{name:"gettext",hash:{},data:i}))+'" class="truncate-line" href="/by/'+o(s(null!=e?e.username:e,e))+'/following/">\n'+o(t.gettext.call(e,"Following",{name:"gettext",hash:{},data:i}))+"\n",a=t["if"].call(e,null!=e?e.showNumTotalFollowing:e,{name:"if",hash:{},fn:this.program(15,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+"</a>\n</li>\n</ul>\n</nav>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/templates/spinnerTall",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div class="spinner-wrapper tall">\n<div class="spinner tall"></div>\n</div>\n'},useData:!0})}),define("home/views/ProfileCoverView",["jquery","backbone-marionette","home/mixins/withTruncate","home/utils/mixpanelUtils","home/templates/profileCover","home/templates/spinnerTall","home/models/Session"],function(e,t,n,i,a,s,o){var r=t.ItemView.extend({attributes:{"data-mix-location":"profile cover"},template:function(e){return e.name?a(e):s(e)},templateHelpers:function(){var e=o.get().user;return{sessionUserName:e.get("username"),isSessionUser:this.model.isSessionUser(),isDisqusNetMod:e.isDisqusNetMod(),numTotalFollowing:this.model.getNumTotalFollowing(),showNumPosts:this.model.has("numPosts"),showNumFollowers:this.model.has("numFollowers"),userReputationLabel:this.model.getUserReputationLabel(),numLines:3,showNumTotalFollowing:this.model.has("numFollowing")&&this.model.has("numForumsFollowing")}},events:{"click [data-action=toggle-follow]":"toggleFollow"},modelEvents:{"change:name":"render","change:isFollowing":"handleFollowedClass","change:numFollowers":"updateNumFollowers","change:numFollowing":"updateNumFollowing","change:numForumsFollowing":"updateNumFollowing","change:numChannelsFollowing":"updateNumFollowing"},handleFollowedClass:function(){this.$("[data-action=toggle-follow]").toggleClass("active",this.model.get("isFollowing"))},updateNumFollowers:function(){this.$("[data-role=num-followers]").text(this.model.get("numFollowers"))},updateNumFollowing:function(){this.$("[data-role=num-following]").text(this.model.getNumTotalFollowing())},toggleFollow:function(e){e&&e.preventDefault(),i.track("follow user",e,{properties:{follow:!this.model.get("isFollowing")}}),this.model.toggleFollowed()},onDomRefresh:function(){e(".tooltipped").tooltip()}});return n.call(r.prototype),r}),define("home/mixins/asProfileCard",["jquery","underscore","home/utils/layoutUtils","home/utils/mixpanelUtils","home/mixins/withTruncate"],function(e,t,n,i,a){var s=function(){a.apply(this,arguments);var e=this.events||{};this.events=t.extend({"click [data-role=thread-link]":"trackOpenedThread"},e),this.initialize=t.wrap(this.initialize,function(e){e.apply(this,t.rest(arguments)),this.listenTo(this.model.thread,"change:content",this.render),this.numTitleLines=3}),this.trackOpenedThread=function(e){i.track("click external article",e)},this.serializeData=t.wrap(this.serializeData,function(e){var i=e.apply(this,t.rest(arguments)),a=this.model.thread;return t.defaults(i,{discussionRoute:a&&a.getDiscussionRoute(),canShowThreadImage:n.shouldShowImages(),image:a&&a.getImage(),numTitleLines:this.numTitleLines,relativeTime:this.model.getRelativeTimestamp(),firstActor:this.model.actors[0]&&this.model.actors[0].toJSON()})
})};return s}),define("home/templates/profileCardPost",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s='<span class="icon-forward"></span>\n';return a=this.invokePartial(n.userName,"","userName",null!=e?e.replyAuthor:e,void 0,t,n,i),null!=a&&(s+=a),s},3:function(e){var t=this.lambda,n=this.escapeExpression;return'<span class="label label-danger">'+n(t(null!=e?e.hiddenExplanation:e,e))+"</span>\n"},5:function(){return"hidden"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r="";return a=this.invokePartial(n.userAvatar,"","userAvatar",null!=e?e.author:e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="comment-body">\n<header class="comment-header">\n',a=this.invokePartial(n.userName,"","userName",null!=e?e.author:e,void 0,t,n,i),null!=a&&(r+=a),a=t["if"].call(e,null!=e?e.replyAuthor:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<a class="link-gray time"\nhref="'+o(s(null!=e?e.discussionRoute:e,e))+"#comment-"+o(s(null!=e?e.id:e,e))+'"\ndata-link-name="timestamp"\ndata-thread-id="'+o(s(null!=(a=null!=e?e.thread:e)?a.id:a,e))+'">\n\n'+o(s(null!=e?e.relativeTime:e,e))+"\n</a>\n",a=t["if"].call(e,null!=e?e.isHidden:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</header>\n<div data-role="post-content"></div>\n<footer class="comment-actions ',a=t["if"].call(e,null!=e?e.isHidden:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'" data-role="post-actions">\n</footer>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/ProfilePostView",["jquery","underscore","home/views/PostView","home/templates/profileCardPost"],function(e,t,n,i){var a=n.extend({template:i,initialize:function(e){e=e||{},e.shouldCollapse=!1,n.prototype.initialize.apply(this,arguments),this.replyAuthor=e.replyAuthor},templateHelpers:function(){var e=n.prototype.templateHelpers.apply(this,arguments);return e.replyAuthor=this.replyAuthor&&this.replyAuthor.toJSON(),e}});return a}),define("home/views/ProfilePostCollectionView",["underscore","backbone-marionette","home/views/ProfilePostView"],function(e,t,n){var i=t.CollectionView.extend({getItemView:function(){return n},itemViewOptions:function(e){var t=e.object,n={model:t};return"reply"===e.get("verb")&&(n.replyAuthor=e.target.author),n}});return i}),define("home/templates/profileCardComments",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="card-discussion no-image">\n<div class="card-body">\n';return a=this.invokePartial(n.profileCardReason,"","profileCardReason",e,void 0,t,n,i),null!=a&&(s+=a),a=this.invokePartial(n.threadTitle,"","threadTitle",e,void 0,t,n,i),null!=a&&(s+=a),s+'<div class="card-comment" data-role="post"></div>\n</div>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/ProfileCardCommentsView",["underscore","backbone","home/views/common/ActivityCardView","home/mixins/asProfileCard","home/mixins/asCollapsibleCard","home/mixins/withSubviews","home/views/ProfilePostCollectionView","home/templates/profileCardComments"],function(e,t,n,i,a,s,o,r){var l=n,c=l.extend({className:"card card-profile card-profile-post",template:r,regions:{postsRegion:"[data-role=post]"},onRender:function(){this.activateRegion(this.postsRegion,this.createPostCollectionView)},createPostCollectionView:function(){return new o({el:this.postsRegion.el,collection:new t.Collection(this.model.activities)})}}),d=c.prototype;return a.call(d),i.call(d),s.call(d),c}),define("home/templates/profileCardFavorite",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" no-image"},3:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},4:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<a href="'+i(n(null!=(t=null!=e?e.thread:e)?t.link:t,e))+'"\nclass="discussion-image"\ndata-link-name="image"\ndata-link-out="'+i(n(null!=(t=null!=e?e.thread:e)?t.signedLink:t,e))+'"\ndata-thread-id="'+i(n(null!=(t=null!=e?e.thread:e)?t.id:t,e))+'">\n\n<img src="'+i(n(null!=(t=null!=e?e.image:e)?t.src:t,e))+'" alt="'+i(n(null!=(t=null!=e?e.image:e)?t.title:t,e))+'">\n</a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="card-discussion';return a=t.unless.call(e,null!=e?e.image:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="card-aside">\n',a=t["if"].call(e,null!=e?e.canShowThreadImage:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</div>\n<div class="card-body">\n',a=this.invokePartial(n.profileCardReason,"","profileCardReason",e,void 0,t,n,i),null!=a&&(r+=a),a=this.invokePartial(n.threadTitle,"","threadTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="card-profile-activity">\n',a=this.invokePartial(n.userAvatar,"","userAvatar",null!=e?e.firstActor:e,void 0,t,n,i),null!=a&&(r+=a),r+s(t.gettext.call(e,"%(userName)s recommended",{name:"gettext",hash:{userName:t.getPartial.call(e,"userName",null!=e?e.firstActor:e,{name:"getPartial",hash:{},data:i})},data:i}))+' <span class="bullet">'+s(o(null!=e?e.relativeTime:e,e))+"</span>\n</div>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/ProfileCardFavoriteView",["home/views/common/ActivityCardView","home/mixins/asProfileCard","home/templates/profileCardFavorite"],function(e,t,n){var i=e,a=i.extend({className:"card card-profile card-profile-favorite",template:n});return t.call(a.prototype),a}),define("home/templates/profileCardCreateDiscussion",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="card-discussion no-image">\n<div class="card-body">\n';return a=this.invokePartial(n.profileCardReason,"","profileCardReason",e,void 0,t,n,i),null!=a&&(r+=a),a=this.invokePartial(n.threadTitle,"","threadTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div class="card-profile-activity">\n',a=this.invokePartial(n.userAvatar,"","userAvatar",null!=e?e.firstActor:e,void 0,t,n,i),null!=a&&(r+=a),r+s(t.gettext.call(e,"%(userName)s started a discussion",{name:"gettext",hash:{userName:t.getPartial.call(e,"userName",null!=e?e.firstActor:e,{name:"getPartial",hash:{},data:i})},data:i}))+' <span class="bullet">'+s(o(null!=e?e.relativeTime:e,e))+"</span>\n</div>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/ProfileCardCreateDiscussionView",["home/views/common/ActivityCardView","home/mixins/asProfileCard","home/templates/profileCardCreateDiscussion"],function(e,t,n){var i=e,a=i.extend({className:"card card-profile card-profile-discussion",template:n});return t.call(a.prototype),a}),define("home/views/ProfileCardCollectionView",["backbone","core/bus","home/views/common/FetchableCollectionView","home/views/ProfileCardCommentsView","home/views/ProfileCardFavoriteView","home/views/ProfileCardCreateDiscussionView","home/mixins/withViewFeedTracking"],function(e,t,n,i,a,s,o){var r=n.extend({initialize:function(){n.prototype.initialize.apply(this,arguments),this.listenToOnce(this,"showFirstItem",function(){t.trigger("showFirstCard","profile")})},itemView:function(t){switch(t.model.get("verb")){case"reply":case"post":return new i(t);case"favorite":return new a(t);case"create":return new s(t);default:return new e.View}},emptyViewOptions:function(){return{model:this.options.user}}});return o.call(r.prototype),r}),define("home/templates/profileCommentsEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="empty-message card-wrap">\n\n<img class="empty-message__img" src="'+a(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/empty-states/comments.png"/>\n\n<div class="empty-message__content">\n<h2 class="text-larger">'+a(t.gettext.call(e,"%(name)s hasn't commented yet",{name:"gettext",hash:{name:null!=e?e.name:e},data:i}))+'</h2>\n<p class="text-gray text-medium">'+a(t.gettext.call(e,"Comments %(name)s leaves on discussions will appear here.",{name:"gettext",hash:{name:null!=e?e.name:e},data:i}))+'</p>\n<a href="/home/channels/explore/" class="button button-outline button-semi-wide text-large">'+a(t.gettext.call(e,"Find interesting discussions to join »",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n</div>\n"},useData:!0})}),define("home/views/ProfileCommentsEmptyView",["backbone-marionette","home/templates/profileCommentsEmpty"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/templates/profileFavoritesEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="empty-message card-wrap">\n\n<img class="empty-message__img" src="'+a(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/empty-states/recommends.png"/>\n\n<div class="empty-message__content">\n<h2 class="text-larger">'+a(t.gettext.call(e,"%(name)s hasn't recommended a discussion yet",{name:"gettext",hash:{name:null!=e?e.name:e},data:i}))+'</h2>\n<p class="text-gray text-medium">'+a(t.gettext.call(e,"Recommending a discussion shares it with people that follow you. Just click the heart!",{name:"gettext",hash:{},data:i}))+'</p>\n<a href="/home/channels/explore/" class="button button-outline button-semi-wide text-large">'+a(t.gettext.call(e,"Find interesting discussions »",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n</div>\n"},useData:!0})}),define("home/views/ProfileFavoritesEmptyView",["backbone-marionette","home/templates/profileFavoritesEmpty"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/templates/profileFollowersEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="empty-message">\n\n<img class="empty-message__img" src="'+a(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/empty-states/followers.png"/>\n\n<div class="empty-message__content">\n<h2 class="text-larger">'+a(t.gettext.call(e,"Nobody is following",{name:"gettext",hash:{name:null!=e?e.name:e},data:i}))+'</h2>\n<p class="text-gray text-medium">'+a(t.gettext.call(e,"Following people helps you keep up with what they’re saying and recommending.",{name:"gettext",hash:{},data:i}))+'</p>\n<a href="/home/channels/explore/" class="button button-outline button-semi-wide text-large">'+a(t.gettext.call(e,"Find interesting people to follow »",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n</div>\n"},useData:!0})}),define("home/views/ProfileFollowersEmptyView",["backbone-marionette","home/templates/profileFollowersEmpty"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/templates/profileRecentEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="empty-message card-wrap">\n\n<img class="empty-message__img" src="'+a(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/empty-states/discussions.png"/>\n\n<div class="empty-message__content">\n<h2 class="text-larger">'+a(t.gettext.call(e,"%(name)s hasn't started any discussions yet",{name:"gettext",hash:{name:null!=e?e.name:e},data:i}))+'</h2>\n<p class="text-gray text-medium">'+a(t.gettext.call(e,"Discussions started by %(name)s will appear here. Anyone can start one on channels!",{name:"gettext",hash:{name:null!=e?e.name:e},data:i}))+'</p>\n<a href="/home/channels/explore/" class="button button-outline button-semi-wide text-large">'+a(t.gettext.call(e,"Find a channel to start discussions on »",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n</div>\n"},useData:!0})}),define("home/views/ProfileRecentEmptyView",["backbone-marionette","home/templates/profileRecentEmpty"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/templates/profileUserModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="aside__subheadings">\n<h2 class="text-subheading">Moderation Links</h2>\n</div>\n<ul class="nav--aside">\n<li class="nav__item">\n<a href="https://disqus.com/admin/moderate/#/all/search/user:'+o(s(null!=e?e.username:e,e))+'" class="nav-lnk -color-muted text-small" target="_blank">\nView User in Mod Panel\n</a>\n</li>\n<li class="nav__item">\n<a href="https://disqus.com/disqus-admin/?action=user_lookup&username='+o(s(null!=e?e.username:e,e))+'" class="nav-lnk -color-muted text-small" target="_blank">\nLookup User in Admin Panel\n</a>\n</li>\n<li class="nav__spacing hidden-md"></li>\n<li class="nav__item">\n<a href="#" data-action="toggle-blacklist" class="nav-lnk -color-muted text-small">\n';return a=t["if"].call(e,null!=e?e.isOnGlobalBlacklist:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.program(4,i),data:i}),null!=a&&(r+=a),r+'</a>\n</li>\n<li class="nav__item">\n<a href="https://disqus.com/disqus-admin/blacklists/" class="nav-lnk -color-muted text-small">\nView Global Blacklist\n</a>\n</li>\n</ul>\n'},2:function(){return"Remove from Global Blacklist\n"},4:function(){return"Add to Global Blacklist\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="aside__wrap">\n<div class="aside__content text-gray-dark">\n';return a=this.invokePartial(n.profileCoverAttributes,"","profileCoverAttributes",e,void 0,t,n,i),null!=a&&(s+=a),s+="</div>\n</div>\n",a=t["if"].call(e,null!=e?e.isDisqusNetMod:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},usePartial:!0,useData:!0})}),define("home/views/ProfileUserModuleView",["backbone-marionette","moment","home/mixins/withTruncate","home/templates/profileUserModule","home/models/Session"],function(e,t,n,i,a){var s=e.ItemView.extend({template:i,events:{"click [data-action=toggle-blacklist]":"toggleBlacklist"},templateHelpers:function(){return{joinDate:t(this.model.get("joinedAt")).format("ll"),numLines:9,isDisqusNetMod:a.get().user.isDisqusNetMod()}},toggleBlacklist:function(){this.model.get("isOnGlobalBlacklist")?this.model.removeFromBlacklist():this.model.confirmBlacklist({notes:"Added via user profile",retroactive:!0})}});return n.call(s.prototype),s}),define("home/templates/profileAlertMessage",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="alert -brand text-small">\n<span class="icon-lock icon-tiny icon__position -inline"></span>\n'+a(t.gettext.call(e,"This user's profile has been set to private.",{name:"gettext",hash:{},data:i}))+"\n</div>\n"},useData:!0})}),define("home/views/ProfileAlertMessageView",["backbone-marionette","moment","home/templates/profileAlertMessage"],function(e,t,n){var i=e.ItemView.extend({template:n});return i}),define("home/templates/profileModerationDetailsModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<div class="aside__subheadings">\n<h2 class="text-subheading">Comment Moderation</h2>\n</div>\n<div class="aside__wrap">\n<div class="aside-user__body align text-small text-center padding-default">\n<div class="align__item truncate-line">\n<h3 class="text-large text-gray-darker">'+i(n(null!=(t=null!=(t=null!=e?e.counts:e)?t.global:t)?t.approved:t,e))+'</h3>\nApproved\n</div>\n<div class="align__item truncate-line">\n<h3 class="text-large text-gray-darker">'+i(n(null!=(t=null!=(t=null!=e?e.counts:e)?t.global:t)?t.spam:t,e))+'</h3>\nSpam\n</div>\n<div class="align__item truncate-line">\n<h3 class="text-large text-gray-darker">'+i(n(null!=(t=null!=(t=null!=e?e.counts:e)?t.global:t)?t.flagged:t,e))+"</h3>\nFlagged\n</div>\n</div>\n</div>\n"},useData:!0})}),define("home/views/ProfileModerationDetailsModuleView",["backbone-marionette","home/templates/profileModerationDetailsModule"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/templates/forumCard",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="/home/channel/'+o(s(null!=(a=null!=e?e.channel:e)?a.slug:a,e))+'/"\nclass="avatar"\ndata-link-name="forum_avatar"\ndata-forum-pk="'+o(s(null!=e?e.pk:e,e))+'">\n';return a=this.invokePartial(n.channelAvatarWithDefault,"","channelAvatarWithDefault",e,void 0,t,n,i),null!=a&&(r+=a),r+"</a>\n"},3:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.forumAvatarLink,"","forumAvatarLink",e,void 0,t,n,i),null!=a&&(s+=a),s},5:function(){return'<span class="label--default -inline">Creator</span>\n'},7:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.sessionUserIsModerator:e,{name:"if",hash:{},fn:this.program(8,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},8:function(){return'<span class="label--default -inline">Moderator</span>\n'},10:function(e){var t=this.lambda,n=this.escapeExpression;return n(t(null!=e?e.channelDescription:e,e))+"\n"},12:function(e){var t=this.lambda,n=this.escapeExpression;return'<a href="'+n(t(null!=e?e.url:e,e))+'"\ndata-link-out="'+n(t(null!=e?e.signedUrl:e,e))+'"\nclass="link-gray"\ndata-link-name="forum_description"\ndata-forum-pk="'+n(t(null!=e?e.pk:e,e))+'">'+n(t(null!=e?e.url:e,e))+"</a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="card--user">\n<div class="user-card__block">\n';return a=t["if"].call(e,null!=e?e.channel:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+='<div class="forum-info">\n<a class="name"\nhref="/home/forum/'+o(s(null!=e?e.id:e,e))+'/"\ndata-link-name="forum_name"\ndata-forum-pk="'+o(s(null!=e?e.pk:e,e))+'">\n\n',a=this.invokePartial(n.channelAwareForumName,"","channelAwareForumName",e,void 0,t,n,i),null!=a&&(r+=a),r+="</a>\n",a=t["if"].call(e,null!=e?e.sessionUserIsOwner:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.program(7,i),data:i}),null!=a&&(r+=a),r+='<p class="description truncate-line">\n',a=t["if"].call(e,null!=e?e.channelDescription:e,{name:"if",hash:{},fn:this.program(10,i),inverse:this.program(12,i),data:i}),null!=a&&(r+=a),r+='</p>\n</div>\n</div>\n<div class="user-card__button btn-follow--mobile">\n',a=this.invokePartial(n.genericFollowButton,"","genericFollowButton",e,void 0,t,n,i),null!=a&&(r+=a),r+"</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/ForumCardView",["underscore","backbone-marionette","home/utils/mixpanelUtils","home/mixins/withChannelAvatar","home/models/Session","home/templates/forumCard"],function(e,t,n,i,a,s){var o=t.ItemView.extend({template:s,templateHelpers:function(){var e=this.model.channel;return{sessionUserIsOwner:this.sessionUserIsOwner,sessionUserIsModerator:this.sessionUserIsModerator,channelDescription:e&&e.get("options").description}},className:"card",events:{"click [data-action=toggle-follow]":"toggleFollow"},modelEvents:{"change:isFollowing":"handleFollowedClass"},initialize:function(){this.session=a.get(),this.session.loadPromise().then(e.bind(this.renderIfOwner,this)),this.session.loadModeratedForums().then(e.bind(this.renderIfModerator,this))},renderIfOwner:function(){var e=this.model.channel&&this.model.channel.get("owner_id"),t=this.session.user.get("id");this.sessionUserIsOwner=e===t,this.sessionUserIsOwner&&this.render()},renderIfModerator:function(){var t=this.session.user.get("moderatedForums");this.sessionUserIsModerator=e.contains(t,this.model.get("id")),this.sessionUserIsModerator&&this.render()},handleFollowedClass:function(){this.$("[data-action=toggle-follow]").toggleClass("active",this.model.get("isFollowing"))},toggleFollow:function(e){e&&e.preventDefault(),n.track("follow forum",e,{properties:{follow:!this.model.get("isFollowing")}}),this.model.toggleFollowed()}});return i.call(o.prototype,function(){return this.model.channel}),o}),define("home/views/ForumCardCollectionView",["underscore","home/utils/layoutUtils","home/mixins/withItemRemovalSkipped","home/mixins/withViewFeedTracking","home/models/Session","home/views/ForumCardView","home/views/common/FetchableCollectionView"],function(e,t,n,i,a,s,o){var r=o.extend({itemView:s,initialize:function(){o.prototype.initialize.apply(this,arguments);var e=a.get();e.loadPromise().then(function(){e.userProfile.forumsFollowing.ensureFetched()})},itemViewOptions:function(e){return e.primaryForum?{model:e.primaryForum}:void 0},emptyViewOptions:function(){return{model:this.options.user}}});return n.call(r.prototype),i.call(r.prototype),r}),define("home/templates/profileFollowingPeopleEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="empty-message">\n\n<img class="empty-message__img" src="'+a(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/empty-states/following-people.png"/>\n\n<div class="empty-message__content">\n<h2 class="text-larger">'+a(t.gettext.call(e,"%(name)s isn't following anyone",{name:"gettext",hash:{name:null!=e?e.name:e},data:i}))+'</h2>\n<p class="text-gray text-medium">'+a(t.gettext.call(e,"Following people helps you keep up with what they’re saying and recommending.",{name:"gettext",hash:{},data:i}))+'</p>\n<a href="/home/channels/explore/" class="button button-outline button-semi-wide text-large">'+a(t.gettext.call(e,"Find interesting people to follow »",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n</div>\n"},useData:!0})}),define("home/views/ProfileFollowingPeopleEmptyView",["backbone-marionette","home/templates/profileFollowingPeopleEmpty"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/templates/profileFollowingCommunitiesEmpty",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"You aren't following any communities",{name:"gettext",hash:{},data:i}))},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"%(name)s isn't following any communities",{name:"gettext",hash:{name:null!=e?e.name:e},data:i}))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="empty-message">\n\n<img class="empty-message__img" src="'+s(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/empty-states/following-communities.png"/>\n\n<div class="empty-message__content">\n<h2 class="text-larger">';return a=t["if"].call(e,null!=e?e.isSessionUser:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(o+=a),o+'</h2>\n<p class="text-gray text-medium">'+s(t.gettext.call(e,"Following communities and channels helps you keep up with what their latest discussions.",{name:"gettext",hash:{},data:i}))+'</p>\n<a href="/home/channels/explore/" class="button button-outline button-semi-wide text-large">'+s(t.gettext.call(e,"Find interesting communities to follow »",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n</div>\n"},useData:!0})}),define("home/views/ProfileFollowingCommunitiesEmptyView",["backbone-marionette","home/templates/profileFollowingCommunitiesEmpty"],function(e,t){var n=e.ItemView.extend({template:t,templateHelpers:function(){return{isSessionUser:this.model.isSessionUser()}}});return n}),define("home/templates/profileFollowing",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.lambda,s=this.escapeExpression;return'<ul class="nav-tabs">\n<li class="active" data-action="switch-tab" data-tab="people">\n<a href="/by/'+s(a(null!=e?e.username:e,e))+'/following/">\n'+s(t.gettext.call(e,"People %(numberFollowing)s",{name:"gettext",hash:{numberFollowing:t.tag.call(e,"span",{name:"tag",hash:{text:null!=e?e.numFollowing:e,"data-role":"num-following","class":"nav-tab-stat"},data:i})},data:i}))+'\n</a>\n</li>\n<li data-action="switch-tab" data-tab="sites">\n<a href="/by/'+s(a(null!=e?e.username:e,e))+'/following/sites/">\n'+s(t.gettext.call(e,"Communities %(numberFollowing)s",{name:"gettext",hash:{numberFollowing:t.tag.call(e,"span",{name:"tag",hash:{text:null!=e?e.numCommunitiesFollowing:e,"data-role":"num-forums-following","class":"nav-tab-stat"},data:i})},data:i}))+'\n</a>\n</li>\n</ul>\n<div data-role="content-area" data-mix-location="following"></div>\n<div data-role="footer-area"></div>\n'},useData:!0})}),define("home/views/ProfileFollowingView",["underscore","home/utils/layoutUtils","home/utils/trackingUtils","home/views/common/TabbedView","home/views/UserCollectionView","home/views/ForumCardCollectionView","home/views/common/FetchableCollectionFooterView","home/views/ProfileFollowingPeopleEmptyView","home/views/ProfileFollowingCommunitiesEmptyView","home/templates/profileFollowing"],function(e,t,n,i,a,s,o,r,l,c){var d=i.extend({defaultTab:"people",template:c,templateHelpers:function(){return{numCommunitiesFollowing:this.model.getNumCommunitiesFollowing()}},regions:e.defaults({footerRegion:"[data-role=footer-area]"},i.prototype.regions),modelEvents:{"change:numFollowing":"updateNumFollowing","change:numForumsFollowing":"updateNumForumsFollowing","change:numChannelsFollowing":"updateNumForumsFollowing"},initialize:function(e){i.prototype.initialize.apply(this,arguments),this.userProfile=e.userProfile},getDefaultOptions:function(e){var t="sites"===e?this.userProfile.forumsFollowing:this.userProfile.following;return{user:this.model,model:t,collection:t.items,emptyView:"people"===e?r:l,infiniteScroll:!0}},updateTabContent:function(e){i.prototype.updateTabContent.call(this,e),this.footerRegion.show(new o(this.getDefaultOptions(this.activeTab)))},updateNumFollowing:function(){this.$("[data-role=num-following]").text(this.model.get("numFollowing"))},updateNumForumsFollowing:function(){this.$("[data-role=num-forums-following]").text(this.model.getNumCommunitiesFollowing())},getTrackingSection:function(e){return"sites"===e?"following-communities":"following-default"},getTabView:function(e){var t,n=this.getDefaultOptions(e);switch(e){case"people":t=new a(n),t.$el.attr({"data-mix-location":"users"});break;case"sites":t=new s(n),t.$el.attr({"data-mix-location":"forums"});break;default:return}return t.model.ensureFetched(),t}});return d}),define("home/templates/discussionsModuleItem",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" no-image"},3:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},4:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<a href="'+i(n(null!=(t=null!=e?e.thread:e)?t.link:t,e))+'"\ndata-link-name="image"\ndata-link-out="'+i(n(null!=(t=null!=e?e.thread:e)?t.signedLink:t,e))+'"\ndata-thread-id="'+i(n(null!=(t=null!=e?e.thread:e)?t.id:t,e))+'">\n\n<img src="'+i(n(null!=(t=null!=e?e.image:e)?t.src:t,e))+'" alt="'+i(n(null!=(t=null!=e?e.image:e)?t.title:t,e))+'" class="img-fit-sm" />\n</a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="post-comments clearfix';return a=t.unless.call(e,null!=e?e.image:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="pull-right spacing-left-small">\n',a=t["if"].call(e,null!=e?e.canShowThreadImage:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</div>\n<div class="card-body">\n<div class="text-medium spacing-bottom-narrow">\n',a=this.invokePartial(n.threadTitle,"","threadTitle",e,void 0,t,n,i),null!=a&&(r+=a),r+='</div>\n<div class="text-small text-gray link-gray">\n',a=this.invokePartial(n.channelAwareForumLink,"","channelAwareForumLink",null!=e?e.thread:e,void 0,t,n,i),null!=a&&(r+=a),r+'<time class="time">'+o(s(null!=e?e.relativeTime:e,e))+"</time>\n</div>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/DiscussionsModuleItemView",["backbone-marionette","home/utils/layoutUtils","home/templates/discussionsModuleItem"],function(e,t,n){var i=e.ItemView.extend({className:"post-comments__wrapper",template:n,templateHelpers:function(){var e=this.model.thread;return{image:e&&e.getImage(),numTitleLines:3,canShowThreadImage:t.shouldShowImages()}}});return i}),define("home/views/common/EnclosedDiscussionsModuleView",["backbone-marionette","home/views/DiscussionsModuleItemView"],function(e,t){var n=e.CompositeView.extend({className:"aside__wrap -padded",itemView:t,itemViewContainer:"[data-role=posts]",addItemView:function(t,n,i){return this.constructor.ITEMS_MAX&&i>this.constructor.ITEMS_MAX-1?void 0:e.CompositeView.prototype.addItemView.call(this,t,n,i)}});return n}),define("home/templates/profileRecommendedModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression,s=this.lambda;return'<header class="module-header text-center">\n<div class="module-header__icon">\n<span class="icon icon-latest-recommendation text-brand"></span>\n</div>\n<div class="module-header__title">\n<h2 class="module-header__heading">'+a(t.gettext.call(e,"Latest Recommendations",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n</header>\n\n<div data-role="posts" class="module-body"></div>\n\n<footer data-action="switch-tab" data-tab="favorites" class="module-footer">\n<a href="/by/'+a(s(null!=e?e.username:e,e))+'/favorites/" class="nav-lnk -color-muted -flushed">\n<div class="nav-lnk__blk">'+a(t.gettext.call(e,"See All Recommendations",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</footer>\n'},useData:!0})}),define("home/views/ProfileRecommendedModuleView",["home/views/common/EnclosedDiscussionsModuleView","home/templates/profileRecommendedModule"],function(e,t){var n=e.extend({template:t},{ITEMS_MAX:3});return n}),define("home/templates/profileCommentsModulePost",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="post-comments">\n<div class="spacing-bottom-narrow">\n<a href="'+o(s(null!=e?e.discussionRoute:e,e))+"#comment-"+o(s(null!=(a=null!=(a=null!=e?e.postActivity:e)?a.object:a)?a.id:a,e))+'" class="link-gray-dark truncate" data-truncate-lines="2">\n'+o(s(null!=e?e.message:e,e))+'\n</a>\n</div>\n<div class="link-gray text-gray text-small">\n';return a=this.invokePartial(n.channelAwareForumLink,"","channelAwareForumLink",null!=e?e.thread:e,void 0,t,n,i),null!=a&&(r+=a),r+'<time class="time">'+o(s(null!=e?e.relativeTime:e,e))+"</time>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/ProfileCommentsModulePostView",["backbone-marionette","core/utils/html","home/templates/profileCommentsModulePost","home/mixins/withTruncate"],function(e,t,n,i){var a=e.ItemView.extend({template:n,className:"post-comments__wrapper",templateHelpers:function(){var e=this.getPostActivity();
return{discussionRoute:this.model.thread.getDiscussionRoute(),postActivity:e.toJSON(),relativeTime:e.getRelativeCreatedAt(),message:t.stripTags(e.object.get("message"))}},getPostActivity:function(){return this.model.activities[0]}});return i.call(a.prototype),a}),define("home/templates/profileCommentsModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression,s=this.lambda;return'<header class="module-header text-center">\n<div class="module-header__icon">\n<span class="icon icon-latest-comments text-brand"></span>\n</div>\n<div class="module-header__title">\n<h2 class="module-header__heading">'+a(t.gettext.call(e,"Latest Comments",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n</header>\n\n<div data-role="posts" class="module-body"></div>\n\n<footer data-action="switch-tab" data-tab="comments" class="module-footer">\n<a href="/by/'+a(s(null!=e?e.username:e,e))+'/comments/" class="nav-lnk -color-muted -flushed">\n<div class="nav-lnk__blk">'+a(t.gettext.call(e,"See All Comments",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</footer>\n'},useData:!0})}),define("home/views/ProfileCommentsModuleView",["backbone-marionette","home/views/ProfileCommentsModulePostView","home/templates/profileCommentsModule"],function(e,t,n){var i=e.CompositeView.extend({template:n,className:"aside__wrap -padded",itemView:t,itemViewContainer:"[data-role=posts]",itemViewOptions:function(e,t){return t>2?{className:"hidden"}:void 0}});return i}),define("home/templates/profileModuleActiveForums",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="aside__subheadings">\n<h2 class="text-subheading">'+a(t.gettext.call(e,"Frequented Communities",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<div class="aside__wrap">\n<div data-role="forums"></div>\n</div>\n'},useData:!0})}),define("home/views/UserActiveForumsModuleView",["backbone-marionette","home/views/FollowingCardView","home/templates/profileModuleActiveForums"],function(e,t,n){var i=e.CompositeView.extend({template:n,itemView:t,itemViewContainer:"[data-role=forums]"});return i}),define("home/templates/profileView",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return'<div data-role="email-verification-alert"></div>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="section-expanded sidebar-fixed">\n<div class="cover cover-profile" data-role="cover-area"></div>\n</div>\n<div class="section-contained">\n<div class="layout -top-narrow">\n<div class="layout__main">\n<div class="layout__nav hidden-lg">\n<div data-role="user-module"></div>\n<div data-role="moderation-module"></div>\n<div data-role="active-forums-module" data-jester-area="active-forums-module"></div>\n</div>\n<div class="layout__content">\n<div class="hidden-sidebar" data-role="alert-message"></div>\n';return a=t["if"].call(e,null!=e?e.isSessionUser:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+='<div class="sidebar-scrollable profile-scrollable scrollable-measure-selector"\ndata-role="content-area" data-mix-location="feed"></div>\n</div>\n</div>\n<aside class="layout__aside hidden-md">\n<div data-role="comments-module" data-jester-area="comments-module" class="module--aside"></div>\n<div data-role="recommended-module" data-jester-area="recommended-module" class="module--aside"></div>\n<div class="text-smaller text-gray">\n',a=this.invokePartial(n.homeFooter,"","homeFooter",e,void 0,t,n,i),null!=a&&(s+=a),s+"</div>\n</aside>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/templates/privateProfile",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="empty-message empty-message-private">\n<div class="empty-message-private-face-wrapper">\n<svg class="art-private-sunglasses"xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 150.5 25" enable-background="new 0 0 150.5 25" xml:space="preserve">\n<polygon points="10.5,0 10.5,5 31.5,5 31.5,10 35.5,10 35.5,15 40.5,15 40.5,20 45.5,20 45.5,25 80.5,25 80.5,20 85.5,20 85.5,15 90.5,15 90.5,10 100.5,10 100.5,15 105.5,15 105.5,20 140.5,20 140.5,15 145.5,15 145.5,10 150.5,10 150.5,5 150.5,0"/>\n<rect x="0.5" y="5" width="10" height="5"/>\n<rect x="40.5" y="5" width="5" height="5" class="shading"/>\n<rect x="45.5" y="10" width="5" height="5" class="shading"/>\n<rect x="50.5" y="15" width="5" height="5" class="shading"/>\n<rect x="60.5" y="15" width="5" height="5" class="shading"/>\n<rect x="55.5" y="10" width="5" height="5" class="shading"/>\n<rect x="110.5" y="10" width="5" height="5" class="shading"/>\n<rect x="120.5" y="10" width="5" height="5" class="shading"/>\n<rect x="50.5" y="5" width="5" height="5" class="shading"/>\n<rect x="105.5" y="5" width="5" height="5" class="shading"/>\n<rect x="115.5" y="5" width="5" height="5" class="shading"/>\n</svg>\n<svg class="art-private-face" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 130 130" enable-background="new 0 0 130 130" xml:space="preserve"><circle cx="65" cy="65" r="65"/><path d="M14 41.6c0-5.5 4.7-10 10.5-10S35 36.1 35 41.6s-4.7 10-10.5 10 S14 47.2 14 41.6z"/><path d="M95 40.6c0-5.5 4.7-10 10.5-10s10.5 4.5 10.5 10s-4.7 10-10.5 10 S95 46.2 95 40.6z"/><rect x="51" y="62.6" width="46" height="4"/></svg>\n</div>\n<div> \n<svg class="art-private-text" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 240 35" enable-background="new 0 0 240 35" xml:space="preserve">\n<rect x="80" width="5" height="35"/>\n<polygon points="165,0 160,0 160,10 155,10 155,15 160,15 160,35 165,35 165,15 170,15 170,10 165,10"/>\n<polygon points="180,10 180,0 175,0 175,35 180,35 180,15 190,15 190,10"/>\n<rect x="190" y="15" width="5" height="20"/>\n<polygon points="5,30 5,5 20,5 20,0 0,0 0,35 20,35 20,30"/>\n<polygon points="45,20 35,20 35,15 30,15 30,30 35,30 35,25 50,25 50,15 45,15"/>\n<rect x="35" y="10" width="10" height="5"/>\n<polygon points="60,10 60,15 70,15 70,30 60,30 60,35 75,35 75,10"/>\n<rect x="105" y="10" width="5" height="20"/>\n<rect x="120" y="10" width="5" height="20"/>\n<rect x="135" y="10" width="5" height="20"/>\n<rect x="145" y="10" width="5" height="25"/>\n<rect x="145" width="5" height="5"/>\n<polygon points="235,10 235,0 230,0 230,10 225,10 225,15 230,15 230,35 235,35 235,15 240,15 240,10"/>\n<rect x="215" y="10" width="5" height="25"/>\n<rect x="215" width="5" height="5"/>\n<rect x="110" y="30" width="10" height="5"/>\n<rect x="125" y="30" width="10" height="5"/>\n<rect x="35" y="30" width="10" height="5"/>\n<rect x="55" y="15" width="5" height="15"/>\n<rect x="20" y="5" width="5" height="25"/>\n</svg>\n</div>\n<div class="empty-message__content">\n<p class="text-gray text-medium">This user\'s activity is private <span class="icon-lock icon__position -inline-swap"></span></span></p>\n<a href="/home/channels/explore/" class="button button-inverted-fill button-semi-wide text-large">'+a(t.gettext.call(e,"Find other interesting people »",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n\n</div>\n"},useData:!0})}),define("home/views/ProfileView",["jquery","underscore","backbone","backbone-marionette","core/strings","home/utils/layoutUtils","home/utils/backboneUtils","home/views/common/TabbedView","home/views/ProfileCoverView","home/views/ProfileCardCollectionView","home/views/ProfileCommentsEmptyView","home/views/ProfileFavoritesEmptyView","home/views/ProfileFollowersEmptyView","home/views/ProfileRecentEmptyView","home/views/ProfileUserModuleView","home/views/ProfileAlertMessageView","home/views/ProfileModerationDetailsModuleView","home/views/common/FetchableCollectionLayout","home/views/UserCollectionView","home/views/ProfileFollowingView","home/views/FollowerCollectionView","home/views/ProfileRecommendedModuleView","home/views/ProfileCommentsModuleView","home/views/ProfileModuleEmptyView","home/views/UserActiveForumsModuleView","home/templates/profileView","home/templates/spinnerTall","home/templates/privateProfile","home/mixins/withClickLinkTracking","home/mixins/withEmailVerificationAlert","home/models/Session"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f,g,v,w,b,x,y,_,k,C,T,S,E,F,P,D){var M=a.get,V=r.extend({defaultTab:"comments",template:function(e){return e.user.name?T(e):S},templateHelpers:function(){return{isSessionUser:this.model.user.isSessionUser()}},regions:t.defaults({coverRegion:"[data-role=cover-area]",userModuleRegion:"[data-role=user-module]",recommendedModuleRegion:"[data-role=recommended-module]",commentsModuleRegion:"[data-role=comments-module]",alertRegion:"[data-role=alert-message]",activeForumsModuleRegion:"[data-role=active-forums-module]",moderationModuleRegion:"[data-role=moderation-module]"},r.prototype.regions),events:t.defaults({"click a[data-link-name]":"trackClickLink"},r.prototype.events),initialize:function(e){r.prototype.initialize.apply(this,arguments),this.listenTo(this.model.user,"sync",this.render),this.subTab=e&&e.subTab,this.session=D.get(),this.listenTo(this,"change:activeTab",this.updateTabSpecificModules),this.listenTo(this.model,"moderationDetailsReady",this.onDomRefresh)},getMetaAttrs:function(){var e=this.model.user;return o.getPromiseFor(e,"name").then(function(n){return{type:"profile",title:a.interpolate(M("%(name)s · Profile"),{name:n}),description:t.escape(e.get("about")),image:e.has("avatar")&&e.get("avatar").cache}})},updateTabContent:function(){if(this.model.isPrivate()&&!this.session.user.isDisqusNetMod()){this.contentRegion.show(new i.ItemView({template:E}));var e=this;t.defer(function(){e.$(".empty-message-private").addClass("loaded")})}else r.prototype.updateTabContent.apply(this,arguments)},updateTabSpecificModules:function(e){this.model.isPrivate()||("comments"===e?(this.hideRegion(this.commentsModuleRegion),this.recommendedModuleRegion.$el.show()):("favorites"===e?this.hideRegion(this.recommendedModuleRegion):this.recommendedModuleRegion.$el.show(),this.commentsModuleRegion.$el.show(),this.commentsModuleRegion.currentView.render()))},hideRegion:function(e){e.$el&&e.$el.hide()},showProfileModerationModule:function(){this.moderationModuleRegion.show(new g({model:this.model.moderationDetails}))},onDomRefresh:function(){var e=this.session.user.isDisqusNetMod();this.userModuleRegion.show(new p({model:this.model.user})),(!this.model.isPrivate()||e)&&(this.recommendedModuleRegion.show(new y({model:this.model.user,collection:this.model.favorites.items,emptyView:k})),this.commentsModuleRegion.show(new _({model:this.model.user,collection:this.model.posts.items,emptyView:k})),this.activeForumsModuleRegion.show(new C({model:this.model.mostActiveForums,collection:this.model.mostActiveForums.items,emptyView:k}))),this.model.isPrivate()&&e&&this.alertRegion.show(new f({model:this.model.user})),this.$(this.coverRegion.el).length&&this.coverRegion.show(new l({model:this.model.user})),e&&this.showProfileModerationModule(),r.prototype.onDomRefresh.apply(this,arguments)},getTrackingSection:function(e){switch(e){case"following":return"following";case"followers":return"followers";case"comments":return"comments";case"favorites":return"favorites";case"discussions":return"discussions"}},getTabView:function(e){var n;switch(e){case"following":return n=new b({model:this.model.user,userProfile:this.model,activeTab:this.subTab}),n.$el.attr({"class":"card-wrap"}),this.listenTo(n,"badTab",t.bind(this.trigger,this,"badTab")),n;case"followers":return n=new v({user:this.model.user,model:this.model.followers,collection:this.model.followers.get("items"),fetchableCollectionView:x,emptyView:h,infiniteScroll:!0}),n.$el.attr({"data-mix-location":"followers","class":"card-wrap"}),n;case"comments":return n=this.getProfileCardCollectionView(this.model.user,this.model.posts,d),n.$el.attr({"data-mix-location":"posts"}),n;case"favorites":return n=this.getProfileCardCollectionView(this.model.user,this.model.favorites,u),n.$el.attr({"data-mix-location":"favorites"}),n;case"discussions":return n=this.getProfileCardCollectionView(this.model.user,this.model.threads,m),n.$el.attr({"data-mix-location":"discussions"}),n;case"recent":return n=this.getProfileCardCollectionView(this.model.user,this.model.profileFeed,m),n.$el.attr({"data-mix-location":"profile"}),n}},getProfileCardCollectionView:function(e,t,n){return new v({model:t,collection:t.get("items"),user:e,fetchableCollectionView:c,emptyView:n,infiniteScroll:!0})}});return F.call(V.prototype),P.call(V.prototype),V}),define("home/templates/discussionCreate",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Starting a discussion:",{name:"gettext",hash:{},data:i}))+"\n"},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Edit your discussion:",{name:"gettext",hash:{},data:i}))+"\n"},5:function(e,t,n,i){var a=this.escapeExpression;return'<li class="spacing-narrow">\n'+a(t.gettext.call(e,"%(emailMods)s to channel mods if you have concerns.",{name:"gettext",hash:{emailMods:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"Send an email",{name:"gettext",hash:{},data:i}),href:null!=e?e.emailHref:e,"class":"link-inverted text-semibold"},data:i})},data:i}))+"\n</li>\n"},7:function(e,t,n,i){var a=this.escapeExpression;return'<li class="spacing-narrow">\n'+a(t.gettext.call(e,"Discussions automatically close after 7 days.",{name:"gettext",hash:{},data:i}))+"\n</li>\n"},9:function(e,t,n,i){var a=this.escapeExpression;return'<div class="alert -brand  align--desktop align--between align--middle text-medium spacing-bottom">\n<div class="align__item">\n<strong>'+a(t.gettext.call(e,"First time creating a discussion?",{name:"gettext",hash:{},data:i}))+"</strong>\n"+a(t.gettext.call(e,"Checkout these %(formatTips)s to make sure it's the best it can be.",{name:"gettext",hash:{formatTips:t.tag.call(e,"button",{name:"tag",hash:{text:t.gettext.call(e,"formatting tips",{name:"gettext",hash:{},data:i}),"data-action":"show-formatting","class":"button button-link -inline -inverted text-medium"},data:i})},data:i}))+'\n</div>\n<div class="align__item button--formatting">\n<button class="button button-wide button-outline -shorter text-medium" data-action="show-formatting">\n'+a(t.gettext.call(e,"Formatting",{name:"gettext",hash:{},data:i}))+' <span class="icon-formatting text-gray-dark">A</span>\n</button>\n</div>\n</div>\n'},11:function(e,t,n,i){var a,s=this.escapeExpression;return'<div class="spacing-bottom">\n<div class="alert -warning text-medium">\n'+s(t.gettext.call(e,"%(channelName)s requires you to %(verifyEmail)s before starting a discussion.",{name:"gettext",hash:{channelName:null!=e?e.channelName:e,verifyEmail:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"verify your email address",{name:"gettext",hash:{},data:i}),"data-forum":null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.id:a,"data-action":"verify-email",href:"#"},data:i})},data:i}))+"\n</div>\n</div>\n"},13:function(){return" disabled"},15:function(){return' class="disabled"'},17:function(e,t,n,i){var a=this.escapeExpression;return'<div class="media spacing-bottom">\n<div class="media-left">\n<input id="dicussion-form-invite-checkbox" type="checkbox" name="invite-active-users">\n</div>\n<label for="dicussion-form-invite-checkbox" class="text-small text-gray-dark media-body media-heading">\n'+a(t.gettext.call(e,"Invite most active users",{name:"gettext",hash:{},data:i}))+'\n<p class="text-gray">\n'+a(t.gettext.call(e,"This will invite the most active users on %(channelName)s when you submit this discussion. Do this ONLY when the thread is final and ready for publishing.",{name:"gettext",hash:{channelName:null!=e?e.channelName:e},data:i}))+"\n</p>\n</label>\n</div>\n"},19:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Create Discussion",{name:"gettext",hash:{},data:i}))+"\n"},21:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Update Discussion",{name:"gettext",hash:{},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div data-role="banner"></div>\n<div class="section-contained form--discussion">\n<div class="layout">\n<div class="layout__main">\n<div class="layout__nav">\n<div class="aside__wrap aside-inverted">\n<div class="aside-inverted__content">\n<h2 class="text-large spacing-narrow">\n';return a=t["if"].call(e,null!=e?e.isNew:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(r+=a),r+='</h2>\n<ul class="list-bullet spacing-narrow text-medium">\n<li class="spacing-narrow">\n'+s(t.gettext.call(e,"Stay on topic for %(channelLink)s.",{name:"gettext",hash:{channelLink:t.tag.call(e,"a",{name:"tag",hash:{text:null!=e?e.channelName:e,href:null!=e?e.channelUrl:e,"class":"link-inverted text-semibold"},data:i})},data:i}))+"\n</li>\n",a=t["if"].call(e,null!=e?e.emailHref:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<li class="spacing-narrow">\n'+s(t.gettext.call(e,"Follow the %(home)s Rules.",{name:"gettext",hash:{home:"Home"},data:i}))+"\n</li>\n",a=t["if"].call(e,null!=e?e.isNew:e,{name:"if",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</ul>\n</div>\n</div>\n</div>\n<section class="layout__content">\n',a=t.unless.call(e,null!=e?e.sessionUserNumPosts:e,{name:"unless",hash:{},fn:this.program(9,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t.unless.call(e,null!=e?e.sessionUserVerified:e,{name:"unless",hash:{},fn:this.program(11,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<form>\n<div class="card-wrap">\n<div class="card__body">\n<div class="form-attribute-input" data-role="channel-categories" data-attribute="category"></div>\n\n<div class="spacing-bottom form-attribute-input" data-attribute="title">\n<h3 class="spacing-default text-gray-darker">\n'+s(t.gettext.call(e,"Title",{name:"gettext",hash:{},data:i}))+'\n<span class="text-gray text-small">'+s(t.gettext.call(e,"(Required)",{name:"gettext",hash:{},data:i}))+'</span>\n</h3>\n<input class="input--textbox -text-large text-semibold" name="title" type="text"\nplaceholder="'+s(t.gettext.call(e,"Headline for your discussion",{name:"gettext",hash:{},data:i}))+'" value="'+s(o(null!=e?e.title:e,e))+'"',a=t.unless.call(e,null!=e?e.sessionUserVerified:e,{name:"unless",hash:{},fn:this.program(13,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+=' />\n<div data-role="attribute-error" class="form-message-error spacing-default text-small"></div>\n</div>\n\n<div class="spacing-bottom form-attribute-input" data-attribute="topics displayName" data-role="topic-input"></div>\n\n<div class="spacing-bottom form-attribute-input" data-attribute="message">\n<h3 class="spacing-default text-gray-darker">'+s(t.gettext.call(e,"Describe your discussion",{name:"gettext",hash:{},data:i}))+'</h3>\n<div data-role="postbox"',a=t.unless.call(e,null!=e?e.sessionUserVerified:e,{name:"unless",hash:{},fn:this.program(15,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='></div>\n<div data-role="attribute-error" class="form-message-error spacing-default text-small"></div>\n<div class="align align--between spacing-top-narrow" data-role="toolbar"></div>\n</div>\n</div>\n</div>\n<div class="align--desktop align--between spacing-bottom">\n<div class="align__item discussion-form__input-block">\n<div class="media spacing-bottom">\n<div class="media-left">\n<input id="discussion-form-subscribe-checkbox" type="checkbox" name="subscribe" checked>\n</div>\n<label for="discussion-form-subscribe-checkbox" class="text-small text-gray-dark media-body media-heading">\n'+s(t.gettext.call(e,"Subscribe for email updates to this discussion",{name:"gettext",hash:{},data:i}))+"\n</label>\n</div>\n",a=t["if"].call(e,null!=e?e.canInviteActiveUsers:e,{name:"if",hash:{},fn:this.program(17,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</div>\n<div class="align__item clearfix">\n<div class="align--mobile">\n<div class="align--swap-first discussion-form__loading">\n<div class="spinner-small"></div>\n</div>\n<button type="button" data-action="cancel-create" class="button text-medium align--swap-first">\n'+s(t.gettext.call(e,"Cancel",{name:"gettext",hash:{},data:i}))+'\n</button>\n<button type="submit" class="button button-inverted-fill button--discussion-form text-medium align--swap-last"',a=t.unless.call(e,null!=e?e.sessionUserVerified:e,{name:"unless",hash:{},fn:this.program(13,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+=">\n",a=t["if"].call(e,null!=e?e.isNew:e,{name:"if",hash:{},fn:this.program(19,i),inverse:this.program(21,i),data:i}),null!=a&&(r+=a),r+='</button>\n</div>\n</div>\n</div>\n</form>\n</section>\n</div>\n<aside class="layout__aside">\n<div class="card-wrap">\n<div class="card__header -default">\n<h3 class="text-gray-darker">\n'+s(t.gettext.call(e,"%(home)s Rules",{name:"gettext",hash:{home:"Home"},data:i}))+'\n</h3>\n</div>\n<div class="text-medium text-gray-darker card__body spacing-inner rules__wrapper -discussion">\n',a=this.invokePartial(n.homeRules,"","homeRules",e,void 0,t,n,i),null!=a&&(r+=a),r+='</div>\n</div>\n<div class="text-smaller text-gray hidden-md">\n',a=this.invokePartial(n.homeFooter,"","homeFooter",e,void 0,t,n,i),null!=a&&(r+=a),r+"</div>\n</aside>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/templates/editDiscussionCategory",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i,a){var s,o=this.lambda,r=this.escapeExpression,l='<label class="input-block">\n<div class="align__item">\n<input type="radio" name="category" value="'+r(o(i&&i.key,e))+'" alt="'+r(o(e,e))+'" ';return s=t["if"].call(e,t.eq.call(e,i&&i.key,null!=a[1]?a[1].category:a[1],{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(2,i,a),inverse:this.noop,data:i}),null!=s&&(l+=s),l+' />\n</div>\n<div class="input-block__label align__item text-medium text-gray-darker">\n'+r(o(i&&i.key,e))+'\n<p class="text-gray">\n'+r(o(e,e))+"\n</p>\n</div>\n</label>\n"},2:function(){return"checked"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i,a){var s,o=this.escapeExpression,r='<h3 class="text-gray-darker">\n'+o(t.gettext.call(e,"Choose Category",{name:"gettext",hash:{},data:i}))+'\n<span data-toggle="tooltip" data-placement="bottom"\ntitle="'+o(t.gettext.call(e,"%(channelTitle)s requires that you choose a category to guide your discussion. This helps maintain a common theme throughout discussions on this channel.",{name:"gettext",hash:{channelTitle:null!=e?e.name:e},data:i}))+'">\n<span class="icon-questions icon__position icon-tiny text-gray"></span>\n</span>\n</h3>\n<div data-role="attribute-error" class="form-message-error text-small spacing-default"></div>\n';return s=t.each.call(e,null!=e?e.categories:e,{name:"each",hash:{},fn:this.program(1,i,a),inverse:this.noop,data:i}),null!=s&&(r+=s),r},useData:!0,useDepths:!0})}),define("home/views/EditDiscussionCategoryView",["jquery","underscore","backbone-marionette","home/templates/editDiscussionCategory"],function(e,t,n,i){var a=n.ItemView.extend({template:i,className:"discussion-form__categories",templateHelpers:function(){return{categories:this.model.thread.forum.channel.getCategories(),existingCategory:this.existingCategory}},initialize:function(){this.existingCategory=this.model.topics.getCategoryTopics()[0]},events:{"change input[name=category]":"categoryChanged"},onDomRefresh:function(){this.$("[data-toggle=tooltip]").tooltip()},categoryChanged:function(t){this.model.set({category:e(t.currentTarget).val()})}});return a}),define("home/templates/topicInput",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<h3 class="spacing-default text-gray-darker">\n'+a(t.gettext.call(e,"Topics",{name:"gettext",hash:{},data:i}))+'\n</h3>\n\n<div data-attribute="topics" class="input-group">\n<div data-role="topics"></div>\n<input class="input-group__text" name="topics" type="text"\nplaceholder="'+a(t.gettext.call(e,"Add topics here, separate with commas.",{name:"gettext",hash:{},data:i}))+'" />\n</div>\n\n<div data-role="attribute-error" class="form-message-error text-small spacing-default"></div>\n'},useData:!0})}),define("home/views/TopicInputView",["underscore","backbone-marionette","home/models/Topic","home/templates/topicInput","home/views/TopicTagView"],function(e,t,n,i,a){var s=t.CompositeView.extend({className:"topic-group__wrapper",template:i,itemView:a,itemViewContainer:"[data-role=topics]",initialize:function(){this.listenTo(this,"itemview:removeTag",this.handleRemoveTopicByTag)},events:{"keydown [name=topics]":"handleTopicInputKeydown","blur input[name=topics]":"handleTopicInputBlur"},ui:{topics:"[name=topics]"},handleTopicInputKeydown:function(t){if(e.contains(s.TOPIC_INSERTION_KEYS,t.keyCode)&&!t.shiftKey)t.preventDefault(),this.parseTopicInput();else if(8===t.keyCode){var n=this.ui.topics.val().length;if(!n){var i=e.last(this.collection.filter(function(e){return!e.get("hidden")}));i&&this.collection.remove(i)}}},handleTopicInputBlur:function(){this.parseTopicInput()},parseTopicInput:function(){var t=this.ui.topics.val();if(t){var i=t.split(",");e.each(i,function(e){var t=n.getOrCreateTopic(e);t&&this.collection.add(t)},this),this.clearTopicInput()}},clearTopicInput:function(){this.ui.topics.val("")},handleRemoveTopicByTag:function(e){this.collection.remove(e.model)}},{TOPIC_INSERTION_KEYS:[9,188,13,186]});return s}),define("home/mixins/asChannelBanner",["jquery","underscore"],function(e,t){var n={initialize:function(e,t){e.call(this,t),this.listenTo(this.model,"change:bannerColor",this.render)},onRender:function(e){e&&e.apply(this,t.rest(arguments));var n=this.model.get("options").alertBackground,i=this.model.get("bannerColor");n&&this.$(".banner__wrapper").css({"background-image":"url("+n+")","background-position":"0 0;"}).addClass("-image-background"),i&&this.$(".banner__wrapper").addClass("-"+i.toLowerCase())}};return function(){this.initialize=t.wrap(this.initialize,n.initialize),this.onRender=t.wrap(this.onRender,n.onRender)}}),define("home/templates/channelBanner",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="banner__wrapper">\n<a href="/home/channel/'+o(s(null!=e?e.slug:e,e))+'/" class="link-inverted">\n<div class="channel-cover section-contained align align--middle">\n';return a=this.invokePartial(n.channelCoverLogo,"","channelCoverLogo",e,void 0,t,n,i),null!=a&&(r+=a),r+"</div>\n</a>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/ChannelBannerView",["backbone-marionette","home/mixins/asChannelBanner","home/mixins/withClickLinkTracking","home/templates/channelBanner"],function(e,t,n,i){var a=e.ItemView.extend({template:i,events:{"click a":"trackClickLink"}}),s=a.prototype;return n.call(s,"channel_top_banner"),t.call(s),a}),define("home/models/formatting/LinkPopover",["backbone"],function(e){var t=function(e){return!(e&&e.trim())},n=e.Model.extend({defaults:{originalText:"",text:"",url:""},validate:function(e){return t(e.text)?{attrName:"text",message:"Link text is required."}:t(e.url)?{attrName:"url",message:"Link URL is required."}:void 0}});return n}),define("home/templates/linkInsertTooltip",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e){var t=this.lambda,n=this.escapeExpression;return'<form data-role="link-form">\n<div class="spacing-bottom-narrow form-attribute-input" data-attribute="text">\n<input name="text" class="input--textbox" placeholder="Link text" value="'+n(t(null!=e?e.text:e,e))+'">\n<div data-role="attribute-error" class="form-message-error spacing-default text-small"></div>\n</div>\n<div class="spacing-bottom-narrow form-attribute-input" data-attribute="url">\n<input name="url" class="input--textbox" placeholder="Link URL" value="'+n(t(null!=e?e.url:e,e))+'">\n<div data-role="attribute-error" class="form-message-error spacing-default text-small"></div>\n</div>\n<div class="text-center">\n<button type="submit" data-action="insert-link" class="button button-outline -wide -small">\nAdd Link\n</button>\n</div>\n</form>\n'},useData:!0})}),define("home/views/BasePopoverView",["jquery","underscore","backbone"],function(e,t,n){var i=n.View.extend({className:"popover notch-up notch--mobile-hidden",initialize:function(e){this.$target=e.$target},move:function(){this.$el.detach().appendTo(".viewport"),this.render(),this.delegateEvents(),this.updatePosition(this.$target,".viewport")},updatePosition:function(t,n){var i=t.offset().top,a=t.offset().left,s=t.height(),o=t.width(),r=this.$el.width(),l=e(window),c=l.width(),d=e(n).offset().top,u=this.constructor.calculateHorizontalAlignment(a,o,r,c);this.$el.toggleClass("-right","right"===u.position),this.$el.toggleClass("-left","left"===u.position),this.$el.css({top:i+s+this.constructor.TOP_MARGIN-d,left:u.left,bottom:"inherit","z-index":this.constructor.Z_INDEX})},show:function(){this.move(),this.$el.addClass("open")},hide:function(){this.$el.removeClass("open")},onBodyClick:function(t){var n=e(t.target);n.closest(this.$target).length||n.closest(this.$el).length||this.hide()}},{TOP_MARGIN:20,Z_INDEX:550,calculateHorizontalAlignment:function(e,t,n,i){var a,s,o=e-(n-t)/2,r=e+t-n,l=e,c=o+n>i&&r>0,d=0>o&&i>l+n,u=i>o+n&&o>0;return u?(s="centered",a=o):c?(s="right",a=r):d?(s="left",a=l):(s="leftEdge",a=0),{position:s,left:a}}});return i}),define("home/views/formatting/LinkPopoverView",["jquery","underscore","core/utils","home/templates/linkInsertTooltip","home/views/BasePopoverView"],function(e,t,n,i,a){var s=n.preventDefaultHandler,o=a,r=o.prototype,l=o.extend({events:{"blur input":"saveModel","submit [data-role=link-form]":"insertLink"},template:i,initialize:function(){r.initialize.apply(this,arguments),this.listenTo(this.model,{"change:text":function(e,t){this.$("[name=text]").val(t)},"change:url":function(e,t){this.$("[name=url]").val(t)}}),this._open=!1,this.onBodyClick=t.bind(this.onBodyClick,this)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},remove:function(){this.removeBodyEvent(),r.remove.apply(this,arguments)},attachBodyEvent:function(){e("body").on("click",this.onBodyClick)},removeBodyEvent:function(){e("body").off("click",this.onBodyClick)},show:function(){t.delay(t.bind(function(){this.$("input").eq(0).focus()},this),50),this._open||(this._open=!0,this.attachBodyEvent(),r.show.apply(this,arguments))},hide:function(){r.hide.apply(this,arguments),this._open&&(this._open=!1,this.removeBodyEvent(),this.saveModel(),this.trigger("hide"))},saveModel:function(){this.model.set({url:this.$("[name=url]").val().trim(),text:this.$("[name=text]").val()})},insertLink:s(function(){this.saveModel(),this.model.isValid()?this.trigger("submit",this.model.toJSON()):this.displayError(this.model.validationError)}),displayError:function(e){this.$(".form-attribute-input").removeClass("is-error"),this.$("[data-attribute="+e.attrName+"]").addClass("is-error").find("[data-role=attribute-error]").text(e.message)
}});return l}),define("home/templates/formattingButtons",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<button type="button" data-action="toggle-formatting" data-formatting="bold" class="button link-gray text-smaller">\n<strong title="Bold">B</strong>\n</button>\n<button type="button" data-action="toggle-formatting" data-formatting="italics" class="button link-gray text-smaller">\n<em title="Italic">I</em>\n</button>\n<button type="button" data-action="toggle-formatting" data-formatting="underline" class="button link-gray text-smaller">\n<u title="Underline">U</u>\n</button>\n<button type="button" data-action="toggle-formatting" data-formatting="blockquote" class="button link-gray text-smaller">\n❛❛\n</button>\n<button type="button" data-action="insert-link" class="button link-gray text-smaller">\n<span class="icon icon-link icon__position -inline icon-small" title="Link"></span>\n</button>\n'},useData:!0})}),define("home/views/formatting/FormattingButtonsView",["underscore","backbone","home/models/formatting/LinkPopover","home/views/formatting/LinkPopoverView","home/templates/formattingButtons"],function(e,t,n,i,a){var s=t.View,o=s.prototype,r=s.extend({template:a,events:{"click [data-action=toggle-formatting]":"onFormattingClick","click [data-action=insert-link]":"onInsertLinkClick"},initialize:function(e){this.getPostbox=e.getPostbox,this.linkModel=new n},render:function(){return this.$el.html(this.template()),this._popoverView?this:(this._popoverView=new i({$target:this.$("[data-action=insert-link]"),model:this.linkModel}),this.listenTo(this._popoverView,{hide:function(){var e=document.activeElement;e&&"INPUT"===e.tagName||this.getPostbox().textarea.restoreSelection()},submit:function(e){this.insertFormattingTags("link",{url:e.url,text:e.text}),this._popoverView.hide(),this.linkModel.clear()}}),this)},remove:function(){this._popoverView&&this._popoverView.remove(),o.remove.apply(this,arguments)},insertFormattingTags:function(t,n){var i=this.getPostbox().textarea;if("link"===t){var a='<a href="'+e.escape(n.url)+'">'+this.constructor.escapeCommentHtml(n.text)+"</a>";i.insertAtCursor(a)}else{var s=r.FORMATTING_TAGS[t];if(!s)throw Error("Invalid formatting operation: "+t);i.insertAroundSelection("<"+s+">","</"+s+">")}},onFormattingClick:function(e){var t=e.currentTarget.getAttribute("data-formatting");this.insertFormattingTags(t)},onInsertLinkClick:function(){var e=this.getPostbox().textarea,t=e.getSelected(),n={originalText:t};this.linkModel.get("text")&&this.linkModel.get("text")!==this.linkModel.get("originalText")||(n.text=t),this.linkModel.set(n),this._popoverView.show()}},{FORMATTING_TAGS:{bold:"strong",blockquote:"blockquote",italics:"em",underline:"u"},escapeCommentHtml:function(e){return e.replace(/&(?=\S)/g,"&amp;").replace(/<(?=\S)/g,"&lt;")}});return r}),define("home/templates/discussionCreateToolbar",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="input--formatting-region">\n<span data-role="formatting-buttons"></span>\n<span data-role="upload-button"></span>\n</div>\n\n<div class="align__item hidden-md">\n<button data-action="show-formatting" type="button" class="button text-smaller link-gray">\n<span class="icon-formatting">A</span>\n'+a(t.gettext.call(e,"Formatting Help",{name:"gettext",hash:{},data:i}))+"\n</button>\n</div>\n"},useData:!0})}),define("home/templates/formatting",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="modal-formatting">\n<div class="modal-body text-medium">\n<h1 class="text-larger spacing-bottom-narrow">\n<span class="icon-formatting">A</span> '+a(t.gettext.call(e,"Formatting Tips",{name:"gettext",hash:{},data:i}))+'\n</h1>\n<div class="align--desktop modal-formatting__block">\n<label class="modal-formatting__label"><a>'+a(t.gettext.call(e,"Linking text",{name:"gettext",hash:{},data:i}))+'</a></label>\n<textarea class="modal-formatting__textarea">&lt;a href="https://www.website.com/"&gt;'+a(t.gettext.call(e,"This is a link",{name:"gettext",hash:{},data:i}))+'&lt;/a&gt;</textarea>\n</div>\n<div class="align--desktop modal-formatting__block">\n<label class="modal-formatting__label">'+a(t.gettext.call(e,"Line Break",{name:"gettext",hash:{},data:i}))+'</label>\n<textarea class="modal-formatting__textarea">&lt;br&gt;</textarea>\n</div>\n<div class="align--desktop modal-formatting__block">\n<label class="modal-formatting__label"><strong>'+a(t.gettext.call(e,"Bold",{name:"gettext",hash:{},data:i}))+'</strong></label>\n<textarea class="modal-formatting__textarea">&lt;strong&gt;'+a(t.gettext.call(e,"Defines bold text",{name:"gettext",hash:{},data:i}))+'&lt;/strong&gt;</textarea>\n</div>\n<div class="align--desktop modal-formatting__block">\n<label class="modal-formatting__label"><blockquote>'+a(t.gettext.call(e,"Block Quote",{name:"gettext",hash:{},data:i}))+'</blockquote></label>\n<textarea class="modal-formatting__textarea">&lt;blockquote&gt;'+a(t.gettext.call(e,"Defines a long quotation",{name:"gettext",hash:{},data:i}))+'&lt;/blockquote&gt;</textarea>\n</div>\n<div class="align--desktop modal-formatting__block">\n<label class="modal-formatting__label"><em>'+a(t.gettext.call(e,"Italic",{name:"gettext",hash:{},data:i}))+'</em></label>\n<textarea class="modal-formatting__textarea">&lt;em&gt;'+a(t.gettext.call(e,"Defines italic text",{name:"gettext",hash:{},data:i}))+'&lt;/em&gt;</textarea>\n</div>\n<div class="align--desktop modal-formatting__block">\n<label class="modal-formatting__label"><strike>'+a(t.gettext.call(e,"Strikethrough",{name:"gettext",hash:{},data:i}))+'</strike></label>\n<textarea class="modal-formatting__textarea">&lt;strike&gt;'+a(t.gettext.call(e,"Defines strikethrough text",{name:"gettext",hash:{},data:i}))+'&lt;/strike&gt;</textarea>\n</div>\n<div class="align--desktop modal-formatting__block">\n<label class="modal-formatting__label"><u>'+a(t.gettext.call(e,"Underlined",{name:"gettext",hash:{},data:i}))+'</u></label>\n<textarea class="modal-formatting__textarea">&lt;u&gt;'+a(t.gettext.call(e,"Defines underlined text",{name:"gettext",hash:{},data:i}))+"&lt;/u&gt;</textarea>\n</div>\n</div>\n</div>\n"},useData:!0})}),define("home/templates/uploadButton",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<button type="button" class="button text-smaller link-gray" data-action="attach" title="Upload Images">\n<span class="icon-photo icon__position -inline"></span>\n</button>\n<input type="file" class="hidden" data-role="media-upload" tabindex="-1" accept="image/*">\n'},useData:!0})}),define("home/views/DiscussionCreateToolbarView",["underscore","backbone","backbone-marionette","core/views/media/UploadButtonView","home/mixins/withSubviews","home/utils/confirmModal","home/views/formatting/FormattingButtonsView","home/templates/discussionCreateToolbar","home/templates/formatting","home/templates/uploadButton"],function(e,t,n,i,a,s,o,r,l,c){var d=n.ItemView,u=d.prototype,h=d.extend({template:r,events:{"click [data-action=show-formatting]":"showFormatting"},regions:{formattingButtonsRegion:"[data-role=formatting-buttons]",uploadButtonRegion:"[data-role=upload-button]"},initialize:function(e){this.getPostbox=e.getPostbox,this.enableFormatting=e.enableFormatting},render:function(){return u.render.call(this),this.activateRegion(this.uploadButtonRegion,this.createUploadButton),this.enableFormatting&&this.activateRegion(this.formattingButtonsRegion,this.createFormattingButtons),this},createUploadButton:function(){var e=new i({el:this.uploadButtonRegion.el,template:c});return this.listenTo(e,"uploader:attachMedia",function(){var e=this.getPostbox();e.handleUploadViaButton.apply(e,arguments)}),e},createFormattingButtons:function(){return new o({el:this.formattingButtonsRegion.el,getPostbox:this.getPostbox})},showFormatting:function(){s.confirmationPromise(s.TYPES.CLOSE,l(this.model.thread.forum.channel.toJSON()))}});return a.call(h.prototype),h}),define("home/templates/discussionChannelInfo",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<img class="favicon" src="'+i(n(null!=(t=null!=e?e.options:e)?t.favicon:t,e))+'" alt="'+i(n(null!=e?e.name:e,e))+'"/>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a class="discussion-origin-name truncate-line" href="/home/channel/'+o(s(null!=e?e.slug:e,e))+'/">\n';return a=t["if"].call(e,null!=(a=null!=e?e.options:e)?a.favicon:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+o(s(null!=e?e.name:e,e))+"\n</a>\n"},useData:!0})}),define("home/templates/threadSubmitError",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda;return'<div class="modal-header">\n<h4 class="modal-title">'+s(t.gettext.call(e,"Uh oh, we weren't unable to save your discussion",{name:"gettext",hash:{},data:i}))+'</h4>\n</div>\n<div class="modal-body">\n<p>'+s(o(null!=(a=null!=e?e.responseJSON:e)?a.response:a,e))+"</p>\n</div>\n"},useData:!0})}),define("home/views/DiscussionCreateView",["underscore","backbone","backbone-marionette","core/mixins/withEmailVerifyLink","core/utils/storage","core/strings","core/switches","core/utils/releaseUtils","home/mixins/withSubviews","core/UniqueModel","home/models/Thread","home/templates/discussionCreate","home/utils/features","home/utils/backboneUtils","home/utils/confirmModal","home/utils/trackingUtils","home/models/Post","home/views/PostReplyView","home/views/EditDiscussionCategoryView","home/views/TopicInputView","home/views/ChannelBannerView","home/views/DiscussionCreateToolbarView","home/templates/discussionChannelInfo","home/templates/threadSubmitError"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f,g,v,w,b,x,y,_,k){var C=s.get,T=n.ItemView,S=T.prototype,E=T.extend({template:u,templateHelpers:function(){var t=this.model.thread.forum.channel.get("options").modEmail,n=e.contains(this.session.moderatedForums,this.model.thread.forum.id);return{isNew:this.isNew,sessionUserNumPosts:this.session.user.get("numPosts"),sessionUserVerified:this.session.user.get("isVerified"),emailHref:t?"mailto:"+t:"",channelName:this.model.thread.forum.channel.get("name"),channelUrl:"/home/channel/"+this.model.thread.forum.channel.get("slug")+"/",canInviteActiveUsers:n,canModifyTopics:this.canModifyTopics}},events:{submit:"submitThread","click [data-action=cancel-create]":"navigateBack","blur input[name=title]":"updateTitle"},ui:{title:"[name=title]",subscribe:"[name=subscribe]",inviteActiveUsers:"[name=invite-active-users]"},initialize:function(e){var t=this.model.thread;this.isNew=t.isNew(),f.setSection(this.isNew?"create":"edit"),this.listenTo(this.model,"change:category",this.categoryChanged),this.listenTo(this.model,"change",this.updateValidationErrors),this.listenTo(this.model.topics,"add remove reset",this.updateValidationErrors),this.listenTo(this.model,"invalid",this.handleValidationError),this.session=e.session},regions:{postboxRegion:"[data-role=postbox]",channelInfoRegion:"[data-role=channel-info]",categoriesRegion:"[data-role=channel-categories]",topicInputRegion:"[data-role=topic-input]",bannerRegion:"[data-role=banner]",toolbarRegion:"[data-role=toolbar]"},getThread:function(){return this.model.thread},getMetaAttrs:function(){return m.getPromiseFor(this.model.thread.forum,"name").then(function(e){return s.interpolate(C("Create new discussion on %(name)s"),{name:e})})},render:function(){if(S.render.call(this),!this.session.fetched)return void this.session.fetch().then(e.bind(this.render,this));this.activateRegion(this.postboxRegion,this.createPostbox),this.activateRegion(this.toolbarRegion,this.createToolbarView);var t=this.model.thread.forum.channel;if(t){this.activateRegion(this.channelInfoRegion,this.createChannelView),this.activateRegion(this.bannerRegion,this.createBanner),this.activateRegion(this.topicInputRegion,this.createTopicInput);var n=t.getCategories();n&&this.activateRegion(this.categoriesRegion,this.createCategoriesView)}return this},createToolbarView:function(){return new y({el:this.toolbarRegion.el,enableFormatting:o.isFeatureActive("home_discussion_formatting"),model:this.model,getPostbox:e.bind(function(){return this.postboxRegion.currentView},this)})},createBanner:function(){return new x({el:this.bannerRegion.el,model:this.model.thread.forum.channel})},createChannelView:function(){return new n.ItemView({el:this.channelInfoRegion.el,model:this.model.thread.forum.channel,template:_})},createCategoriesView:function(){var e=new w({model:this.model});return this.bindTitleCategoryHandlers(),e},categoryChanged:function(e,t){var n=this.ui.title,i=this.model._previousAttributes.category;if(i){var a=n.val().match(RegExp(i+d.CATEGORY_TITLE_SEPARATOR+"(.*)"));a&&n.val(a[1])}n.val(t+d.CATEGORY_TITLE_SEPARATOR+n.val()),this.updateTitle()},bindTitleCategoryHandlers:function(){if(!this.titleCategoryHandlerBound){var t=this.ui.title,n=e.partial(function(t,n){var i=t.get("category"),a=i&&(i+d.CATEGORY_TITLE_SEPARATOR).length;return!e.contains(E.NON_EDITING_KEYS,n.which)&&(a>this.selectionStart||this.selectionStart===a&&8===n.which)?!1:void 0},this.model);t.on("keydown",n),this.titleCategoryHandlerBound=!0}},submitThread:function(t){t.preventDefault();var n,i;!this._submitLocked&&this.model.isValid()&&(n=this.postboxRegion.currentView,i=n.textarea.get(),this._submitLocked=this.model.thread.save({title:this.ui.title.val(),message:i},{success:e.bind(this.handleThreadCreate,this),error:e.bind(this.handleSaveError,this)}),this._submitLocked&&this.$el.find("form").addClass("is-submitting"))},createPostbox:function(){var e=new v({model:this.model.thread,thread:this.model.thread,placeholder:C("Tell people what you want your discussion to be about.  Use gifs and images too."),session:this.session,canUseContentEditable:h.canUseContentEditable(),showSubmitButton:!1,showAvatar:!1,showMediaPreviews:!0,showMustVerifyAlert:!1,enableUploadUrls:!0});return this.listenTo(e,"blur",this.updateMessage),e},createTopicInput:function(){return new b({collection:this.model.topics})},handleThreadCreate:function(){var e=this.ui.subscribe.prop("checked");e&&this.model.thread.subscribe();var t=this.ui.inviteActiveUsers.prop("checked");t&&this.model.thread.inviteUserGroup("good_forum_commenters"),this.model.saveVisibleTopics(),this.isNew&&this.model.thread.set("isNew",!0),this.trigger("createThread")},updateTitle:function(){this.model.set({title:this.ui.title.val()})},updateMessage:function(){var e=this.postboxRegion.currentView;this.model.set({message:e.textarea.get()})},updateValidationErrors:function(){this.$(".form-attribute-input").removeClass("is-error"),this.model.isValid()},handleValidationError:function(t,n){e.each(n,function(e){this.$(".form-attribute-input[data-attribute*="+e.attrName+"]").addClass("is-error").find("[data-role=attribute-error]").text(e.message)},this)},handleSaveError:function(e,t){this._submitLocked=!1,this.$("form").removeClass("is-submitting"),p.confirmationPromise(p.TYPES.CLOSE,k(t))},navigateBack:function(){window.history.back()},getPageTrackingParams:function(){return{forum:this.model.thread.forum.id}}},{NON_EDITING_KEYS:[37,39,36,35,9,13]});return l.call(E.prototype),i.call(E.prototype),E}),define("home/templates/relatedDiscussion",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<div class="module-recent__media">\n<a href="'+i(n(null!=e?e.discussionRoute:e,e))+'">\n<img src="'+i(n(null!=(t=null!=e?e.image:e)?t.src:t,e))+'" class="img-fit-sm" />\n</a>\n</div>\n'},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"1 Comment",{name:"gettext",hash:{},data:i}))+"\n"},5:function(e,t,n,i){var a,s=this.escapeExpression;return s(t.gettext.call(e,"%(number)s Comments",{name:"gettext",hash:{number:null!=(a=null!=e?e.thread:e)?a.posts:a},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r="";return a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<div class="media-body">\n<a href="'+o(s(null!=e?e.discussionRoute:e,e))+'"\nclass="link-gray-darker module-recent__title spacing-bottom-small">\n<div class="spacing-bottom-small">\n<h2 class="truncate" data-truncate-lines="2" dir="auto">\n'+o(s(null!=(a=null!=e?e.thread:e)?a.clean_title:a,e))+'\n</h2>\n</div>\n<p class="text-medium text-brand">\n',a=t["if"].call(e,t.eq.call(e,null!=(a=null!=e?e.thread:e)?a.posts:a,1,{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(3,i),inverse:this.program(5,i),data:i}),null!=a&&(r+=a),r+"</p>\n</a>\n</div>\n"},useData:!0})}),define("home/views/RelatedDiscussionView",["backbone-marionette","home/templates/relatedDiscussion","home/mixins/withTruncate"],function(e,t,n){var i=e.ItemView.extend({template:t,className:"module-recent__item",initialize:function(e){this.hideImage=e&&e.hideImage},templateHelpers:function(){var e=this.model.thread;return{image:!this.hideImage&&this.model.thread.getImage(),discussionRoute:e.getDiscussionRoute(),threadDescription:e.getPlainDescription()}}});return n.call(i.prototype),i}),define("home/templates/relatedDiscussionsModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<header class="module-header -plain">\n<div class="module-header__title">\n<h2 class="text-gray-darker">\n'+a(t.gettext.call(e,"More from %(source)s",{name:"gettext",hash:{source:t.getPartial.call(e,"channelAwareForumLink",e,{name:"getPartial",hash:{},data:i})},data:i}))+'\n</h2>\n</div>\n</header>\n<div data-role="discussions" class="module-body"></div>\n'},useData:!0})}),define("home/views/RelatedDiscussionsModuleView",["backbone-marionette","home/views/RelatedDiscussionView","home/views/ProfileModuleEmptyView","home/templates/relatedDiscussionsModule"],function(e,t,n,i){var a=e.CompositeView.extend({template:i,itemView:t,itemViewContainer:"[data-role=discussions]",emptyView:n});return a}),define("home/templates/discussionBanner",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s='<div class="visible-lg">\n';return a=this.invokePartial(n.discussionOnboardAlert,"","discussionOnboardAlert",e,void 0,t,n,i),null!=a&&(s+=a),s+"</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r="";return a=t["if"].call(e,null!=e?e.inOnboarding:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<div class="banner__wrapper grad-overlay__wrapper">\n<div class="grad-overlay">\n<a href="/home/channel/'+o(s(null!=e?e.slug:e,e))+'/">\n<div class="channel-cover section-contained align align--middle align--between">\n<div class="spacing-right truncate-line text-light">\n',a=this.invokePartial(n.channelCoverLogo,"","channelCoverLogo",e,void 0,t,n,i),null!=a&&(r+=a),r+='</div>\n<div class="visible-lg btn-follow--inverted btn-follow--plain">\n',a=this.invokePartial(n.genericFollowButton,"","genericFollowButton",e,void 0,t,n,i),null!=a&&(r+=a),r+"</div>\n</div>\n</a>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/DiscussionBannerView",["underscore","backbone-marionette","home/mixins/asChannelBanner","home/mixins/withChannelFollowing","home/mixins/withClickLinkTracking","home/mixins/withOnboarding","home/templates/discussionBanner"],function(e,t,n,i,a,s,o){var r=t.ItemView.extend({template:o,templateHelpers:function(){return{inOnboarding:this.inOnboarding}},events:{"click a":"trackClickLink"},initialize:function(e){this.app=e.app,this.session=e.session,this.listenTo(this,"toggled:follow",this.render),this.listenTo(this.app,"route",this.initOnboarding)},initOnboarding:function(){this.session.loadPromise().then(e.bind(function(){this.inOnboarding=this.isInOnboarding(this.session),this.render()},this))}}),l=r.prototype;return a.call(l,"discussion_top_banner"),n.call(l),i.call(l,function(){return this.model}),s.call(l,function(){return this.app}),r}),define("home/templates/discussionCoverActions",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" -wide"},3:function(){return" is-recommended"},5:function(e){var t=this.lambda,n=this.escapeExpression;return'<span class="button__count">'+n(t(null!=e?e.likes:e,e))+"</span>\n"},7:function(e,t,n,i){var a,s='<li class="dropdown" data-role="menu">\n<a href="#" class="button icon__rotate--right" data-toggle="dropdown">\n<span class="icon icon-show-more text-smaller"></span>\n</a>\n<ul class="dropdown-menu dropdown--cards dropdown--discussion" role="menu" aria-labeledby="drop-discover">\n<li>\n<a href="#" class="link text-semibold" data-action="toggle-subscription">\n';return a=t["if"].call(e,null!=e?e.userSubscription:e,{name:"if",hash:{},fn:this.program(8,i),inverse:this.program(10,i),data:i}),null!=a&&(s+=a),s+"</a>\n</li>\n</ul>\n</li>\n"},8:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Unsubscribe from discussion",{name:"gettext",hash:{},data:i}))+"\n"},10:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Subscribe to discussion",{name:"gettext",hash:{},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<ul class="list--inline">\n<li class="button__wrapper--recommend -count';return a=t["if"].call(e,t.gt.call(e,null!=e?e.likes:e,9,{name:"gt",hash:{},data:i}),{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),a=t["if"].call(e,null!=e?e.favorited:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='" data-action="favorite">\n<a class="button--recommend text-medium" href="#">\n<span class="button__heart icon-heart"></span>\n<span class="button__text hidden-md">'+s(t.gettext.call(e,"Recommend",{name:"gettext",hash:{},data:i}))+"</span>\n",a=t["if"].call(e,null!=e?e.likes:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='</a>\n</li>\n<li class="dropdown" data-dropdown="enabled">\n<a class="button text-medium -share-discussion dropdown-toggle" data-toggle="dropdown" href="#">\n<span class="icon-share-discussion text-smaller icon__position"></span><span class="spacing-left-small hidden-md">'+s(t.gettext.call(e,"Share",{name:"gettext",hash:{},data:i}))+'</span>\n</a>\n<ul class="dropdown-menu dropdown--cards dropdown--share-discussion">\n<li>\n<a class="link" data-action="share" data-network="twitter" href="#">\n<span class="icon icon-twitter text-smaller icon__position -inline"></span>\n<strong>'+s(t.gettext.call(e,"Tweet this",{name:"gettext",hash:{},data:i}))+'</strong>\n</a>\n</li>\n<li>\n<a class="link" data-action="share" data-network="facebook" href="#">\n<span class="icon icon-facebook text-smaller icon__position -inline"></span>\n<strong>'+s(t.gettext.call(e,"Post to Facebook",{name:"gettext",hash:{},data:i}))+"</strong>\n</a>\n</li>\n</ul>\n</li>\n",a=t.unless.call(e,null!=e?e.isDeleted:e,{name:"unless",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+"</ul>\n"},useData:!0})}),define("home/views/DiscussionCoverActionsView",["home/views/ThreadCardDefaultFooterView","home/templates/discussionCoverActions"],function(e,t){var n=e,i=n.prototype,a=n.extend({template:t,toggleThreadFavorited:function(e){i.toggleThreadFavorited.call(this,e),this.$("[data-action=favorite]").addClass("animate-recommend")}});return a}),define("home/views/common/DiscussionCoverBaseView",["jquery","underscore","backbone-marionette","core/bus","home/models/Session","home/views/RelatedDiscussionsModuleView","home/views/DiscussionBannerView","home/views/DiscussionCoverActionsView","home/views/TopicTagCollectionView","home/mixins/withTruncate","home/mixins/withSubviews"],function(e,t,n,i,a,s,o,r,l,c,d){var u=n.ItemView,h=u.extend({events:{"click [data-role=message] a":"trackClickLink"},trackClickLink:function(e){i.trigger("uiAction:clickLink",e,{adjective:"message"})},templateHelpers:function(){var e=this.model.thread,t=this.model.channel;return{relativeTime:e.getRelativeCreatedAt(),channel:t&&t.toJSON(),image:e.getImage(),discussionRoute:e.getDiscussionRoute(this.channel)}},initialize:function(e){this.app=e.app,this.session=a.get(),this.channel=this.model.channel,this.channel&&this.listenTo(this.channel,"change",this.render),this.listenTo(this.model.thread,{sync:this.render,"change:extending":this.render})},regions:{bannerRegion:"[data-role=banner]",relatedStoriesRegion:"[data-role=related-stories]",topicsRegion:"[data-role=topics]",threadActionsRegion:"[data-role=thread-actions]"},onRender:function(){var e=this.model.channel;e&&(this.activateRegion(this.bannerRegion,this.createBanner),this.activateRegion(this.topicsRegion,this.createTopicsView)),this.activateRegion(this.threadActionsRegion,this.createThreadActions),this.activateRegion(this.relatedStoriesRegion,this.createRelatedLinksView)},createRelatedLinksView:function(){return new s({collection:this.model.coverRelatedCollection,className:"module--plain",model:this.model.thread})},createBanner:function(){return new o({model:this.model.channel,app:this.app,session:this.session})},createThreadActions:function(){return new r({el:this.threadActionsRegion.el,model:this.model.thread,channel:this.model.channel})},createTopicsView:function(){var e=this.model.thread.topics,t=this.model.channel;return new l({collection:e,channel:t})}}),m=h.prototype;return c.call(m),d.call(m),h}),define("home/templates/networkDiscussionCover",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" is-deleted"},3:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<a class="spacing-right" href="/home/forum/'+i(n(null!=(t=null!=(t=null!=e?e.thread:e)?t.forum:t)?t.id:t,e))+'/"\ndata-role="publisher-link">\n<img class="img-round-sm img-block" src="'+i(n(null!=(t=null!=(t=null!=(t=null!=e?e.thread:e)?t.forum:t)?t.favicon:t)?t.cache:t,e))+'" alt="'+i(n(null!=(t=null!=(t=null!=e?e.thread:e)?t.forum:t)?t.name:t,e))+'"/>\n</a>\n'},5:function(){return" has-image"},7:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<div class="card-content__media">\n<div style="background-image: url('+i(n(null!=(t=null!=e?e.image:e)?t.src:t,e))+')" class="img-cards"></div>\n</div>\n'},9:function(e){var t=this.lambda,n=this.escapeExpression;return'<div class="spacing-bottom-small">\n<p class="truncate" data-truncate-lines="2" dir="auto">\n'+n(t(null!=e?e.description:e,e))+"\n</p>\n</div>\n"},11:function(e){var t=this.lambda,n=this.escapeExpression;return'<div class="text-smaller link-gray spacing-bottom-narrow">\n<span class="icon icon-communities icon__position -inline icon-tiny"></span>\n'+n(t(null!=e?e.forumFriendlyUrl:e,e))+"\n</div>\n"},13:function(){return'<span class="icon icon-lock icon-tiny spacing-right-small"></span>\n'},15:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"1 Comment",{name:"gettext",hash:{},data:i}))+"\n"},17:function(e,t,n,i){var a,s=this.escapeExpression;return s(t.gettext.call(e,"%(number)s Comments",{name:"gettext",hash:{number:null!=(a=null!=e?e.thread:e)?a.posts:a},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="discussion-page--network">\n<header data-role="banner"></header>\n<div class="section-contained">\n<div class="layout layout--no-aside';return a=t["if"].call(e,null!=(a=null!=e?e.thread:e)?a.isDeleted:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="layout__main">\n<div class="layout__content -centered">\n<header class="align align--middle spacing-bottom">\n',a=t["if"].call(e,null!=e?e.hasFavicon:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<div class="discussion__byline truncate-line">\n<a href="/home/forum/'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.id:a,e))+'/">\n<strong>'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.name:a,e))+'</strong>\n</a>\n<time class="bullet text-gray">'+o(s(null!=e?e.relativeTime:e,e))+'</time>\n</div>\n</header>\n<section class="discussion__content">\n<a href="'+o(s(null!=(a=null!=e?e.thread:e)?a.link:a,e))+'"\nclass="card-wrap -link"\ndata-role="article-link"\ndata-link-out="'+o(s(null!=(a=null!=e?e.thread:e)?a.signedLink:a,e))+'"\ndata-mix-location="title">\n<div class="card__content -network',a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n',a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<div class="card-content__body">\n<h2 class="discussion-title text-brand link-default-hover" dir="auto">\n'+o(s(null!=(a=null!=e?e.thread:e)?a.clean_title:a,e))+'\n</h2>\n<div class="card-content__summary">\n',a=t["if"].call(e,null!=e?e.description:e,{name:"if",hash:{},fn:this.program(9,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t["if"].call(e,null!=e?e.forumFriendlyUrl:e,{name:"if",hash:{},fn:this.program(11,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<div class="text-medium text-gray-darker">\n',a=t["if"].call(e,null!=(a=null!=e?e.thread:e)?a.isClosed:a,{name:"if",hash:{},fn:this.program(13,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+="<strong>\n",a=t["if"].call(e,t.eq.call(e,null!=(a=null!=e?e.thread:e)?a.posts:a,1,{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(15,i),inverse:this.program(17,i),data:i}),null!=a&&(r+=a),r+="</strong>\n</div>\n</div>\n</div>\n</div>\n</a>\n</section>\n",a=this.invokePartial(n.threadPostActivity,"","threadPostActivity",e,void 0,t,n,i),null!=a&&(r+=a),r+'</div>\n</div>\n<div class="layout__aside hidden-lg">\n<div class="absolute__wrapper -aside">\n<div data-role="channel-module" data-jester-area="channel_sidebar" class="module--aside"></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/NetworkDiscussionCoverView",["underscore","backbone","backbone-marionette","home/views/ChannelsModuleView","home/views/common/DiscussionCoverBaseView","home/utils/mixpanelUtils","home/templates/networkDiscussionCover"],function(e,t,n,i,a,s,o){var r=a,l=a.prototype,c=r.extend({template:o,templateHelpers:function(){var t=a.prototype.templateHelpers.apply(this,arguments),n=this.model.thread;return e.defaults({hasFavicon:n.forum.hasFavicon(),forumFriendlyUrl:n.forum.getFriendlyUrl(),description:n.getPlainDescription()},t)},regions:e.defaults({channelRegion:"[data-role=channel-module]"},l.regions),events:e.defaults({"click [data-role=channel-module] a":"trackChannelsLink"},l.events),onRender:function(){l.onRender.call(this),this.activateRegion(this.channelRegion,this.createChannelsView)},createChannelsView:function(){var n=new t.Collection;return this.model.channels.ensureFetched().then(e.bind(function(){n.reset(e.shuffle(this.model.channels.items.models))},this)),new i({collection:n})},trackChannelsLink:function(e){s.track("click channels module",e)
}});return c}),define("core/WindowBus",["jquery","underscore","backbone","modernizr"],function(e,t,n,i){var a=n.Model.extend({initialize:function(){i.localstorage&&e(window).on("storage",t.bind(this.onStorageEvent,this))},broadcast:function(e,t){if(i.localstorage){var n=JSON.stringify({name:e,data:t,time:(new Date).getTime()});try{window.localStorage.setItem(this.constructor.STORAGE_KEY,n)}catch(a){return}}},onStorageEvent:function(e){var t=e.originalEvent.key,n=e.originalEvent.newValue;if(n&&t===this.constructor.STORAGE_KEY)try{n=JSON.parse(n),this.trigger(n.name,n.data)}catch(i){return}}},{STORAGE_KEY:"disqus.bus"});return a}),define("home/templates/discussionPageChannelInfo",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.discussionOnboardAlert,"","discussionOnboardAlert",e,void 0,t,n,i),null!=a&&(s+=a),s},3:function(e){var t=this.lambda,n=this.escapeExpression;return'<img src="'+n(t(null!=e?e.channelAvatar:e,e))+'" class="img-round-sm img-block" />\n'},5:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=(a=null!=e?e.options:e)?a.favicon:a,{name:"if",hash:{},fn:this.program(6,i),inverse:this.program(8,i),data:i}),null!=a&&(s+=a),s},6:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<img src="'+i(n(null!=(t=null!=e?e.options:e)?t.favicon:t,e))+'" class="img-round-sm img-block" />\n'},8:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.defaultChannelAvatar,"","defaultChannelAvatar",e,void 0,t,n,i),null!=a&&(s+=a),s},10:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<p class="spacing-bottom-narrow">'+i(n(null!=(t=null!=e?e.options:e)?t.description:t,e))+"</p>\n"},12:function(e,t,n,i){var a=this.escapeExpression;return'<p>\n<button class="text-medium--discussion" data-action="show-guidelines">\n'+a(t.gettext.call(e,"Home Rules",{name:"gettext",hash:{},data:i}))+"\n</button>\n</p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r="";return a=t["if"].call(e,null!=e?e.inOnboarding:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<header class="module-header -plain">\n<div class="align align--between align--middle">\n<div class="align align--middle truncate-line">\n<a href="/home/channel/'+o(s(null!=e?e.slug:e,e))+'/" class="spacing-right">\n',a=t["if"].call(e,null!=e?e.channelAvatar:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.program(5,i),data:i}),null!=a&&(r+=a),r+='</a>\n<a href="/home/channel/'+o(s(null!=e?e.slug:e,e))+'/" class="link-gray-darker truncate-line">\n<strong>'+o(s(null!=e?e.name:e,e))+'</strong>\n</a>\n</div>\n<div class="btn-follow--loud">\n',a=this.invokePartial(n.genericFollowButton,"","genericFollowButton",e,void 0,t,n,i),null!=a&&(r+=a),r+='</div>\n</div>\n</header>\n<section class="module-body spacing-narrow text-gray-darker">\n',a=t["if"].call(e,null!=(a=null!=e?e.options:e)?a.description:a,{name:"if",hash:{},fn:this.program(10,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t.unless.call(e,null!=e?e.inOnboarding:e,{name:"unless",hash:{},fn:this.program(12,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+"</section>\n"},usePartial:!0,useData:!0})}),define("home/views/DiscussionPageChannelInfoView",["underscore","jquery","backbone-marionette","home/mixins/withChannelAvatar","home/mixins/withChannelFollowing","home/mixins/withOnboarding","home/templates/discussionPageChannelInfo","home/utils/layoutUtils"],function(e,t,n,i,a,s,o,r){var l=n.ItemView.extend({template:o,templateHelpers:function(){return{previouslyFollowing:this.previouslyFollowing,inOnboarding:this.inOnboarding}},initialize:function(e){this.app=e.app,this.session=e.session,this.previouslyFollowing=this.getIsFollowing(),this.listenTo(this,"toggled:follow",this.render),this.listenTo(this.app,"route",this.initOnboarding)},initOnboarding:function(){this.session.loadPromise().then(e.bind(function(){this.inOnboarding=this.isInOnboarding(this.session),this.inOnboarding&&this.toggleRightModuleFixedPosition(),this.render()},this))},toggleRightModuleFixedPosition:function(){if(r.isScreenGreaterThanLarge()){var n=t("[data-role=banner]").height(),i=e.bind(function(){t("[data-role=right-module]").toggleClass("is-fixed-md",t(window).scrollTop()>n)},this),a=e.debounce(i,200);t(window).on("scroll",a),this.listenTo(this,"close",function(){t(window).off("scroll",a)})}}});return a.call(l.prototype,function(){return this.model}),i.call(l.prototype,function(){return this.model}),s.call(l.prototype,function(){return this.app}),l}),define("home/templates/followChannelPrompt",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s="";return a=t.unless.call(e,null!=e?e.viewExpired:e,{name:"unless",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},2:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="follow-prompt__wrapper" data-mix-location="follow prompt">\n<div class="alert -outline spacing-narrow">\n<div class="media">\n';return a=t["if"].call(e,null!=(a=null!=e?e.options:e)?a.favicon:a,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='<div class="media-right">\n<p class="text-larger">\n'+s(t.gettext.call(e,"Enjoy %(channelName)s?",{name:"gettext",hash:{channelName:t.tag.call(e,"strong",{name:"tag",hash:{text:null!=e?e.name:e},data:i})},data:i}))+'\n</p>\n<p class="spacing-narrow">\n'+s(t.gettext.call(e,"It's easy to keep up with %(channelName)s. Just follow and you'll start seeing the latest updates in your home feed. You can follow other channels too!",{name:"gettext",hash:{channelName:null!=e?e.name:e},data:i}))+"\n</p>\n",a=this.invokePartial(n.genericFollowButton,"","genericFollowButton",e,void 0,t,n,i),null!=a&&(o+=a),o+"</div>\n</div>\n</div>\n</div>\n"},3:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<div class="media-left spacing-right">\n<a href="/home/channel/'+i(n(null!=e?e.slug:e,e))+'/">\n<img src="'+i(n(null!=(t=null!=e?e.options:e)?t.favicon:t,e))+'" alt="'+i(n(null!=e?e.name:e,e))+'" class="img-avatar-lg">\n</a>\n</div>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.shouldShowAlert:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},usePartial:!0,useData:!0})}),define("home/views/FollowChannelPromptView",["backbone-marionette","remote/config","home/mixins/withChannelFollowing","home/mixins/withExpiration","home/models/Session","home/templates/followChannelPrompt"],function(e,t,n,i,a,s){var o=e.ItemView.extend({template:s,templateHelpers:function(){return{shouldShowAlert:this.session.isLoggedIn()&&!this.model.primaryForum.get("isFollowing")}},initialize:function(){this.session=a.get(),this.expirationKey="followChannelPrompt-"+this.model.get("slug"),this.defaultViews=t.lounge.follow_channel_prompt_views,this.listenTo(this.session,"change:id",this.render)}});return n.call(o.prototype),i.call(o.prototype),o}),define("home/templates/postTree",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<section data-role="post"></section>\n<div style="margin-left: 50px" data-role="children"></div>\n'},useData:!0})}),define("home/views/PostTreeView",["backbone-marionette","home/mixins/withSubviews","home/views/PostView","home/templates/postTree"],function(e,t,n,i){var a=e.ItemView.extend({template:i,regions:{postRegion:"[data-role=post]",childrenRegion:"[data-role=children]"},onRender:function(){this.activateRegion(this.postRegion,this.createPostView),this.activateRegion(this.childrenRegion,this.createChildrenView)},createPostView:function(){return new n({model:this.model.post})},createChildrenView:function(){return new e.CollectionView({itemView:a,collection:this.model.children})}});return t.call(a.prototype),a}),define("home/templates/threadHighlight",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e){var t=this.lambda,n=this.escapeExpression;return'<div class="panel-heading" role="tab">\n<h4 class="panel-title">\n<a data-toggle="collapse" href="#" aria-expanded="false" style="text-transform: capitalize;">\n'+n(t(null!=e?e.term:e,e))+'\n</a>\n</h4>\n</div>\n<div class="panel-collapse collapse in" role="tabpanel">\n<div class="panel-body" data-role="posts"></div>\n</div>\n'},useData:!0})}),define("home/views/ThreadHighlightView",["backbone-marionette","home/views/PostTreeView","home/templates/threadHighlight"],function(e,t,n){var i=e.CompositeView.extend({className:"panel panel-default",template:n,itemView:t,itemViewContainer:"[data-role=posts]",events:{"click a[data-toggle=collapse]":"toggleCollapse"},initialize:function(e){this.collection=this.model.posts,this.$accordionParent=e&&e.accordionParent},onRender:function(){this.$(".collapse").collapse({parent:this.$accordionParent})},toggleCollapse:function(e){e&&e.preventDefault(),this.$(".collapse").collapse("toggle")}});return i}),define("home/templates/threadHighlights",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<h3>Highlights</h3>\n<div class="panel-group" role="tablist" aria-multiselectable="true" data-role="highlights"></div>\n'},useData:!0})}),define("home/views/ThreadHighlightsView",["jquery","underscore","backbone-marionette","home/views/ThreadHighlightView","home/templates/threadHighlights"],function(e,t,n,i,a){var s=n.CompositeView.extend({itemView:i,itemViewOptions:function(){return{accordionParent:this.$(".panel-group")}},itemViewContainer:"[data-role=highlights]",template:a,onRender:function(){this.$(".panel-group").on("shown.bs.collapse",t.bind(this.scrollToPanel,this))},scrollToPanel:function(){var t=this.$(".panel-collapse.in").closest(".panel.panel-default").offset(),n=t&&t.top-70,i=e("body"),a=i.scrollTop(),s=i.height();n&&(a>n||n>a+s)&&i.scrollTop(t.top-70)}});return s}),define("home/views/MediaThumbView",["jquery","backbone-marionette","core/models/Media","core/media"],function(e,t,n,i){var a=t.ItemView.extend({template:e.noop,className:"media-gallery__item",onRender:function(){var e=this.getThumbView();e&&this.$el.append(e.$el)},getThumbView:function(){var e=this.model.get("media");if(e.length){e=new n(e[0]);var t=i.instantiateRichMediaThumbnail(e);return t.render(),t}}});return a}),define("home/templates/mediaGallery",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"1 comment with media",{name:"gettext",hash:{},data:i}))+"\n"},3:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"%(num)s comments with media",{name:"gettext",hash:{num:null!=e?e.numMediaPosts:e},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<header class="module-header -plain">\n<div class="module-header__title media">\n<div class="media-left">\n<span class="icon-media-gallery text-brand icon__position"></span>\n</div>\n<div class="media-body">\n<h2 class="text-medium text-gray-darker">\n'+s(t.gettext.call(e,"Media Gallery",{name:"gettext",hash:{},data:i}))+'\n</h2>\n</div>\n</div>\n</header>\n<div data-role="thumbs" class="media-gallery__wrap"></div>\n<footer class="spacing-narrow">\n<a href="#disqus_thread" class="text-small">\n';return a=t["if"].call(e,t.eq.call(e,null!=e?e.numMediaPosts:e,1,{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(o+=a),o+"</a>\n</footer>\n"},useData:!0})}),define("home/views/MediaGalleryView",["backbone-marionette","home/views/MediaThumbView","home/templates/mediaGallery"],function(e,t,n){var i=e.CompositeView.extend({itemView:t,itemViewContainer:"[data-role=thumbs]",className:"module--plain",template:n,modelEvents:{"change:numMediaPosts":"render"}});return i}),define("home/templates/userGeneratedDiscussionCover",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" is-deleted"},3:function(e,t,n,i){var a=this.escapeExpression;return'<div class="alert -brand -share-discussion">\n'+a(t.gettext.call(e,"Share your new discussion!",{name:"gettext",hash:{},data:i}))+'\n<button class="button-link -inverted spacing-left" data-action="share" data-network="facebook">\n'+a(t.gettext.call(e,"Share on %(facebook)s",{name:"gettext",hash:{facebook:"Facebook"},data:i}))+'\n</button>\n<button class="button-link -inverted spacing-left" data-action="share" data-network="twitter">\n'+a(t.gettext.call(e,"Share on %(twitter)s",{name:"gettext",hash:{twitter:"Twitter"},data:i}))+"\n</button>\n</div>\n"},5:function(e,t,n,i){var a=this.escapeExpression;return'<div class="alert -warning text-medium">\n<strong>'+a(t.gettext.call(e,"This discussion has been removed.",{name:"gettext",hash:{},data:i}))+"</strong>\n"+a(t.gettext.call(e,"Seem wrong? Contact %(support)s.",{name:"gettext",hash:{support:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"%(disqus)s Support",{name:"gettext",hash:{disqus:"Disqus"},data:i}),href:"http://disqus.com/support"},data:i})},data:i}))+"\n</div>\n"},7:function(){return'<span class="icon-lock icon-small spacing-right-small"></span>\n'},9:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"1 Comment",{name:"gettext",hash:{},data:i}))+"\n"},11:function(e,t,n,i){var a,s=this.escapeExpression;return s(t.gettext.call(e,"%(number)s Comments",{name:"gettext",hash:{number:null!=(a=null!=e?e.thread:e)?a.posts:a},data:i}))+"\n"},13:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression;return'<a href="/home/edit/'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.forum:a)?a.id:a,e))+"/"+o(s(null!=(a=null!=e?e.thread:e)?a.slug:a,e))+'/" class="spacing-left text-semibold">\n<span class="icon-cog icon-small spacing-right-small"></span>'+o(t.gettext.call(e,"Edit",{name:"gettext",hash:{},data:i}))+"\n</a>\n"},15:function(e){var t,n=this.lambda,i='<div class="reading-block" data-role="message">\n';return t=n(null!=e?e.description:e,e),null!=t&&(i+=t),i+"\n</div>\n"},17:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="'+o(s(null!=e?e.embedlyLink:e,e))+'"\nclass="card-wrap -link card-wrap--sm link-gray-dark"\ndata-role="article-link"\ndata-mix-location="title">\n<div class="card__content';return a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(18,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n',a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(20,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<div class="card-content__body text-medium">\n',a=t["if"].call(e,null!=(a=null!=(a=null!=e?e.thread:e)?a.content:a)?a.title:a,{name:"if",hash:{},fn:this.program(22,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t["if"].call(e,null!=(a=null!=(a=null!=e?e.thread:e)?a.content:a)?a.description:a,{name:"if",hash:{},fn:this.program(24,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+"</div>\n</div>\n</a>\n"},18:function(){return" has-image"},20:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<div class="card-content__media">\n<div style="background-image: url('+i(n(null!=(t=null!=e?e.image:e)?t.src:t,e))+')" class="img-cards"></div>\n</div>\n'},22:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<h3 class="spacing-bottom-small text-brand link-default-hover" dir="auto">\n'+i(n(null!=(t=null!=(t=null!=e?e.thread:e)?t.content:t)?t.title:t,e))+"\n</h3>\n"},24:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<p class="truncate-line link-default-hover" dir="auto">\n'+i(n(null!=(t=null!=(t=null!=e?e.thread:e)?t.content:t)?t.description:t,e))+"\n</p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<header data-role="banner"></header>\n<div class="section-contained">\n<div class="layout -top-spacing layout--no-aside';return a=t["if"].call(e,null!=(a=null!=e?e.thread:e)?a.isDeleted:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="layout__main">\n<div class="layout__content -centered">\n',a=t["if"].call(e,null!=e?e.showSharePrompt:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+="\n",a=t["if"].call(e,null!=(a=null!=e?e.thread:e)?a.isDeleted:a,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<div class="spacing-bottom">\n<header class="spacing-bottom-small" data-role="title-area">\n<div data-role="topics" class="topics--small topics--discussion"></div>\n<h1 class="text-title text-gray-darker">\n'+o(s(null!=(a=null!=e?e.thread:e)?a.clean_title:a,e))+'\n</h1>\n</header>\n<div class="padding-top-bottom">\n<a href="#disqus_thread" class="spacing-right text-semibold">\n',a=t["if"].call(e,null!=(a=null!=e?e.thread:e)?a.isClosed:a,{name:"if",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t["if"].call(e,t.eq.call(e,null!=(a=null!=e?e.thread:e)?a.posts:a,1,{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(9,i),inverse:this.program(11,i),data:i}),null!=a&&(r+=a),r+="</a>\n",a=t["if"].call(e,null!=e?e.canEdit:e,{name:"if",hash:{},fn:this.program(13,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</div>\n</div>\n<section class="discussion__content">\n<div class="align">\n<a class="spacing-right" href="/by/'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.author:a)?a.username:a,e))+'/">\n<img class="img-avatar-md img-block"\nsrc="'+o(s(null!=(a=null!=(a=null!=(a=null!=e?e.thread:e)?a.author:a)?a.avatar:a)?a.cache:a,e))+'" alt="'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.author:a)?a.name:a,e))+'" />\n</a>\n<div class="discussion__byline">\n<a href="/by/'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.author:a)?a.username:a,e))+'/">\n<strong>'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.author:a)?a.name:a,e))+'</strong>\n</a><br />\n<a href="/by/'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.author:a)?a.username:a,e))+'/" class="link-gray-dark">\n@'+o(s(null!=(a=null!=(a=null!=e?e.thread:e)?a.author:a)?a.username:a,e))+'\n</a>\n<time class="bullet text-gray">'+o(s(null!=e?e.relativeTime:e,e))+"</time>\n</div>\n</div>\n",a=t["if"].call(e,null!=e?e.description:e,{name:"if",hash:{},fn:this.program(15,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t["if"].call(e,null!=e?e.hasEmbedlyData:e,{name:"if",hash:{},fn:this.program(17,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</section>\n<div data-role="highlights"></div>\n<div class="visible-lg">\n',a=this.invokePartial(n.discussionModerationActions,"","discussionModerationActions",e,void 0,t,n,i),null!=a&&(r+=a),r+="</div>\n",a=this.invokePartial(n.threadPostActivity,"","threadPostActivity",e,void 0,t,n,i),null!=a&&(r+=a),r+='<div data-role="follow-channel-prompt"></div>\n</div>\n</div>\n<div class="layout__aside hidden-lg">\n<div class="absolute__wrapper -aside" data-role="right-module">\n',a=this.invokePartial(n.discussionModerationActions,"","discussionModerationActions",e,void 0,t,n,i),null!=a&&(r+=a),r+'<div data-role="channel-info" class="module--plain" data-jester-area="channel_info"></div>\n<div data-role="media-gallery" data-jester-area="media_gallery"></div>\n<div data-role="related-stories" data-jester-area="related_sidebar"></div>\n</div>\n</div>\n</div>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/templates/guidelines",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="padding-double">\n<h4 class="text-larger">'+s(t.gettext.call(e,"Home Rules",{name:"gettext",hash:{},data:i}))+'</h4>\n<div class="spacing-inner -medium spacing-top text-medium">';return a=this.invokePartial(n.homeRules,"","homeRules",e,void 0,t,n,i),null!=a&&(o+=a),o+"</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/UserGeneratedDiscussionCoverView",["jquery","underscore","core/utils/storage","core/mixins/withRichMedia","core/utils/releaseUtils","core/switches","core/WindowBus","core/UniqueModel","home/mixins/withChannelAvatar","home/mixins/withChannelFollowing","home/mixins/withThreadSharing","home/mixins/withOnboarding","home/models/UserProfile","home/views/common/DiscussionCoverBaseView","home/views/DiscussionPageChannelInfoView","home/views/FollowChannelPromptView","home/views/ThreadHighlightsView","home/views/MediaGalleryView","home/templates/userGeneratedDiscussionCover","home/templates/guidelines","home/utils/confirmModal"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f,g,v,w,b,x){var y=m,_=m.prototype,k=y.extend({template:w,templateHelpers:function(){var e=_.templateHelpers.apply(this,arguments),n=this.model.thread,i=n.get("content"),a=n.canEdit(this.session),s=t.contains(this.session.moderatedForums,n.forum.id),o=this.session.user.get("isGlobalAdmin");return t.defaults({description:n.getFullDescription(),hasEmbedlyData:i.title||i.description||i.image.url,embedlyLink:n.getLinks()[0],canEdit:a,isChannelModerator:s,isGlobalAdmin:o,showSharePrompt:n.get("isNew")&&n.author&&n.author.isSessionUser(),canDelete:a&&(s||o)},e)},regions:t.defaults({highlightsRegion:"[data-role=highlights]",mediaRegion:"[data-role=media-gallery]",followChannelPromptRegion:"[data-role=follow-channel-prompt]",channelInfoRegion:"[data-role=channel-info]"},_.regions),events:t.defaults({"click [data-action=delete-thread]":"deleteThread","click [data-action=close-thread]":"closeThread","click [data-action=open-thread]":"openThread","click [data-action=show-guidelines]":"showGuidelines","click [data-action=moderation-dropdown]":"toggleDropdown","click [data-action=blacklist-forum]":"blacklistAuthorOnForum","click [data-action=blacklist-global]":"toggleBlacklistAuthorGlobally"},_.events),initialize:function(e){_.initialize.call(this,e),this.listenTo(this.session,"setModeratedForums",this.render),this.listenTo(this.model.thread,"change:isClosed change:isDeleted",this.render),this.model.thread.author?this.bindToAuthor():this.model.thread.fetchAuthor().then(t.bind(function(){this.bindToAuthor(),this.render()},this));var n=new o;this.listenTo(n,"posts.create",this.showFollowChannelPromptView),this.listenTo(this.app,"route",this.initOnboarding)},initOnboarding:function(){this.session.loadPromise().then(t.bind(function(){var e=this.isInOnboarding(this.session);this.relatedStoriesRegion.$el&&this.relatedStoriesRegion.$el.toggleClass("hidden",e)},this))},bindToAuthor:function(){this.listenTo(this.model.thread.author,"change",this.render)},onRender:function(){_.onRender.call(this);var e=this.model.thread.getMedia();e&&e.length&&this.renderRichMedia(e),this.model.highlights&&this.activateRegion(this.highlightsRegion,t.partial(this.createHighlightsView,this.model.highlights)),this.model.mediaPosts&&this.activateRegion(this.mediaRegion,t.partial(this.createMediaGalleryView,this.model.mediaPosts.items)),this.activateRegion(this.channelInfoRegion,t.partial(this.createChannelInfoView,this.model.channel))},showFollowChannelPromptView:function(e){this.model.channel&&this.model.channel.primaryForum&&!e.parent&&e.forum===this.model.channel.primaryForum.get("id")&&this.activateRegion(this.followChannelPromptRegion,t.partial(this.createFollowChannelPromptView,this.model.channel))},createChannelInfoView:function(e){return new p({model:e,app:this.app,session:this.session})},createFollowChannelPromptView:function(e){return new f({model:e})},createHighlightsView:function(e){return new g({collection:e})},createMediaGalleryView:function(e){return new v({collection:e,model:this.model})},blacklistAuthorOnForum:function(){this.getAuthorProfile().user.confirmBlacklist({forum:this.model.thread.forum.id,notes:"Added via discussion page",retroactive:!0})},toggleBlacklistAuthorGlobally:function(){var e=this.getAuthorProfile(),t=e.user;t.get("isOnGlobalBlacklist")?t.removeFromBlacklist():t.confirmBlacklist({notes:"Added via discussion page",retroactive:!0})},getAuthorProfile:function(){return new r(h,this.model.thread.author.attributes)},deleteThread:function(){this.model.thread.confirmDelete()},closeThread:function(){this.model.thread.close()},openThread:function(){this.model.thread.open()},showGuidelines:function(){x.confirmationPromise(x.TYPES.CLOSE,b(this.model.thread.forum.channel.toJSON()))},toggleDropdown:function(){var e=this.$(".nav-dropdown__item");e.toggleClass("dropdown-open")}});return i.call(k.prototype),c.call(k.prototype,function(){return this.model.channel}),l.call(k.prototype,function(){return this.model.channel}),d.call(k.prototype),u.call(k.prototype,function(){return this.app}),k}),define("home/utils/embed",["jquery","home/utils/mixpanelUtils","home/models/Session"],function(e,t,n){var i=function(){var i=n.get().user;i.set({numPosts:i.get("numPosts")+1}),t.track("post post",{target:e("[data-role=embed]")})},a=function(){};return{onEmbedComment:i,onEmbedLoaded:a}}),define("home/templates/embedContainer",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div class="story-thread" id="disqus_thread" data-role="embed" data-mix-location="embed"></div>\n'},useData:!0})}),define("home/views/EmbedContainerView",["underscore","backbone-marionette","core/utils/cookies","home/utils/embed","home/templates/embedContainer"],function(e,t,n,i,a){function s(e,t){var n=this;n.discovery={disable_all:!0},n.forum=e.forum.id,n.page.slug=e.get("slug"),n.page.title=e.get("title"),n.page.url=e.get("link"),n.experiment.force_auto_styles=!0,n.experiment.enable_scroll_container=!0,t&&(n.experiment.sort_order=t),n.callbacks.onNewComment.push(i.onEmbedComment)}return t.ItemView.extend({template:a,initialize:function(e){this.sortOrder=e&&e.sortOrder},onShow:function(){window.DISQUS.reset({reload:!0,config:e.partial(s,this.model,this.sortOrder)})}})}),define("home/views/LoungeView",["backbone-marionette"],function(e){var t=e.ItemView;return t.extend({template:function(){return"hello world"}})}),define("home/templates/deletedThreadError",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="empty-message">\n<img src="'+a(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/Pam_Error.png" class="img-responsive" />\n<h2>'+a(t.gettext.call(e,"Darn it!",{name:"gettext",hash:{},data:i}))+'</h2>\n<div class="text-small">\n'+a(t.gettext.call(e,"This discussion could not be found.",{name:"gettext",hash:{},data:i}))+'\n</div>\n<div class="text-small">\n'+a(t.gettext.call(e,"Please visit %(discussDisqus)s to learn more.",{name:"gettext",hash:{discussDisqus:t.tag.call(e,"a",{name:"tag",hash:{text:"Discuss Disqus",href:"//disqus.com/home/channel/discussdisqus/"},data:i})},data:i}))+"\n</div>\n</div>\n"},useData:!0})}),define("home/templates/discussionPage",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return"channel"},3:function(){return"network"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="discussion-page" data-mix-location="';return a=t["if"].call(e,null!=(a=null!=e?e.thread:e)?a.isUserGenerated:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(o+=a),o+' discussion page">\n<section data-role="discussion-cover" data-mix-location="cover"></section>\n<div class="section-contained">\n<div class="layout -top-flush layout--no-aside">\n<div class="layout__main">\n<div class="layout__content -centered">\n<section class="discussion__comments" id="discussion-comments"></section>\n<div class="spacing-bottom spacing-top">\n<button data-action="scroll-top" class="button button-outline -muted button-wide text-medium">\n<span class="icon-arrow-up icon-tiny spacing-right-small"></span>'+s(t.gettext.call(e,"Back to Top",{name:"gettext",hash:{},data:i}))+"\n</button>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n"},useData:!0})}),define("home/views/DiscussionPageView",["jquery","underscore","core/bus","core/utils/html","core/utils/storage","home/utils/backboneUtils","home/utils/layoutUtils","home/views/common/TabbedView","home/views/NetworkDiscussionCoverView","home/views/UserGeneratedDiscussionCoverView","home/views/EmbedContainerView","home/views/LoungeView","home/views/FetchingView","home/views/RelatedDiscussionsModuleView","home/templates/deletedThreadError","home/templates/discussionPage","home/mixins/withClickLinkTracking"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f,g){var v=r,w=v.prototype,b=v.extend({defaultTab:function(){var e,n=a.get("disqus.sort");return n&&(e=t.findKey(b.TAB_SORTS,function(e){return e===n})),e||"best"},saveDefaultTab:function(e){a.set("disqus.sort",b.TAB_SORTS[e]||b.TAB_SORTS.best)},template:function(e){return e.thread.isDeleted?p(e):f(e)},regions:t.defaults({cover:"[data-role=discussion-cover]",contentRegion:"#discussion-comments",relatedRegion:"[data-role=related]"},w.regions),initialize:function(e){w.initialize.call(this,e),this.app=e.app,this.listenToOnce(this.cover,"show",function(){n.trigger("showDiscussionCover","discussion")}),this.listenTo(this,"change:activeTab",this.saveDefaultTab),this.listenTo(this.model.thread,"sync",this.render),this.noEmbed=e.noEmbed},events:t.defaults({"click a[data-link-name]":"trackClickLink","click button[data-action=scroll-top]":"scrollToTop"},w.events),onDomRefresh:function(){w.onDomRefresh.call(this),this.showCover()},showCover:function(){if(this.model.thread.shouldFetch())return void this.cover.show(new h);var e=this.model.thread.get("isUserGenerated")?c:l,n=new e({model:this.model,app:this.app});n.listenTo(n,"dom:refresh",t.bind(this.updateTabClasses,this)),this.cover.show(n)},getPageTitle:function(){var t=this.model.thread;return e.when(s.getPromiseFor(t,"title"),s.getPromiseFor(t.forum,"name")).then(function(e,t){return e+" · "+t})},getMetaAttrs:function(){var e=this.model.thread;return this.getPageTitle().then(function(t){var n=e.getUserGeneratedImage();return{title:t,description:e.get("message"),image:n&&n.src,type:"article"}})},getChannelSlug:function(){var n=this.model.channel;if(n)return n.get("slug");if(!this.model.thread.shouldFetch())return null;var i=e.Deferred();return this.model.thread.fetch().then(t.bind(function(){var e=this.model.channel;i.resolve(e?e.get("slug"):null)},this)),i.promise()},getPageTrackingParams:function(){var n={forum:this.model.thread.forum.id};return e.when(this.getChannelSlug(),this.getPageTitle()).then(t.bind(function(e,t){e&&(n.channel_slug=e),t&&(n.title=t);var i=this.model.thread.author,a=i&&i.get("username");return a&&(n.author=a),n},this))},getTrackingSection:function(e){return e},getTabView:function(e){var t=this.noEmbed?u:d,n={model:this.model.thread,sortOrder:b.TAB_SORTS[e]||"popular"};return new t(n)},scrollToTop:function(){window.scrollTo(0,0)}},{TAB_SORTS:{best:"popular",newest:"desc",oldest:"asc"}});return g.call(b.prototype),b}),define("home/templates/welcome",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<div class="spacing-bottom animate-fade-up-out">\n<span class="button button--secondary text-medium">'+a(t.gettext.call(e,"Email verified!",{name:"gettext",hash:{},data:i}))+"</span>\n</div>\n"},3:function(e,t,n,i){var a=this.escapeExpression;return'<div>\n<a class="text-small" href="/" data-action="complete-onboarding">\n'+a(t.gettext.call(e,"Skip",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n"
},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="welcome__wrapper text-center padding-default">\n';return a=t["if"].call(e,null!=e?e.showVerifiedMessage:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='<div class="padding-gutter">\n<img class="img-responsive" src="'+s(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/empty-states/discussions.png">\n</div>\n<h1 class="text-largest text-gray-darker padding-default">\n'+s(t.gettext.call(e,"Welcome to %(disqus)s, %(name)s!",{name:"gettext",hash:{name:null!=(a=null!=e?e.user:e)?a.name:a,disqus:"Disqus"},data:i}))+'</h1>\n<p class="padding-default text-large text-gray-dark">\n'+s(t.gettext.call(e,"Easily find %(greatdiscussions)s being started by people just like you in our channels.",{name:"gettext",hash:{greatdiscussions:t.tag.call(e,"strong",{name:"tag",hash:{text:t.gettext.call(e,"great discussions",{name:"gettext",hash:{},data:i})},data:i})},data:i}))+'\n</p>\n<div class="padding-default">\n<a class="button button-inverted-fill button-semi-wide text-large" href="/home/explore/">\n'+s(t.gettext.call(e,"Let's go!",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n",a=t.unless.call(e,null!=e?e.registeredThisWeek:e,{name:"unless",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+"</div>\n"},useData:!0})}),define("home/views/WelcomeView",["backbone-marionette","moment","core/time","core/utils","home/templates/welcome"],function(e,t,n,i,a){return e.ItemView.extend({template:a,templateHelpers:function(){return{user:this.session.user.toJSON(),registeredThisWeek:this.session.user.registeredThisWeek(),showVerifiedMessage:this.showVerifiedMessage()}},events:{"click [data-action=complete-onboarding]":"completeOnboarding"},initialize:function(e){this.session=e.session,this.listenTo(this.session,"change:id",this.render)},showVerifiedMessage:function(){return!!i.getQueryParams().email_verified},getMetaAttrs:function(){return"Welcome"},completeOnboarding:function(){this.session.user.updateFlags({homeOnboardingComplete:!0})}})}),define("home/models/SearchManager",["underscore","backbone","core/UniqueModel","home/models/Feed","home/models/ActivityFeedItem","home/models/Thread","home/models/User","home/models/Forum","home/models/Post","home/models/activities/TrendingThreadActivity","home/collections/FeedItemCollection","core/api"],function(e,t,n,i,a,s,o,r,l,c,d,u){var h=t.Collection.extend({parse:function(e){return e.response}}),m=function(e){e=new s(e);var t=new a({verb:"trending"},{activities:[new c({id:e.id,target:e})]});return t.thread=e,t},p=d.extend({parse:function(t){return e.map(t.response,m)},fetch:function(e){return t.Collection.prototype.fetch.call(this,e)}});return t.Model.extend({initialize:function(e){var t=u.getURL("users/search"),a=e.query;this.threads=new i({fetchOptions:{obj_type:"thread",query:a}},{collection:new p,collectionUrl:t}),this.forums=new i({fetchOptions:{obj_type:"forum",query:a}},{collection:new h(null,{model:n.boundModel(r)}),collectionUrl:t}),this.users=new i({fetchOptions:{obj_type:"user",query:a}},{collection:new h(null,{model:n.boundModel(o)}),collectionUrl:t}),this.posts=new i({fetchOptions:{obj_type:"post",query:a}},{collection:new h(null,{model:n.boundModel(l)}),collectionUrl:t}),this.myposts=new i({fetchOptions:{obj_type:"post",query:a,user:e.userId}},{collection:new h(null,{model:n.boundModel(l)}),collectionUrl:t})},fetchSearchResults:function(){this.threads.fetchItems({reset:!0}),this.forums.fetchItems({reset:!0}),this.users.fetchItems({reset:!0}),this.posts.fetchItems({reset:!0}),this.myposts.fetchItems({reset:!0})}})}),define("home/templates/searchResults",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<ul class="nav-tabs tabs-5">\n<li data-action="switch-tab" data-tab="threads" class="active">\n<a href="#">\n'+a(t.gettext.call(e,"Threads",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li data-action="switch-tab" data-tab="forums">\n<a href="#">\n'+a(t.gettext.call(e,"Communities",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li data-action="switch-tab" data-tab="users">\n<a href="#">\n'+a(t.gettext.call(e,"Users",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li data-action="switch-tab" data-tab="posts">\n<a href="#">\n'+a(t.gettext.call(e,"Comments",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li data-action="switch-tab" data-tab="myposts">\n<a href="#">\n'+a(t.gettext.call(e,"My Comments",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n</ul>\n\n<div data-role="content-area"></div>\n<div data-role="footer-area"></div>\n'},useData:!0})}),define("home/views/SearchResultsView",["home/views/common/TabbedView","home/views/ForumCardCollectionView","home/views/UserCollectionView","home/views/FeedEmptyView","home/views/ActivityCardWrapperView","home/views/PostCollectionView","home/views/ActivityCardCollectionView","home/templates/searchResults"],function(e,t,n,i,a,s,o,r){return e.extend({defaultTab:"threads",template:r,getTabView:function(e){var r=this.model[e];switch(e){case"threads":return new o({itemView:a.extend({className:"card"}),model:r,collection:r.get("items")});case"forums":return new t({emptyView:i,model:r,collection:r.get("items")});case"users":return new n({emptyView:i,model:r,collection:r.get("items")});case"posts":return new s({className:"cards",emptyView:i,model:r,collection:r.get("items")});case"myposts":return new s({className:"cards",emptyView:i,model:r,collection:r.get("items")})}}})}),define("home/templates/searchPage",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div class="cover section-contained" data-role="cover-area">\n<div class="cover-body search">\n<form>\n<span class="icon-search"></span>\n<input class="search-input" type="text" placeholder="Search" data-role="search-query">\n</div>\n</form>\n</div>\n<div id="container-content" class="section-contained">\n<div data-role="search-results"></div>\n</div>\n'},useData:!0})}),define("home/views/SearchPageLayout",["backbone-marionette","home/models/SearchManager","home/views/SearchResultsView","home/templates/searchPage"],function(e,t,n,i){return e.Layout.extend({template:i,ui:{query:"[data-role=search-query]"},events:{submit:"handleSearchRequest"},regions:{resultsRegion:"[data-role=search-results]"},initialize:function(e){this.session=e.session},getMetaAttrs:function(){return"Search"},handleSearchRequest:function(e){e.preventDefault();var i=new t({query:this.ui.query.val(),userId:this.session.user.get("id")});i.fetchSearchResults(),this.resultsRegion.show(new n({model:i}))}})}),define("home/templates/channelCover",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="banner__wrapper">\n<div class="grad-overlay">\n<div class="section-contained">\n<div class="channel-cover align align--middle align--between">\n<div class="metadata-hidden">\n';return a=this.invokePartial(n.channelCoverLogo,"","channelCoverLogo",e,void 0,t,n,i),null!=a&&(o+=a),o+'</div>\n<div class="metadata-hidden visible-md spacing-left-small">\n<button\nclass="button button-inverted -thick text-large feed-content"\ntitle='+s(t.gettext.call(e,"Info",{name:"gettext",hash:{},data:i}))+'\ndata-action="show-metadata">\n'+s(t.gettext.call(e,"About",{name:"gettext",hash:{},data:i}))+'\n</button>\n</div>\n<div class="metadata-visible">\n<button\nclass="spacing-top-small link-inverted pull-left"\ntitle='+s(t.gettext.call(e,"Feed",{name:"gettext",hash:{},data:i}))+'\ndata-action="hide-metadata">\n<span class="icon icon-left-bracket text-large icon__position"></span>\n</button>\n<h1 class="text-largest text-center">'+s(t.gettext.call(e,"About this Channel",{name:"gettext",hash:{},data:i}))+"</h1>\n</div>\n</div>\n</div>\n</div>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t.unless.call(e,null!=e?e.shouldFetch:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},usePartial:!0,useData:!0})}),define("home/views/ChannelCoverView",["underscore","backbone-marionette","core/switches","home/utils/mixpanelUtils","home/models/Session","home/mixins/asChannelBanner","home/templates/channelCover"],function(e,t,n,i,a,s,o){var r=t.ItemView.extend({template:o,templateHelpers:function(){return{shouldFetch:this.model.shouldFetch()}},events:{"click [data-action=show-metadata]":"showMetadata","click [data-action=hide-metadata]":"hideMetadata"},initialize:function(){this.session=a.get(),this.listenTo(this.session,"change:id",this.render),this.listenTo(this.model,"changeRelated:primaryForum",this.render)},modelEvents:{sync:"render"},showMetadata:function(){this.trigger("showMetadata",!0)},hideMetadata:function(){this.trigger("showMetadata",!1)}}),l=r.prototype;return s.call(l),r}),define("home/templates/channelLeadingUser",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<span class="label--default -inline">'+a(t.gettext.call(e,"Mod",{name:"gettext",hash:{},data:i}))+"</span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s='<div class="media-left avatar-sm__wrapper">';return a=this.invokePartial(n.userAvatar,"","userAvatar",e,void 0,t,n,i),null!=a&&(s+=a),s+='</div>\n<div class="media-body media-middle">\n',a=this.invokePartial(n.userName,"","userName",e,void 0,t,n,i),null!=a&&(s+=a),a=t["if"].call(e,null!=e?e.isModerator:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+"</div>\n"},usePartial:!0,useData:!0})}),define("home/views/ChannelLeadingUserView",["underscore","backbone-marionette","home/templates/channelLeadingUser"],function(e,t,n){var i=t.ItemView.extend({template:n,tagName:"li",className:"leader-list__item media",templateHelpers:function(){var t=this.model.get("moderatedForums")||[],n=this.channel&&this.channel.primaryForum;return{isModerator:n&&e.contains(t,n.id)}},modelEvents:{"change:moderatedForums":"render"},initialize:function(e){this.channel=e&&e.channel}});return i}),define("home/templates/channelMetadata",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s='<div class="media-left">\n';return a=t["if"].call(e,null!=e?e.channel:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.program(7,i),data:i}),null!=a&&(s+=a),s+"</div>\n"},2:function(e,t,n,i){var a,s="";return a=t["if"].call(e,null!=e?e.channelAvatar:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.program(5,i),data:i}),null!=a&&(s+=a),s},3:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<img class="img-round-sm" src="'+o(s(null!=e?e.channelAvatar:e,e))+'" alt="';return a=this.invokePartial(n.forumName,"","forumName",e,void 0,t,n,i),null!=a&&(r+=a),r+'">\n'},5:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.defaultChannelAvatar,"","defaultChannelAvatar",e,void 0,t,n,i),null!=a&&(s+=a),s},7:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<img src="'+i(n(null!=(t=null!=(t=null!=e?e.channel:e)?t.options:t)?t.favicon:t,e))+'" class="img-round-sm" />\n'},9:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression;return'<a href="'+o(s(null!=(a=null!=(a=null!=e?e.channel:e)?a.options:a)?a.aboutUrlPath:a,e))+'"\ndata-link-name="about"\ndata-channel-slug="'+o(s(null!=(a=null!=e?e.channel:e)?a.slug:a,e))+'">\n\n'+o(t.gettext.call(e,"Read more",{name:"gettext",hash:{},data:i}))+'\n<span class="icon icon-arrow-forward icon-tiny"></span>\n</a>\n'},11:function(e,t,n,i){var a,s='<p class="spacing-narrow">\n';return a=this.invokePartial(n.genericFollowButton,"","genericFollowButton",e,void 0,t,n,i),null!=a&&(s+=a),s+"</p>\n"},13:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="aside__wrap hidden" data-role="leaders-section">\n<div class="aside__header -padded -border-bottom">\n<h2>'+s(t.gettext.call(e,"Top Contributors",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<div data-role="leaders"></div>\n</div>\n<div class="aside__wrap" data-role="guidelines-section">\n<div class="aside__header -padded -border-bottom">\n<h2>'+s(t.gettext.call(e,"Channel Rules",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<div class="padding-gutter">\n<div class="guidelines" data-role="guidelines">\n';return a=this.invokePartial(n.homeRules,"","homeRules",e,void 0,t,n,i),null!=a&&(r+=a),r+'</div>\n<a data-link-name="guidelines"\nclass="curtain-truncate text-small"\ndata-action="expand" data-target="[data-role=guidelines]"\nhref="#"\ndata-channel-slug="'+s(o(null!=(a=null!=e?e.channel:e)?a.slug:a,e))+'">\n\n'+s(t.gettext.call(e,"Show guidelines",{name:"gettext",hash:{},data:i}))+'\n<span class="icon__position -inline icon-arrow icon"></span>\n</a>\n<a data-action="collapse" data-target="[data-role=guidelines]" class="hidden text-small" href="#">\n<span class="icon__position -inline icon-arrow-2 icon"></span>\n'+s(t.gettext.call(e,"Collapse guidelines",{name:"gettext",hash:{},data:i}))+"\n</a>\n</div>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="metadata-wrapper">\n<div class="aside__wrap -default">\n<div class="media">\n';return a=t.if_any.call(e,null!=e?e.channel:e,null!=(a=null!=(a=null!=e?e.channel:e)?a.options:a)?a.favicon:a,{name:"if_any",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<div class="media-body media-heading">\n<h2 class="spacing-bottom-small">'+o(s(null!=(a=null!=e?e.channel:e)?a.name:a,e))+'</h2>\n<p class="text-gray">\n'+o(s(null!=(a=null!=(a=null!=e?e.channel:e)?a.options:a)?a.description:a,e))+"<br />\n",a=t["if"].call(e,null!=(a=null!=(a=null!=e?e.channel:e)?a.options:a)?a.aboutUrlPath:a,{name:"if",hash:{},fn:this.program(9,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+="</p>\n",a=t.unless.call(e,null!=(a=null!=e?e.channel:e)?a.isAggregation:a,{name:"unless",hash:{},fn:this.program(11,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</div>\n<p class="text-gray spacing-narrow">\n'+o(t.gettext.call(e,"Want your own channel?",{name:"gettext",hash:{},data:i}))+'\n<a href="/home/channels/new/">'+o(t.gettext.call(e,"Create one »",{name:"gettext",hash:{},data:i}))+"</a>\n</p>\n</div>\n</div>\n",a=t.unless.call(e,null!=(a=null!=(a=null!=e?e.channel:e)?a.options:a)?a.isCurationOnlyChannel:a,{name:"unless",hash:{},fn:this.program(13,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+"</div>\n"},usePartial:!0,useData:!0})}),define("home/views/ChannelMetadataView",["underscore","backbone-marionette","home/views/ChannelLeadingUserView","home/mixins/withChannelAvatar","home/mixins/withChannelFollowing","home/mixins/withCollapsing","home/templates/channelMetadata"],function(e,t,n,i,a,s,o){var r=t.Layout.extend({regions:{leadersRegion:"[data-role=leaders]"},template:o,initialize:function(){this.listenTo(this.model.channel,"sync",this.render)},onDomRefresh:function(){var i=new t.CollectionView({itemView:n,tagName:"ul",className:"leader-list",itemViewOptions:{channel:this.model.channel},collection:this.model.leaders.items});this.model.ensureFetchedLeaders().then(e.bind(this.showLeaders,this)),this.leadersRegion.show(i)},showLeaders:function(){this.model.leaders.items.length&&this.$("[data-role=leaders-section]").removeClass("hidden")}});return a.call(r.prototype,function(){return this.model.channel}),i.call(r.prototype,function(){return this.model.channel}),s.call(r.prototype,{maxHeight:200,collapsibleSelector:"[data-role=guidelines-section]"}),r}),define("home/templates/channelCreateForm",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s='<input class="input--textbox" name="name" type="text" ';return a=t.unless.call(e,null!=e?e.sessionUserVerified:e,{name:"unless",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+" />\n"},2:function(){return" disabled"},4:function(e){var t=this.lambda,n=this.escapeExpression;return'<h2 class="text-larger spacing-bottom-narrow text-gray-darker">'+n(t(null!=e?e.name:e,e))+"</h2>\n"},6:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"The best names are short, descriptive, and memorable",{name:"gettext",hash:{},data:i}))+"\n"},8:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"This can't be changed",{name:"gettext",hash:{},data:i}))+"\n"},10:function(e,t,n,i,a){var s,o=this.lambda,r=this.escapeExpression,l='<option value="'+r(o(i&&i.key,e))+'" ';return s=t["if"].call(e,t.eq.call(e,null!=a[1]?a[1].bannerColor:a[1],i&&i.key,{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(11,i,a),inverse:this.noop,data:i}),null!=s&&(l+=s),l+">\n"+r(o(e,e))+"\n</option>\n"},11:function(){return"selected"},13:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="spacing-bottom form-attribute-input" data-attribute="avatar">\n<div class="spacing-default">\n<h3 class="text-gray-darker">\n'+s(t.gettext.call(e,"Avatar",{name:"gettext",hash:{},data:i}))+'\n</h3>\n<p class="text-gray spacing-bottom">\n'+s(t.gettext.call(e,"Used when listing your channel",{name:"gettext",hash:{},data:i}))+'</p>\n</p>\n<label class="align align--middle spacing-bottom-narrow">\n<div class="spacing-right">\n<input type="radio" name="avatarType" value="default" checked>\n</div>\n<div class="align align--middle">\n<div class="spacing-right-small">\n'+s(t.gettext.call(e,"Default",{name:"gettext",hash:{},data:i}))+'\n</div>\n<div class="spacing-left-small" data-role="default-avatar">\n';return a=this.invokePartial(n.defaultChannelAvatar,"","defaultChannelAvatar",e,void 0,t,n,i),null!=a&&(o+=a),o+='</div>\n</div>\n</label>\n<label class="align spacing-bottom-small">\n<div class="spacing-right">\n<input type="radio" name="avatarType" value="file" ',a=t["if"].call(e,null!=e?e.channelAvatar:e,{name:"if",hash:{},fn:this.program(14,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='>\n</div>\n<div>\n<div class="align align--middle spacing-bottom-small">\n<div class="spacing-right-small">\n'+s(t.gettext.call(e,"Custom Image",{name:"gettext",hash:{},data:i}))+"\n</div>\n",a=t["if"].call(e,null!=e?e.channelAvatar:e,{name:"if",hash:{},fn:this.program(16,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+'<div class="spacing-left-small">\n<input type="file" name="avatar" data-role="avatar-file-upload">\n</div>\n</div>\n<p class="text-small text-gray">'+s(t.gettext.call(e,"For the best results: 200 x 200 pixels",{name:"gettext",hash:{},data:i}))+'</p>\n</div>\n</label>\n<div data-role="attribute-error" class="form-message-error spacing-narrow"></div>\n<p class="text-gray spacing-bottom"></p>\n</div>\n</div>\n'},14:function(){return"checked"},16:function(e,t,n,i){var a,s='<div class="spacing-right-small">\n';return a=this.invokePartial(n.channelAvatarWithDefault,"","channelAvatarWithDefault",e,void 0,t,n,i),null!=a&&(s+=a),s+"</div>\n"},18:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Create Channel",{name:"gettext",hash:{},data:i}))+"\n"},20:function(e,t,n,i){var a=this.escapeExpression;return a(t.gettext.call(e,"Update Channel",{name:"gettext",hash:{},data:i}))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i,a){var s,o=this.escapeExpression,r=this.lambda,l='<form data-role="channel-form">\n<div class="card-wrap">\n<div class="card__body">\n<div class="spacing-bottom form-attribute-input" data-attribute="name">\n<div class="spacing-default">\n<h3 class="text-gray-darker">\n'+o(t.gettext.call(e,"Name",{name:"gettext",hash:{},data:i}))+'\n</h3>\n<p class="spacing-narrow">\n';return s=t["if"].call(e,null!=e?e.isNew:e,{name:"if",hash:{},fn:this.program(1,i,a),inverse:this.program(4,i,a),data:i}),null!=s&&(l+=s),l+='</p>\n<div data-role="attribute-error" class="form-message-error spacing-narrow"></div>\n<p class="text-gray spacing-bottom">\n',s=t["if"].call(e,null!=e?e.isNew:e,{name:"if",hash:{},fn:this.program(6,i,a),inverse:this.program(8,i,a),data:i}),null!=s&&(l+=s),l+='</p>\n</div>\n</div>\n<div class="spacing-bottom form-attribute-input" data-attribute="description">\n<div class="spacing-default">\n<h3 class="text-gray-darker">\n'+o(t.gettext.call(e,"Description",{name:"gettext",hash:{},data:i}))+'\n</h3>\n<p class="spacing-narrow">\n<textarea class="input--textbox" name="description" type="text" ',s=t.unless.call(e,null!=e?e.sessionUserVerified:e,{name:"unless",hash:{},fn:this.program(2,i,a),inverse:this.noop,data:i}),null!=s&&(l+=s),l+=">"+o(r(null!=(s=null!=e?e.options:e)?s.description:s,e))+'</textarea>\n</p>\n<div data-role="attribute-error" class="form-message-error spacing-narrow"></div>\n<p class="text-gray spacing-bottom">'+o(t.gettext.call(e,"Describe what your channel will be discussing in a sentence or two",{name:"gettext",hash:{},data:i}))+'</p>\n</div>\n</div>\n<div class="spacing-bottom form-attribute-input" data-attribute="bannerColor">\n<div class="spacing-default">\n<h3 class="text-gray-darker">\n'+o(t.gettext.call(e,"Banner Color",{name:"gettext",hash:{},data:i}))+'\n</h3>\n<p class="spacing-narrow">\n<select class="input--select" name="bannerColor" ',s=t.unless.call(e,null!=e?e.sessionUserVerified:e,{name:"unless",hash:{},fn:this.program(2,i,a),inverse:this.noop,data:i}),null!=s&&(l+=s),l+=">\n",s=t.each.call(e,null!=e?e.bannerColors:e,{name:"each",hash:{},fn:this.program(10,i,a),inverse:this.noop,data:i}),null!=s&&(l+=s),l+='</select>\n</p>\n<div data-role="attribute-error" class="form-message-error spacing-narrow"></div>\n<p class="text-gray spacing-bottom"></p>\n</div>\n</div>\n',s=t["if"].call(e,null!=e?e.editChannelAvatar:e,{name:"if",hash:{},fn:this.program(13,i,a),inverse:this.noop,data:i}),null!=s&&(l+=s),l+='</div>\n</div>\n<div class="align align--between spacing-bottom">\n<div></div>\n<div class="align--mobile">\n<div class="discussion-form__loading">\n<div class="spinner-small"></div>\n</div>\n<button type="button" data-action="cancel-create" class="button text-medium">\n'+o(t.gettext.call(e,"Cancel",{name:"gettext",hash:{},data:i}))+'\n</button>\n<button type="submit" data-role="channel-form-button" class="button button-inverted-fill button--discussion-form text-medium"',s=t.unless.call(e,null!=e?e.sessionUserVerified:e,{name:"unless",hash:{},fn:this.program(2,i,a),inverse:this.noop,data:i}),null!=s&&(l+=s),l+=">\n",s=t["if"].call(e,null!=e?e.isNew:e,{name:"if",hash:{},fn:this.program(18,i,a),inverse:this.program(20,i,a),data:i}),null!=s&&(l+=s),l+"</button>\n</div>\n</div>\n</form>\n"},usePartial:!0,useData:!0,useDepths:!0})}),define("home/templates/channelCreateError",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda;return'<div class="modal-header">\n<h4 class="modal-title">'+s(t.gettext.call(e,"Uh oh, we weren't unable to create your channel",{name:"gettext",hash:{},data:i}))+'</h4>\n</div>\n<div class="modal-body">\n<p>'+s(o(null!=(a=null!=e?e.responseJSON:e)?a.response:a,e))+"</p>\n</div>\n"},useData:!0})}),define("home/views/ChannelCreateFormView",["jquery","underscore","backbone-marionette","handlebars","core/switches","core/UniqueModel","home/models/Channel","home/mixins/withChannelAvatar","home/templates/channelCreateForm","home/templates/channelCreateError","home/utils/confirmModal"],function(e,t,n,i,a,s,o,r,l,c,d){var u=a.isFeatureActive("editChannelAvatar"),h=n.ItemView.extend({template:l,templateHelpers:function(){return{sessionUserVerified:this.session.user.get("isVerified"),bannerColors:o.BANNER_COLORS,editChannelAvatar:u,isNew:this.isNew}},events:{submit:"submitChannel","keyup input[name=name]":"handleNameKeyup","change select[name=bannerColor]":"handleBannerColorChange","click [data-action=cancel-create]":"navigateBack"},ui:{name:"[name=name]",bannerColor:"[name=bannerColor]",description:"[name=description]",avatar:"[name=avatar]",defaultAvatar:"[data-role=default-avatar]",form:"[data-role=channel-form]",buttons:"[data-role=channel-form-button]"},initialize:function(e){this.session=e.session,this.isNew=this.model.isNew(),this.listenTo(this.model,"invalid",this.handleValidationError),this.listenTo(this.model,"change:bannerColor change:name",this.updateDefaultAvatar)},updateDefaultAvatar:function(){var e=this.model.get("name")||"",t=this.model.get("bannerColor");this.ui.defaultAvatar.html(i.partials.defaultChannelAvatar({bannerColorClass:t&&"-"+t,channelInitial:e.charAt(0)}))},submitChannel:function(n){n.preventDefault(),this.$(".form-attribute-input").removeClass("is-error"),this.disableForm();var i=this.isNew?"created":"updated",a={name:this.isNew?this.ui.name.val():this.model.get("name"),bannerColor:this.ui.bannerColor.val(),description:this.ui.description.val()},s=e("[name=avatarType]:checked").val();if("file"===s){var o=this.ui.avatar[0].files[0];o&&(a.avatar=o)}this.model.save(a,{avatarType:s,success:t.bind(this.handleSaveSuccess,this,i),error:t.bind(this.handleSaveError,this)})},handleSaveSuccess:function(e,t){this.enableForm(),this.trigger(e,t)},handleNameKeyup:function(){var e=this.ui.name.val().trim();this.model.set("name",e)},handleBannerColorChange:function(){this.model.set("bannerColor",this.ui.bannerColor.val())},navigateBack:function(){window.history.back()},handleValidationError:function(e,n){this.enableForm(),t.each(n,function(e){this.$(".form-attribute-input[data-attribute*="+e.attrName+"]").addClass("is-error").find("[data-role=attribute-error]").text(e.message)},this)},handleSaveError:function(e,t){this.enableForm(),d.confirmationPromise(d.TYPES.CLOSE,c(t))},enableForm:function(){this.ui.form.removeClass("is-submitting"),this.ui.buttons.removeAttr("disabled")},disableForm:function(){this.ui.form.addClass("is-submitting"),this.ui.buttons.attr("disabled","disabled")}});return r.call(h.prototype),h}),define("home/templates/channelDiscussionFeed",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression;return'<div class="card-wrap -padded">\n<a href="/home/discuss/'+o(s(null!=(a=null!=(a=null!=e?e.channel:e)?a.primaryForum:a)?a.id:a,e))+'/" class="button button-wide">\n<div class="align align--between align--middle">\n<div class="align__item">\n<span class="icon-create-discussion text-small icon__position -inline"></span>\n'+o(t.gettext.call(e,"What do you want to discuss?",{name:"gettext",hash:{},data:i}))+'\n</div>\n<div class="align__item">\n<button class="button button-outline text-medium">'+o(t.gettext.call(e,"Discuss",{name:"gettext",hash:{},data:i}))+"</button>\n</div>\n</div>\n</a>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t.unless.call(e,null!=(a=null!=(a=null!=e?e.channel:e)?a.options:a)?a.isCurationOnlyChannel:a,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s+'<div data-role="content-area"></div>\n<div data-role="footer-area"></div>\n'},useData:!0})}),define("home/views/ChannelDiscussionFeedView",["underscore","home/views/common/FetchableCollectionLayout","home/templates/channelDiscussionFeed"],function(e,t,n){var i=t.extend({template:n,templateHelpers:function(){return{channel:this.channel.toJSON()}},initialize:function(e){t.prototype.initialize.call(this,e),this.channel=e.channel}});return i}),define("home/templates/channelTopicTab",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e){var t=this.lambda,n=this.escapeExpression;return'<span class="button--tag -inverted -large">'+n(t(null!=e?e.topicName:e,e))+"</span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<div class="alert -topics">\n<div class="align align--between">\n<div class="align align--wrap align--middle">\n<div class="spacing-right">\n<strong>'+s(t.gettext.call(e,"Channel Topic",{name:"gettext",hash:{},data:i}))+":</strong>\n</div>\n";return a=t["if"].call(e,null!=e?e.topicName:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'</div>\n\n<a href="/home/channel/'+s(o(null!=(a=null!=e?e.channel:e)?a.slug:a,e))+'/" class="link-tag" title="'+s(t.gettext.call(e,"Remove Filter",{name:"gettext",hash:{},data:i}))+'">\n<span class="icon-cancel icon-tiny"></span>\n</a>\n</div>\n</div>\n<div data-role="header-area"></div>\n<div data-role=\'content-area\'></div>\n<div data-role=\'footer-area\'></div>\n'},useData:!0})}),define("home/views/ChannelTopicTabView",["home/views/common/FetchableCollectionLayout","home/templates/channelTopicTab"],function(e,t){var n=e.extend({template:t,templateHelpers:function(){return{topicName:this.filteredTopic.get("displayName"),channel:this.channel.toJSON()}},initialize:function(t){e.prototype.initialize.call(this,t),this.channel=t.channel,this.filteredTopic=t.filteredTopic,this.listenTo(this.filteredTopic,"change:displayName",this.render)}});return n}),define("home/templates/channelProfile",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression;return'<li data-action="switch-tab" data-tab="comments" class="nav__item">\n<a href="/home/channel/'+o(s(null!=(a=null!=e?e.channel:e)?a.slug:a,e))+'/comments/" data-action="hide-metadata" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n<span class="nav-lnk__icon icon icon-comments"></span>\n<span class="button__text">'+o(t.gettext.call(e,"Latest Comments",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n'},3:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression;return'<li data-action="switch-tab" data-tab="recent" class="nav__item">\n<a href="/home/channel/'+o(s(null!=(a=null!=e?e.channel:e)?a.slug:a,e))+'/recent/" data-action="hide-metadata" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n<span class="nav-lnk__icon icon icon-discussions"></span>\n<span class="button__text">'+o(t.gettext.call(e,"Latest",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n'},5:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda;return'<section data-role="admin-nav" class="hidden-lg">\n<div class="aside__subheadings">\n<h2 class="text-subheading">'+s(t.gettext.call(e,"Channel settings",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<ul class="nav--aside">\n<li class="nav__item">\n<a href="/home/channel/'+s(o(null!=(a=null!=e?e.channel:e)?a.slug:a,e))+'/basics/" data-action="hide-metadata" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n<span class="button__text">'+s(t.gettext.call(e,"Basics",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n</ul>\n</section>\n'},7:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<section data-role="admin-nav" class="hidden-lg">\n<div class="aside__subheadings">\n<h2 class="text-subheading">'+s(t.gettext.call(e,"Admin links",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<ul class="nav--aside">\n<li class="nav__item">\n<a href="//'+s(o(null!=(a=null!=(a=null!=e?e.channel:e)?a.primaryForum:a)?a.id:a,e))+'.disqus.com/admin/moderate/" class="nav-lnk -color-muted" target="_blank">\n'+s(t.gettext.call(e,"Moderate",{name:"gettext",hash:{},data:i}))+"\n</a>\n</li>\n";
return a=t["if"].call(e,null!=e?e.isDisqusAdmin:e,{name:"if",hash:{},fn:this.program(8,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+"</ul>\n</section>\n"},8:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression;return'<li class="nav__item">\n<a href="//'+o(s(null!=(a=null!=(a=null!=e?e.channel:e)?a.primaryForum:a)?a.id:a,e))+'.disqus.com/admin/analytics/" class="nav-lnk -color-muted" target="_blank">\n'+o(t.gettext.call(e,"Analytics",{name:"gettext",hash:{},data:i}))+'\n</a>\n</li>\n<li class="nav__item">\n<a href="/home/curate/channel/'+o(s(null!=(a=null!=e?e.channel:e)?a.slug:a,e))+'/" class="nav-lnk -color-muted">\n'+o(t.gettext.call(e,"Curation Tools",{name:"gettext",hash:{},data:i}))+"\n</a>\n</li>\n"},10:function(e,t,n,i,a){var s,o=this.escapeExpression,r='<div class="hidden-lg">\n<div class="aside__subheadings text-subheading">\n<h2>\n'+o(t.gettext.call(e,"Channel topics",{name:"gettext",hash:{},data:i}))+'\n</h2>\n</div>\n<div class="aside__wrap">\n<ul class="tag-list">\n';return s=t.each.call(e,null!=e?e.trendingTopics:e,{name:"each",hash:{},fn:this.program(11,i,a),inverse:this.noop,data:i}),null!=s&&(r+=s),r+"</ul>\n</div>\n</div>\n"},11:function(e,t,n,i,a){var s,o=this.lambda,r=this.escapeExpression;return'<li data-action="switch-tab" data-tab="topic-'+r(o(null!=e?e.identifier:e,e))+'">\n<a href="/home/channel/'+r(o(null!=(s=null!=a[1]?a[1].channel:a[1])?s.slug:s,e))+"/topics/"+r(o(null!=e?e.identifier:e,e))+'" class="button--tag">\n'+r(o(null!=e?e.displayName:e,e))+"\n</a>\n</li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i,a){var s,o=this.escapeExpression,r=this.lambda,l='<header data-role="cover"></header>\n<div class="nav-wrapper feed-content" id="content-area">\n</div>\n<div class="section-contained">\n<div class="layout">\n<div class="layout__main">\n<nav class="layout__nav">\n<section data-role="default-nav">\n<div class="aside__subheadings hidden-lg">\n<h2 class="text-subheading">'+o(t.gettext.call(e,"Discussions",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<ul class="nav--aside">\n<li data-action="switch-tab" data-tab="top" class="nav__item">\n<a href="/home/channel/'+o(r(null!=(s=null!=e?e.channel:e)?s.slug:s,e))+'/top/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n<span class="nav-lnk__icon icon icon-popular"></span>\n<span class="button__text">'+o(t.gettext.call(e,"Recommended",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n';return s=t["if"].call(e,null!=e?e.showCommentsFeed:e,{name:"if",hash:{},fn:this.program(1,i,a),inverse:this.noop,data:i}),null!=s&&(l+=s),s=t.unless.call(e,null!=(s=null!=(s=null!=e?e.channel:e)?s.options:s)?s.isCurationOnlyChannel:s,{name:"unless",hash:{},fn:this.program(3,i,a),inverse:this.noop,data:i}),null!=s&&(l+=s),l+="</ul>\n</section>\n\n",s=t["if"].call(e,null!=e?e.isSessionUserChannelOwner:e,{name:"if",hash:{},fn:this.program(5,i,a),inverse:this.noop,data:i}),null!=s&&(l+=s),s=t["if"].call(e,null!=e?e.isChannelModerator:e,{name:"if",hash:{},fn:this.program(7,i,a),inverse:this.noop,data:i}),null!=s&&(l+=s),l+="\n",s=t["if"].call(e,null!=e?e.trendingTopics:e,{name:"if",hash:{},fn:this.program(10,i,a),inverse:this.noop,data:i}),null!=s&&(l+=s),l+'</nav>\n<section class="layout__content feed-content" data-role="content-area">\n</section>\n</div>\n<aside class="layout__aside metadata-content" data-role="metadata">\n</aside>\n</div>\n</div>\n'},useData:!0,useDepths:!0})}),define("home/views/ChannelProfileView",["jquery","underscore","backbone","backbone-marionette","core/utils/releaseUtils","home/utils/layoutUtils","home/utils/backboneUtils","home/utils/confirmModal","home/utils/navigationUtils","home/views/common/TabbedView","home/views/ChannelCoverView","home/views/ChannelMetadataView","home/views/ChannelCardCollectionView","home/views/ChannelCreateFormView","home/views/common/FetchableCollectionLayout","home/views/ChannelFeedFooterView","home/views/UserCollectionView","home/views/ChannelDiscussionFeedView","home/views/ChannelTopicTabView","home/views/CommentCardCollectionView","home/templates/channelProfile","home/templates/guidelines","home/templates/spinnerTall","core/UniqueModel","home/models/Session","home/models/Topic","home/mixins/withClickLinkTracking","core/strings","core/switches"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f,g,v,w,b,x,y,_,k,C,T,S,E,F){var P=E.get,D=F.isFeatureActive("channelComments"),M=c.extend({className:"channel-profile",defaultTab:function(){return"top"},template:function(e){return e.channel.name?x(e):_(e)},templateHelpers:function(){var e=a.isDisqusAdmin(this.session.user),t=e||this.model.moderators.items.contains(this.session.user);return{showCommentsFeed:D,isDisqusAdmin:e,isChannelModerator:t,isSessionUserChannelOwner:this.isSessionUserChannelOwner()}},regions:t.defaults({coverRegion:"[data-role=cover]",metadataRegion:"[data-role=metadata]"},c.prototype.regions),initialize:function(e){e&&"guidelines"===e.activeTab&&(e.activeTab=t.result(this,"defaultTab"),this.listenToOnce(this,"show",this.showGuidelines)),this.session=C.get(),c.prototype.initialize.apply(this,arguments),this.listenTo(this.model.channel,"sync",this.render),this.listenTo(this.model.moderators,"items:sync",this.render),this.model.trendingTopics&&this.listenTo(this.model.trendingTopics,"items:sync",this.render),this.listenTo(this,"change:activeTab",this.updateTabSpecificModules)},events:t.defaults({"click a[data-link-name]":"trackClickLink","click [data-action=show-guidelines]":"showGuidelines","click [data-action=hide-metadata]":"hideMetadata"},c.prototype.events),hideMetadata:function(){this.trigger("showMetadata",!1)},showGuidelines:function(){var e=this;o.getPromiseFor(this.model.channel,"name").then(function(){var t=y(e.model.channel.toJSON());r.confirmationPromise(r.TYPES.CLOSE,t).always(function(){l.navigate("/home/channel/"+e.model.id+"/",{replace:!0,silent:!0})})})},onDomRefresh:function(){if(this.$(this.coverRegion.el).length){var e=new d({model:this.model.channel});this.listenTo(e,"showMetadata",this.showMetadata),this.coverRegion.show(e),this.metadataRegion.show(new u({model:this.model})),c.prototype.onDomRefresh.apply(this,arguments)}},updateTabSpecificModules:function(e){var t=/^topic-.+/.test(e);this.$("[data-role=default-nav]").toggleClass("hidden",t)},showMetadata:function(e){this.$el.toggleClass("metadata-view",e)},getTrackingSection:function(e){return e},getTabView:function(e){var n;switch(e){case"recent":return n=new v({model:this.model.recentActivities,collection:this.model.recentActivities.items,fetchableCollectionView:h,fetchableCollectionFooterView:f,channel:this.model.channel,isChannelFeed:!0,infiniteScroll:!0,filterVerbs:["trending"]}),n.$el.attr({"data-mix-location":"recent"}),n;case"top":return n=new v({model:this.model.topActivities,collection:this.model.topActivities.items,fetchableCollectionView:h,fetchableCollectionFooterView:f,channel:this.model.channel,isChannelFeed:!0,infiniteScroll:!0}),n.$el.attr({"data-mix-location":"top"}),n;case"followers":return n=new p({model:this.model.followers,collection:this.model.followers.items,fetchableCollectionView:g,fetchableCollectionFooterView:f,infiniteScroll:!0}),n.$el.attr({"data-mix-location":"followers","class":"card-wrap"}),n;case"basics":return this.isSessionUserChannelOwner()?(n=new m({model:this.model.channel,session:this.session}),this.listenTo(n,"updated",function(e){l.navigate("/home/channel/"+e.id+"/",{trigger:!0})}),n):void this.trigger("badTab");case"comments":return D?(n=new p({model:this.model.comments,collection:this.model.comments.items,fetchableCollectionView:b,infiniteScroll:!0}),n.$el.attr({"data-mix-location":"comments"}),n):(t.defer(function(e){e.activeTab=t.result(e,"defaultTab"),e.updateTab()},this),new i.View)}var a=e.match(/^topic-(.+)/);if(a){if(!this.model.trendingTopics)return;var s=a[1],o=this.model.getFetchedTopicFilteredFeed(s);return n=new w({model:o,collection:o.items,fetchableCollectionView:h,fetchableCollectionFooterView:f,filteredTopic:new k(T,{identifier:s}),channel:this.model.channel,isChannelFeed:!0,infiniteScroll:!0}),n.$el.attr({"data-mix-location":"topic"}),n}},isSessionUserChannelOwner:function(){return this.model.channel.get("owner_id")===this.session.user.get("id")},getPageTitle:function(){var e=this.model.channel;return o.getPromiseFor(e,"name").then(function(e){return E.interpolate(P("%(name)s Channel"),{name:e})})},getMetaAttrs:function(){var e=this.model.channel;return this.getPageTitle().then(function(t){var n=e.get("options")||{};return{title:t,image:n.coverImage?n.coverImage.cache:n.tile,description:n.description,type:"article"}})},getPageTrackingParams:function(){var e=this.model.channel;return this.getPageTitle().then(function(t){return{channel_slug:e.get("slug"),title:t}})}});return S.call(M.prototype),M}),define("home/templates/exploreModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<header class="module-header -plain">\n<div class="module-header__title">\n<h2 class="text-gray-darker">\n'+a(t.gettext.call(e,"Other Channel Groups",{name:"gettext",hash:{},data:i}))+'\n</h2>\n</div>\n</header>\n<div data-role="channels"></div>\n'},useData:!0})}),define("home/templates/exploreChannelCover",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="banner__wrapper">\n<div class="grad-overlay">\n<div class="section-contained">\n<div class="channel-cover -explore">\n';return a=this.invokePartial(n.channelCoverLogo,"","channelCoverLogo",e,void 0,t,n,i),null!=a&&(r+=a),r+'<div class="padding-default">\n<h1 class="text-largest">'+o(s(null!=e?e.name:e,e))+"</h1>\n</div>\n</div>\n</div>\n</div>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s="";return a=t.unless.call(e,null!=e?e.shouldFetch:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},usePartial:!0,useData:!0})}),define("home/templates/exploreChannelProfile",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return"hidden-md"},3:function(e,t,n,i){var a=this.escapeExpression;return"<p><strong>"+a(t.gettext.call(e,"Pick a discussion that interests you.",{name:"gettext",hash:{},data:i}))+"</strong></p>\n"},5:function(e,t,n,i){var a=this.escapeExpression;return'<div class="visible-md text-center">\n<p><strong>'+a(t.gettext.call(e,"Pick a discussion",{name:"gettext",hash:{},data:i}))+"</strong></p>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<header data-role="cover"></header>\n<div class="section-contained">\n<div class="layout spacing-bottom-large">\n<div class="layout__main">\n<div class="layout__content -centered">\n<div class="spacing-top spacing-bottom-large ';return a=t.unless.call(e,null!=e?e.isInOnboarding:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="hidden-md">\n<p class="text-gray">'+o(s(null!=(a=null!=(a=null!=e?e.channel:e)?a.options:a)?a.description:a,e))+"</p>\n",a=t["if"].call(e,null!=e?e.isInOnboarding:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+="</div>\n",a=t["if"].call(e,null!=e?e.isInOnboarding:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'</div>\n<section data-role="content" class="channel-profile"></section>\n</div>\n</div>\n<aside class="layout__aside -centered-mobile">\n<div data-role="source-channels-module" class="module--aside"></div>\n<div data-role="discussions-module" class="module--aside"></div>\n<div data-role="channels-module" class="module--aside"></div>\n</aside>\n</div>\n</div>\n'},useData:!0})}),define("home/templates/channelCardExplore",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" has-image"},3:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<div class="card-content__media">\n<div style="background-image: url('+i(n(null!=(t=null!=e?e.image:e)?t.src:t,e))+')" class="img-cards"></div>\n</div>\n'},5:function(e){var t,n=this.lambda,i=this.escapeExpression;return i(n(null!=(t=null!=e?e.threadOverrides:e)?t.title:t,e))+"\n"},7:function(e){var t,n=this.lambda,i=this.escapeExpression;return i(n(null!=(t=null!=e?e.thread:e)?t.clean_title:t,e))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="'+o(s(null!=(a=null!=e?e.thread:e)?a.link:a,e))+'">\n<div class="card__header -feed">\n<div class="card__reason align align--middle">\n<strong class="text-gray-darker">';return a=this.invokePartial(n.forumName,"","forumName",null!=(a=null!=e?e.thread:e)?a.forum:a,void 0,t,n,i),null!=a&&(r+=a),r+='</strong>\n<time class="bullet text-gray">'+o(s(null!=e?e.threadCreated:e,e))+'</time>\n</div>\n</div>\n<div class="card__content -default',a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n',a=t["if"].call(e,null!=e?e.image:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<div class="card-content__body">\n<h2 class="discussion-title text-gray-darker" dir="auto">\n',a=t["if"].call(e,null!=(a=null!=e?e.threadOverrides:e)?a.title:a,{name:"if",hash:{},fn:this.program(5,i),inverse:this.program(7,i),data:i}),null!=a&&(r+=a),r+'</h2>\n\n<div class="card-content__summary text-gray-dark">\n<div class="truncate" data-truncate-lines="3" dir="auto">\n'+o(s(null!=e?e.threadDescription:e,e))+'\n</div>\n</div>\n</div>\n</div>\n<div class="card__footer text-gray-dark text-semibold">\n'+o(t.gettext.call(e,"%(recommendCount)s recommends",{name:"gettext",hash:{recommendCount:null!=(a=null!=e?e.thread:e)?a.likes:a},data:i}))+'\n<span class="bullet"></span>\n'+o(t.gettext.call(e,"%(commentCount)s comments",{name:"gettext",hash:{commentCount:null!=(a=null!=e?e.thread:e)?a.posts:a},data:i}))+"\n</div>\n</a>\n"},usePartial:!0,useData:!0})}),define("home/views/ChannelCardExploreView",["underscore","core/config","home/views/ChannelCardView","home/templates/channelCardExplore"],function(e,t,n,i){var a=n.extend({template:i,className:"card-wrap card--channel -link",templateHelpers:function(){var i=n.prototype.templateHelpers;return e.defaults({guestAvatar:t.urls.avatar.generic},e.isFunction(i)?i.call(this):i)}});return a}),define("home/views/ExploreChannelCoverView",["home/views/ChannelCoverView","home/templates/exploreChannelCover"],function(e,t){var n=e.extend({template:t});return n}),define("home/templates/sourceChannelsModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div data-mix-location="channel module">\n<header class="module-header">\n';return a=this.invokePartial(n.channelsModuleHeader,"","channelsModuleHeader",e,void 0,t,n,i),null!=a&&(r+=a),r+'</header>\n<div data-role="channels" class="module-body"></div>\n<footer class="module-footer">\n<a href="/home/explore/'+o(s(null!=e?e.slug:e,e))+'/channels/"\nclass="nav-lnk -color-muted -flushed"\ndata-action="switch-tab"\ndata-tab="channels">\n\n<div class="nav-lnk__blk">'+o(t.gettext.call(e,"See all",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</footer>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/SourceChannelsModuleView",["underscore","core/UniqueModel","core/strings","home/models/ChannelProfile","home/views/ChannelsModuleView","home/views/ChannelSuggestionView","home/templates/sourceChannelsModule"],function(e,t,n,i,a,s,o){var r=n.get,l=a.extend({className:"aside__wrap -padded",itemView:s,template:o,templateHelpers:{moduleTitle:r("Channels in this group")},itemViewOptions:function(t,n){var i=a.prototype.itemViewOptions;e.isFunction(i)&&(i=i.call(this,t,n));var s=t===this.model||t.channel===this.model;return e.defaults({className:s?"hidden":"recommended-wrap"},i)}},{CHANNELS_MAX:3});return l}),define("home/templates/channelGroupDiscussionsModule",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression,s=this.lambda;return'<header class="module-header text-center">\n<div class="module-header__icon">\n<span class="icon icon-latest-recommendation text-brand"></span>\n</div>\n<div class="module-header__title">\n<h2 class="module-header__heading">'+a(t.gettext.call(e,"Discussions in this group",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n</header>\n\n<div data-role="posts" class="module-body"></div>\n\n<footer class="module-footer">\n<a href="/home/explore/'+a(s(null!=e?e.slug:e,e))+'/discussions/"\nclass="nav-lnk -color-muted -flushed"\ndata-action="switch-tab"\ndata-tab="discussions">\n\n<div class="nav-lnk__blk">'+a(t.gettext.call(e,"See all",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</footer>\n'},useData:!0})}),define("home/views/ChannelGroupDiscussionsModuleView",["home/views/common/EnclosedDiscussionsModuleView","home/templates/channelGroupDiscussionsModule"],function(e,t){var n=e.extend({template:t},{ITEMS_MAX:3});return n}),define("home/templates/channelCardGrid",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div class="channels-explore">\n<section class="clearfix module-body -discover -plain">\n<div class="channels-module__wrap" data-role="channels"></div>\n</section>\n</div>\n'},useData:!0})}),define("home/views/SourceChannelCardGridView",["backbone-marionette","core/UniqueModel","home/models/ChannelProfile","home/views/DiscoverChannelView","home/templates/channelCardGrid"],function(e,t,n,i,a){var s=e.CompositeView.extend({itemView:i,template:a,itemViewContainer:"[data-role=channels]",itemViewOptions:function(e){var i={},a=new t(n,{id:e.channel.id,channel:e.channel});return a.ensureFetchedTopActivities(),i.model=a,e.channel===this.model&&(i.className="hidden"),i}});return s}),define("home/templates/explore",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="explore__wrapper">\n<header class="text-center spacing-narrow">\n<h1 class="text-largest text-gray-darker">\n'+a(t.gettext.call(e,"Pick a channel group that interests you",{name:"gettext",hash:{},data:i}))+'\n</h1>\n<p class="padding-default text-large text-gray">\n'+a(t.gettext.call(e,"There's great discussions behind all of these. You can't go wrong!",{name:"gettext",hash:{},data:i}))+'\n</p>\n</header>\n<div data-role="channels" class="align align--wrap"></div>\n<div class="padding-gutter text-center text-gray text-medium">\n'+a(t.gettext.call(e,"Don't see one that interests you?",{name:"gettext",hash:{},data:i}))+'\n<a href="https://disqus.com/home/channel/channelchat/discussion/channel-channelchat/which_channel_groups_are_missing_from_disqus/" data-action="complete-onboarding">'+a(t.gettext.call(e,"Tell us what you want to see",{name:"gettext",hash:{},data:i}))+'</a>\nor\n<a href="/home/channels/new/">'+a(t.gettext.call(e,"create your own channel",{name:"gettext",hash:{},data:i}))+"</a>.\n</div>\n</div>\n"},useData:!0})}),define("home/templates/exploreChannel",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<a href="/home/explore/'+o(s(null!=(a=null!=e?e.channel:e)?a.slug:a,e))+'/discussions/" alt="'+o(s(null!=(a=null!=e?e.channel:e)?a.name:a,e))+'" class="explore__link link-gray-darker">\n<div class="explore__tile '+o(s(null!=e?e.bannerColor:e,e))+'">\n';return a=this.invokePartial(n.channelCoverLogo,"","channelCoverLogo",null!=e?e.channel:e,void 0,t,n,i),null!=a&&(r+=a),r+'</div>\n<div class="explore__description">\n<h2 class="explore__name spacing-bottom-small">'+o(s(null!=(a=null!=e?e.channel:e)?a.name:a,e))+'</h2>\n<p class="text-gray text-medium">'+o(s(null!=(a=null!=(a=null!=e?e.channel:e)?a.options:a)?a.description:a,e))+"</p>\n</div>\n</a>\n"},usePartial:!0,useData:!0})}),define("home/views/ExploreChannelView",["backbone-marionette","home/templates/exploreChannel"],function(e,t){var n=e.ItemView.extend({template:t,className:"explore__item",templateHelpers:function(){var e=this.model.channel.get("bannerColor");return{bannerColor:e?"-"+e:""}}});return n}),define("home/views/ExploreView",["backbone-marionette","underscore","core/UniqueModel","home/models/ChannelProfileFeed","home/templates/explore","home/views/ExploreChannelView","home/views/FetchingView"],function(e,t,n,i,a,s,o){var r=e.CompositeView.extend({template:a,emptyView:function(){return new o({className:"spinner-small"})},events:{"click [data-action=complete-onboarding]":"completeOnboarding"},itemView:s,itemViewContainer:"[data-role=channels]",initialize:function(e){this.session=e.session,this.collection=this.model.items,this.hideChannelId=e.hideChannelId},onCompositeCollectionBeforeRender:function(){this.collection.models=this.collection.shuffle()},itemViewOptions:function(e){return e.id===this.hideChannelId?{className:"hidden"}:void 0},getMetaAttrs:function(){return"Explore"},completeOnboarding:function(){this.session.user.updateFlags({homeOnboardingComplete:!0})}},{Create:function(e){var a=new n(i,{listName:i.LIST_NAMES.explore});return a.ensureFetched(),new r(t.extend({model:a},e))}});return r}),define("home/views/ExploreChannelProfileView",["underscore","backbone-marionette","home/models/Session","home/templates/exploreModule","home/templates/exploreChannelCover","home/templates/exploreChannelProfile","home/views/common/TabbedView","home/views/ChannelCardCollectionView","home/views/ChannelCardExploreView","home/views/ExploreChannelCoverView","home/views/SourceChannelsModuleView","home/views/ChannelGroupDiscussionsModuleView","home/views/SourceChannelCardGridView","home/views/ExploreView","home/utils/trackingUtils","home/mixins/withOnboarding"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f){var g=o.extend({defaultTab:"discussions",template:s,templateHelpers:function(){return{isInOnboarding:this.isInOnboarding(this.session)}},regions:{coverRegion:"[data-role=cover]",contentRegion:"[data-role=content]",channelsModuleRegion:"[data-role=channels-module]",sourceChannelsModuleRegion:"[data-role=source-channels-module]",discussionsModuleRegion:"[data-role=discussions-module]"},initialize:function(t){o.prototype.initialize.call(this,t),this.app=t.app,this.session=n.get(),this.session.loadPromise().then(e.bind(this.render,this)),this.listenTo(this.model.channel,"change",this.render),this.listenTo(this,"change:activeTab",this.toggleTabSpecificModules),p.setSection(this.model.channel.get("slug"))},onDomRefresh:function(){o.prototype.onDomRefresh.call(this),this.coverRegion.show(this.createCoverView()),this.channelsModuleRegion.show(this.createChannelsModuleView()),this.isInOnboarding(this.session)||(this.sourceChannelsModuleRegion.show(this.createSourceChannelsModuleView()),this.discussionsModuleRegion.show(this.createDiscussionsModuleView()),this.toggleTabSpecificModules(this.activeTab))},createCoverView:function(){return new c({model:this.model.channel})},createChannelsModuleView:function(){return new m.Create({template:i,hideChannelId:this.model.id})},createSourceChannelsModuleView:function(){return this.model.ensureFetchedSourceForums(),new d({collection:this.model.sourceForums,model:this.model.channel})},createDiscussionsModuleView:function(){return new u({model:this.model.channel,collection:this.model.topActivities.items})},toggleTabSpecificModules:function(e){var t="discussions"===e,n="channels"===e;this.sourceChannelsModuleRegion.ensureEl(),this.sourceChannelsModuleRegion.$el.toggleClass("hidden",!t),this.discussionsModuleRegion.ensureEl(),this.discussionsModuleRegion.$el.toggleClass("hidden",!n)},getTabView:function(e){return"discussions"===e?new r({model:this.model.topActivities,collection:this.model.topActivities.items,itemView:l,channel:this.model.channel}):"channels"===e?new h({collection:this.model.sourceForums,model:this.model.channel}):void 0}}),v=g.prototype;return f.call(v,function(){return this.app}),g}),define("home/templates/channelCreate",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<div class="alert -warning text-medium">\n'+a(t.gettext.call(e,"Creating a channel requires your account to be verified.",{name:"gettext",hash:{},data:i}))+'\n<a href="/verify" data-action="verify-email">'+a(t.gettext.call(e,"Resend confirmation email »",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div data-role="banner" class="banner__wrapper">\n<div class="section-contained">\n<div class="channel-cover align align--middle">\n<h1 class="channel-cover__heading" data-role="channel-name">'+s(t.gettext.call(e,"Your Channel Name",{name:"gettext",hash:{},data:i}))+'</h1>\n</div>\n</div>\n</div>\n<div class="section-contained">\n<div class="layout">\n<div class="layout__main">\n<div class="layout__nav">\n<div class="aside__wrap aside-inverted">\n<div class="aside-inverted__content">\n<h2 class="text-large spacing-bottom-narrow">\n'+s(t.gettext.call(e,"Create a Channel:",{name:"gettext",hash:{},data:i}))+"\n</h2>\n<p>\n"+s(t.gettext.call(e,"Need Help?",{name:"gettext",hash:{},data:i}))+'\n<a href="https://disqus.com/home/channel/channelchat/" class="link-inverted text-bold">\n'+s(t.gettext.call(e,"Go to %(channelChat)s.",{name:"gettext",hash:{channelChat:"Channel Chat"},data:i}))+"\n</a>\n</p>\n<p>\n"+s(t.gettext.call(e,"Not ready to create your own channel but want to be involved in channels?",{name:"gettext",hash:{},data:i}))+'\n<a href="https://disqusinquiry.wufoo.com/forms/disqus-channel-moderator-application/"\nclass="link-inverted text-bold">'+s(t.gettext.call(e,"Apply to be a moderator.",{name:"gettext",hash:{},data:i}))+'</a>\n</p>\n</div>\n\n</div>\n</div>\n<section class="layout__content spacing-bottom-small">\n';return a=t.unless.call(e,null!=e?e.sessionUserVerified:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='<div data-role="channel-create-form"></div>\n</section>\n</div>\n<aside class="layout__aside">\n<div class="card-wrap">\n<div class="card__header -default">\n<h3 class="text-gray-darker">\n'+s(t.gettext.call(e,"%(channel)s Rules",{name:"gettext",hash:{channel:"Channel"},data:i}))+'\n</h3>\n</div>\n<div class="text-medium text-gray-darker card__body spacing-inner rules__wrapper -channel">\n',a=this.invokePartial(n.channelRules,"","channelRules",e,void 0,t,n,i),null!=a&&(o+=a),o+='</div>\n</div>\n<div class="text-smaller text-gray hidden-md">\n',a=this.invokePartial(n.homeFooter,"","homeFooter",e,void 0,t,n,i),null!=a&&(o+=a),o+"</div>\n</aside>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/templates/channelCreateInstructions",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="create-modal__header text-center">\n<h1 class="text-larger">'+a(t.gettext.call(e,"Creating a Channel: The Low-Down",{name:"gettext",hash:{},data:i}))+'</h1>\n<p class="spacing-narrow text-gray-dark">'+a(t.gettext.call(e,"Things you should know before diving in",{name:"gettext",hash:{},data:i}))+'</p>\n</div>\n<div class="create-modal">\n<div class="create-modal__media">\n<img src="'+a(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/Pam_CreateChannel.png" class="create-modal__img img-responsive" width="300" />\n</div>\n<div class="create-modal__body text-gray-dark">\n<p class="spacing-bottom">\n'+a(t.gettext.call(e,"A channel is a place for anyone to start a discussion around certain topics like %(food)s or %(movies)s. It's your own little corner of the internet.",{name:"gettext",hash:{movies:t.tag.call(e,"a",{name:"tag",hash:{target:"_blank",href:"/home/channel/plotthreads/",text:t.gettext.call(e,"movies",{name:"gettext",hash:{},data:i})},data:i}),food:t.tag.call(e,"a",{name:"tag",hash:{target:"_blank",href:"/home/channel/hashbrownparty/",text:t.gettext.call(e,"food",{name:"gettext",hash:{},data:i})},data:i})},data:i}))+'\n<a href="/home/channels/explore/" target="_blank">'+a(t.gettext.call(e,"See all channels.",{name:"gettext",hash:{},data:i}))+'</a>\n</p>\n<p class="spacing-bottom">\n'+a(t.gettext.call(e,"A channel thrives based on how much its creator and mods put into them. Make sure you start discussions that others will want to join. It'll be worth it.",{name:"gettext",hash:{},data:i}))+'\n</p>\n<p class="spacing-bottom">\n'+a(t.gettext.call(e,"Most importantly: a channel should be fun. It's a place to connect with other like-minded people. Always remember that.",{name:"gettext",hash:{},data:i}))+'\n</p>\n</div>\n</div>\n<p class="spacing-default text-center">\n<button class="button button-inverted button-inverted-fill button-semi-wide text-large" data-dismiss="modal">\n'+a(t.gettext.call(e,"Got it! Let's create a channel.",{name:"gettext",hash:{},data:i}))+'\n</button>\n</p>\n<p class="spacing-default text-center">\n<a href="/home/" class="link-gray text-small" data-dismiss="modal" data-action="navigate-back">\n'+a(t.gettext.call(e,"Nevermind",{name:"gettext",hash:{},data:i}))+"\n</a>\n</p>\n"},useData:!0})}),define("home/views/ChannelCreateInstructionsView",["underscore","backbone-marionette","home/mixins/asModal","home/templates/channelCreateInstructions"],function(e,t,n,i){var a=t.ItemView.extend({template:i,events:{"click [data-action=navigate-back]":"navigateBack"},navigateBack:function(){window.history.back()}});return n.call(a.prototype,{keyboard:!1,backdrop:"static"}),a}),define("home/views/ChannelCreateView",["underscore","backbone-marionette","core/strings","core/UniqueModel","core/mixins/withEmailVerifyLink","home/mixins/withSubviews","home/models/Channel","home/templates/channelCreate","home/templates/channelCreateError","home/utils/confirmModal","home/utils/navigationUtils","home/views/ChannelCreateFormView","home/views/ChannelCreateInstructionsView"],function(e,t,n,i,a,s,o,r,l,c,d,u,h){var m=n.get,p=e.chain(o.BANNER_COLORS).keys().map(function(e){return"-"+e}).value().join(" "),f=t.ItemView.extend({template:r,templateHelpers:function(){return{sessionUserVerified:this.session.user.get("isVerified")}},regions:{channelCreateFormRegion:"[data-role=channel-create-form]"},ui:{channelName:"[data-role=channel-name]",bannerWrapper:"[data-role=banner]"},initialize:function(e){this.session=e.session,this.listenToOnce(this,"show",this.showChannelCreateInstructionsModal),this.listenTo(this.model,"change:name",this.updateChannelName),this.listenTo(this.model,"change:bannerColor",this.updateBannerColor)},onRender:function(){this.activateRegion(this.channelCreateFormRegion,this.createChannelFormView)},updateChannelName:function(){var e=this.model.get("name").trim();this.ui.channelName.text(e.length>0?e:m("Your Channel Name"))},updateBannerColor:function(){this.ui.bannerWrapper.removeClass(p).addClass("-"+this.model.get("bannerColor"))},createChannelFormView:function(){var e=new u({model:this.model,session:this.session});
return this.listenTo(e,"created",function(e){d.navigate("/home/channel/"+e.id+"/",{trigger:!0,replace:!0})}),e},showChannelCreateInstructionsModal:function(){var e=new h({modal:{type:c.TYPES.CLOSE_LIGHT}});e.render().showModal()}});return a.call(f.prototype),s.call(f.prototype),f}),define("home/models/ActivityFeed",["underscore","home/models/Feed","home/collections/FeedItemCollection"],function(e,t,n){var i=t.extend({initialize:function(i,a){t.prototype.initialize.call(this,i,e.extend({collectionClass:n},a))}});return i}),define("home/collections/CuratedCollection",["underscore","backbone","home/collections/FeedItemCollection"],function(e,t,n){var i=n.extend({comparator:function(e){return-1*e.get("score")},initialize:function(e,t){n.prototype.initialize.call(this,e,t),this.listenTo(this,"change:score",this.updateActivityIndex),this.activityFunctions=t.activityFunctions},updateActivityIndex:function(t){this.remove(t);var n=e.sortedIndex(this.models,t,this.comparator);this.add(t,{at:n})},getNaturalIndex:function(t){return e.sortedIndex(this.map(this.comparator),-1*t.get("naturalScore"))},calculateBoostScore:function(e,t){var n=0===e?2*this.first().get("score"):this.at(e-1).get("score"),i=e===this.length?.5*this.last().get("score"):this.at(e).get("score");return t>=i&&n>=t?t:(n+i)/2},boost:function(e,t){var n=e.get("naturalScore"),i=this.calculateBoostScore(t,n);n>i&&(i=n),i>n?this.activityFunctions.boost.call(e,i):e.get("boostedScore")&&this.activityFunctions.unboost.call(e)}});return i}),define("home/models/CuratedFeedProfile",["underscore","backbone","core/api","core/UniqueModel","home/models/ActivityFeed","home/models/ActivityFeedItem","home/models/Feed","home/collections/CuratedCollection","home/models/Channel"],function(e,t,n,i,a,s,o,r,l){var c=t.Model.extend({initialize:function(t,i){var c,d;this.get("channel")&&(this.initializeRelated("channel",i,l),c="timelines/ranked?type=source&target=channel:"+this.channel.id,d="timelines/ranked?type=curated&target=channel:"+this.channel.id,this.activityFunctions={boost:e.partial(s.prototype.boostInChannel,this.channel.id),unboost:e.partial(s.prototype.unboostInChannel,this.channel.id)}),this.suggestions=new a({},{collectionUrl:n.getURL(c)}),this.curated=new o({},{collectionClass:r,collectionUrl:n.getURL(d),collectionOptions:{activityFunctions:this.activityFunctions}})},ensureFetched:function(){this.channel&&this.channel.shouldFetch()&&this.channel.fetch(),this.suggestions.get("fetched")||this.suggestions.ensureFetched(),this.curated.get("fetched")||this.curated.ensureFetched()},url:function(e){return n.getURL("timelines/curation/"+this.urls[e])},urls:{dismiss:"hideThreadFromChannel",share:"shareThreadToChannel"},sync:function(n,i,a){return a=a||{},a.url=i.url(n),a.type="POST",a.processData=!0,a.emulateHTTP=!0,a.data=e.defaults({channel:i.channel.id},a.data),t.sync(n,i,a)},refreshFeeds:function(){this.refreshFeed("source",this.suggestions),this.refreshFeed("curated",this.curated)},refreshFeed:function(e,i){t.ajax({url:n.getURL("timelines/rank"),type:"GET",data:{target:"channel:"+this.channel.id,type:e}}).then(function(){i.fetchItems.call(i,{reset:!0})})},dismiss:function(e,t){t.remove(e),e.get("boostedScore")&&this.activityFunctions.unboost.call(e),this.sync("dismiss",this,{data:{thread:e.thread.id}})},shareByThreadId:function(e){var t=this.suggestions.items.find(function(t){return t.thread.id===e});return t?void this.share(t):this.sync("share",this,{data:{thread:e}})},share:function(e){this.suggestions.items.remove(e),this.curated.items.add(e),this.sync("share",this,{data:{thread:e.thread.id}})},boost:function(e,t){this.curated.items.boost(e,t)},updateBoostTime:function(e,t){this.activityFunctions.boost.call(e,e.get("score"),t)},unboost:function(e){e.get("boostedScore")&&this.activityFunctions.unboost.call(e)}},{buildId:function(e){return e.channel?"channel:"+e.channel.id:void 0}});return i.addType("CuratedFeedProfile",c),c}),define("home/templates/curatedCard",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" no-image"},3:function(e,t,n,i){var a,s="";return a=this.invokePartial(n.boostTimeRemaining,"","boostTimeRemaining",e,void 0,t,n,i),null!=a&&(s+=a),s},5:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="card-selected-post">\n<h3 class="text-subheading">'+s(t.gettext.call(e,"Selected Comment",{name:"gettext",hash:{},data:i}))+'</h3>\n<section data-role="selected-post"></section>\n';return a=t["if"].call(e,null!=e?e.showCurationDetails:e,{name:"if",hash:{},fn:this.program(6,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+"</div>\n"},6:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda;return'<h3 class="text-subheading">'+s(t.gettext.call(e,"Excerpt",{name:"gettext",hash:{},data:i}))+'</h3>\n<div class="selected-post-excerpt">\n<textarea data-role="excerpt-textarea" class="input--textbox">'+s(o(null!=(a=null!=e?e.selectedPost:e)?a.excerpt:a,e))+'</textarea>\n</div>\n<button class="button button-outline -small" data-action="remove-post">\n'+s(t.gettext.call(e,"Remove",{name:"gettext",hash:{},data:i}))+"\n</button>\n"},8:function(e,t,n,i){var a=this.escapeExpression;return'<button class="button button-outline -small" data-action="dismiss">\n'+a(t.gettext.call(e,"Dismiss",{name:"gettext",hash:{},data:i}))+"\n</button>\n"},10:function(e,t,n,i){var a=this.escapeExpression;return'<button class="button button-outline -small" data-action="configure-curation">\n'+a(t.gettext.call(e,"Configure",{name:"gettext",hash:{},data:i}))+"\n</button>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.lambda,o='<div class="overlay"></div>\n<div class="card-discussion';return a=t.unless.call(e,null!=e?e.image:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='">\n<div class="curated-settings" data-role="boost-message">\n',a=t["if"].call(e,null!=e?e.boostedScore:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='</div>\n<div class="media curate-body">\n<div class="card-aside pull-right">\n',a=this.invokePartial(n.threadImage,"","threadImage",e,void 0,t,n,i),null!=a&&(o+=a),o+='</div>\n<div class="card-body media-body">\n<section data-role="author-avatar"></section>\n<span class="text-small">\n<section data-role="author-link"></section>\n</span>\n\n<div class="card-content__topics">\n<div data-role="topics"></div>\n</div>\n\n',a=this.invokePartial(n.threadTitle,"","threadTitle",e,void 0,t,n,i),null!=a&&(o+=a),o+='\n<div class="card-summary">\n<div class="card-summary-content truncate" data-truncate-lines="3">\n',a=s(null!=e?e.threadDescription:e,e),null!=a&&(o+=a),o+="\n</div>\n</div>\n",a=t["if"].call(e,null!=e?e.selectedPost:e,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='</div>\n<div class="media">\n<div class="curate-actions pull-right">\n',a=t["if"].call(e,null!=e?e.showDismiss:e,{name:"if",hash:{},fn:this.program(8,i),inverse:this.noop,data:i}),null!=a&&(o+=a),a=t["if"].call(e,null!=e?e.showSettings:e,{name:"if",hash:{},fn:this.program(10,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+'</div>\n<footer class="card-footer media-body" data-role="footer"></footer>\n</div>\n</div>\n</div>\n'},usePartial:!0,useData:!0})}),define("home/views/CuratedCardView",["handlebars","underscore","backbone-marionette","home/utils/navigationUtils","home/mixins/asGenericCard","home/templates/curatedCard","home/views/TopicTagCollectionView","home/views/ChannelCardPostView"],function(e,t,n,i,a,s,o,r){var l=n.ItemView,c=l.extend({template:s,templateHelpers:function(){var e=this.model.getSelectedPost();return{showUnboost:this.model.get("fixedUntil")&&this.supportsUnboost,showDismiss:this.supportsDimiss,showSettings:this.supportsSettings,boostTimeRemaining:this.model.getRelativeBoostTimeRemaining(),showBoostTimeSelector:!this.model.get("fixedUntil"),selectedPost:e?e.toJSON():null,showCurationDetails:this.showCurationDetails}},regions:{selectedPostRegion:"[data-role=selected-post]",topicsRegion:"[data-role=topics]"},events:{mouseover:"onHover",mouseout:"onHoverEnd","click [data-action=configure-curation]":"goToConfigurationPageForActivityItem","click [data-action=dismiss]":"dismiss","click [data-action=unboost]":"unboost","click [data-action=choose-boost-time]":"chooseBoostTime","click [data-action=remove-post]":"removePost"},modelEvents:{"change:boostedScore":"renderBoostTimeRemaining","change:fixedUntil":"renderBoostTimeRemaining"},initialize:function(e){e=e||{};var n=e.supportedActions||[];this.supportsUnboost=t.contains(n,"unboost"),this.supportsDimiss=t.contains(n,"dismiss"),this.supportsSettings=t.contains(n,"settings"),this.showTopics=this.model.thread.topics.length,this.showCurationDetails=e.showCurationDetails,this.channel=e.channel},onClose:function(){this.interval&&window.clearInterval(this.interval)},goToConfigurationPageForActivityItem:function(){var e=this.model.collection.indexOf(this.model);i.navigate(window.location.pathname+e+"/",{trigger:!0})},onHover:function(){this.$el.addClass("hovered")},onHoverEnd:function(){this.$el.removeClass("hovered")},onRender:function(){this.handleBoostTimeRemainingUpdates(),this.renderAuthor(),this.model.getSelectedPost()&&this.activateRegion(this.selectedPostRegion,this.createSelectedPostPreview),this.showTopics&&this.activateRegion(this.topicsRegion,this.createTopicsView)},createTopicsView:function(){var e=this.model.thread.topics,t=this.channel;return new o({collection:e,channel:t})},renderAuthor:function(){this.model.thread.author?(this.$("[data-role=author-avatar]").replaceWith(e.partials.userAvatar(this.model.thread.author.toJSON())),this.$("[data-role=author-link]").replaceWith(e.partials.userName(this.model.thread.author.toJSON()))):(this.$("[data-role=author-avatar]").replaceWith(e.partials.forumAvatarLink(this.model.thread.forum.toJSON())),this.$("[data-role=author-link]").replaceWith(e.partials.forumLink(this.model.thread.forum.toJSON())))},createSelectedPostPreview:function(){var e=this.model.getSelectedPost();return new r({model:e})},handleBoostTimeRemainingUpdates:function(){this.interval&&window.clearInterval(this.interval),this.model.get("boostedScore")&&(this.interval=window.setInterval(t.bind(this.renderBoostTimeRemaining,this),6e4),this.renderBoostTimeRemaining())},chooseBoostTime:function(){this.$("[data-role=boost-message]").html(e.partials.boostTimeRemaining(t.extend(this.templateHelpers(),{showBoostTimeSelector:!0}))),this.handleSelectBoostTime()},renderBoostTimeRemaining:function(){var t=this.$("[data-role=boost-message]");this.model.get("boostedScore")?(t.html(e.partials.boostTimeRemaining(this.templateHelpers())),this.handleSelectBoostTime()):t.empty()},handleSelectBoostTime:function(){var e=this.$("select[name=time]");if(e.length){var t=this,n=function(){var n=parseInt(e.val(),10);t.trigger("updateBoostTime",1e3*n),e.attr({size:0}).removeClass("open")};e.attr({size:5}).addClass("open").change(n)}},removePost:function(){var e=this;this.model.shareThreadToChannel(this.channel.id,null).then(function(){e.model.setSelectedPost(null)},function(e){window.alert(e.responseJSON.response||e.statusText)}).always(function(){e.render()})},dismiss:function(){this.trigger("dismiss")},unboost:function(){this.trigger("unboost")}});return a.call(c.prototype),c}),define("home/templates/curatedPostCard",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="card-curated-post">\n<div class="card-discussion-comments" data-role="post"></div>\n<div class="media">\n<div class="curate-actions pull-right">\n<button class="button button-outline -small" data-action="feature-post">\n'+a(t.gettext.call(e,"Select Comment",{name:"gettext",hash:{},data:i}))+"\n</button>\n</div>\n</div>\n</div>\n"},useData:!0})}),define("home/views/CuratedPostCardView",["handlebars","underscore","backbone-marionette","home/utils/confirmModal","home/utils/navigationUtils","home/utils/datetimeUtils","home/mixins/withSubviews","home/templates/curatedPostCard","home/views/PostView"],function(e,t,n,i,a,s,o,r,l){var c=n.ItemView,d=c.extend({className:"card card-generic",template:r,regions:{postRegion:"[data-role=post]"},events:{mouseover:"onHover",mouseout:"onHoverEnd","click [data-action=feature-post]":"featurePost"},onHover:function(){this.$el.addClass("hovered")},onHoverEnd:function(){this.$el.removeClass("hovered")},featurePost:function(){var e=this.getPost();this.trigger("updateSelectedPostFromView",e)},getPost:function(){return this.model},onRender:function(){this.activateRegion(this.postRegion,this.createPostView)},createPostView:function(){return new l({model:this.getPost(),hideActions:!1})}});return o.call(d.prototype),d}),define("home/views/CuratedPostCollectionView",["home/views/common/FetchableCollectionView","home/views/CuratedPostCardView"],function(e,t){var n=e.extend({itemView:t});return n}),define("home/templates/curatedPostsFooter",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="feed-end" data-role="end-message">\n'+a(t.gettext.call(e,"No more comments on this discussion.",{name:"gettext",hash:{},data:i}))+"\n</div>\n"},useData:!0})}),define("home/views/CuratedPostFooterView",["home/views/common/FetchableCollectionFooterView","home/templates/curatedPostsFooter"],function(e,t){var n=e.extend({endOfItemsTemplate:t});return n}),define("home/templates/curateActivity",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda;return'<div class="section-contained">\n<div class="header">\n<div class="preview" data-role="preview"></div>\n<div class="card card-generic">\n<h2>'+s(t.gettext.call(e,"Discussion Overrides",{name:"gettext",hash:{},data:i}))+'</h2>\n<span class="text-subtitle">\n'+s(t.gettext.call(e,"Overrides allow for changing how the discussion is presented only for this channel.",{name:"gettext",hash:{},data:i}))+'\n</span>\n<div class="spacing-bottom spacing-top">\n<h3 class="text-subheading">'+s(t.gettext.call(e,"Curated Title",{name:"gettext",hash:{},data:i}))+'</h3>\n<input type="text" class="input--textbox" data-role="title-override" class="thread-override"\nvalue="'+s(o(null!=(a=null!=e?e.threadOverrides:e)?a.title:a,e))+'" placeholder="'+s(t.gettext.call(e,"Enter an alternate title",{name:"gettext",hash:{},data:i}))+'">\n</div>\n<div class="spacing-bottom">\n<h3 class="text-subheading">'+s(t.gettext.call(e,"Curated Image",{name:"gettext",hash:{},data:i}))+'</h3>\n<input type="text" class="input--textbox" data-role="image-override" class="thread-override"\nvalue="'+s(o(null!=(a=null!=e?e.threadOverrides:e)?a.imageUrl:a,e))+'" placeholder="'+s(t.gettext.call(e,"Enter an alternate image URL",{name:"gettext",hash:{},data:i}))+'">\n</div>\n<div class="spacing-bottom">\n<h3 class="text-subheading">'+s(t.gettext.call(e,"Curated Description",{name:"gettext",hash:{},data:i}))+'</h3>\n<input type="text" class="input--textbox" data-role="excerpt-override" class="thread-override"\nvalue="'+s(o(null!=(a=null!=e?e.threadOverrides:e)?a.excerpt:a,e))+'" placeholder="'+s(t.gettext.call(e,"Enter an alternate description",{name:"gettext",hash:{},data:i}))+'">\n</div>\n</div>\n<div class="card card-generic">\n<h2>'+s(t.gettext.call(e,"Discussion topics",{name:"gettext",hash:{},data:i}))+'</h2>\n<span class="text-subtitle">\n'+s(t.gettext.call(e,"These topics are global and can't be different for each channel.",{name:"gettext",hash:{},data:i}))+'\n</span>\n<div class="spacing-bottom form-attribute-input" data-attribute="topics" data-role="topic-input"></div>\n</div>\n<div class="card card-generic card-share-actions">\n<button class="button button-inverted-fill -small" data-action="save">'+s(t.gettext.call(e,"Update",{name:"gettext",hash:{},data:i}))+'</button>\n<a class="button -small" href="/home/curate/channel/'+s(o(null!=e?e.channelId:e,e))+'/">'+s(t.gettext.call(e,"Back",{name:"gettext",hash:{},data:i}))+'</a>\n</div>\n</div>\n<div class="card card-generic">\n<h2>'+s(t.gettext.call(e,"Comments",{name:"gettext",hash:{},data:i}))+'</h2>\n<input type="text" data-role="post-id-input" placeholder="'+s(t.gettext.call(e,"Add by comment ID",{name:"gettext",hash:{},data:i}))+'">\n<button class="btn" data-action="lookup">'+s(t.gettext.call(e,"Lookup",{name:"gettext",hash:{},data:i}))+'</button>\n<ul class="nav-list">\n<li class="nav-list__item active" data-action="switch-tab" data-tab="desc">\n<a class="nav-list__lnk" href="#">\n<strong>'+s(t.gettext.call(e,"Newest",{name:"gettext",hash:{},data:i}))+'</strong>\n</a>\n</li>\n<li class="nav-list__item" data-action="switch-tab" data-tab="asc">\n<a class="nav-list__lnk" href="#">\n<strong>'+s(t.gettext.call(e,"Oldest",{name:"gettext",hash:{},data:i}))+'</strong>\n</a>\n</li>\n</ul>\n</div>\n</div>\n<div class="section-contained feed-content" data-role="content-area"></div>\n'},useData:!0})}),define("home/views/CurateActivityView",["underscore","backbone-marionette","core/strings","core/api","home/models/Post","home/models/CuratedFeedProfile","core/UniqueModel","home/collections/TopicCollection","home/views/common/FetchableCollectionLayout","home/views/common/TabbedView","home/views/CuratedCardView","home/views/CuratedPostCollectionView","home/views/CuratedPostFooterView","home/views/TopicInputView","home/templates/curateActivity"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p){var f=n.get,g=c.extend({defaultTab:"desc",template:p,templateHelpers:function(){return{channelId:this.getChannelId(),threadOverrides:this.model.getThreadOverrides()}},regions:e.defaults({previewRegion:"[data-role=preview]",topicInputRegion:"[data-role=topic-input]"},c.prototype.regions),events:e.defaults({"click [data-action=save]":"handleUpdateSelectedPost","click [data-action=lookup]":"lookupPostById"},c.prototype.events),initialize:function(e){c.prototype.initialize.apply(this,arguments),this.channel=e.channel,this.topics=new r(this.model.thread.topics.models,{thread:this.model.thread}),this.listenTo(this.topics,"invalid",this.handleTopicError)},onDomRefresh:function(){c.prototype.onDomRefresh.call(this),this.showTopicInputView(),this.showCuratedCardPreview()},showTopicInputView:function(){this.topicInputRegion.show(new m({collection:this.topics}))},showCuratedCardPreview:function(){this.previewRegion.show(new d({model:this.model,channel:this.channel,showCurationDetails:!0}))},getTabView:function(e){var t=new l({model:this.model.getPosts()[e],collection:this.model.getPosts()[e].items,fetchableCollectionView:u,fetchableCollectionFooterView:h,infiniteScroll:!0});return this.bindPostCardActionListeners(t,{updateSelectedPostFromView:this.updateSelectedPostFromView}),t},bindPostCardActionListeners:function(t,n){var i=this;e.each(n,function(e,n){this.listenTo(t,"collectionview:itemview:"+n,function(){e.apply(i,Array.prototype.slice.call(arguments,1))})},this)},getChannelId:function(){return this.channel?this.channel.id:""},lockSharing:function(){if(!this._shareLocked){this._shareLocked=!0;var e=this.$("[data-action=save]");this.existingButtonText=e.text(),e.text(f("Updating...")).addClass("btn-disabled"),this.$("input.thread-override").prop("disabled",!0)}},unlockSharing:function(){if(this._shareLocked){this._shareLocked=!1;var e=this.$("[data-action=save]");e.text(this.existingButtonText).removeClass("btn-disabled"),this.$("input.thread-override").prop("disabled",!1)}},handleUpdateSelectedPost:function(){this.shareThreadToChannel(),this.topics.save()},handleTopicError:function(e){window.alert(e&&e.validationError&&e.validationError.message)},shareThreadToChannel:function(e,t){if(!this._shareLocked){var n=this.getChannelId();if(n){this.lockSharing();var i=e||this.model.getSelectedPost(),a=this.getSelectedPostExcerpt(i,t),s={title:this.$("input[data-role=title-override]").val()||null,excerpt:this.$("input[data-role=excerpt-override]").val()||null,imageUrl:this.$("input[data-role=image-override]").val()||null},o=this;this.model.shareThreadToChannel(n,i,a,s).then(function(){i&&(i.set({excerpt:a}),o.model.setSelectedPost(i)),o.model.setThreadOverrides(s)},function(e){window.alert(e.responseJSON.response||e.statusText)}).always(function(){o.unlockSharing(),o.showCuratedCardPreview()})}}},lookupPostById:function(){var e=this.$("[data-role=post-id-input]").val().match(/(#comment-)?(\d+)$/),t=e&&e[e.length-1];if(t){var n=o.get(a,t);if(n)this.updateSelectedPost(n);else{var i=this;this.requestPostById(t).then(function(e){n=new o(a,e.response),i.updateSelectedPost(n)},function(e){window.alert(e.responseJSON.response)})}}else window.alert(f("Comment ID must be a number or a direct comment link."))},requestPostById:function(e){return i.call("posts/details",{type:"GET",data:{post:e}})},getSelectedPostExcerpt:function(e,t){if(!e)return null;var n,i=this.$("[data-role=excerpt-textarea]").val();return n=t?t:i?i:e.get("raw_message")},updateSelectedPostFromView:function(e){this.updateSelectedPost(e.model)},updateSelectedPost:function(e){return e.thread.get("id")!==this.model.getThread().id?void window.alert(f("You've selected a comment that doesn't belong to this thread.")):void this.shareThreadToChannel(e,e.get("raw_message"))}});return g}),define("home/models/SettingsApp",["underscore","backbone","core/config","core/utils/cookies","home/models/common/BaseSettings"],function(e,t,n,i,a){var s=a.extend({url:function(){return n.urls.apiSettings+"apps/"+this.id+"/"},toJSON:function(){return{id:this.get("id"),name:this.get("name")}}});return s}),define("home/collections/SettingsAppCollection",["backbone","core/api","core/config","home/models/SettingsApp"],function(e,t,n,i){var a=e.Collection.extend({url:n.urls.apiSettings+"apps/",model:i});return a}),define("home/models/SettingsModeration",["underscore","backbone","core/config","core/utils/cookies","home/models/common/BaseSettings","core/UniqueModel"],function(e,t,n,i,a,s){var o=a.extend({url:n.urls.apiSettings+"moderation/",toJSON:function(){return{disable_approved:this.get("disable_approved"),receive_unapproved:this.get("receive_unapproved"),receive_spam:this.get("receive_spam"),forum_subscriptions:this.get("forum_subscriptions")}}});return s.addType("SettingsModeration",o),o}),define("home/models/SettingsProfile",["underscore","backbone","core/config","core/utils/cookies","home/models/common/BaseSettings","home/models/User","core/UniqueModel"],function(e,t,n,i,a,s,o){var r=a.extend({url:n.urls.apiSettings+"profile/",useMultiPartForm:!0,initialize:function(){var e={};e[s.prototype.idAttribute]=this.id,this.user=new o(s,e),this.listenTo(this,"change",this.updateUser)},save:function(t,n){return t||(t=e.pick(this.attributes,["display_name","about","location","url","is_private","avatar_file","avatar_source","avatar_facebook","avatar_twitter"])),a.prototype.save.call(this,t,n)},updateUser:function(){var t=e.defaults({cache:this.get("avatar_cache"),permalink:this.get("avatar_permalink"),isCustom:!/noavatar/.test(this.get("avatar_cache"))},this.user.get("avatar"));this.user.set({about:this.get("about"),avatar:t,name:this.get("display_name"),isPrivate:this.get("is_private"),location:this.get("location"),url:this.get("url")})}});return o.addType("SettingsProfile",r),r}),define("home/models/SettingsEmailNotifications",["underscore","backbone","core/config","core/utils/cookies","home/models/common/BaseSettings","core/UniqueModel"],function(e,t,n,i,a,s){var o=a.extend({url:n.urls.apiSettings+"email/",toJSON:function(){return{receive_notifications:this.get("receive_notifications"),subscribe_thread_on_post:this.get("subscribe_thread_on_post"),replies_to_comments:this.get("replies_to_comments"),digest_frequency:this.get("digest_frequency")}}},{FREQUENCY_NEVER:"never"});return s.addType("SettingsEmailNotifications",o),o}),define("home/templates/settingsDelete",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<form class="form">\n<div class="form__header--mobile visible-md">\n<a href="/home/settings/" class="form__header--mobile-back"><span class="icon-left-bracket"></span></a>\n<h2>'+a(t.gettext.call(e,"Confirm Account Deletion",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<div class="form__header">\n<h1 class="form-heading">'+a(t.gettext.call(e,"Confirm Account Deletion",{name:"gettext",hash:{},data:i}))+'</h1>\n<p class="form-description text-gray text-medium">'+a(t.gettext.call(e,"Doing this will delete any registered sites under this account and the comments contained within them. Comments made by this account on other sites with replies will only be anonymized in order to maintain the context of their discussions. Are you sure?",{name:"gettext",hash:{},data:i}))+'</p>\n</div>\n<div class="form__content">\n<div class="fieldset" role="group" data-role="notification">\n<div class="fieldset__label align__item text-gray">\n'+a(t.gettext.call(e,"Let us know why you're leaving (required)",{name:"gettext",hash:{},data:i}))+'\n</div>\n<div class="fieldset__block align__item">\n<div class="fieldset__block--radio">\n<input type="radio" name="delete_reason" value="1" id="settings-delete-reason-1">\n<label for="settings-delete-reason-1" class="text-medium">\n'+a(t.gettext.call(e,"I can't get %(Disqus)s to work on my site.",{name:"gettext",hash:{Disqus:"Disqus"},data:i}))+'\n</label>\n</div>\n<p class="fieldset__description -radio text-gray text-small hidden" data-role="delete-resolution">\n'+a(t.gettext.call(e,"The best place to start is our %(knowledgeBase)s. If you are still having issues shoot us an email at %(helpEmail)s and we'll get you taken care of.",{name:"gettext",hash:{helpEmail:t.tag.call(e,"a",{name:"tag",hash:{text:"help@disqus.com",href:"mailto:help@disqus.com"},data:i}),knowledgeBase:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"Knowledge Base",{name:"gettext",hash:{},data:i}),target:"_blank",href:"https://help.disqus.com"},data:i})},data:i}))+'\n</p>\n<div class="fieldset__block--radio">\n<input type="radio" name="delete_reason" value="2" id="settings-delete-reason-2">\n<label for="settings-delete-reason-2" class="text-medium">\n'+a(t.gettext.call(e,"I receive too many emails notifications.",{name:"gettext",hash:{},data:i}))+'\n</label>\n</div>\n<p class="fieldset__description -radio text-gray text-small hidden" data-role="delete-resolution">\n'+a(t.gettext.call(e,"To help suppress the amount of email notifications you're receiving, you can change your options here: %(emailNotifications)s.",{name:"gettext",hash:{emailNotifications:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"Settings &gt; Email Notifications",{name:"gettext",hash:{},data:i}),href:"https://disqus.com/home/settings/email/"},data:i})},data:i}))+'\n</p>\n<div class="fieldset__block--radio">\n<input type="radio" name="delete_reason" value="3" id="settings-delete-reason-3">\n<label for="settings-delete-reason-3" class="text-medium">\n'+a(t.gettext.call(e,"I spend too much time using %(Disqus)s.",{name:"gettext",hash:{Disqus:"Disqus"},data:i}))+'\n</label>\n</div>\n<p class="fieldset__description -radio text-gray text-small hidden" data-role="delete-resolution">\n'+a(t.gettext.call(e,"One way to control your interaction with %(Disqus)s is to limit the number of emails you receive from us at %(emailNotifications)s.",{name:"gettext",hash:{emailNotifications:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"Settings &gt; Email Notifications",{name:"gettext",hash:{},data:i}),href:"https://disqus.com/home/settings/email/"},data:i}),Disqus:"Disqus"},data:i}))+'\n</p>\n<div class="fieldset__block--radio">\n<input type="radio" name="delete_reason" value="4" id="settings-delete-reason-4">\n<label for="settings-delete-reason-4" class="text-medium">\n'+a(t.gettext.call(e,"I don't find %(Disqus)s useful.",{name:"gettext",hash:{Disqus:"Disqus"},data:i}))+'\n</label>\n</div>\n<p class="fieldset__description -radio text-gray text-small hidden" data-role="delete-resolution">\n'+a(t.gettext.call(e,"You may find %(Disqus)s more useful by connecting with more of your friends.",{name:"gettext",hash:{Disqus:"Disqus"},data:i}))+"\n"+a(t.gettext.call(e,"You can add more of your friends here %(followLink)s or by learning about all our features: %(aboutLink)s",{name:"gettext",hash:{aboutLink:t.tag.call(e,"a",{name:"tag",hash:{text:"https://disqus.com/about/",href:"https://disqus.com/about/"},data:i}),followLink:t.tag.call(e,"a",{name:"tag",hash:{text:"https://disqus.com/follow/",href:"https://disqus.com/follow/"},data:i})},data:i}))+'\n</p>\n<div class="fieldset__block--radio">\n<input type="radio" name="delete_reason" value="5" id="settings-delete-reason-5">\n<label for="settings-delete-reason-5" class="text-medium">\n'+a(t.gettext.call(e,"I can't change my name.",{name:"gettext",hash:{},data:i}))+'\n</label>\n</div>\n<p class="fieldset__description -radio text-gray text-small hidden" data-role="delete-resolution">\n'+a(t.gettext.call(e,"You can change your display name by going to your %(profileSettings)s",{name:"gettext",hash:{profileSettings:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"Profile settings",{name:"gettext",hash:{},data:i}),href:"https://disqus.com/home/settings/profile/"},data:i})},data:i}))+'\n</p>\n<div class="fieldset__block--radio">\n<input type="radio" name="delete_reason" value="6" id="settings-delete-reason-6">\n<label for="settings-delete-reason-6" class="text-medium">\n'+a(t.gettext.call(e,"Other",{name:"gettext",hash:{},data:i}))+'\n</label>\n</div>\n<p class="fieldset__description -radio fieldset text-gray text-small hidden" data-role="delete-resolution">\n'+a(t.gettext.call(e,"Could you explain it further?",{name:"gettext",hash:{},data:i}))+'\n<br>\n<textarea class="input--textbox" id="delete-other" name="delete_other"></textarea>\n</p>\n<p class="fieldset__description text-gray text-small">\n'+a(t.gettext.call(e,"Please note that it may take up to 24 hours for your account to be removed from the system.",{name:"gettext",hash:{},data:i}))+'\n</p>\n<p class="fieldset__description fieldset__description--error text-small" data-role="error-alert"></p>\n</div>\n</div>\n</div>\n<div class="form__footer">\n<div class="fieldset" role="group">\n<div class="fieldset__label" data-role="save-status"><div class="spinner-small"></div><div class="icon-checkmark"></div></div>\n<div class="fieldset__block"><input type="submit" class="button button-inverted button-inverted-fill text-medium" value="'+a(t.gettext.call(e,"Delete my account",{name:"gettext",hash:{},data:i}))+'"></div>\n</div>\n</div>\n</form>\n'},useData:!0})}),define("home/views/SettingsDeleteView",["jquery","backbone","backbone-marionette","underscore","core/config","core/strings","home/templates/settingsDelete","home/views/common/BaseSettingsView"],function(e,t,n,i,a,s,o,r){var l=s.get,c=r.extend({template:o,events:{"submit form":"handleDeleteAccount","change input[type=radio]":"handleReasonChange"},initialize:function(t){this.session=t.session,e(window).scrollTop(0)},handleReasonChange:function(t){t.preventDefault();var n=e(t.currentTarget);this.$("[data-role=delete-resolution]").addClass("hidden"),n.parent().next("[data-role=delete-resolution]").removeClass("hidden")},handleDeleteAccount:function(t){t.preventDefault();var n=l("This will delete your account permanently. Are you sure?");if(window.confirm(n)){this.updateStatus("is-saving");var a=e(t.originalEvent.target);this.deleteAccount(a.serialize()).done(i.bind(this.session.logout,this.session)).fail(i.bind(this.showError,this))}},showError:function(){this.$("[data-role=error-alert]").text(l("Please select a reason.")),this.updateStatus("")
},deleteAccount:function(t){return e.post(a.urls.userDelete,t,"json")}});return c}),define("home/templates/settingsProfile",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<option value="gravatar">'+a(t.gettext.call(e,"Gravatar",{name:"gettext",hash:{},data:i}))+"</option>\n"},3:function(e,t,n,i){var a=this.escapeExpression;return'<option value="twitter">'+a(t.gettext.call(e,"Twitter",{name:"gettext",hash:{},data:i}))+"</option>\n"},5:function(e,t,n,i){var a=this.escapeExpression;return'<option value="facebook">'+a(t.gettext.call(e,"Facebook",{name:"gettext",hash:{},data:i}))+"</option>\n"},7:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<input type="hidden" name="avatar_twitter" value="'+i(n(null!=(t=null!=(t=null!=e?e.remotes:e)?t.twitter:t)?t.avatar_url:t,e))+'">\n'},9:function(e){var t,n=this.lambda,i=this.escapeExpression;return'<input type="hidden" name="avatar_facebook"value="'+i(n(null!=(t=null!=(t=null!=e?e.remotes:e)?t.facebook:t)?t.username:t,e))+'">\n'},11:function(e,t,n,i){var a,s="";return a=t.each.call(e,null!=(a=null!=e?e.errors:e)?a.avatar_file:a,{name:"each",hash:{},fn:this.program(12,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},12:function(e){var t=this.lambda,n=this.escapeExpression;return'<p class="fieldset__description fieldset__description--error text-small">'+n(t(e,e))+"</p>\n"},14:function(){return"is-error"},16:function(e,t,n,i){var a,s="";return a=t.each.call(e,null!=(a=null!=e?e.errors:e)?a.display_name:a,{name:"each",hash:{},fn:this.program(12,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},18:function(e,t,n,i){var a,s="";return a=t.each.call(e,null!=(a=null!=e?e.errors:e)?a.about:a,{name:"each",hash:{},fn:this.program(12,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},20:function(e,t,n,i){var a,s="";return a=t.each.call(e,null!=(a=null!=e?e.errors:e)?a.url:a,{name:"each",hash:{},fn:this.program(12,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},22:function(e,t,n,i){var a,s="";return a=t.each.call(e,null!=(a=null!=e?e.errors:e)?a.location:a,{name:"each",hash:{},fn:this.program(12,i),inverse:this.noop,data:i}),null!=a&&(s+=a),s},24:function(){return"checked"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o=this.lambda,r='<form class="form">\n<div class="form__header--mobile visible-md">\n<a href="/home/settings/" class="form__header--mobile-back"><span class="icon-left-bracket"></span></a>\n<h2>'+s(t.gettext.call(e,"Profile",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<div class="form__header">\n<h1 class="form-heading hidden-md">'+s(t.gettext.call(e,"Profile",{name:"gettext",hash:{},data:i}))+'</h1>\n<p class="form-description text-gray text-medium">\n'+s(t.gettext.call(e,"Control your profile information, both what it says and what other people see. User profiles are shown across all Disqus sites. To understand what's acceptable to display on profiles, please see %(helpDoc)s.",{name:"gettext",hash:{helpDoc:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"these rules",{name:"gettext",hash:{},data:i}),target:"blank",href:"https://help.disqus.com/customer/portal/articles/1753105-basic-rules-for-disqus-powered-profiles-and-discussions"},data:i})},data:i}))+'\n</p>\n</div>\n<div class="form__content">\n<div class="fieldset" role="group">\n<div class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Avatar",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="fieldset__block align__item">\n<div class="fieldset__avatar align">\n<div class="fieldset__avatar--img align__item"><img src="'+s(o(null!=e?e.avatar_cache:e,e))+'" alt="profile image" data-role="avatar-img"></div>\n<div class="fieldset__avatar--options align__item">\n<select name="avatar_source">\n<option value="">'+s(t.gettext.call(e,"Choose a method",{name:"gettext",hash:{},data:i}))+'</option>\n<option value="computer">'+s(t.gettext.call(e,"Upload from computer",{name:"gettext",hash:{},data:i}))+'</option>\n<option value="default">'+s(t.gettext.call(e,"Default",{name:"gettext",hash:{},data:i}))+"</option>\n";return a=t["if"].call(e,null!=(a=null!=e?e.remotes:e)?a.gravatar:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t["if"].call(e,null!=(a=null!=e?e.remotes:e)?a.twitter:a,{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t["if"].call(e,null!=(a=null!=e?e.remotes:e)?a.facebook:a,{name:"if",hash:{},fn:this.program(5,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+="</select>\n",a=t["if"].call(e,null!=(a=null!=e?e.remotes:e)?a.twitter:a,{name:"if",hash:{},fn:this.program(7,i),inverse:this.noop,data:i}),null!=a&&(r+=a),a=t["if"].call(e,null!=(a=null!=e?e.remotes:e)?a.facebook:a,{name:"if",hash:{},fn:this.program(9,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<input type="file" name="avatar_file" data-role="avatar-file-upload" class="hidden">\n',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.avatar_file:a,{name:"if",hash:{},fn:this.program(11,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='</div>\n</div>\n</div>\n</div>\n<div class="fieldset" role="group">\n<label for="settings-name" class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Name",{name:"gettext",hash:{},data:i}))+'</label>\n<div class="fieldset__block align__item ',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.display_name:a,{name:"if",hash:{},fn:this.program(14,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="fieldset__block--text">\n<input type="text" id="settings-name" name="display_name" class="input--textbox" value="'+s(o(null!=e?e.display_name:e,e))+'">\n</div>\n',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.display_name:a,{name:"if",hash:{},fn:this.program(16,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<p class="fieldset__description text-gray text-small">\n'+s(t.gettext.call(e,"If blank, your username will be shown instead. To change your username, go to %(accountSettings)s.",{name:"gettext",hash:{accountSettings:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"Account",{name:"gettext",hash:{},data:i}),href:"/home/settings/account/"},data:i})},data:i}))+'\n</p>\n</div>\n</div>\n<div class="fieldset" role="group">\n<label for="settings-bio" class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Biography",{name:"gettext",hash:{},data:i}))+'</label>\n<div class="fieldset__block align__item ',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.about:a,{name:"if",hash:{},fn:this.program(14,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="fieldset__block--text">\n<input type="text" id="settings-bio" name="about" class="input--textbox" value="'+s(o(null!=e?e.about:e,e))+'">\n</div>\n',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.about:a,{name:"if",hash:{},fn:this.program(18,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<p class="fieldset__description text-gray text-small">\n'+s(t.gettext.call(e,"Describe yourself in a sentence or two. 200 characters max.",{name:"gettext",hash:{},data:i}))+'\n</p>\n</div>\n</div>\n<div class="fieldset" role="group">\n<label for="settings-website" class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Website",{name:"gettext",hash:{},data:i}))+'</label>\n<div class="fieldset__block align__item ',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.url:a,{name:"if",hash:{},fn:this.program(14,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="fieldset__block--text">\n<input type="text" id="settings-website" class="input--textbox" name="url" value="'+s(o(null!=e?e.url:e,e))+'">\n</div>\n',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.url:a,{name:"if",hash:{},fn:this.program(20,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<p class="fieldset__description text-gray text-small">\n'+s(t.gettext.call(e,"Link to your profile or website.",{name:"gettext",hash:{},data:i}))+'\n</p>\n</div>\n</div>\n<div class="fieldset" role="group">\n<div class="fieldset__label align__item text-gray"><label for="settings-location">'+s(t.gettext.call(e,"Location",{name:"gettext",hash:{},data:i}))+'</label></div>\n<div class="fieldset__block align__item ',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.location:a,{name:"if",hash:{},fn:this.program(14,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='">\n<div class="fieldset__block--text">\n<input type="text" id="settings-location" class="input--textbox" name="location" value="'+s(o(null!=e?e.location:e,e))+'">\n</div>\n',a=t["if"].call(e,null!=(a=null!=e?e.errors:e)?a.location:a,{name:"if",hash:{},fn:this.program(22,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+='<p class="fieldset__description  text-gray text-small">'+s(t.gettext.call(e,"Where you're commenting from. 100 characters max.",{name:"gettext",hash:{},data:i}))+'</p>\n</div>\n</div>\n<div class="fieldset" role="group">\n<div class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Privacy",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="fieldset__block align__item">\n<div class="fieldset__block--checkbox">\n<input type="checkbox" name="is_private" id="settings-privacy" ',a=t["if"].call(e,null!=e?e.is_private:e,{name:"if",hash:{},fn:this.program(24,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'>\n<label for="settings-privacy" class="text-medium">'+s(t.gettext.call(e,"Keep your profile activity private",{name:"gettext",hash:{},data:i}))+'</label>\n</div>\n<p class="fieldset__description  text-gray text-small">'+s(t.gettext.call(e,"This means no one can follow you or see comments on your profile.",{name:"gettext",hash:{},data:i}))+'</p>\n</div>\n</div>\n</div>\n<div class="form__footer">\n<div class="fieldset" role="group">\n<div class="fieldset__label" data-role="save-status"><div class="spinner-small"></div><div class="icon-checkmark"></div></div>\n<div class="fieldset__block"><button class="button button-inverted button-inverted-fill button-semi-wide text-medium" data-role="save-btn" disabled>'+s(t.gettext.call(e,"Save",{name:"gettext",hash:{},data:i}))+"</button></div>\n</div>\n</div>\n</form>\n"},useData:!0})}),define("home/views/SettingsProfileView",["jquery","backbone-marionette","underscore","core/config","home/templates/settingsProfile","home/views/common/BaseSettingsView"],function(e,t,n,i,a,s){var o=s.extend({template:a,events:n.defaults({"change select[name=avatar_source]":"sourceChangeHandler"},s.prototype.events),serializeData:function(){var e=s.prototype.serializeData.call(this,arguments);return n.defaults(e,{remotes:this.model.get("remotes"),avatar_cache:this.model.get("avatar_cache")})},sourceChangeHandler:function(t){var n=e(t.originalEvent.target),i=e("[data-role=avatar-file-upload]"),a=this.$el.find("[data-role=avatar-img]"),s=n.val();"computer"===s?i.removeClass("hidden"):(i.addClass("hidden"),a.attr("src",this.getAvatar(s)))},getAvatar:function(e){switch(e){case"gravatar":return"https://www.gravatar.com/avatar/"+this.model.get("remotes").gravatar.username;case"twitter":return this.ensureHttpsUrl(this.model.get("remotes").twitter.avatar_url);case"facebook":return"https://graph.facebook.com/"+this.model.get("remotes").facebook.username.replace("facebook-","")+"/picture?&height=92&width=92";case"default":return i.urls.avatar.generic}},ensureHttpsUrl:function(e){return e.replace("http:","https:")},getFormData:function(){var e=s.prototype.getFormData.apply(this,arguments);return e.is_private=!!e.is_private,e.avatar_file=this.$form.find("input[name=avatar_file]")[0].files[0]||"",e}});return o}),define("home/templates/settingsMenu",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="empty-message">\n'+a(t.gettext.call(e,"Pick a settings page on the left",{name:"gettext",hash:{},data:i}))+"\n</div>\n"},useData:!0})}),define("home/views/SettingsMenuView",["backbone-marionette","home/templates/settingsMenu"],function(e,t){var n=e.ItemView.extend({template:t});return n}),define("home/templates/settingsAccount",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<div class="alert -success">'+a(t.gettext.call(e,"Email verified. Now choose a username before someone else grabs it!",{name:"gettext",hash:{},data:i}))+"</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o="";return a=t["if"].call(e,null!=e?e.showVerifiedMessage:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+'<div data-role="account-form"></div>\n<div data-role="connected-accounts"></div>\n<div class="form">\n<div class="form__header">\n<h1 class="form-heading">'+s(t.gettext.call(e,"Personalization",{name:"gettext",hash:{},data:i}))+'</h1>\n<p class="form-description text-gray text-medium">\n'+s(t.gettext.call(e,"%(Disqus)s collects anonymous data from you in order to deliver better targeted content and advertising.",{name:"gettext",hash:{Disqus:"Disqus"},data:i}))+'\n</p>\n</div>\n<div class="form__content">\n<a href="https://help.disqus.com/customer/portal/articles/1657951" class="button button-inverted button-inverted-fill text-medium inline__item">'+s(t.gettext.call(e,"Configure",{name:"gettext",hash:{},data:i}))+'</a>\n</div>\n</div>\n\n<div data-role="delete-form"></div>\n'},useData:!0})}),define("core/engagement/vendor/visibly",[],function(){var e={q:document,p:void 0,prefixes:["webkit","ms","o","moz","khtml"],props:["VisibilityState","visibilitychange","Hidden"],m:["focus","blur"],visibleCallbacks:[],hiddenCallbacks:[],genericCallbacks:[],_callbacks:[],cachedPrefix:"",fn:null,onVisible:function(e){"function"==typeof e&&this.visibleCallbacks.push(e)},onHidden:function(e){"function"==typeof e&&this.hiddenCallbacks.push(e)},getPrefix:function(){if(!this.cachedPrefix)for(var e=0;b=this.prefixes[e++];)if(b+this.props[2]in this.q)return this.cachedPrefix=b},visibilityState:function(){return this._getProp(0)},hidden:function(){return this._getProp(2)},visibilitychange:function(e){"function"==typeof e&&this.genericCallbacks.push(e);var t=this.genericCallbacks.length;if(t)if(this.cachedPrefix)for(;t--;)this.genericCallbacks[t].call(this,this.visibilityState());else for(;t--;)this.genericCallbacks[t].call(this,arguments[0])},isSupported:function(){return this._getPropName(2)in this.q},_getPropName:function(e){return""==this.cachedPrefix?this.props[e].substring(0,1).toLowerCase()+this.props[e].substring(1):this.cachedPrefix+this.props[e]},_getProp:function(e){return this.q[this._getPropName(e)]},_execute:function(e){if(e){this._callbacks=1==e?this.visibleCallbacks:this.hiddenCallbacks;for(var t=this._callbacks.length;t--;)this._callbacks[t]()}},_visible:function(){e._execute(1),e.visibilitychange.call(e,"visible")},_hidden:function(){e._execute(2),e.visibilitychange.call(e,"hidden")},_nativeSwitch:function(){this[this._getProp(2)?"_hidden":"_visible"]()},_listen:function(){try{this.isSupported()?this.q.addEventListener(this._getPropName(1),function(){e._nativeSwitch.apply(e,arguments)},1):this.q.addEventListener?(window.addEventListener(this.m[0],this._visible,1),window.addEventListener(this.m[1],this._hidden,1)):this.q.attachEvent&&(this.q.attachEvent("onfocusin",this._visible),this.q.attachEvent("onfocusout",this._hidden))}catch(t){}},init:function(){this.getPrefix(),this._listen()}};return e.init(),e}),define("core/engagement/page",["jquery","underscore","backbone","core/bus","core/utils","core/engagement/vendor/visibly"],function(e,t,n,i,a,s){var o=t.extend(n.Events,{_initialized:!1,isEngaged:!1,resetTimeout:null,ACTIVE_TIMEOUT:6e4});return o._markNotEngaged=function(){o.isEngaged&&(o.isEngaged=!1,o.trigger("change:isEngaged",o.isEngaged,o))},o._markIsEngaged=function(){o.resetTimeout&&o.resetTimeout(),o.isEngaged||(o.isEngaged=!0,o.trigger("change:isEngaged",o.isEngaged,o))},o.start=function(){o._initialized||(o._initialized=!0,s.hidden()||o._markIsEngaged(),s.onVisible(o._markIsEngaged),s.onHidden(o._markNotEngaged),a.isMobileUserAgent()||(o.resetTimeout=t.debounce(o._markNotEngaged,o.ACTIVE_TIMEOUT),o.resetTimeout(),e(document).on("mousemove keyup",o._markIsEngaged),e(window).on("scroll",o._markIsEngaged),o.listenTo(i.frame,"window.mousemove window.scroll window.click",o._markIsEngaged)))},o.stop=function(){o._initialized&&(o._initialized=!1,o.resetTimeout=null,o.stopListening(),o.off(),s.visibleCallbacks=[],s.hiddenCallbacks=[],e(document).off("mousemove keyup",o._markIsEngaged),e(window).off("scroll",o._markIsEngaged),o._markNotEngaged())},o}),define("home/templates/settingsConnectedAccounts",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="fieldset__block--button">\n<button class="button button-inverted button-inverted-fill text-medium" data-action="disconnect" data-social="facebook">'+s(t.gettext.call(e,"Disconnect",{name:"gettext",hash:{},data:i}))+'</button>\n<small class="text-gray text-small">\n';return a=this.invokePartial(n.settingsAccountSocialLink,"","settingsAccountSocialLink",null!=(a=null!=e?e.items:e)?a.facebook:a,void 0,t,n,i),null!=a&&(o+=a),o+"</small>\n</div>\n"},3:function(e,t,n,i){var a=this.escapeExpression;return'<div class="fieldset__block--button">\n<button class="button button-inverted button-inverted-fill text-medium" data-action="connect" data-social="facebook">'+a(t.gettext.call(e,"Connect",{name:"gettext",hash:{},data:i}))+'</button>\n<small class="text-gray text-small">'+a(t.gettext.call(e,"Connect your Facebook account",{name:"gettext",hash:{},data:i}))+"</small>\n</div>\n"},5:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="fieldset__block--button">\n<button class="button button-inverted button-inverted-fill text-medium" data-action="disconnect" data-social="twitter">'+s(t.gettext.call(e,"Disconnect",{name:"gettext",hash:{},data:i}))+'</button>\n<small class="text-gray text-small">\n';return a=this.invokePartial(n.settingsAccountSocialLink,"","settingsAccountSocialLink",null!=(a=null!=e?e.items:e)?a.twitter:a,void 0,t,n,i),null!=a&&(o+=a),o+"</small>\n</div>\n"},7:function(e,t,n,i){var a=this.escapeExpression;return'<div class="fieldset__block--button">\n<button class="button button-inverted button-inverted-fill text-medium" data-action="connect" data-social="twitter">'+a(t.gettext.call(e,"Connect",{name:"gettext",hash:{},data:i}))+'</button>\n<small class="text-gray text-small">'+a(t.gettext.call(e,"Connect your Twitter account",{name:"gettext",hash:{},data:i}))+"</small>\n</div>\n"},9:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="fieldset__block--button">\n<button class="button button-inverted button-inverted-fill text-medium" data-action="disconnect" data-social="google">'+s(t.gettext.call(e,"Disconnect",{name:"gettext",hash:{},data:i}))+'</button>\n<small class="text-gray text-small">\n';return a=this.invokePartial(n.settingsAccountSocialLink,"","settingsAccountSocialLink",null!=(a=null!=e?e.items:e)?a.google:a,void 0,t,n,i),null!=a&&(o+=a),o+"</small>\n</div>\n"},11:function(e,t,n,i){var a=this.escapeExpression;return'<div class="fieldset__block--button">\n<button class="button button-inverted button-inverted-fill text-medium" data-action="connect" data-social="google">'+a(t.gettext.call(e,"Connect",{name:"gettext",hash:{},data:i}))+'</button>\n<small class="text-gray text-small">'+a(t.gettext.call(e,"Connect your Google account",{name:"gettext",hash:{},data:i}))+"</small>\n</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="form">\n<div class="form__header">\n<h1 class="form-heading">'+s(t.gettext.call(e,"Connected Accounts",{name:"gettext",hash:{},data:i}))+'</h1>\n<p class="form-description text-gray text-medium">\n'+s(t.gettext.call(e,"Connect your social media accounts for one-click login and to show off your online presence on your %(Disqus)s profile.",{name:"gettext",hash:{Disqus:"Disqus"},data:i}))+'\n</p>\n<p class="form-error text-medium" data-role="connected-accounts-alert"></p>\n</div>\n<div class="form__content">\n<div class="fieldset" role="group">\n<div class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Facebook",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="fieldset__block align__item">\n';return a=t["if"].call(e,null!=(a=null!=e?e.items:e)?a.facebook:a,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(o+=a),o+='</div>\n</div>\n<div class="fieldset" role="group">\n<div class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Twitter",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="fieldset__block align__item">\n',a=t["if"].call(e,null!=(a=null!=e?e.items:e)?a.twitter:a,{name:"if",hash:{},fn:this.program(5,i),inverse:this.program(7,i),data:i}),null!=a&&(o+=a),o+='</div>\n</div>\n<div class="fieldset" role="group">\n<div class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Google",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="fieldset__block align__item">\n',a=t["if"].call(e,null!=(a=null!=e?e.items:e)?a.google:a,{name:"if",hash:{},fn:this.program(9,i),inverse:this.program(11,i),data:i}),null!=a&&(o+=a),o+"</div>\n</div>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/SettingsConnectedAccountsView",["jquery","backbone-marionette","underscore","core/config","core/engagement/page","core/strings","core/utils","core/utils/cookies","home/models/Session","home/models/SettingsSocialAccount","home/templates/settingsConnectedAccounts"],function(e,t,n,i,a,s,o,r,l,c,d){var u=s.get,h=t.ItemView.extend({template:d,events:{"click [data-action=connect]":"connectHandler","click [data-action=disconnect]":"disconnectHandler"},initialize:function(){this.listenTo(this.collection,"reset remove add",this.render),this.session=l.get()},disconnectHandler:function(t){t.preventDefault();var i=e(t.originalEvent.target),a=i.attr("data-social"),s=this.collection.get(a),o=this;s.destroy({wait:!0}).fail(n.bind(o.showDisconnectError,o)).done(function(e){e.success||(this.collection.add(s),o.showDisconnectError())})},showDisconnectError:function(){this.updateSocialStatus(u("Can't disconnect your account."))},connectHandler:function(t){t.preventDefault();var n=e(t.originalEvent.target),i=n.attr("data-social");this.authenticate(i)},authenticate:function(e){var t=this.openAuthWindow(e);o.isMobileUserAgent()?this.checkStatusOnPageVisible(e):this.pollAuthWindow(e,t)},openAuthWindow:function(e){var t="location=0,status=0,width=800,height=400",n=this.getConnectUrl(e);return window.open(n,e+"Window",t)},getConnectUrl:function(e){return i.urls.oauth[e]+"?ctkn="+this.session.getCsrfToken()},pollAuthWindow:function(e,t){var n=this,i=window.setInterval(function(){t.closed&&(window.clearInterval(i),n.getAuthenticationStatus(e))},1e3)},checkStatusOnPageVisible:function(e){var t=this,n=function(i){i&&(t.getAuthenticationStatus(e),a.off("change:isEngaged",n))};a.on("change:isEngaged",n)},getAuthenticationStatus:function(e){var t=this,i=new c({id:e});i.fetch().fail(n.bind(t.showConnectError,t)).done(function(e){e.success?t.collection.add(i):t.showConnectError()})},showConnectError:function(){this.updateSocialStatus(u("Can't connect to your account."))},updateSocialStatus:function(e){this.$("[data-role=connected-accounts-alert]").text(e)}});return h}),define("home/templates/settingsDeleteForm",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="form">\n<div class="form__header">\n<h1 class="form-heading">'+a(t.gettext.call(e,"Delete Your %(Disqus)s Account",{name:"gettext",hash:{Disqus:"Disqus"},data:i}))+'</h1>\n<p class="form-description text-gray text-medium">'+a(t.gettext.call(e,"This can't be reversed, so make sure you're sure this is what you want.",{name:"gettext",hash:{},data:i}))+'</p>\n</div>\n<div class="form__content">\n<a href="#" class="button button-inverted button-inverted-fill text-medium inline__item" data-action="switch-tab" data-tab="delete">'+a(t.gettext.call(e,"Delete",{name:"gettext",hash:{},data:i}))+"</a>\n</div>\n</div>\n"},useData:!0})}),define("home/views/SettingsDeleteFormView",["jquery","backbone","backbone-marionette","underscore","home/templates/settingsDeleteForm"],function(e,t,n,i,a){var s=n.ItemView.extend({template:a});return s}),define("home/views/SettingsAccountView",["jquery","backbone-marionette","underscore","core/utils","core/utils/cookies","home/mixins/withSubviews","home/templates/settingsAccount","home/views/SettingsAccountFormView","home/views/SettingsConnectedAccountsView","home/views/SettingsDeleteFormView"],function(e,t,n,i,a,s,o,r,l,c){var d=t.ItemView.extend({template:o,regions:{connectedAccountsRegion:"[data-role=connected-accounts]",formRegion:"[data-role=account-form]",deleteRegion:"[data-role=delete-form]"},templateHelpers:function(){return{showVerifiedMessage:this.showVerifiedMessage()}},initialize:function(e){this.session=e.session},showVerifiedMessage:function(){return!!i.getQueryParams().email_verified},onRender:function(){this.activateRegion(this.connectedAccountsRegion,this.createConnectedAccountsView),this.activateRegion(this.formRegion,this.createFormView),this.activateRegion(this.deleteRegion,this.createDeleteFormView)},createFormView:function(){return new r({el:this.formRegion.el,model:this.model})},createDeleteFormView:function(){return new c({el:this.deleteRegion.el,session:this.session})},createConnectedAccountsView:function(){return new l({el:this.connectedAccountsRegion.el,collection:this.model.socialAccounts})}});return s.call(d.prototype),d}),define("home/templates/settingsEmail",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return"checked"},3:function(){return'checked="checked"'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<form class="form">\n<div class="form__header--mobile visible-md">\n<a href="/home/settings/" class="form__header--mobile-back"><span class="icon-left-bracket"></span></a>\n<h2>'+s(t.gettext.call(e,"Email Notifications",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<div class="form__header">\n<h1 class="form-heading hidden-md">'+s(t.gettext.call(e,"Email Notifications",{name:"gettext",hash:{},data:i}))+'</h1>\n<p class="form-description text-gray text-medium">'+s(t.gettext.call(e,"Control the emails %(Disqus)s sends you.",{name:"gettext",hash:{Disqus:"Disqus"},data:i}))+'</p>\n</div>\n<div class="form__content">\n<div class="fieldset" role="group">\n<div class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Enable Emails",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="fieldset__block align__item">\n<div class="fieldset__block--checkbox">\n<input type="checkbox" name="receive_notifications" id="settings-all-emails" ';return a=t["if"].call(e,null!=e?e.receive_notifications:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='>\n<label for="settings-all-emails" class="text-medium">'+s(t.gettext.call(e,"Receive emails from %(Disqus)s",{name:"gettext",hash:{Disqus:"Disqus"},data:i}))+'</label>\n</div>\n</div>\n</div>\n<div class="fieldset" role="group" data-role="notification">\n<div class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Digests",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="fieldset__block align__item">\n<div class="fieldset__block--checkbox">\n<input type="checkbox" name="receive_digests" id="settings-digests" ',a=t["if"].call(e,t.ne.call(e,null!=e?e.digest_frequency:e,null!=e?e.FREQUENCY_NEVER:e,{name:"ne",hash:{},data:i}),{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='>\n<label for="settings-digests" class="text-medium">'+s(t.gettext.call(e,"Receive %(Disqus)s Digest emails",{name:"gettext",hash:{Disqus:"Disqus"},data:i}))+'</label>\n</div>\n<div class="fieldset__block--radio" data-role="notification-digest">\n<input type="radio" name="digest_frequency" value="daily" ',a=t["if"].call(e,t.eq.call(e,null!=e?e.digest_frequency:e,"daily",{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+=' id="settings-digests-daily">\n<label for="settings-digests-daily" class="text-medium">'+s(t.gettext.call(e,"Daily",{name:"gettext",hash:{},data:i}))+'</label>\n</div>\n<div class="fieldset__block--radio" data-role="notification-digest">\n<input type="radio" name="digest_frequency" value="weekly" ',a=t["if"].call(e,t.eq.call(e,null!=e?e.digest_frequency:e,"weekly",{name:"eq",hash:{},data:i}),{name:"if",hash:{},fn:this.program(3,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+=' id="settings-digests-week">\n<label for="settings-digests-week" class="text-medium">'+s(t.gettext.call(e,"Weekly",{name:"gettext",hash:{},data:i}))+'</label>\n</div>\n<p class="fieldset__description text-gray text-small">\n'+s(t.gettext.call(e,"Digests give you a daily or weekly view of activity on %(Disqus)s, customized for you. Visit the %(digestFaq)s to learn more.",{name:"gettext",hash:{digestFaq:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"Digest FAQ",{name:"gettext",hash:{},data:i}),target:"blank",href:"https://help.disqus.com/customer/portal/articles/808919-disqus-digests"},data:i}),Disqus:"Disqus"},data:i}))+'\n</p>\n</div>\n</div>\n<div class="fieldset" role="group" data-role="notification">\n<div class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Replies",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="fieldset__block align__item">\n<div class="fieldset__block--checkbox">\n<input type="checkbox" name="replies_to_comments" id="settings-replies" ',a=t["if"].call(e,null!=e?e.replies_to_comments:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='>\n<label for="settings-replies" class="text-medium">'+s(t.gettext.call(e,"Receive an email when someone replies to your comments",{name:"gettext",hash:{},data:i}))+'</label>\n</div>\n</div>\n</div>\n<div class="fieldset" role="group" data-role="notification">\n<div class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Subscribe",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="fieldset__block align__item">\n<div class="fieldset__block--checkbox">\n<input type="checkbox" name="subscribe_thread_on_post" id="settings-subscribe" ',a=t["if"].call(e,null!=e?e.subscribe_thread_on_post:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+'>\n<label for="settings-subscribe" class="text-medium">'+s(t.gettext.call(e,"Subscribe automatically to discussions you comment on",{name:"gettext",hash:{},data:i}))+'</label>\n</div>\n<p class="fieldset__description text-gray text-small">'+s(t.gettext.call(e,"You'll get an email for every new comment on discussions you're subscribed to.",{name:"gettext",hash:{},data:i}))+'</p>\n</div>\n</div>\n</div>\n<div class="form__footer">\n<div class="fieldset" role="group">\n<div class="fieldset__label" data-role="save-status"><div class="spinner-small"></div><div class="icon-checkmark"></div></div>\n<div class="fieldset__block"><button class="button button-inverted button-inverted-fill button-semi-wide text-medium" data-role="save-btn" disabled>'+s(t.gettext.call(e,"Save",{name:"gettext",hash:{},data:i}))+"</button></div>\n</div>\n</div>\n</form>\n"},useData:!0})}),define("home/views/SettingsEmailView",["jquery","backbone-marionette","underscore","home/models/SettingsEmailNotifications","home/templates/settingsEmail","home/views/common/BaseSettingsView"],function(e,t,n,i,a,s){var o=s.extend({template:a,events:n.defaults({"change input[name=receive_notifications]":"receiveNotificationsChangeHandler","change input[name=receive_digests]":"receiveDigestsChangeHandler"},s.prototype.events),templateHelpers:function(){return{FREQUENCY_NEVER:i.FREQUENCY_NEVER}
},receiveDigestsChangeHandler:function(t){this.updateDigestsDisplay(e(t.originalEvent.target).is(":checked"))},receiveNotificationsChangeHandler:function(t){this.updateNotificationsDisplay(e(t.originalEvent.target).is(":checked"))},onDomRefresh:function(){this.updateNotificationsDisplay(this.model.get("receive_notifications")),this.updateDigestsDisplay(this.shouldReceiveDigests())},shouldReceiveDigests:function(){var e=this.model.get("digest_frequency");return e&&e!==i.FREQUENCY_NEVER},updateDigestsDisplay:function(e){var t=this.$el.find("[data-role=notification-digest]");e?(t.show(),this.setDefaultDigestFrequency()):t.hide()},setDefaultDigestFrequency:function(){this.$el.find("input[name=digest_frequency]:checked").val()||this.$el.find("input[name=digest_frequency][value=daily]").attr("checked","checked")},updateNotificationsDisplay:function(e){var t=this.$el.find("[data-role=notification]");e?t.removeClass("fieldset--hidden"):t.addClass("fieldset--hidden")},getFormData:function(){var e=s.prototype.getFormData.apply(this,arguments);return e.receive_notifications=!!e.receive_notifications,e.replies_to_comments=!!e.replies_to_comments,e.subscribe_thread_on_post=!!e.subscribe_thread_on_post,e.digest_frequency=e.receive_digests?e.digest_frequency:i.FREQUENCY_NEVER,e}});return o}),define("home/templates/settingsWeb",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return"checked"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<form class="form">\n<div class="form__header--mobile visible-md">\n<a href="/home/settings/" class="form__header--mobile-back"><span class="icon-left-bracket"></span></a>\n<h2>'+s(t.gettext.call(e,"Web Notifications",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<div class="form__header">\n<h1 class="form-heading hidden-md">'+s(t.gettext.call(e,"Web Notifications",{name:"gettext",hash:{},data:i}))+'</h1>\n<p class="form-description text-gray text-medium">\n'+s(t.gettext.call(e,"Control what %(Disqus)s notifies you about in your %(inbox)s. Looking for email instead? Go to %(emailNotifications)s.",{name:"gettext",hash:{Disqus:"Disqus",emailNotifications:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"Email Notifications",{name:"gettext",hash:{},data:i}),"data-tab":"email","data-action":"switch-tab",href:"/home/settings/email/"},data:i}),inbox:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"Notifications",{name:"gettext",hash:{},data:i}),href:"/home/inbox/"},data:i})},data:i}))+'\n</p>\n</div>\n<div class="form__content">\n<div class="fieldset" role="group">\n<div class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Notify you when",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="fieldset__block align__item">\n<div class="fieldset__block--checkbox">\n<input data-role="filter-checkbox" data-filter="likepost" type="checkbox" id="show-upvote-notification" name="show-upvote-notification" value="likepost" ';return a=t["if"].call(e,null!=e?e.showUpvoteNotification:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='>\n<label for="show-upvote-notification" class="text-medium">'+s(t.gettext.call(e,"Someone upvotes your comment",{name:"gettext",hash:{},data:i}))+'</label>\n</div>\n<div class="fieldset__block--checkbox">\n<input data-role="filter-checkbox" data-filter="invite" type="checkbox" id="show-invite-notification" name="show-invite-notification" value="invite" ',a=t["if"].call(e,null!=e?e.showInviteNotification:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='>\n<label for="show-invite-notification" class="text-medium">'+s(t.gettext.call(e,"Someone invites you to a discussion",{name:"gettext",hash:{},data:i}))+'</label>\n</div>\n<div class="fieldset__block--checkbox">\n<input data-role="filter-checkbox" data-filter="favoritethread" type="checkbox" id="show-recommend-notification" name="show-recommend-notification" value="favoritethread" ',a=t["if"].call(e,null!=e?e.showRecommendNotification:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='>\n<label for="show-recommend-notification" class="text-medium">'+s(t.gettext.call(e,"Someone recommends a discussion you started",{name:"gettext",hash:{},data:i}))+'</label>\n</div>\n<div class="fieldset__block--checkbox">\n<input data-role="filter-checkbox" data-filter="threadreplies" type="checkbox" id="show-threadreplies-notification" name="show-threadreplies-notification" value="threadreplies" ',a=t["if"].call(e,null!=e?e.showThreadRepliesNotification:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+'>\n<label for="show-threadreplies-notification" class="text-medium">'+s(t.gettext.call(e,"Someone comments on a discussion you started",{name:"gettext",hash:{},data:i}))+'</label>\n</div>\n</div>\n</div>\n</div>\n<div class="form__footer">\n<div class="fieldset" role="group">\n<div class="fieldset__label" data-role="save-status"><div class="spinner-small"></div><div class="icon-checkmark"></div></div>\n<div class="fieldset__block"><button class="button button-inverted button-inverted-fill button-semi-wide text-medium" disabled data-role="save-btn">'+s(t.gettext.call(e,"Save",{name:"gettext",hash:{},data:i}))+"</button></div>\n</div>\n</div>\n</form>\n"},useData:!0})}),define("home/views/SettingsWebView",["jquery","underscore","backbone-marionette","home/mixins/withFetchingView","home/models/TimelineFilter","home/templates/settingsWeb"],function(e,t,n,i,a,s){var o=n.ItemView.extend({events:{"submit form":"submitHandler","change input[type=checkbox]":"changeHandler"},template:s,initialize:function(){this.listenToOnce(this.collection,"reset",this.doneFetching),this.listenTo(this.collection,"sync",this.render)},templateHelpers:function(){return{showUpvoteNotification:!this.collection.get(a.FILTER_LIKEPOST),showInviteNotification:!this.collection.get(a.FILTER_INVITE),showRecommendNotification:!this.collection.get(a.FILTER_RECOMMEND),showThreadRepliesNotification:!this.collection.get(a.FILTER_THREADREPLIES)}},onRender:function(){this.$form=this.$("form"),this.$checkboxes=this.$form.find("[data-role=filter-checkbox]"),this.$saveStatus=this.$("[data-role=save-status]"),this.saveBtn=this.$("[data-role=save-btn]")[0]},changeHandler:function(){var e=t.chain(this.$checkboxes).filter(this.hasFilterChanged,this).value();this.saveBtn.disabled=!e.length},doneFetching:function(){this.collection.fetched=!0},isDoneFetching:function(){return this.collection.fetched},submitHandler:function(n){n.preventDefault(),this.updateStatus("is-saving");var i=t.chain(this.$checkboxes).filter(this.hasFilterChanged,this).map(this.updateFilter,this).value();e.when.apply(e,i).done(t.bind(this.updateStatus,this,"is-saved"))},hasFilterChanged:function(t){var n=e(t),i=n.is(":checked"),a=this.collection.get(n.attr("data-filter"));return i&&a||!i&&!a},updateFilter:function(t){var n=e(t),i=n.is(":checked")?"removeFilter":"addFilter";return this.collection[i](n.attr("data-filter"))},updateStatus:function(e){this.$el.find("[data-role=save-status]").removeClass("is-saving is-saved").addClass(e)}});return i.call(o.prototype),o}),define("home/templates/settingsApps",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.lambda,s=this.escapeExpression;return'<div class="fieldset" role="group" data-role="app-field">\n<div class="fieldset__label align__item text-gray">'+s(a(null!=e?e.name:e,e))+'</div>\n<div class="fieldset__block align__item">\n<div class="fieldset__block--button">\n<button class="button button-inverted button-inverted-fill text-medium" data-action=\'revoke-app\' data-app-id=\''+s(a(null!=e?e.id:e,e))+"'>"+s(t.gettext.call(e,"Revoke Access",{name:"gettext",hash:{},data:i}))+"</button>\n</div>\n</div>\n</div>\n"},3:function(e,t,n,i){var a=this.escapeExpression;return'<p class="form-description text-gray text-medium">'+a(t.gettext.call(e,"You haven't given access to any applications yet.",{name:"gettext",hash:{},data:i}))+"</p>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="form">\n<div class="form__header--mobile visible-md">\n<a href="/home/settings/" class="form__header--mobile-back"><span class="icon-left-bracket"></span></a>\n<h2>'+s(t.gettext.call(e,"Apps",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<div class="form__header">\n<h1 class="form-heading hidden-md">'+s(t.gettext.call(e,"Apps",{name:"gettext",hash:{},data:i}))+'</h1>\n<p class="form-description text-gray text-medium">'+s(t.gettext.call(e,"Control what apps can access your %(Disqus)s account.",{name:"gettext",hash:{Disqus:"Disqus"},data:i}))+'</p>\n</div>\n<div class="form__content">\n';return a=t.each.call(e,null!=e?e.items:e,{name:"each",hash:{},fn:this.program(1,i),inverse:this.program(3,i),data:i}),null!=a&&(o+=a),o+"</div>\n</div>\n"},useData:!0})}),define("home/views/SettingsAppsView",["jquery","backbone-marionette","core/strings","home/mixins/withFetchingView","home/templates/settingsApps"],function(e,t,n,i,a){var s=n.get,o=t.ItemView.extend({events:{"click [data-action=revoke-app]":"revokeAppHandler"},template:a,initialize:function(){this.listenToOnce(this.collection,"reset",this.doneFetching),this.listenTo(this.collection,"reset remove",this.render)},doneFetching:function(){this.collection.fetched=!0},isDoneFetching:function(){return this.collection.fetched},revokeAppHandler:function(t){var i=e(t.originalEvent.target).attr("data-app-id"),a=this.collection.get(i);if(a){var o=n.interpolate(s("Revoke access for %(appName)s?"),{appName:a.get("name")});window.confirm(o)&&a.destroy({wait:!0})}}});return i.call(o.prototype),o}),define("home/templates/settingsModeration",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="fieldset" role="group">\n<div class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Receive email notifications for comments that are",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="fieldset__block align__item">\n<div class="fieldset__block--checkbox">\n<input type="checkbox" name="receive_approved" id="settings-admin-approved" ';return a=t.unless.call(e,null!=e?e.disable_approved:e,{name:"unless",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='>\n<label for="settings-admin-approved" class="text-medium">'+s(t.gettext.call(e,"Newly posted",{name:"gettext",hash:{},data:i}))+'</label>\n</div>\n<div class="fieldset__block--checkbox">\n<input type="checkbox" name="receive_unapproved" id="settings-admin-pending" ',a=t["if"].call(e,null!=e?e.receive_unapproved:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='>\n<label for="settings-admin-pending" class="text-medium">'+s(t.gettext.call(e,"Pending (waiting for moderation)",{name:"gettext",hash:{},data:i}))+'</label>\n</div>\n<div class="fieldset__block--checkbox">\n<input type="checkbox" name="receive_spam" id="settings-admin-spam" ',a=t["if"].call(e,null!=e?e.receive_spam:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+='>\n<label for="settings-admin-spam" class="text-medium">'+s(t.gettext.call(e,"Marked as spam",{name:"gettext",hash:{},data:i}))+'</label>\n</div>\n</div>\n</div>\n<div class="fieldset" role="group">\n<div class="fieldset__label align__item text-gray">'+s(t.gettext.call(e,"Sites to receive emails for",{name:"gettext",hash:{},data:i}))+'</div>\n<div class="fieldset__block align__item">\n',a=t.each.call(e,null!=e?e.forum_subscriptions:e,{name:"each",hash:{},fn:this.program(4,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+'</div>\n</div>\n</div>\n<div class="form__footer">\n<div class="fieldset" role="group">\n<div class="fieldset__label" data-role="save-status"><div class="spinner-small"></div><div class="icon-checkmark"></div></div>\n<div class="fieldset__block"><button class="button button-inverted button-inverted-fill button-semi-wide text-medium" data-role="save-btn" disabled>'+s(t.gettext.call(e,"Save",{name:"gettext",hash:{},data:i}))+"</button></div>\n</div>\n</div>\n"},2:function(){return"checked"},4:function(e,t,n,i){var a,s=this.lambda,o=this.escapeExpression,r='<div class="fieldset__block--checkbox">\n<input type="checkbox" id="forum_'+o(s(i&&i.key,e))+'" name="forum_'+o(s(i&&i.key,e))+'" ';return a=t["if"].call(e,null!=e?e.subscribed:e,{name:"if",hash:{},fn:this.program(2,i),inverse:this.noop,data:i}),null!=a&&(r+=a),r+'>\n<label for="forum_'+o(s(i&&i.key,e))+'" class="text-medium">'+o(s(null!=e?e.name:e,e))+" ("+o(s(null!=e?e.url:e,e))+")</label>\n</div>\n"},6:function(e,t,n,i){var a=this.escapeExpression;return'<p class="form-description text-gray text-medium">\n'+a(t.gettext.call(e,"You aren't moderating any sites. To add a new site, %(addSite)s.",{name:"gettext",hash:{addSite:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"go here",{name:"gettext",hash:{},data:i}),target:"_blank",href:"http://publishers.disq.us/engage?utm_source=Home-Settings"},data:i})},data:i}))+"\n</p>\n\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<form class="form">\n<div class="form__header--mobile visible-md">\n<a href="/home/settings/" class="form__header--mobile-back"><span class="icon-left-bracket"></span></a>\n<h2>'+s(t.gettext.call(e,"Moderation",{name:"gettext",hash:{},data:i}))+'</h2>\n</div>\n<div class="form__header">\n<h1 class="form-heading hidden-md">'+s(t.gettext.call(e,"Moderation",{name:"gettext",hash:{},data:i}))+'</h1>\n<p class="form-description text-gray text-medium">\n'+s(t.gettext.call(e,"Control which moderation email notifications you receive for sites you moderate. To moderate comments posted on your site and adjust your site's settings, visit your %(moderatorLink)s.",{name:"gettext",hash:{moderatorLink:t.tag.call(e,"a",{name:"tag",hash:{text:t.gettext.call(e,"moderation panel",{name:"gettext",hash:{},data:i}),href:"/admin/"},data:i})},data:i}))+'\n</p>\n</div>\n<div class="form__content">\n';return a=t["if"].call(e,null!=e?e.moderatesForums:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.program(6,i),data:i}),null!=a&&(o+=a),o+"</form>\n"},useData:!0})}),define("home/views/SettingsModerationView",["jquery","backbone-marionette","underscore","core/config","home/templates/settingsModeration","home/views/common/BaseSettingsView"],function(e,t,n,i,a,s){var o=s.extend({template:a,templateHelpers:function(){return{moderatesForums:!n.isEmpty(this.model.get("forum_subscriptions"))}},getFormData:function(){var t=s.prototype.getFormData.apply(this,arguments);t.receive_unapproved=!!t.receive_unapproved,t.receive_spam=!!t.receive_spam,t.disable_approved=!t.receive_approved;var i=e.extend(!0,{},this.model.attributes.forum_subscriptions);return n.each(i,function(e,n){e.subscribed=!!t["forum_"+n],delete t["forum_"+n]}),t.forum_subscriptions=i,t}});return o}),define("home/templates/settings",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="section-contained">\n<div class="layout layout--no-aside layout--mobile-flush settings--root" data-role="settings-layout">\n<div class="layout__main">\n<div class="layout__nav">\n<ul class="nav-stacked">\n<li data-action="switch-tab" data-tab="profile" class="nav__item active">\n<a href="/home/settings/profile/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n'+s(t.gettext.call(e,"Profile",{name:"gettext",hash:{},data:i}))+'\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n<li data-action="switch-tab" data-tab="account" class="nav__item">\n<a href="/home/settings/account/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n'+s(t.gettext.call(e,"Account",{name:"gettext",hash:{},data:i}))+'\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n<li data-action="switch-tab" data-tab="email" class="nav__item">\n<a href="/home/settings/email/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n'+s(t.gettext.call(e,"Email Notifications",{name:"gettext",hash:{},data:i}))+'\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n<li data-action="switch-tab" data-tab="web" class="nav__item">\n<a href="/home/settings/web/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n'+s(t.gettext.call(e,"Web Notifications",{name:"gettext",hash:{},data:i}))+'\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n<li data-action="switch-tab" data-tab="apps" class="nav__item">\n<a href="/home/settings/apps/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n'+s(t.gettext.call(e,"Apps",{name:"gettext",hash:{},data:i}))+'\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n<li data-action="switch-tab" data-tab="moderation" class="nav__item">\n<a href="/home/settings/moderation/" class="nav-lnk -color-muted">\n<div class="nav-lnk__blk">\n'+s(t.gettext.call(e,"Moderation",{name:"gettext",hash:{},data:i}))+'\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n</ul>\n</div>\n<div class="layout__content" data-role="content-area">\n</div>\n</div>\n<aside class="layout__aside hidden-lg">\n<div class="aside__wrap aside-inverted">\n<div class="aside-inverted__content aside-inverted__content--settings text-center">\n<img src="'+s(t.urlfor.call(e,"cdn",{name:"urlfor",hash:{},data:i}))+'/img/Pam_Settings.png" width="170" height="93" />\n<h2 class="text-large">'+s(t.gettext.call(e,"Get more from Disqus",{name:"gettext",hash:{},data:i}))+"</h2>\n<p>"+s(t.gettext.call(e,"Follow channels for a personalized experience. Jump into channels to start your own discussion.",{name:"gettext",hash:{},data:i}))+'</p>\n<p>\n<a href="/home/channels/explore" class="button button-inverted text-small">'+s(t.gettext.call(e,"Find Channels To Join",{name:"gettext",hash:{},data:i}))+'</a>\n</p>\n</div>\n</div>\n<div class="text-smaller text-gray">\n';return a=this.invokePartial(n.homeFooter,"","homeFooter",e,void 0,t,n,i),null!=a&&(o+=a),o+"</div>\n</aside>\n</div>\n</div>\n"},usePartial:!0,useData:!0})}),define("home/views/SettingsLayout",["jquery","underscore","backbone","backbone-marionette","core/bus","core/strings","home/utils/layoutUtils","home/utils/backboneUtils","home/collections/SettingsAppCollection","core/UniqueModel","home/models/SettingsApp","home/models/SettingsModeration","home/models/SettingsProfile","home/models/SettingsAccount","home/models/SettingsEmailNotifications","home/views/common/TabbedView","home/views/SettingsDeleteView","home/views/SettingsProfileView","home/views/SettingsMenuView","home/views/SettingsAccountView","home/views/SettingsEmailView","home/views/SettingsWebView","home/views/SettingsAppsView","home/views/SettingsModerationView","home/templates/settings"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f,g,v,w,b,x,y,_,k,C){var T=s.get,S=f.extend({defaultTab:"menu",template:C,initialize:function(e){this.session=e.session,this.user=this.session.user,this.getSettingsAppCollection=t.once(this.getSettingsAppCollection),this.getNotificationFilters=t.once(this.getNotificationFilters),this.listenTo(this,"change:activeTab",this.updateLayoutClass),this.listenTo(this,"change:activeTab",this.trackOpenSection),f.prototype.initialize.apply(this,arguments)},updateLayoutClass:function(){this.$el.find("[data-role=settings-layout]").removeClass("settings--root settings--page").addClass(this.activeTab===this.defaultTab?"settings--root":"settings--page")},getMetaAttrs:function(){return T("Settings")},getSettingsAppCollection:function(){var e=new l;return e.fetch({reset:!0}),e},getNotificationFilters:function(){var e=this.session.getOrCreateNotifications();return e.filters.fetch({reset:!0}),e.filters},getTabView:function(e){switch(e){case"menu":return new w({model:this.session.user});case"profile":return new v({model:new c(h,{id:this.session.user.id})});case"account":return new b({session:this.session,model:new c(m,{id:this.session.user.id})});case"email":return new x({model:new c(p,{id:this.session.user.id})});case"web":return new y({collection:this.getNotificationFilters()});case"apps":return new _({collection:this.getSettingsAppCollection()});case"moderation":return new k({model:new c(u,{id:this.session.user.id})});case"delete":return new g({session:this.session,model:new c(m,{id:this.session.user.id})})}},getTrackingSection:function(e){return e},trackOpenSection:function(){a.trigger("openSection",this)}});return S}),define("home/templates/userChannels",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(){return" hidden"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="spacing-bottom';return a=t["if"].call(e,null!=e?e.hideManagedChannels:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+'" data-role="managed-channels-wrapper">\n<div class="card-wrap" data-role="managed-channels"></div>\n</div>\n\n<h2 class="text-subheading spacing-narrow">'+s(t.gettext.call(e,"Following",{name:"gettext",hash:{},data:i}))+'</h2>\n<div class="card-wrap" data-role="followed-channels"></div>\n'},useData:!0})}),define("home/views/UserChannelsView",["underscore","backbone-marionette","home/mixins/withSubviews","home/models/Session","home/views/ForumCardCollectionView","home/views/ProfileFollowingCommunitiesEmptyView","home/templates/userChannels"],function(e,t,n,i,a,s,o){var r=t.ItemView.extend({template:o,templateHelpers:function(){return{hideManagedChannels:this.shouldHideManagedChannels()}},regions:{managedChannelsRegion:"[data-role=managed-channels]",followedChannelsRegion:"[data-role=followed-channels]"},initialize:function(){this.listenTo(this.model.managedChannels.items,"reset add",function(){this.$("[data-role=managed-channels-wrapper]").toggleClass("hidden",this.shouldHideManagedChannels())})},shouldHideManagedChannels:function(){return 0===this.model.managedChannels.items.length},onRender:function(){this.activateRegion(this.managedChannelsRegion,e.partial(this.createChannelsView,this.model.managedChannels)),this.activateRegion(this.followedChannelsRegion,e.partial(this.createFollowedChannelsView,this.model.followedChannels))},createFollowedChannelsView:function(e){return this.createChannelsView(e,{infiniteScroll:!0,emptyView:s})},createChannelsView:function(t,n){return new a(e.extend({user:this.model.user,model:t,collection:t.items},n))}});return n.call(r.prototype),r}),define("home/templates/channels",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({1:function(e,t,n,i){var a=this.escapeExpression;return'<li data-action="switch-tab" data-tab="yours" class="nav__item active">\n<a href="/home/channels/yours/" class="nav-lnk -color-muted truncate-line">\n<div class="nav-lnk__blk">\n<span class="button__text">'+a(t.gettext.call(e,"Your Channels",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a,s=this.escapeExpression,o='<div class="section-contained" data-mix-location="discover page">\n<div class="layout layout--no-aside">\n<div class="layout__main">\n<div class="layout__nav text-medium">\n<ul class="nav--no-aside">\n';return a=t.unless.call(e,null!=e?e.isAnon:e,{name:"unless",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=a&&(o+=a),o+'<li data-action="switch-tab" data-tab="explore" class="nav__item active">\n<a href="/home/channels/explore/" class="nav-lnk -color-muted truncate-line">\n<div class="nav-lnk__blk">\n<span class="button__text">'+s(t.gettext.call(e,"Explore",{name:"gettext",hash:{},data:i}))+'</span>\n</div>\n<div class="nav-lnk__pointer">\n<span class="icon icon-right-bracket"></span>\n</div>\n</a>\n</li>\n</ul>\n<div class="text-medium hidden-md">\n<a href="https://disqusinquiry.wufoo.com/forms/disqus-channel-moderator-application/"\nclass="button button-inverted-fill -wide">\n'+s(t.gettext.call(e,"Become a Mod",{name:"gettext",hash:{},data:i}))+'\n</a>\n<a href="/home/channels/new/" class="button button-inverted-fill -wide spacing-top-narrow">\n'+s(t.gettext.call(e,"Create a Channel",{name:"gettext",hash:{},data:i}))+'\n</a>\n</div>\n</div>\n<div class="layout__content">\n<section data-role="content-area" class="spacing-bottom-large"></section>\n</div>\n</div>\n<div class="layout__aside hidden-lg">\n<section data-role="recommend-module" data-recommend-type="forum" class="module--aside"></section>\n<section data-role="recommend-module" data-recommend-type="channel" class="module--aside"></section>\n<section data-role="recommend-module" data-recommend-type="user" class="module--aside"></section>\n</div>\n</div>\n</div>\n'},useData:!0})}),define("home/templates/discoverChannelCollection",["handlebars","handlebars.partials","core/extensions/handlebars.helpers"],function(e){return e.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var a=this.escapeExpression;return'<div class="card-wrap padding-double">\n<header class="module-header text-center module--content">\n<div class="module-header__icon icon-colorful">\n<svg class="icon-discover" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 18 18" enable-background="new 0 0 18 18" xml:space="preserve" width="36" height="36"><rect x="14" width="4" height="4" class="dot"/><rect x="14" y="7" width="4" height="4" class="dot"/><rect x="14" y="14" width="4" height="4" class="dot"/><rect x="7" width="4" height="4" class="dot"/><rect x="7" y="7" width="4" height="4" class="dot"/><rect x="7" y="14" width="4" height="4" class="dot"/><rect width="4" height="4" class="dot"/><rect y="7" width="4" height="4" class="dot"/><rect y="14" width="4" height="4" class="dot"/></g></svg>\n</div>\n<div class="module-header__title">\n<h1 class="module-header__heading text-gray-darker">'+a(t.gettext.call(e,"Channels on %(disqus)s",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+'</h1>\n<p class="module-header__subheading">'+a(t.gettext.call(e,"Places to start your own discussions on %(disqus)s",{name:"gettext",hash:{disqus:"Disqus"},data:i}))+'</p>\n</div>\n</header>\n<section class="clearfix module-body -discover -plain">\n<div class="channels-module__wrap" data-role="channels"></div>\n</section>\n</div>\n'},useData:!0})}),define("home/views/DiscoverChannelCollectionView",["backbone-marionette","home/views/DiscoverChannelView","home/templates/discoverChannelCollection"],function(e,t,n){var i=e.CompositeView.extend({itemView:t,template:n,itemViewContainer:"[data-role=channels]"});return i}),define("home/views/ChannelsView",["underscore","backbone","core/switches","core/strings","core/UniqueModel","home/models/Session","home/models/UserProfile","home/views/common/TabbedView","home/views/TopicTagCollectionView","home/views/RecommendationsModuleView","home/views/UserChannelsView","home/views/HomepageChannelsModuleView","home/mixins/withEmailConfirmedModal","home/templates/channels","home/templates/spinnerTall","home/views/DiscoverChannelCollectionView"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f){var g=i.get,v=r.extend({defaultTab:function(){return s.get().isKnownToBeLoggedOut()?this.constructor.TABS.EXPLORE:this.constructor.TABS.YOURS},getTemplate:function(){return this.showFetching?p:m},templateHelpers:function(){return{isAnon:this.session.isKnownToBeLoggedOut()}},regions:e.defaults({recommendedUsersModuleRegion:"[data-role=recommend-module][data-recommend-type=user]",recommendedForumsModuleRegion:"[data-role=recommend-module][data-recommend-type=forum]",recommendedChannelsModuleRegion:"[data-role=recommend-module][data-recommend-type=channel]"},r.prototype.regions),initialize:function(t){r.prototype.initialize.call(this,t),this.listenTo(this,"change:activeTab",this.showTabSpecificModules),this.hasPromotedChannels=!1,this.session=s.get(),this.session.isKnownToBeLoggedOut()?this.showFetching=!1:(this.showFetching=!0,this.session.loadPromise().always(e.bind(function(){this.showFetching=!1,this.render()},this)))},onDomRefresh:function(){r.prototype.onDomRefresh.call(this),this.recommendedUsersModuleRegion.show(c.createUserRecommendedModuleView({model:this.model.interestingUsers,hideDiscoverLink:!0})),this.recommendedForumsModuleRegion.show(c.createForumRecommendedModuleView({model:this.model.interestingForums,hideDiscoverLink:!0})),this.model.promotedChannelProfiles.ensureFetched().then(e.bind(function(){var e=this.model.promotedChannelProfiles.items.chain().reject(function(e){return e.channel.primaryForum.get("isFollowing")}).pluck("channel").shuffle().value();e.length&&(this.hasPromotedChannels=!0,this.recommendedChannelsModuleRegion.show(new u({collection:new t.Collection(e)}))),this.showTabSpecificModules()},this))},showTabSpecificModules:function(e){e=e||this.activeTab;var t=e===this.constructor.TABS.YOURS&&this.hasPromotedChannels;this.$(this.recommendedChannelsModuleRegion.el).toggleClass("hidden",!t),this.$(this.recommendedForumsModuleRegion.el).toggleClass("hidden",t)},getMetaAttrs:function(){return g("Channels")},getTabView:function(e){switch(e){case this.constructor.TABS.YOURS:if(this.session.isKnownToBeLoggedOut())return void this.trigger("badTab");var t=this.session.userProfile;return t.ensureFetchedAllChannels(),new d({model:t});case this.constructor.TABS.EXPLORE:return new f({collection:this.model.promotedChannelProfiles.items})}}},{TABS:{YOURS:"yours",EXPLORE:"explore"}});return h.call(v.prototype),v}),define("home/viewmodels/DiscussionCreateViewModel",["underscore","backbone","home/utils/backboneUtils","home/models/Thread","home/models/Topic","core/UniqueModel","home/collections/TopicCollection"],function(e,t,n,i,a,s,o){var r=t.Model.extend({editableThreadAttrs:["title","message"],initialize:function(t,a){this.thread=a.thread||new i({forum:a.forum}),this.thread.forum.shouldFetch()&&this.thread.forum.fetch(),this.topics=new o([],{thread:this.thread}),this.listenTo(this,"change:category",this.updateTopicCategory),n.getPromiseFor(this.thread,"id").then(e.bind(this.onThreadInit,this))},onThreadInit:function(){s.set(i,this.thread),this.set(this.thread.pick(this.editableThreadAttrs)),this.topics.add(this.thread.topics.models),this.initCategory()},initCategory:function(){var e=this.thread.forum.channel,t=e&&e.getCategories();if(t){var n=this.topics.getCategoryTopics();if(!n.length){var s=this.get("title").split(i.CATEGORY_TITLE_SEPARATOR)[0];s&&t[s]&&(n=[a.getOrCreateTopic(s)])}n.length&&(n[0].set({hidden:!0}),this.set({category:n[0].get("displayName")}))}},updateTopicCategory:function(t,n){if(n){var i=this.topics.getCategoryTopics();e.each(i,this.topics.remove,this.topics);var s=a.getOrCreateTopic(n);s.set({hidden:!0}),this.topics.add(s)}},validate:function(t){var n=e.compact([this.thread.validate(e.pick(t,this.editableThreadAttrs)),this.topics.validate()]);return n.length?n:null},toJSON:function(){return e.defaults({thread:this.thread.toJSON()},t.Model.prototype.toJSON.call(this))},saveVisibleTopics:function(){this.topics.save()}});return r}),define("home/viewmodels/ChannelsViewModel",["underscore","backbone","core/UniqueModel","home/models/ChannelProfileFeed","home/models/FollowRecommendationFeed"],function(e,t,n,i,a){var s=t.Model.extend({initialize:function(){var e={fetchOptions:{limit:5}};
this.interestingForums=a.createForumFollowRecommendationFeed(e),this.interestingUsers=a.createUserFollowRecommendationFeed(e),this.promotedChannelProfiles=new n(i,{listName:i.LIST_NAMES.promoted})},ensureFetched:function(){this.interestingForums.ensureFetched(),this.interestingUsers.ensureFetched(),this.promotedChannelProfiles.ensureFetched().then(e.bind(function(){this.promotedChannelProfiles.items.each(function(e){e.ensureFetchedTopActivities()})},this))}});return n.addType("ChannelsViewModel",s),s}),define("home/collections/common/SelectiveCollection",["jquery","underscore","backbone"],function(e,t,n){var i=n.Collection.extend({initialize:function(t,i){if(t)throw Error("SelectiveCollection should be initialized with undefined models to be allowed to populate itself from a given toSelect collection");if(!(i&&i.toSelect&&i.toSelect instanceof n.Collection))throw Error("SelectiveCollection must be initialized with a toSelect collection");this.toSelect=i.toSelect,this.shouldSelect=i.shouldSelect||this.shouldSelect,this.maxSize=i.maxSize,this.order=i.order||this.order,this.selectComplete=e.Deferred(),this.toSelect.length?this.selectFrom(this.toSelect):this.toSelect.once("sync",this.selectFrom,this)},selectFrom:function(e){if(!e.length)return void this.completeSelection();this.maxSize=t.isNumber(this.maxSize)?this.maxSize:e.length;var n=this.order(e);this.resolveSelectability(n.shift(),n)},resolveSelectability:function(t,n){if(!t)return void this.completeSelection();var i=this;e.when(this.shouldSelect(t)).then(function(e){e&&i.select(t),i.maxSize>i.length?i.resolveSelectability(n.shift(),n):i.completeSelection()})},isComplete:function(){return this.selectComplete.promise()},completeSelection:function(){this.selectComplete.resolve()},select:function(e){return this.length>=this.maxSize?void this.completeSelection():void this.add(e)},shouldSelect:function(){return!0},order:function(e){return e.toArray()}});return i}),define("home/models/PostTree",["underscore","backbone","home/activityExpander"],function(e,t,n){var i=t.Model.extend({initialize:function(e,t){this.post=t.post,this.children=t.children}},{expandPostTree:function(a,s){return new i({},{post:n.buildPost(a,s.id),children:new t.Collection(e.map(s.children,e.bind(i.expandPostTree,i,a)))})}});return i}),define("home/collections/ThreadHighlightCollection",["underscore","backbone","core/api","home/models/PostTree"],function(e,t,n,i){var a=t.Collection.extend({url:n.getURL("threads/listHighlights"),initialize:function(e,t){this.thread=t.thread},fetch:function(e){return e=e||{},e.data=this.thread.buildFetchData(e.data),t.Collection.prototype.fetch.call(this,e)},parse:function(n){var a=n.response.objects,s=e.bind(i.expandPostTree,i,a);return e.map(n.response.items,function(n){var i=new t.Model({term:n.term});return i.posts=new t.Collection(e.map(n.posts,s)),i})}});return a}),define("home/collections/MediaPostCollection",["underscore","core/api","home/collections/PostCollection","home/activityExpander"],function(e,t,n,i){var a=n.extend({url:t.getURL("threads/listMediaPosts"),parse:function(t){var n=e.bind(i.buildPost,i,t.response.objects);return e.map(t.response.items,n)}});return a}),define("home/models/ForumFeed",["underscore","backbone","home/collections/FeedItemCollection","core/UniqueModel","home/models/Feed"],function(e,t,n,i,a){var s=a.extend({initialize:function(){a.prototype.initialize.call(this,{},{collectionClass:n,collectionOptions:{type:"profile",target:"forum:"+this.id}})},shouldFetch:function(){return!this.get("items").length&&!this.get("fetching")},fetch:function(e){this.get("items").length||this.get("fetching")||this.fetchItems(e)},parse:function(e){return e.response}});return i.addType("ForumFeed",s),s}),define("home/viewmodels/DiscussionViewModel",["jquery","underscore","backbone","core/UniqueModel","core/switches","core/api","home/collections/common/SelectiveCollection","home/collections/ThreadHighlightCollection","home/collections/MediaPostCollection","home/models/Feed","home/models/Channel","home/models/ChannelProfile","home/models/ForumFeed","home/models/ChannelProfileFeed"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m){var p={},f=n.Model,g=f.prototype,v=f.extend({initialize:function(e,t){if(this.thread=t.thread,this.channel=t.channel||this.thread.forum.channel,!this.channel&&this.thread.shouldFetch()&&this.listenToOnce(this.thread,"sync",function(){this.channel=this.thread.forum.channel}),a.isFeatureActive("discussionHighlights")&&(this.highlights=new r([],{thread:this.thread})),a.isFeatureActive("discussionMedia")){var n=this.thread.buildFetchData({limit:4});this.mediaPosts=new c({fetchOptions:n},{collectionClass:l})}this.channels=new i(m,{listName:m.LIST_NAMES.promoted}),this.buildRelatedCollections()},buildRelatedCollections:function(){var e=this.getRelatedThreads(),t=this;this.coverRelatedCollection=new o(void 0,{toSelect:e,maxSize:5,shouldSelect:function(e){return e.thread!==t.thread},order:function(e){return e.shuffle()}}),this.footerRelatedCollection=new o(void 0,{toSelect:e,maxSize:3,shouldSelect:function(e){return e.thread!==t.thread&&!t.coverRelatedCollection.contains(e)},order:function(e){return e.shuffle()}})},getRelatedThreads:function(){var e,t,n,a=this.channel;return a?(t=new i(u,{id:a.id,channel:a}),t.ensureFetchedTopActivities(),e=t.topActivities.get("items")):(n=new i(h,{id:this.thread.forum.id}),n.fetch(),e=n.get("items")),e},isKnownToBeNetworkThread:function(){return this.thread.has("isUserGenerated")&&!this.thread.get("isUserGenerated")},ensureFetched:function(){this.channels.ensureFetched(),this.ensureFetchedHighlights(),this.ensureFetchedMediaPosts()},ensureFetchedMediaPosts:function(){if(!this.isKnownToBeNetworkThread()&&this.mediaPosts){this.mediaPosts.ensureFetched();var e=this;s.call("threads/countMediaPosts",{data:this.thread.buildFetchData()}).done(function(t){e.set("numMediaPosts",t.response)})}},ensureFetchedHighlights:function(){this.isKnownToBeNetworkThread()||this.highlights&&this.highlights.fetch()},toJSON:function(e){return t.defaults({thread:this.thread.toJSON()},g.toJSON.call(this,e))}},{getOrCreate:function(e,t){var n=t&&t.thread,i=n&&p[n.cid];if(i)return i;var a=new v(e,t);return n&&(p[n.cid]=a),a.ensureFetched(),a}});return v}),define("home/models/TopicFeed",["underscore","backbone","home/collections/FeedItemCollection","core/UniqueModel","home/models/Feed"],function(e,t,n,i,a){var s=a.extend({initialize:function(){a.prototype.initialize.call(this,{},{collectionClass:n,collectionOptions:{type:"profile",target:"topic:"+this.id}})},shouldFetch:function(){return!this.get("items").length},fetch:function(e){this.get("items").length||this.fetchItems(e)},parse:function(e){return e.response}});return i.addType("TopicFeed",s),s}),define("home/collections/MostLikedUserCollection",["underscore","core/api","core/collections/PaginatedCollection","core/UniqueModel","home/models/User"],function(e,t,n,i,a){return n.extend({initialize:function(e,t){this.forum=t.forum},model:i.boundModel(a),url:t.getURL("forums/listMostLikedUsers"),fetch:function(t){return t=t||{},t.data=e.defaults({forum:this.forum,limit:20},t.data),n.prototype.fetch.call(this,t)},parse:function(){var t=n.prototype.parse.apply(this,arguments);return e.each(t,function(e){e.verb="topcommenter"}),e.filter(t,function(e){return parseFloat(e.rep)>.7?e:void 0})}})}),define("home/models/ForumProfile",["underscore","backbone","core/UniqueModel","home/collections/MostLikedUserCollection","home/models/Feed","home/models/FollowRecommendationFeed","home/models/Forum","home/models/ForumFeed"],function(e,t,n,i,a,s,o,r){var l=t.Model.extend({initialize:function(t,l){this.initializeRelated("forum",e.defaults({forum:{id:this.id}},l),o),this.recent=new n(r,{id:this.id});var c={forum:this.id};this.mostLikedUsers=new a({fetchOptions:c},{collectionClass:i}),this.interestingForums=s.createForumFollowRecommendationFeed(),this.interestingUsers=s.createUserFollowRecommendationFeed()},ensureFetched:function(){this.interestingForums.ensureFetched(),this.interestingUsers.ensureFetched()},toJSON:function(){return e.defaults({forum:this.forum.toJSON(),recent:this.recent.toJSON(),mostLikedUsers:this.mostLikedUsers.toJSON()},t.Model.prototype.toJSON.call(this))}});return n.addType("ForumProfile",l),l}),define("home/models/HomepageProfile",["jquery","underscore","backbone","core/UniqueModel","core/strings","home/models/Session","home/models/Feed","home/models/ChannelProfile","home/models/ChannelProfileFeed","home/models/FollowRecommendationFeed","home/models/ActivityFeed","home/collections/FeedItemCollection"],function(e,t,n,i,a,s,o,r,l,c,d,u){var h=a.get,m=n.Model.extend({initialize:function(){this.popular=new d({},{collectionOptions:{type:"home"}}),this.comments=new o({},{collectionClass:u,collectionOptions:{type:"comments"}}),this.discussions=new d({},{collectionOptions:{type:"discussions"}}),this.interestingChannels=new i(l,{listName:l.LIST_NAMES.promoted}),this.interestingUsers=c.createUserFollowRecommendationFeed(),this.spotlightProfile=new i(r,{id:this.constructor.SPOTLIGHT_ID,channel:this.constructor.SPOTLIGHT_ID},{topActivitiesOptions:{fetchOptions:{limit:3}}});var e="spotlight";this.topicChannelProfile=new i(r,{id:e,channel:e})},ensureFetchedSpotlightProfile:function(){this.spotlightProfile.ensureFetchedTopActivities()},ensureFetched:function(){var n=s.get();n.isKnownToBeLoggedOut()?(this.comments.set({fetched:!0}),this.comments.fetchPromise=e.Deferred().resolve().promise(),this.popular.set({fetched:!0}),this.discussions.set({fetched:!0}),this.ensureFetchedSpotlightProfile()):(this.popular.ensureFetched().always(t.bind(function(){this.popular.items.length||this.ensureFetchedSpotlightProfile()},this)),this.comments.ensureFetched(),this.discussions.ensureFetched()),this.commentsPromise=this.comments.fetchPromise,this.interestingUsers.ensureFetched(),this.topicChannelProfile.ensureFetchedTrendingTopics(),this.interestingChannels.ensureFetched()},initializeAndFetchInterestingForums:function(){this.interestingForums||(this.interestingForums=c.createForumFollowRecommendationFeed()),this.interestingForums.ensureFetched()}},{SPOTLIGHT_ID:"spotlight",MAX_SPOTLIGHT_ITEMS:{NUM:3,TEXT:h("3")}});return i.addType("HomepageProfile",m),m}),define("home/backbone.overrides",["underscore","backbone","core/api","core/UniqueModel"],function(e,t,n,i){t.ajax=e.wrap(t.ajax,function(e,t){return t.traditional=!0,/disqus\.com\/api/.test(t.url)?n.call(t.url,t):e(t)}),t.Model.prototype.initializeRelated=function(t,n,a){var s=n&&n[t]||this.get(t);if(!s)throw"missing the id, attributes, or model for related model "+t;if(e.isString(s)||e.isNumber(s)){var o=s;s={},s[a.prototype.idAttribute||"id"]=o}s instanceof a||(s=new i(a,s,n)),this.unset(t),this[t]=s}}),define("home/overrides/marionette.overrides",["jquery","backbone-marionette"],function(e,t){t.CompositeView.prototype.rerenderModel=function(){var e=this.$(this.itemViewContainer).detach();this.$el.html(this.renderModel()),this.$(this.itemViewContainer).replaceWith(e),this.triggerMethod("render",this)}}),define("Router",["underscore","jquery","modernizr","backbone","backbone-marionette","home/templates/preload","home/views/MainLayout","home/views/HomepageView","home/views/ActivityFeedView","home/views/NotificationsView","home/views/NotificationsLoggedOutView","home/views/ForumProfileView","home/views/TopicCoverView","home/views/ProfileView","home/views/DiscussionCreateView","home/views/DiscussionPageView","home/views/WelcomeView","home/views/SearchPageLayout","home/views/ChannelProfileView","home/views/ExploreChannelProfileView","home/views/ChannelCreateView","home/views/CurateActivityView","home/views/SettingsLayout","home/views/ChannelsView","home/views/ExploreView","home/viewmodels/DiscussionCreateViewModel","home/viewmodels/ChannelsViewModel","home/viewmodels/DiscussionViewModel","home/collections/common/ExtensibleCollection","home/collections/FollowingUserCollection","home/models/Session","core/UniqueModel","home/models/ActivityFeed","home/models/Notifications","home/models/UserProfile","home/models/TopicFeed","home/models/Thread","home/models/Forum","home/models/Channel","home/models/ChannelProfile","home/models/ForumProfile","home/models/CuratedFeedProfile","home/models/HomepageProfile","home/utils/navigationUtils","home/utils/trackingUtils","core/utils","core/utils/cookies","core/utils/releaseUtils","core/api","core/engagement/page","core/strings","core/switches","remote/config","core/config/urls","home/backbone.overrides","home/overrides/marionette.overrides","disqus.sdk"],function(e,t,n,i,a,s,o,r,l,c,d,u,h,m,p,f,g,v,w,b,x,y,_,k,C,T,S,E,F,P,D,M,V,A,R,N,O,I,U,L,q,H,$,j,z,B,W,G,Y,J,K,X,Q,Z){var et=n.localstorage,tt=function(e){(new Image).src=Z.jester+"/stat.gif?event="+e},nt=K.get,it=i.Router.extend({name:"home",routes:{"home/discuss/:forum(/)":"startDiscussion","home/channels/new(/)":"createChannel","home/edit/:forum/:thread(/)":"editDiscussion","home/search(/)":"search","home/user(s)(/:username)(/:feed)(/)":"profile","home/user(s)/(:username)(/:feed)(/:subfeed)(/)":"profile","by/:username(/:feed)(/)":"profile","by/:username(/:feed)(/:subfeed)(/)":"profile","home/inbox(/:feed)(/)":"inbox","home/preload(/)":"preload","home/account(/)":"account","home/notifications(/)":"notifications","home/topic(s)/:topicId(/)":"topics","home/forum(s)/:forumId(/:feed)(/)":"forums","home/discussion(s)/:forum/:thread(/:activeTab)(/:permalink)(/)":"discussion","home/ndiscussion(s)/:forum/:thread(/:activeTab)(/:permalink)(/)":"nativeDiscussion","home/follow/channel(s)/:channelId(/)":"followChannel","home/channel(s)/:channelId(/:feed)(/)":"channels","home/channel(s)/:channelId/topics/:topic(/)":"channelTopics","home/channel(s)/:channelId/discussion(s)/:forumId/:thread(/:activeTab)(/:permalink)(/)":"channelDiscussion","home/channel(s)/:channelId/ndiscussion(s)/:forumId/:thread(/:activeTab)(/:permalink)(/)":"nativeChannelDiscussion","home/curate/channel/:channelId(/:activityIndex)(/)":"curate","home/settings(/:section)/":"settings","home/discover(/)":"channelsPage","home/welcome(/)":"onboarding","home/explore(/)":"explore","home/explore/:channelId/:activeTab(/)":"exploreChannel","home(/:feed)(/)":"home","(/)":"home"},initialize:function(e){this.initRoutes(),this.CDN_ROOT=e.CDN_ROOT,this.feeds={},this.listenTo(this,"route",this.handleRouteChange),this.listenTo(this,"route",this.logRouteChange),this.messages=[]},initRoutes:function(){this.route(/home\/channels(?:\/(yours|explore))?\/?(?:\?.+)?$/,"channels",this.channelsPage)},bootstrap:function(){this.initSession(),this.initTracking(),this.initPageEngagementTracking(),this.initLinkHandling(),this.initMainLayout()},initTracking:function(){z.init(),z.trackVisit()},initLinkHandling:function(){t("body").on("click","a[href]",e.bind(j.handleLinkClicks,j))},initSession:function(){var t=this.session=D.get();return t.load(),t.loadPromise().then(e.bind(function(){window.Raven&&window.Raven.setUser({id:t.user.get("id"),username:t.user.get("username")}),this.loadModeratedForums()},this)),t.loadPromise().fail(function(){var e=t.provider();e&&tt("home.session.rejected."+("disqus"===e?"disqus":"remote"))}),this.initUserProfile(),t},initMainLayout:function(){this.layout=new o({container:"body",session:this.session,app:this})},getCurrentView:function(){return this.layout.content.currentView},initPageEngagementTracking:function(){J.start()},loadModeratedForums:function(){this.session.loadModeratedForums()},logRouteChange:function(e){tt(this.name+".route."+e)},initUserProfile:function(){var e=this.session._fromCookie().username;e?this.session.initUserProfile(e):this.session.once("change:id",function(e){this.session.initUserProfile(e.get("username"))},this)},execute:function(){Y.off("error",j.navigateToLoginOnAuthFail),z.pageChanged(),i.Router.prototype.execute.apply(this,arguments)},ensureAuthenticated:function(t){return Y.off("error",j.navigateToLoginOnAuthFail),this.session.isKnownToBeLoggedOut()?j.navigateToLogin():(Y.on("error",j.navigateToLoginOnAuthFail),void this.session.loadPromise().then(e.bind(t,this,e.tail(arguments)),j.navigateToLogin))},ensureOnboardingComplete:function(t){return!X.isFeatureActive("homeOnboarding")||this.session.isKnownToBeLoggedOut()?t.apply(this):void this.session.loadPromise().always(e.bind(function(){this.session.isLoggedIn()&&!this.session.user.get("homeOnboardingComplete")?e.defer(this.navigateToOnboarding):t.apply(this)},this))},navigateToOnboarding:function(){var e="/home/welcome/";!B.getQueryParams().email_verified||(e+="?email_verified=1"),j.navigate(e,{trigger:!0,replace:!0})},ensureCanCreateOnChannel:function(t,n){var i=new M(I,{id:n});return i.shouldFetch()?(i.fetch(),void this.listenToOnce(i,"sync",e.bind.apply(e,[this.ensureCanCreateOnChannel,this].concat(e.toArray(arguments))))):!i.channel&&"gabalafou-test"!==n||!i.channel.userCanCreate(this.session.user)?this.notFound():void t.apply(this,e.tail(arguments))},ensureTab:function(e,t){e.listenTo(e,"badTab",function(){j.navigate(t,{silent:!0,replace:!0})})},preventBlacklisted:function(t){e.contains(Q.timelines.BLACKLISTED_FORUMS,t.forum)&&(window.top.location="https://help.disqus.com/customer/portal/articles/1689402-redirected-from-home")},curate:function(t,n){this.ensureAdmin(function(){var i={channel:t};i.id=H.buildId(i);var a=new M(H,i);return null===n||a.curated.get("fetched")?(a.ensureFetched(),void(null!==n?this.layout.showView(new y({model:a.curated.items.at(n),channel:a.channel})):require(["home/views/CurationView"],e.bind(function(e){this.layout.showView(new e({model:a}))},this)))):void j.navigate("/home/curate/channel/"+t+"/",{trigger:!0,replace:!0})})},preload:function(){this.preloadView=new(a.ItemView.extend({template:s})),this.layout.showView(this.preloadView)},handleRouteChange:function(e){this.setCurrentRouteName(e),j.coerceTrailingSlash(window.location)},setCurrentRouteName:function(e){this._previousRouteName=this.getCurrentRouteName(),this._currentRouteName=e},getCurrentRouteName:function(){return this._currentRouteName},getPreviousRouteName:function(){return this._previousRouteName},onboarding:function(){return this.ensureAuthenticated(function(){this.layout.showView(new g({session:this.session}),{lightBackground:!0})})},explore:function(){this.layout.showView(C.Create({session:this.session}),{lightBackground:!0})},exploreChannel:function(e,t){var n=new M(L,{id:e,channel:e});n.ensureFetchedTopActivities();var i=new b({model:n,app:this,activeTab:t});this.layout.showView(i,{lightBackground:!0})},renavigateToProfile:function(e){var t=e.get("username");return t?(j.navigate("/by/"+t+"/",{replace:!0}),void this.profile(t)):(j.navigate("/home/",{replace:!0}),void this.home())},settings:function(e){return this.ensureAuthenticated(function(){this.layout.showView(new _({session:this.session,activeTab:e}))})},channelsPage:function(e){this.ensureOnboardingComplete(function(){var t=new M(S,{id:"discover-view-model"});t.ensureFetched(),this.layout.showView(new k({model:t,activeTab:e}))})},search:function(){this.layout.showView(new v({session:this.session}))},profile:function(t,n,i){if(-1!==window.location.pathname.indexOf("home/user")&&j.navigate(window.location,{replace:!0,silent:!0}),!t)return this.ensureAuthenticated(function(){var e=this.session,t=e.user;return t.get("username")?void this.renavigateToProfile(t):void this.listenToOnce(e,"change:id",this.renavigateToProfile)});var a=e.find(M.pool(R),function(e){return e.user.get("username")===t});a||(a=new M(R,{username:t})),a.ensureFetched();var s=new m({model:a,activeTab:n,subTab:i});this.ensureTab(s,"/by/"+t+"/"),this.layout.showView(s)},home:function(t,n){return this.session.isKnownToBeLoggedOut()&&!!B.getQueryParams().email_verified?j.navigateToLogin():void this.ensureOnboardingComplete(function(){"/home/"===window.location.pathname&&j.navigate(window.location,{replace:!0,silent:!0});var i,a;i=new M($,{id:"home-view-model"}),i.ensureFetched(),a=new r({model:i,activeTab:t}),this.ensureTab(a,"/"),this.layout.showView(a),e.isFunction(n)&&n(),this.cleanLocalStorage()})},cleanLocalStorage:function(){if(et)try{localStorage.removeItem("dhome_v2oo"),localStorage.removeItem("whatsNewViewsRemaining"),localStorage.removeItem("v2SwitchoverViewsRemaining")}catch(e){}},account:function(){return j.navigate("/home/settings/account/",{trigger:!0,replace:!0})},notifications:function(){return j.navigate("/home/settings/email/",{trigger:!0,replace:!0})},ensureAdmin:function(t,n){var i=this.session;return i.fetched?G.isDisqusAdmin(i.user)?t.apply(this,n):this.notFound():void i.fetch().then(e.bind(this.ensureAdmin,this,t,n),e.bind(this.notFound,this))},followChannel:function(e){return"disqusfun"===e?this.ensureAdmin(this._followChannel,arguments):this._followChannel.apply(this,arguments)},_followChannel:function(e){this.ensureAuthenticated(function(){var t=new M(U,{slug:e});t.primaryForum&&!t.primaryForum.get("isFollowing")?t.primaryForum.follow():this.listenToOnce(t,"changeRelated:primaryForum",function(){t.primaryForum.get("isFollowing")||t.primaryForum.follow()}),j.navigate("/home/channel/"+e+"/",{trigger:!0,replace:!0})})},channels:function(e){return"disqusfun"===e||"gabalafou-test"===e?this.ensureAdmin(this._channels,arguments):this._channels.apply(this,arguments)},channelTopics:function(e,t){return this.channels(e,"topic-"+t)},_channels:function(e,t){var n=new M(L,{id:e,channel:e});n.ensureFetched();var i=new w({model:n,activeTab:t});this.ensureTab(i,"home/channel/"+e+"/"),this.layout.showView(i),z.trackChannelVisit(e)},createChannel:function(){this.ensureAuthenticated(function(){var e=new x({model:new U,session:this.session});this.layout.showView(e)})},_forums:function(e,t){var n=new M(q,{id:e}),i=n.forum,a=this;if(i.channel)return void j.navigate("/home/channel/"+i.channel.id+"/",{trigger:!0,replace:!0});i.fetch().then(function(){i.channel&&a._forums(e)},this.notFound),n.ensureFetched();var s=new u({model:n,activeTab:t});this.ensureTab(s,"/home/forum/"+e+"/"),this.layout.showView(s)},forums:function(e){return this.preventBlacklisted({forum:e}),"disqus-disqusfun"===e?this.ensureAdmin(this._forums,arguments):this._forums.apply(this,arguments)},topics:function(e){var t=new M(N,{id:e});t.shouldFetch()&&t.fetch();var n=new l({coverView:h,model:t,collection:t.get("items")});n.$el.attr({"data-mix-location":"feed topic"}),this.layout.showView(n)},inbox:function(e){var t,n=this.session.getOrCreateNotifications();if(n.ensureFetchedRecommendations(),this.session.isKnownToBeLoggedOut())t=new d({model:n});else{if(window.location.search.indexOf("email_verified")>-1){var i=K.interpolate(nt("Your email's verified! Have a look around -- %(Disqus)s is a lot more than comments"),{Disqus:"Disqus"});this.messages.push({message:i})}t=new c({model:n,activeTab:e})}this.ensureTab(t,"/home/inbox/"),this.layout.showView(t)},_showDiscussionForm:function(t,n){var i=new p({session:this.session,model:new T({},e.extend({forum:t},n))});this.listenTo(i,"createThread",function(){var e=i.getThread();(new F).add(e),j.navigate(e.getDiscussionRoute(),{trigger:!0})}),this.layout.showView(i),z.trackChannelVisit(i.getThread().forum.channel.id)},startDiscussion:function(e){return this.ensureAuthenticated(function(){this.ensureCanCreateOnChannel(function(){this._showDiscussionForm.apply(this,arguments)},e)},arguments)},editDiscussion:function(n,i){var a=this.session,s=O.getOrCreateThread(n,i),o=[];return a.fetched||o.push(a.fetch()),s.shouldFetch()&&o.push(s.fetch()),a.moderatedForums||o.push(a.loadModeratedForums()),o.length?void t.when.apply(t,o).then(e.bind(this.editDiscussion,this,n,i),e.bind(this.notFound,this)):s.canEdit(a)?void this._showDiscussionForm(n,{thread:s}):void j.navigate(s.getDiscussionRoute(),{trigger:!0,replace:!0})},discussionPage:function(t,n,i,a){a=a||{};var s=O.getOrCreateThread(t,n,a.threadFetchOptions),o=E.getOrCreate({},{channel:a.channel,thread:s}),r=new f(e.extend({model:o,session:this.session,activeTab:i,app:this},a));this.layout.showView(r,{lightBackground:!0})},_discussion:function(e,t,n,i){return this.preventBlacklisted({forum:e}),"disqus-disqusfun"===e?this.ensureAdmin(this.discussionPage,[e,t,n,i]):this.discussionPage(e,t,n,i)},discussion:function(e,t,n){return this._discussion(e,t,n)},channelDiscussion:function(e,t,n,i,a){a=a||{};var s=new M(U,{slug:e});return s.shouldFetch()&&s.fetch(),z.trackChannelVisit(e),this._discussion(t,n,i,{channel:s,threadFetchOptions:{data:{related:["author"]}},noEmbed:a.noEmbed})},nativeDiscussion:function(e,t,n){return this._discussion(e,t,n,{noEmbed:!0})},nativeChannelDiscussion:function(e,t,n,i){return this.channelDiscussion(e,t,n,i,{noEmbed:!0})},notFound:j.notFoundRouteHandler});return it}),define("home/mixins/asEmbedApp",["jquery","underscore","backbone","modernizr","core/api","core/frameBus","core/bus","core/utils","core/utils/cookies","home/utils/mixpanelUtils","home/utils/navigationUtils"],function(e,t,n,i,a,s,o,r,l,c,d){var u,h={initialize:function(t){u=e.Deferred(),this.name="embed_sidebar",c.trackError=e.noop,c.track=e.noop,this.mainLayoutIsRendered=e.Deferred(),this.listenTo(s,"mainlayoutRendered",this.mainLayoutIsRendered.resolve),this.listenTo(o,"after:render",function(){s.sendHostMessage("after:render")}),t.apply(this,arguments),this.listenTo(s,"showPath",this.loadPath),this.listenTo(s,"open",this.openDrawer),s.sendHostMessage("ready")},initUserProfile:function(e){u.done(e)},loadModeratedForums:e.noop,setSsoHeaders:function(e){a.headers({"X-Disqus-Publisher-API-Key":e.apiKey,"X-Disqus-Remote-Auth":e.remoteAuthS3})},loadPath:function(e){e.sso&&e.sso.apiKey&&e.sso.remoteAuthS3&&this.setSsoHeaders(e.sso),u.resolveWith(this),this.mainLayoutIsRendered.done(function(){d.navigate(e.path,!0),s.sendHostMessage("openReady")})},openDrawer:function(){var t=e("body");t.addClass("active"),t.one(r.transitionEndEvent,function(){s.sendHostMessage("after:render")})}},m={fetch:function(e,n){return u.then(t.bind(e,this,n))},fetchFollowedForums:e.noop,fetchFollowedChannels:e.noop},p=function(e,n){e.initialize=t.wrap(e.initialize,h.initialize),e.initUserProfile=t.wrap(e.initUserProfile,h.initUserProfile),e.loadModeratedForums=h.loadModeratedForums,e.setSsoHeaders=h.setSsoHeaders,e.loadPath=h.loadPath,e.openDrawer=h.openDrawer,e.navigateToPath=h.navigateToPath,n.fetch=t.wrap(n.fetch,m.fetch),n.fetchFollowedForums=m.fetchFollowedForums,n.fetchFollowedChannels=m.fetchFollowedChannels};return p}),+function(e){function t(t){e(i).remove(),e(a).each(function(){var i=n(e(this)),a={relatedTarget:this};i.hasClass("open")&&(i.trigger(t=e.Event("hide.bs.dropdown",a)),t.isDefaultPrevented()||i.removeClass("open").trigger("hidden.bs.dropdown",a))})}function n(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&e(n);return i&&i.length?i:t.parent()}var i=".dropdown-backdrop",a="[data-toggle=dropdown]",s=function(t){e(t).on("click.bs.dropdown",this.toggle)};s.prototype.toggle=function(i){var a=e(this);if(!a.is(".disabled, :disabled")){var s=n(a),o=s.hasClass("open");if(t(),!o){"ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t);var r={relatedTarget:this};if(s.trigger(i=e.Event("show.bs.dropdown",r)),i.isDefaultPrevented())return;s.toggleClass("open").trigger("shown.bs.dropdown",r),a.focus()}return!1}},s.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var i=e(this);if(t.preventDefault(),t.stopPropagation(),!i.is(".disabled, :disabled")){var s=n(i),o=s.hasClass("open");if(!o||o&&27==t.keyCode)return 27==t.which&&s.find(a).focus(),i.click();var r=" li:not(.divider):visible a",l=s.find("[role=menu]"+r+", [role=listbox]"+r);if(l.length){var c=l.index(l.filter(":focus"));38==t.keyCode&&c>0&&c--,40==t.keyCode&&l.length-1>c&&c++,~c||(c=0),l.eq(c).focus()}}}};var o=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new s(this)),"string"==typeof t&&i[t].call(n)})},e.fn.dropdown.Constructor=s,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=o,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",a,s.prototype.toggle).on("keydown.bs.dropdown.data-api",a+", [role=menu], [role=listbox]",s.prototype.keydown)}(jQuery),define("bootstrap/dropdown",["jquery"],function(){}),+function(e){var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,n,i){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(i);for(var a=this.options.trigger.split(" "),s=a.length;s--;){var o=a[s];if("click"==o)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=o){var r="hover"==o?"mouseenter":"focusin",l="hover"==o?"mouseleave":"focusout";this.$element.on(r+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,i){n[e]!=i&&(t[e]=i)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show()},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide()},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(t),t.isDefaultPrevented())return;var n=this,i=this.tip();this.setContent(),this.options.animation&&i.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement,s=/\s?auto?\s?/i,o=s.test(a);o&&(a=a.replace(s,"")||"top"),i.detach().css({top:0,left:0,display:"block"}).addClass(a),this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element);var r=this.getPosition(),l=i[0].offsetWidth,c=i[0].offsetHeight;if(o){var d=this.$element.parent(),u=a,h=document.documentElement.scrollTop||document.body.scrollTop,m="body"==this.options.container?window.innerWidth:d.outerWidth(),p="body"==this.options.container?window.innerHeight:d.outerHeight(),f="body"==this.options.container?0:d.offset().left;a="bottom"==a&&r.top+r.height+c-h>p?"top":"top"==a&&0>r.top-h-c?"bottom":"right"==a&&r.right+l>m?"left":"left"==a&&f>r.left-l?"right":a,i.removeClass(u).addClass(a)}var g=this.getCalculatedOffset(a,r,l,c);this.applyPlacement(g,a),this.hoverState=null;var v=function(){n.$element.trigger("shown.bs."+n.type)};e.support.transition&&this.$tip.hasClass("fade")?i.one(e.support.transition.end,v).emulateTransitionEnd(150):v()}},t.prototype.applyPlacement=function(t,n){var i,a=this.tip(),s=a[0].offsetWidth,o=a[0].offsetHeight,r=parseInt(a.css("margin-top"),10),l=parseInt(a.css("margin-left"),10);
isNaN(r)&&(r=0),isNaN(l)&&(l=0),t.top=t.top+r,t.left=t.left+l,e.offset.setOffset(a[0],e.extend({using:function(e){a.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),a.addClass("in");var c=a[0].offsetWidth,d=a[0].offsetHeight;if("top"==n&&d!=o&&(i=!0,t.top=t.top+o-d),/bottom|top/.test(n)){var u=0;0>t.left&&(u=-2*t.left,t.left=0,a.offset(t),c=a[0].offsetWidth,d=a[0].offsetHeight),this.replaceArrow(u-s+c,c,"left")}else this.replaceArrow(d-o,d,"top");i&&a.offset(t)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(){function t(){"in"!=n.hoverState&&i.detach(),n.$element.trigger("hidden.bs."+n.type)}var n=this,i=this.tip(),a=e.Event("hide.bs."+this.type);return this.$element.trigger(a),a.isDefaultPrevented()?void 0:(i.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i.one(e.support.transition.end,t).emulateTransitionEnd(150):t(),this.hoverState=null,this)},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,n,i){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-i,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-i/2,left:t.left-n}:{top:t.top+t.height/2-i/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;n.tip().hasClass("in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=function(n){return this.each(function(){var i=e(this),a=i.data("bs.tooltip"),s="object"==typeof n&&n;(a||"destroy"!=n)&&(a||i.data("bs.tooltip",a=new t(this,s)),"string"==typeof n&&a[n]())})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(jQuery),define("bootstrap/tooltip",["jquery"],function(){}),+function(e){var t=function(t,n){this.options=n,this.$element=e(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},t.prototype.show=function(t){var n=this,i=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var i=e.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(document.body),n.$element.show().scrollTop(0),n.$element.addClass("in").attr("aria-hidden",!1),n.enforceFocus();var a=e.Event("shown.bs.modal",{relatedTarget:t});i?n.$element.find(".modal-dialog").one(e.support.transition.end,function(){n.$element.focus().trigger(a)}).emulateTransitionEnd(300):n.$element.focus().trigger(a)}))},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&n;if(this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(document.body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),this.$backdrop.addClass("in"),!t)return;i?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var n=e.fn.modal;e.fn.modal=function(n,i){return this.each(function(){var a=e(this),s=a.data("bs.modal"),o=e.extend({},t.DEFAULTS,a.data(),"object"==typeof n&&n);s||a.data("bs.modal",s=new t(this,o)),"string"==typeof n?s[n](i):o.show&&s.show(i)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),i=n.attr("href"),a=e(n.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),s=a.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(i)&&i},a.data(),n.data());n.is("a")&&t.preventDefault(),a.modal(s,this).one("hide",function(){n.is(":visible")&&n.focus()})}),e(document).on("show.bs.modal",".modal",function(){e(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){e(document.body).removeClass("modal-open")})}(jQuery),define("bootstrap/modal",["jquery"],function(){}),+function(e){var t=function(n,i){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,i),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},t.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t=e.Event("show.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var i=n.data("bs.collapse");if(i&&i.transitioning)return;n.collapse("hide"),i||n.data("bs.collapse",null)}var a=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[a](0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[a]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var o=e.camelCase(["scroll",a].join("-"));this.$element.one(e.support.transition.end,e.proxy(s,this)).emulateTransitionEnd(350)[a](this.$element[0][o])}}},t.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return e.support.transition?void this.$element[n](0).one(e.support.transition.end,e.proxy(i,this)).emulateTransitionEnd(350):i.call(this)}}},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var i=e(this),a=i.data("bs.collapse"),s=e.extend({},t.DEFAULTS,i.data(),"object"==typeof n&&n);!a&&s.toggle&&"show"==n&&(n=!n),a||i.data("bs.collapse",a=new t(this,s)),"string"==typeof n&&a[n]()})},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(t){var n,i=e(this),a=i.attr("data-target")||t.preventDefault()||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),s=e(a),o=s.data("bs.collapse"),r=o?"toggle":i.data(),l=i.attr("data-parent"),c=l&&e(l);o&&o.transitioning||(c&&c.find('[data-toggle=collapse][data-parent="'+l+'"]').not(i).addClass("collapsed"),i[s.hasClass("in")?"addClass":"removeClass"]("collapsed")),s.collapse(r)})}(jQuery),define("bootstrap/collapse",["jquery"],function(){}),function(e){function t(t){this.$element=e(t),this.original_text=this.$element.html(),this.settings=e.extend({},e.fn.trunk8.defaults)}function n(e){var t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText}function i(e){if(n(e)===e)return e.split(/\s/g);for(var t,a,s=[],o=/<([a-z]+)([^<]*)(?:>(.*?(?!<\1>)*)<\/\1>|\s+\/>)(['.?!,]*)|((?:[^<>\s])+['.?!,]*\w?|<br\s?\/?>)/gi,r=o.exec(e);r&&t!==o.lastIndex;)t=o.lastIndex,r[5]?s.push(r[5]):r[1]&&s.push({tag:r[1],attribs:r[2],content:r[3],after:r[4]}),r=o.exec(e);for(a=0;s.length>a;a++)"string"!=typeof s[a]&&s[a].content&&(s[a].content=i(s[a].content));return s}function a(t,n,i){t=t.replace(i,"");var a=function(n,s){var o,r,l,c,d="";for(c=0;n.length>c;c++)o=n[c],l=e.trim(t).split(" ").length,e.trim(t).length&&("string"==typeof o?(/<br\s*\/?>/.test(o)||(1===l&&e.trim(t).length<=o.length?(o=t,("p"===s||"div"===s)&&(o+=i),t=""):t=t.replace(o,"")),d+=e.trim(o)+(c===n.length-1||1>=l?"":" ")):(r=a(o.content,o.tag),o.after&&(t=t.replace(o.after,"")),r&&(o.after||(o.after=" "),d+="<"+o.tag+o.attribs+">"+r+"</"+o.tag+">"+o.after)));return d},s=a(n);return s.slice(s.length-i.length)===i&&(s+=i),s}function s(){var t,s,o,l,d,u,h=this.data("trunk8"),m=h.settings,p=m.width,f=m.side,g=m.fill,v=m.parseHTML,w=r.getLineHeight(this)*m.lines,b=h.original_text,x=b.length,y="";if(this.html(b),d=this.text(),v&&n(b)!==b&&(u=i(b),b=n(b),x=b.length),p===c.auto){if(this.height()<=w)return;for(t=0,s=x-1;s>=t;)o=t+(s-t>>1),l=r.eatStr(b,f,x-o,g),v&&u&&(l=a(l,u,g)),this.html(l),this.height()>w?s=o-1:(t=o+1,y=y.length>l.length?y:l);this.html(""),this.html(y),m.tooltip&&this.attr("title",d)}else isNaN(p)?e.error('Invalid width "'+p+'".'):(o=x-p,l=r.eatStr(b,f,o,g),this.html(l),m.tooltip&&this.attr("title",b))}var o,r,l={center:"center",left:"left",right:"right"},c={auto:"auto"};t.prototype.updateSettings=function(t){this.settings=e.extend(this.settings,t)},o={init:function(n){return this.each(function(){var i=e(this),a=i.data("trunk8");a||i.data("trunk8",a=new t(this)),a.updateSettings(n),s.call(i)})},update:function(t){return this.each(function(){var n=e(this);t&&(n.data("trunk8").original_text=t),s.call(n)})},revert:function(){return this.each(function(){var t=e(this).data("trunk8").original_text;e(this).html(t)})},getSettings:function(){return e(this.get(0)).data("trunk8").settings}},r={eatStr:function(t,n,i,a){var s,o,c=t.length,d=r.eatStr.generateKey.apply(null,arguments);if(r.eatStr.cache[d])return r.eatStr.cache[d];if(("string"!=typeof t||0===c)&&e.error('Invalid source string "'+t+'".'),0>i||i>c)e.error('Invalid bite size "'+i+'".');else if(0===i)return t;switch("string"!=typeof(a+"")&&e.error("Fill unable to be converted to a string."),n){case l.right:return r.eatStr.cache[d]=e.trim(t.substr(0,c-i))+a;case l.left:return r.eatStr.cache[d]=a+e.trim(t.substr(i));case l.center:return s=c>>1,o=i>>1,r.eatStr.cache[d]=e.trim(r.eatStr(t.substr(0,c-s),l.right,i-o,""))+a+e.trim(r.eatStr(t.substr(c-s),l.left,o,""));default:e.error('Invalid side "'+n+'".')}},getLineHeight:function(t){var n=e(t).css("float");"none"!==n&&e(t).css("float","none");var i=e(t).css("position");"absolute"===i&&e(t).css("position","static");var a,s=e(t).html();return e(t).html("i"),a=e(t).parent().innerHeight(),e(t).html(s).css({"float":n,position:i}),a}},r.eatStr.cache={},r.eatStr.generateKey=function(){return Array.prototype.join.call(arguments,"")},e.fn.trunk8=function(t){return o[t]?o[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.trunk8"):o.init.apply(this,arguments)},e.fn.trunk8.defaults={fill:"&hellip;",lines:1,side:l.right,tooltip:!0,width:c.auto,parseHTML:!1}}(jQuery),define("jquery.trunk8",["jquery"],function(){}),define("home/main",["home/config","home/utils/layoutUtils","Router","home/models/Session","core/config/urls","jquery","backbone","home/mixins/asEmbedApp","home/utils/sidebarUtils","home/utils/navigationUtils","bootstrap/dropdown","bootstrap/tooltip","bootstrap/modal","bootstrap/collapse","jquery.trunk8"],function(e,t,n,i,a,s,o,r,l,c){function d(){var e=window.location;if(e.hash.length>1&&("/home"===e.pathname||"/home/"===e.pathname)){var t={pathname:"/home/"+e.hash.slice(1).replace(/^\//,""),search:e.search,hash:"",host:e.host};if(c.matchesRoute(t))return c.navigate(t,!0)}return o.history.loadUrl()}var u=function(e){window.IS_DEV?require(["fixtures/fixtures"],e):e()};return{_init:function(i){var a=new n(i);a.bootstrap(),t.getScreenWidth()<=480&&(s.fn.tooltip=function(){}),window.DISQUS=window.DISQUS||{},window.DISQUS.home={app:a},u(function(){o.history.start({pushState:!0,hashChange:!1,root:e.appRoot,silent:!0}),d()||a.notFound()})},init:function(e){a.cdn=e.CDN_ROOT;var t=this;l.isSidebar()&&r(n.prototype,i.prototype),s(function(){t._init(e)})}}}),!function(e,t){function n(e,t){var n,i;t=t||{},e="raven"+e.substr(0,1).toUpperCase()+e.substr(1),document.createEvent?(n=document.createEvent("HTMLEvents"),n.initEvent(e,!0,!0)):(n=document.createEventObject(),n.eventType=e);for(i in t)u(t,i)&&(n[i]=t[i]);if(document.createEvent)document.dispatchEvent(n);else try{document.fireEvent("on"+n.eventType.toLowerCase(),n)}catch(a){}}function i(e){this.name="RavenConfigError",this.message=e}function a(e){var t=Y.exec(e),n={},a=7;try{for(;a--;)n[G[a]]=t[a]||""}catch(s){throw new i("Invalid DSN: "+e)}if(n.pass)throw new i("Do not specify your private key in the DSN!");return n}function s(e){return void 0===e}function o(e){return"function"==typeof e}function r(e){return"[object String]"===z.toString.call(e)}function l(e){return"object"==typeof e&&null!==e}function c(e){for(var t in e)return!1;return!0}function d(e){return l(e)&&"[object Error]"===z.toString.call(e)||e instanceof Error}function u(e,t){return z.hasOwnProperty.call(e,t)}function h(e,t){var n,i;if(s(e.length))for(n in e)u(e,n)&&t.call(null,n,e[n]);else if(i=e.length)for(n=0;i>n;n++)t.call(null,n,e[n])}function m(){L="?sentry_version=4&sentry_client=raven-js/"+W.VERSION+"&sentry_key="+I}function p(e,t){var i=[];e.stack&&e.stack.length&&h(e.stack,function(e,t){var n=f(t);n&&i.push(n)}),n("handle",{stackInfo:e,options:t}),v(e.name,e.message,e.url,e.lineno,i,t)}function f(e){if(e.url){var t,n={filename:e.url,lineno:e.line,colno:e.column,"function":e.func||"?"},i=g(e);if(i){var a=["pre_context","context_line","post_context"];for(t=3;t--;)n[a[t]]=i[t]}return n.in_app=!(!$.includePaths.test(n.filename)||/(Raven|TraceKit)\./.test(n["function"])||/raven\.(min\.)?js$/.test(n.filename)),n}}function g(e){if(e.context&&$.fetchContext){for(var t=e.context,n=~~(t.length/2),i=t.length,a=!1;i--;)if(t[i].length>300){a=!0;break}if(a){if(s(e.column))return;return[[],t[n].substr(e.column,50),[]]}return[t.slice(0,n),t[n],t.slice(n+1)]}}function v(e,t,n,i,a,s){var o,r;t+="",("Error"!==e||t)&&($.ignoreErrors.test(t)||(a&&a.length?(n=a[0].filename||n,a.reverse(),o={frames:a}):n&&(o={frames:[{filename:n,lineno:i,in_app:!0}]}),t=b(t,$.maxMessageLength),$.ignoreUrls&&$.ignoreUrls.test(n)||(!$.whitelistUrls||$.whitelistUrls.test(n))&&(r=i?t+" at "+i:t,_(w({exception:{type:e,value:t},stacktrace:o,culprit:n,message:r},s)))))}function w(e,t){return t?(h(t,function(t,n){e[t]=n}),e):e}function b(e,t){return t>=e.length?e:e.substr(0,t)+"…"}function x(){return+new Date}function y(){var e={url:document.location.href,headers:{"User-Agent":navigator.userAgent}};return document.referrer&&(e.headers.Referer=document.referrer),e}function _(e){T()&&(e=w({project:U,logger:$.logger,platform:"javascript",request:y()},e),e.tags=w(w({},$.tags),e.tags),e.extra=w(w({},$.extra),e.extra),e.extra=w({"session:duration":x()-B},e.extra),c(e.tags)&&delete e.tags,O&&(e.user=O),$.release&&(e.release=$.release),o($.dataCallback)&&(e=$.dataCallback(e)||e),e&&!c(e)&&(!o($.shouldSendCallback)||$.shouldSendCallback(e))&&(R=e.event_id||(e.event_id=E()),k(e)))}function k(e){var t=C(),i=N+L+"&sentry_data="+encodeURIComponent(JSON.stringify(e));t.crossOrigin="anonymous",t.onload=function(){n("success",{data:e,src:i})},t.onerror=t.onabort=function(){n("failure",{data:e,src:i})},t.src=i}function C(){return document.createElement("img")}function T(){return H?N?!0:(F("error","Error: Raven has not been configured."),!1):!1}function S(e){for(var t,n=[],i=0,a=e.length;a>i;i++)t=e[i],r(t)?n.push(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):t&&t.source&&n.push(t.source);return RegExp(n.join("|"),"i")}function E(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}function F(t,n){e.console&&console[t]&&W.debug&&console[t](n)}function P(){var t=e.RavenConfig;t&&W.config(t.dsn,t.config).install()}var D={remoteFetching:!1,collectWindowErrors:!0,linesOfContext:7},M=[].slice,V="?";D.wrap=function(e){function t(){try{return e.apply(this,arguments)}catch(t){throw D.report(t),t}}return t},D.report=function(){function n(e){r(),p.push(e)}function i(e){for(var t=p.length-1;t>=0;--t)p[t]===e&&p.splice(t,1)}function a(){l(),p=[]}function s(e,t){var n=null;if(!t||D.collectWindowErrors){for(var i in p)if(u(p,i))try{p[i].apply(null,[e].concat(M.call(arguments,2)))}catch(a){n=a}if(n)throw n}}function o(e,t,n,i,a){var o=null;if(v)D.computeStackTrace.augmentStackTraceWithInitialElement(v,t,n,e),c();else if(a)o=D.computeStackTrace(a),s(o,!0);else{var r={url:t,line:n,column:i};r.func=D.computeStackTrace.guessFunctionName(r.url,r.line),r.context=D.computeStackTrace.gatherContext(r.url,r.line),o={message:e,url:document.location.href,stack:[r]},s(o,!0)}return h?h.apply(this,arguments):!1}function r(){m||(h=e.onerror,e.onerror=o,m=!0)}function l(){m&&(e.onerror=h,m=!1,h=t)}function c(){var e=v,t=f;f=null,v=null,g=null,s.apply(null,[e,!1].concat(t))}function d(t,n){var i=M.call(arguments,1);if(v){if(g===t)return;c()}var a=D.computeStackTrace(t);if(v=a,g=t,f=i,e.setTimeout(function(){g===t&&c()},a.incomplete?2e3:0),n!==!1)throw t}var h,m,p=[],f=null,g=null,v=null;return d.subscribe=n,d.unsubscribe=i,d.uninstall=a,d}(),D.computeStackTrace=function(){function t(t){if(!D.remoteFetching)return"";try{var n=function(){try{return new e.XMLHttpRequest}catch(t){return new e.ActiveXObject("Microsoft.XMLHTTP")}},i=n();return i.open("GET",t,!1),i.send(""),i.responseText}catch(a){return""}}function n(e){if(!r(e))return[];if(!u(x,e)){var n="";-1!==e.indexOf(document.domain)&&(n=t(e)),x[e]=n?n.split("\n"):[]}return x[e]}function i(e,t){var i,a=/function ([^(]*)\(([^)]*)\)/,o=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,r="",l=10,c=n(e);if(!c.length)return V;for(var d=0;l>d;++d)if(r=c[t-d]+r,!s(r)){if(i=o.exec(r))return i[1];if(i=a.exec(r))return i[1]}return V}function a(e,t){var i=n(e);if(!i.length)return null;var a=[],o=Math.floor(D.linesOfContext/2),r=o+D.linesOfContext%2,l=Math.max(0,t-o-1),c=Math.min(i.length,t+r-1);t-=1;for(var d=l;c>d;++d)s(i[d])||a.push(i[d]);return a.length>0?a:null}function o(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,"\\$&")}function l(e){return o(e).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function c(e,t){for(var i,a,s=0,o=t.length;o>s;++s)if((i=n(t[s])).length&&(i=i.join("\n"),a=e.exec(i)))return{url:t[s],line:i.substring(0,a.index).split("\n").length,column:a.index-i.lastIndexOf("\n",a.index)-1};return null}function d(e,t,i){var a,s=n(t),r=RegExp("\\b"+o(e)+"\\b");return i-=1,s&&s.length>i&&(a=r.exec(s[i]))?a.index:null}function h(t){for(var n,i,a,s,r=[e.location.href],d=document.getElementsByTagName("script"),u=""+t,h=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]*)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,m=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,p=0;d.length>p;++p){var f=d[p];f.src&&r.push(f.src)}if(a=h.exec(u)){var g=a[1]?"\\s+"+a[1]:"",v=a[2].split(",").join("\\s*,\\s*");n=o(a[3]).replace(/;$/,";?"),i=RegExp("function"+g+"\\s*\\(\\s*"+v+"\\s*\\)\\s*{\\s*"+n+"\\s*}")}else i=RegExp(o(u).replace(/\s+/g,"\\s+"));if(s=c(i,r))return s;if(a=m.exec(u)){var w=a[1];if(n=l(a[2]),i=RegExp("on"+w+"=[\\'\"]\\s*"+n+"\\s*[\\'\"]","i"),s=c(i,r[0]))return s;if(i=RegExp(n),s=c(i,r))return s}return null}function m(e){if(!e.stack)return null;for(var t,n,o=/^\s*at (.*?) ?\(?((?:file|https?|chrome-extension):.*?):(\d+)(?::(\d+))?\)?\s*$/i,r=/^\s*(.*?)(?:\((.*?)\))?@((?:file|https?|chrome).*?):(\d+)(?::(\d+))?\s*$/i,l=e.stack.split("\n"),c=[],u=/^(.*) is undefined$/.exec(e.message),h=0,m=l.length;m>h;++h){if(t=r.exec(l[h]))n={url:t[3],func:t[1]||V,args:t[2]?t[2].split(","):"",line:+t[4],column:t[5]?+t[5]:null};else{if(!(t=o.exec(l[h])))continue;n={url:t[2],func:t[1]||V,line:+t[3],column:t[4]?+t[4]:null}}!n.func&&n.line&&(n.func=i(n.url,n.line)),n.line&&(n.context=a(n.url,n.line)),c.push(n)}return c.length?(c[0].line&&!c[0].column&&u?c[0].column=d(u[1],c[0].url,c[0].line):c[0].column||s(e.columnNumber)||(c[0].column=e.columnNumber+1),{name:e.name,message:e.message,url:document.location.href,stack:c}):null}function p(e){for(var t,n=e.stacktrace,s=/ line (\d+), column (\d+) in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\) in (.*):\s*$/i,o=n.split("\n"),r=[],l=0,c=o.length;c>l;l+=2)if(t=s.exec(o[l])){var d={line:+t[1],column:+t[2],func:t[3]||t[4],args:t[5]?t[5].split(","):[],url:t[6]};if(!d.func&&d.line&&(d.func=i(d.url,d.line)),d.line)try{d.context=a(d.url,d.line)}catch(u){}d.context||(d.context=[o[l+1]]),r.push(d)}return r.length?{name:e.name,message:e.message,url:document.location.href,stack:r}:null}function f(t){var s=t.message.split("\n");if(4>s.length)return null;var o,r,d,h,m=/^\s*Line (\d+) of linked script ((?:file|https?)\S+)(?:: in function (\S+))?\s*$/i,p=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|https?)\S+)(?:: in function (\S+))?\s*$/i,f=/^\s*Line (\d+) of function script\s*$/i,g=[],v=document.getElementsByTagName("script"),w=[];for(r in v)u(v,r)&&!v[r].src&&w.push(v[r]);for(r=2,d=s.length;d>r;r+=2){var b=null;if(o=m.exec(s[r]))b={url:o[2],func:o[3],line:+o[1]};else if(o=p.exec(s[r])){b={url:o[3],func:o[4]};var x=+o[1],y=w[o[2]-1];if(y&&(h=n(b.url))){h=h.join("\n");var _=h.indexOf(y.innerText);_>=0&&(b.line=x+h.substring(0,_).split("\n").length)}}else if(o=f.exec(s[r])){var k=e.location.href.replace(/#.*$/,""),C=o[1],T=RegExp(l(s[r+1]));h=c(T,[k]),b={url:k,line:h?h.line:C,func:""}}if(b){b.func||(b.func=i(b.url,b.line));var S=a(b.url,b.line),E=S?S[Math.floor(S.length/2)]:null;b.context=S&&E.replace(/^\s*/,"")===s[r+1].replace(/^\s*/,"")?S:[s[r+1]],g.push(b)}}return g.length?{name:t.name,message:s[0],url:document.location.href,stack:g}:null}function g(e,t,n,s){var o={url:t,line:n};if(o.url&&o.line){e.incomplete=!1,o.func||(o.func=i(o.url,o.line)),o.context||(o.context=a(o.url,o.line));var r=/ '([^']+)' /.exec(s);if(r&&(o.column=d(r[1],o.url,o.line)),e.stack.length>0&&e.stack[0].url===o.url){if(e.stack[0].line===o.line)return!1;if(!e.stack[0].line&&e.stack[0].func===o.func)return e.stack[0].line=o.line,e.stack[0].context=o.context,!1}return e.stack.unshift(o),e.partial=!0,!0}return e.incomplete=!0,!1}function v(e,t){for(var n,a,s,o=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,r=[],l={},c=!1,u=v.caller;u&&!c;u=u.caller)if(u!==w&&u!==D.report){if(a={url:null,func:V,line:null,column:null},u.name?a.func=u.name:(n=o.exec(""+u))&&(a.func=n[1]),s=h(u)){a.url=s.url,a.line=s.line,a.func===V&&(a.func=i(a.url,a.line));var m=/ '([^']+)' /.exec(e.message||e.description);m&&(a.column=d(m[1],s.url,s.line))}l[""+u]?c=!0:l[""+u]=!0,r.push(a)}t&&r.splice(0,t);var p={name:e.name,message:e.message,url:document.location.href,stack:r};return g(p,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),p}function w(e,t){var n=null;t=null==t?0:+t;try{if(n=p(e))return n}catch(i){if(b)throw i}try{if(n=m(e))return n}catch(i){if(b)throw i}try{if(n=f(e))return n}catch(i){if(b)throw i}try{if(n=v(e,t+1))return n}catch(i){if(b)throw i}return{}}var b=!1,x={};return w.augmentStackTraceWithInitialElement=g,w.computeStackTraceFromStackProp=m,w.guessFunctionName=i,w.gatherContext=a,w}();var A,R,N,O,I,U,L,q=e.Raven,H=!("object"!=typeof JSON||!JSON.stringify),$={logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],collectWindowErrors:!0,tags:{},maxMessageLength:100,extra:{}},j=!1,z=Object.prototype,B=x(),W={VERSION:"1.1.19",debug:!0,noConflict:function(){return e.Raven=q,W},config:function(e,t){if(N)return F("error","Error: Raven has already been configured"),W;if(!e)return W;var n=a(e),i=n.path.lastIndexOf("/"),s=n.path.substr(1,i);return t&&h(t,function(e,t){$[e]=t}),$.ignoreErrors.push(/^Script error\.?$/),$.ignoreErrors.push(/^Javascript error: Script error\.? on line 0$/),$.ignoreErrors=S($.ignoreErrors),$.ignoreUrls=$.ignoreUrls.length?S($.ignoreUrls):!1,$.whitelistUrls=$.whitelistUrls.length?S($.whitelistUrls):!1,$.includePaths=S($.includePaths),I=n.user,U=n.path.substr(i+1),N="//"+n.host+(n.port?":"+n.port:"")+"/"+s+"api/"+U+"/store/",n.protocol&&(N=n.protocol+":"+N),$.fetchContext&&(D.remoteFetching=!0),$.linesOfContext&&(D.linesOfContext=$.linesOfContext),D.collectWindowErrors=!!$.collectWindowErrors,m(),W},install:function(){return T()&&!j&&(D.report.subscribe(p),j=!0),W},context:function(e,n,i){return o(e)&&(i=n||[],n=e,e=t),W.wrap(e,n).apply(this,i)},wrap:function(e,n){function i(){for(var t=[],i=arguments.length,a=!e||e&&e.deep!==!1;i--;)t[i]=a?W.wrap(e,arguments[i]):arguments[i];try{return n.apply(this,t)}catch(s){throw W.captureException(s,e),s}}if(s(n)&&!o(e))return e;if(o(e)&&(n=e,e=t),!o(n))return n;if(n.__raven__)return n;for(var a in n)u(n,a)&&(i[a]=n[a]);return i.__raven__=!0,i.__inner__=n,i},uninstall:function(){return D.report.uninstall(),j=!1,W},captureException:function(e,t){if(!d(e))return W.captureMessage(e,t);A=e;try{D.report(e,t)}catch(n){if(e!==n)throw n}return W},captureMessage:function(e,t){return $.ignoreErrors.test&&$.ignoreErrors.test(e)?void 0:(_(w({message:e+""},t)),W)},setUserContext:function(e){return O=e,W},setExtraContext:function(e){return $.extra=e||{},W},setTagsContext:function(e){return $.tags=e||{},W},setReleaseContext:function(e){return $.release=e,W},setDataCallback:function(e){return $.dataCallback=e,W},setShouldSendCallback:function(e){return $.shouldSendCallback=e,W},lastException:function(){return A},lastEventId:function(){return R},isSetup:function(){return T()}};W.setUser=W.setUserContext;var G="source protocol user pass host port path".split(" "),Y=/^(?:(\w+):)?\/\/(\w+)(:\w+)?@([\w\.-]+)(?::(\d+))?(\/.*)/;i.prototype=Error(),i.prototype.constructor=i,P(),"function"==typeof define&&define.amd?(e.Raven=W,define("raven",[],function(){return W})):"object"==typeof module?module.exports=W:"object"==typeof exports?exports=W:e.Raven=W}("undefined"!=typeof window?window:this);
//# sourceMappingURL=main.js.map